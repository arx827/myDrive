!function(t){function e(e){for(var i,n,r=e[0],l=e[1],c=e[2],u=0,p=[];u<r.length;u++)n=r[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&p.push(s[n][0]),s[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);for(d&&d(e);p.length;)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],i=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(i=!1)}i&&(o.splice(e--,1),t=n(n.s=a[0]))}return t}var i={},s={app:0},o=[];function n(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=i,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;o.push([0,"chunk-ant-design-vue","vendors~app"]),a()}({0:function(t,e,a){t.exports=a("cd49")},"0018":function(t,e,a){t.exports=a.p+"img/icon_enter1_o.ec44f652.svg"},"00b6":function(t,e,a){t.exports=a.p+"img/AccountAgentIndex.683bd771.svg"},"016f":function(t,e,a){t.exports=a.p+"img/icon_store_o.60c53951.svg"},"02a7":function(t,e,a){},"02fb":function(t,e,a){t.exports=a.p+"img/icon-fubon-logo.edd6b118.svg"},"048c":function(t,e,a){},"04cc":function(t,e,a){"use strict";a("6a88")},"04db":function(t,e,a){"use strict";a("5ca2")},"04e5":function(t,e,a){},"056d":function(t,e,a){t.exports=a.p+"img/icon_group.9fa348da.svg"},"06af":function(t,e,a){t.exports=a.p+"img/icon_course_o.b7e5e5b1.svg"},"0931":function(t,e,a){},"0993":function(t,e,a){t.exports=a.p+"img/icon_export2.943a908f.svg"},"09a1":function(t,e,a){t.exports=a.p+"img/icon_change.79efa5f7.svg"},"0a61":function(t,e,a){t.exports=a.p+"img/icon_set_up_o.fa553d1a.svg"},"0a75":function(t,e,a){},"0b8c":function(t,e,a){},"0c4d":function(t,e,a){t.exports=a.p+"img/icon_delete-action_none.ac0793de.svg"},"0d7a":function(t,e,a){},"0f11":function(t,e,a){t.exports=a.p+"img/icon_window.85ff277b.svg"},"0f47":function(t,e,a){"use strict";a("16ab")},1:function(t,e){},10:function(t,e){},1048:function(t,e,a){var i={"./AccountAgentIndex.svg":"00b6","./AccountIndex.svg":"1de5","./AuditMeetingIndex.svg":"1f2b","./AuditOpinionIndex.svg":"d6e4","./AuditPlanIndex.svg":"677e","./AuditReportIndex.svg":"e5e3","./DataCollectIndex.svg":"df5f","./IssueTrackingIndex.svg":"ec5e","./ParameterIndex.svg":"eedc","./PreparationIndex.svg":"16a0","./WorkPaperIndex.svg":"a37b","./icon-home-left-bg.svg":"edf9","./icon-home-right-bg.svg":"db05","./icon-home-title.svg":"640c"};function s(t){var e=o(t);return a(e)}function o(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=o,t.exports=s,s.id="1048"},1097:function(t,e,a){"use strict";a("a57e")},"10a1":function(t,e,a){},"10df":function(t,e,a){t.exports=a.p+"img/icon_upload.e44a23b6.svg"},11:function(t,e){},12:function(t,e){},"126a":function(t,e,a){"use strict";a("5c95")},"12b2":function(t,e,a){},13:function(t,e){},14:function(t,e){},1490:function(t,e,a){"use strict";a("f3c3")},"14a0":function(t,e,a){t.exports=a.p+"img/icon-home-people.c3128403.svg"},1543:function(t,e,a){t.exports=a.p+"img/icon_enter1.708aacae.svg"},1578:function(t,e,a){"use strict";a("81ef")},1697:function(t,e,a){},"16a0":function(t,e,a){t.exports=a.p+"img/PreparationIndex.308f2126.svg"},"16ab":function(t,e,a){},"16d9":function(t,e,a){},"178a":function(t,e,a){t.exports=a.p+"img/icon_delete.14cb6965.svg"},"178e":function(t,e,a){},"18f2":function(t,e,a){},"18f3":function(t,e,a){},"194e":function(t,e,a){t.exports=a.p+"img/icon_window_close.fe8441aa.svg"},"197b":function(t,e,a){t.exports=a.p+"img/icon_edit-acion_none.7d91626a.svg"},"1a9b":function(t,e,a){t.exports=a.p+"img/icon_questionnaire.4f2494fa.svg"},"1b53":function(t,e,a){"use strict";a("cb26")},"1b6c":function(t,e,a){t.exports=a.p+"img/icon_house_o.0e6c127a.svg"},"1b99":function(t,e,a){t.exports=a.p+"img/icon_top.4b7a9fd8.svg"},"1db4":function(t,e,a){},"1dbe":function(t,e,a){},"1de5":function(t,e,a){t.exports=a.p+"img/AccountIndex.a69c1a50.svg"},"1f2b":function(t,e,a){t.exports=a.p+"img/AuditMeetingIndex.11c2da8d.svg"},"1f4a":function(t,e,a){t.exports=a.p+"img/icon_recogniz_ok.a4d656d9.svg"},"1f9b":function(t,e,a){t.exports=a.p+"img/icon_mail_none.1c42581f.svg"},2:function(t,e){},"219a":function(t,e,a){"use strict";a("02a7")},"22ef":function(t,e,a){"use strict";a("1697")},"23ee":function(t,e,a){t.exports=a.p+"img/icon_add.018ae9ee.svg"},2581:function(t,e,a){},"274f":function(t,e,a){"use strict";a("db86")},"27d1":function(t,e,a){},2820:function(t,e,a){t.exports=a.p+"img/icon_export.e612fb86.svg"},"28a9":function(t,e,a){"use strict";a("ffe5")},"2a94":function(t,e,a){t.exports=a.p+"img/icon_delete-action_o.1195f117.svg"},"2b6d":function(t,e,a){"use strict";a("ebe1")},"2bb4":function(t,e,a){t.exports=a.p+"img/icon_announcement_1.26d633ef.svg"},"2c2a":function(t,e,a){},"2cad":function(t,e,a){t.exports=a.p+"img/icon_edit_none.ebdfd396.svg"},"2e00":function(t,e,a){},"2e674":function(t,e,a){t.exports=a.p+"img/icon_questionnaire_o.3de3fabf.svg"},"2ed7":function(t,e,a){t.exports=a.p+"img/icon_add_project.8a92c61d.svg"},"2fb7":function(t,e,a){"use strict";a("e4e4")},3:function(t,e){},"310b":function(t,e,a){t.exports=a.p+"img/icon_delete_name.b1ebb0e7.svg"},3112:function(t,e,a){"use strict";a("9a72")},"31c9":function(t,e,a){t.exports=a.p+"img/icon_enter.0b25fda5.svg"},"31d9":function(t,e,a){t.exports=a.p+"img/icon_question.a7b55af5.svg"},"322f":function(t,e,a){},3253:function(t,e,a){t.exports=a.p+"img/icon_remind.e8e271b2.svg"},3273:function(t,e,a){},"32c6":function(t,e,a){t.exports=a.p+"img/icon_communicate.83d5e839.svg"},"32cf":function(t,e,a){t.exports=a.p+"img/icon-login-4.194482f2.svg"},"339f":function(t,e,a){t.exports=a.p+"img/icon-login-2.8cc30ec6.svg"},"33d1":function(t,e,a){"use strict";a("0d7a")},3404:function(t,e,a){},3415:function(t,e,a){t.exports=a.p+"img/icon_manpower_o.ec0115d4.svg"},"361a":function(t,e,a){},"364c":function(t,e,a){t.exports=a.p+"img/icon_delete_name_o.22a7f4db.svg"},3668:function(t,e,a){t.exports=a.p+"img/icon_communicate1_n.653896db.svg"},"373e":function(t,e,a){t.exports=a.p+"img/icon_time_out.fb734e69.svg"},"37a7":function(t,e,a){},"37c2":function(t,e,a){t.exports=a.p+"img/icon_start_o.4349e104.svg"},"37ce":function(t,e,a){},"37fb":function(t,e,a){"use strict";a("db1b")},3817:function(t,e,a){t.exports=a.p+"img/icon-login-7.c81b1617.svg"},3968:function(t,e,a){"use strict";a("0931")},"39a1":function(t,e,a){"use strict";a("f7c7")},"3ac8":function(t,e,a){"use strict";a("cc04")},"3be3":function(t,e,a){},"3be4":function(t,e,a){t.exports=a.p+"img/icon_comparison_d_o.a30cc15c.svg"},"3c7c":function(t,e,a){t.exports=a.p+"img/icon-no-found.291266af.svg"},"3cd1":function(t,e,a){"use strict";a("8983")},"3de8":function(t,e,a){t.exports=a.p+"img/icon_change_none.dfb1c0a7.svg"},"3e1a":function(t,e,a){t.exports=a.p+"img/icon_confirm.db6a68c8.svg"},"3e99":function(t,e,a){"use strict";a("3be3")},4:function(t,e){},"41e7":function(t,e,a){"use strict";a("cb52")},4255:function(t,e,a){t.exports=a.p+"img/icon_record.267dc443.svg"},4257:function(t,e,a){t.exports=a.p+"img/icon_small_delete.46c077ed.svg"},4270:function(t,e,a){"use strict";a("fd75")},"428a":function(t,e,a){t.exports=a.p+"img/icon_record_o.ea7a9084.svg"},"42d8":function(t,e,a){},"443f":function(t,e,a){"use strict";a("2c2a")},"44de":function(t,e,a){},"455f":function(t,e,a){},4580:function(t,e,a){t.exports=a.p+"img/icon_return.5920e6be.svg"},"45d7":function(t,e,a){t.exports=a.p+"img/icon_download_none.4904fb96.svg"},"45da":function(t,e,a){"use strict";a("3404")},4669:function(t,e,a){"use strict";a("10a1")},4678:function(t,e,a){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fbd","./ml.js":"02fbd","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=o(t);return a(e)}function o(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=o,t.exports=s,s.id="4678"},4688:function(t,e,a){},"46ef":function(t,e,a){},"47e7":function(t,e,a){t.exports=a.p+"img/icon_sort_o.ba50f9c3.svg"},"495c":function(t,e,a){t.exports=a.p+"img/icon-password.4a2044a3.svg"},4961:function(t,e,a){t.exports=a.p+"img/icon-login-3.60a0e70c.svg"},"49d8":function(t,e,a){t.exports=a.p+"img/icon-home-collect.90c258cc.svg"},"4b0d":function(t,e,a){t.exports=a.p+"img/icon-right-bg.422457cd.svg"},"4bc9":function(t,e,a){t.exports=a.p+"img/icon_remind.e8e271b2.svg"},"4e1a":function(t,e,a){"use strict";a("f58d")},"4fc7":function(t,e,a){"use strict";a("e28b")},"4fce":function(t,e,a){t.exports=a.p+"img/icon_small_delete_o.5531b7c7.svg"},5:function(t,e){},5054:function(t,e,a){"use strict";a("78ce")},"50bf":function(t,e,a){"use strict";a("6b2c")},"50d2":function(t,e,a){},"51bc":function(t,e,a){t.exports=a.p+"img/icon_successfully.f84b43c1.svg"},"527d":function(t,e,a){t.exports=a.p+"img/icon_bell.a7f5ece4.svg"},5365:function(t,e,a){},5395:function(t,e,a){t.exports=a.p+"img/icon_subproject_close.64adf918.svg"},5398:function(t,e,a){t.exports=a.p+"img/icon_news.87cabb4e.svg"},"53f8":function(t,e,a){"use strict";a("62b5")},5430:function(t,e,a){t.exports=a.p+"img/icon_recogniz.c48419e5.svg"},"54ef":function(t,e,a){},5526:function(t,e,a){"use strict";a("4688")},5633:function(t,e,a){t.exports=a.p+"img/icon_small_link.e6714448.svg"},5679:function(t,e,a){"use strict";a("b25d")},"573e":function(t,e,a){t.exports=a.p+"img/icon_comparison_o.79897d27.svg"},"58e0":function(t,e,a){t.exports=a.p+"img/icon_question_red.571e1cca.svg"},"59d5":function(t,e,a){},"5a3c":function(t,e,a){},"5ada":function(t,e,a){},"5b64":function(t,e,a){"use strict";a("eb0e")},"5bda":function(t,e,a){t.exports=a.p+"img/icon_check_fin_o.99049887.svg"},"5bf4":function(t,e,a){"use strict";a("92e5")},"5c95":function(t,e,a){},"5c9f":function(t,e,a){"use strict";a("3273")},"5ca2":function(t,e,a){},"5cb7":function(t,e,a){"use strict";a("178e")},"5cfc":function(t,e,a){"use strict";a("a17e")},"5d51":function(t,e,a){},"5d84":function(t,e,a){t.exports=a.p+"img/icon_communicate1_o.bc543386.svg"},"5d92":function(t,e,a){t.exports=a.p+"img/icon_version_o.afd7e757.svg"},"5dc1":function(t,e,a){t.exports=a.p+"img/icon_edit.1ab835d0.svg"},"5ded":function(t,e,a){t.exports=a.p+"img/icon_version.843f7794.svg"},"5e97":function(t,e,a){},"5f5e":function(t,e,a){},"5fae":function(t,e,a){},6:function(t,e){},6030:function(t,e,a){},"615d":function(t,e,a){},"61d6":function(t,e,a){t.exports=a.p+"img/icon_download.977cd920.svg"},6246:function(t,e,a){"use strict";a("7616")},"62b5":function(t,e,a){},"640c":function(t,e,a){t.exports=a.p+"img/icon-home-title.13d467a3.svg"},6461:function(t,e,a){t.exports=a.p+"img/icon_web_linke_o.1f0ff2f1.svg"},6579:function(t,e,a){"use strict";a("12b2")},"670b":function(t,e,a){t.exports=a.p+"img/icon_question.a27b47c3.svg"},"677e":function(t,e,a){t.exports=a.p+"img/AuditPlanIndex.a36b0dca.svg"},6817:function(t,e,a){t.exports=a.p+"img/icon_closed_o.c183c86f.svg"},"68da":function(t,e,a){t.exports=a.p+"img/icon_export1.aef83d70.svg"},"68f8":function(t,e,a){"use strict";a("18f3")},6987:function(t,e,a){t.exports=a.p+"img/icon_recogniz_no.62f5206b.svg"},"6a29":function(t,e,a){},"6a88":function(t,e,a){},"6b2c":function(t,e,a){},"6cb2":function(t,e,a){"use strict";a("9a34")},"6dcf":function(t,e,a){t.exports=a.p+"img/icon_return_o.710c7e57.svg"},"6e0f":function(t,e,a){t.exports=a.p+"img/icon-home-system.b92e52c4.svg"},"6e34":function(t,e,a){t.exports=a.p+"img/icon_comparison_d.8fda2003.svg"},"6eed":function(t,e,a){},"6f02":function(t,e,a){t.exports=a.p+"img/icon_export2_o.ae23ea63.svg"},"6f14":function(t,e,a){"use strict";a("5fae")},"6f87":function(t,e,a){"use strict";a("9e0b")},7:function(t,e){},"700b":function(t,e,a){"use strict";a("debf")},"70e1":function(t,e,a){"use strict";a("b899")},"71f8":function(t,e,a){"use strict";a("5d51")},"746d":function(t,e,a){"use strict";a("46ef")},"74a8":function(t,e,a){"use strict";a("44de")},"758e":function(t,e,a){},7616:function(t,e,a){},"76f7":function(t,e,a){t.exports=a.p+"img/icon_close.a693e700.svg"},"77f5":function(t,e,a){t.exports=a.p+"img/icon_window.da78d4e7.svg"},"78ce":function(t,e,a){},"7a36":function(t,e,a){"use strict";a("322f")},"7a7e":function(t,e,a){"use strict";a("758e")},"7c34":function(t,e,a){},"7e87":function(t,e,a){"use strict";a("54ef")},"7ff9":function(t,e,a){"use strict";a("6eed")},8:function(t,e){},"81ef":function(t,e,a){},8234:function(t,e,a){"use strict";a("455f")},8268:function(t,e,a){"use strict";a("8765")},"827f":function(t,e,a){"use strict";a("87e3")},"82c7":function(t,e,a){"use strict";a("9412")},"83e4":function(t,e,a){"use strict";a("dc9d")},"850b":function(t,e,a){t.exports=a.p+"img/icon_export_o.3fa56c2a.svg"},"851d":function(t,e,a){t.exports=a.p+"img/icon_declare.d070ea1b.svg"},"85cc":function(t,e,a){t.exports=a.p+"img/icon_canned_o.65627e31.svg"},"86ab":function(t,e,a){t.exports=a.p+"img/icon_communicate_o.af18641f.svg"},8715:function(t,e,a){"use strict";a("0a75")},8765:function(t,e,a){},"87b4":function(t,e,a){},"87ba":function(t,e,a){"use strict";a("87b4")},"87e3":function(t,e,a){},"87e7":function(t,e,a){"use strict";a("a5e7")},8866:function(t,e,a){"use strict";a("5e97")},8983:function(t,e,a){},"8a0e":function(t,e,a){t.exports=a.p+"img/icon_download_o.7dfcc275.svg"},"8bdd":function(t,e,a){t.exports=a.p+"img/icon_bell_o.c265c127.svg"},"8c38":function(t,e,a){t.exports=a.p+"img/icon_question_red_o.f18d52b0.svg"},"8d1d":function(t,e,a){"use strict";a("2581")},"8d50":function(t,e,a){t.exports=a.p+"img/icon_complete_o.ad1447c2.svg"},"8e9f":function(t,e,a){"use strict";a("a148")},"8f1d":function(t,e,a){t.exports=a.p+"img/icon_course.0b20a9cc.svg"},"8f2c":function(t,e,a){t.exports=a.p+"img/icon_export1_o.f4668102.svg"},9:function(t,e){},"909c":function(t,e,a){t.exports=a.p+"img/icon_delete_o.f6312600.svg"},9114:function(t,e,a){"use strict";a("adbe")},"91f3":function(t,e,a){t.exports=a.p+"img/icon_announcement_2.b5ec0884.svg"},9233:function(t,e,a){t.exports=a.p+"img/icon_course-action.bdccd631.svg"},"92e5":function(t,e,a){},"935a":function(t,e,a){t.exports=a.p+"img/icon_confirm_sobv.d167a858.svg"},"93a4":function(t,e,a){t.exports=a.p+"img/icon_edit-acion.93ca5811.svg"},9412:function(t,e,a){},"948ee":function(t,e,a){t.exports=a.p+"img/icon_closed.f20d969e.svg"},"94f8":function(t,e,a){},9661:function(t,e,a){t.exports=a.p+"img/icon_sort.5e6a7272.svg"},"97a5":function(t,e,a){t.exports=a.p+"img/icon_upload1.ee1df8fc.svg"},"97af":function(t,e,a){"use strict";a("50d2")},9811:function(t,e,a){t.exports=a.p+"img/icon_import_o.aae08201.svg"},98393:function(t,e,a){t.exports=a.p+"img/icon-left-bg.2f09dd4a.svg"},9870:function(t,e,a){t.exports=a.p+"img/icon_import.53c15118.svg"},9919:function(t,e,a){},9925:function(t,e,a){t.exports=a.p+"img/icon_canned_add.c95c86bc.svg"},"9a34":function(t,e,a){},"9a72":function(t,e,a){},"9b66":function(t,e,a){t.exports=a.p+"img/icon_manpower.8460c239.svg"},"9e0b":function(t,e,a){},"9e40":function(t,e,a){"use strict";a("0b8c")},"9e57":function(t,e,a){t.exports=a.p+"img/icon-login-1.0ae4b714.svg"},"9fa7":function(t,e,a){},a148:function(t,e,a){},a17e:function(t,e,a){},a207:function(t,e,a){"use strict";a("04e5")},a37b:function(t,e,a){t.exports=a.p+"img/WorkPaperIndex.91ff78ab.svg"},a383:function(t,e,a){t.exports=a.p+"img/icon_add_o.53142e1d.svg"},a3cf:function(t,e,a){t.exports=a.p+"img/icon-breadcrumb-title.044edcd9.svg"},a418:function(t,e,a){t.exports=a.p+"img/icon_review.65d08058.svg"},a57e:function(t,e,a){},a5e7:function(t,e,a){},a6fb:function(t,e,a){"use strict";a("add8")},a754:function(t,e,a){t.exports=a.p+"img/icon_change_o.41ea0a0a.svg"},a787:function(t,e,a){t.exports=a.p+"img/icon_web_linke.20129b34.svg"},a8bb:function(t,e,a){t.exports=a.p+"img/icon_download_light_o.f7c6cc09.svg"},a9b3:function(t,e,a){},aac1:function(t,e,a){"use strict";a("37ce")},abe5:function(t,e,a){},ac2b:function(t,e,a){"use strict";a("048c")},adb0:function(t,e,a){t.exports=a.p+"img/icon_add_name_o.4b090b4a.svg"},adbe:function(t,e,a){},adc0:function(t,e,a){"use strict";a("6a29")},add8:function(t,e,a){},adfe:function(t,e,a){t.exports=a.p+"img/icon_upload1_o.a1c83d5c.svg"},afd7:function(t,e,a){t.exports=a.p+"img/icon_small_link_o.5381c6ad.svg"},b080:function(t,e,a){t.exports=a.p+"img/icon_search_o.01b8d5f2.svg"},b0a2:function(t,e,a){"use strict";a("b776")},b1b0:function(t,e,a){t.exports=a.p+"img/icon_question_o.495613f0.svg"},b1e6:function(t,e,a){t.exports=a.p+"img/icon_start.31792a22.svg"},b1f4:function(t,e,a){"use strict";a("16d9")},b254:function(t,e,a){t.exports=a.p+"img/icon_working_1.1f0898c2.svg"},b25d:function(t,e,a){},b2c9:function(t,e,a){t.exports=a.p+"img/icon_confirm_o.afe0c363.svg"},b32a:function(t,e,a){t.exports=a.p+"img/icon_close_sobv.c06f41d3.svg"},b35c:function(t,e,a){"use strict";a("c711")},b4a1:function(t,e,a){t.exports=a.p+"img/icon_edit-acion_o.c3ee20aa.svg"},b776:function(t,e,a){},b899:function(t,e,a){},b93d:function(t,e,a){"use strict";a("361a")},ba7a:function(t,e,a){"use strict";a("fd5d")},c072:function(t,e,a){t.exports=a.p+"img/icon_feedback_o.6d63529a.svg"},c232:function(t,e,a){t.exports=a.p+"img/icon_house.98ec5df8.svg"},c2f1:function(t,e,a){t.exports=a.p+"img/icon_mail.29580f52.svg"},c646:function(t,e,a){"use strict";a("615d")},c711:function(t,e,a){},c7f3:function(t,e,a){"use strict";a("ff29")},c82c:function(t,e,a){t.exports=a.p+"img/icon_search.3daf1338.svg"},c8fa:function(t,e,a){"use strict";a("37a7")},c97b:function(t,e,a){t.exports=a.p+"img/icon_store.02b464f6.svg"},ca2d:function(t,e,a){t.exports=a.p+"img/icon_complete.157c7842.svg"},cb26:function(t,e,a){},cb52:function(t,e,a){},cbc6:function(t,e,a){t.exports=a.p+"img/icon_check_fin.493c8648.svg"},cbea:function(t,e,a){"use strict";a("9fa7")},cc04:function(t,e,a){},cc35:function(t,e,a){"use strict";a("a9b3")},cccb:function(t,e,a){"use strict";a("27d1")},cd3f:function(t,e,a){t.exports=a.p+"img/icon_feedback.3485c871.svg"},cd49:function(t,e,a){"use strict";a.r(e),a("98a7");var i=a("7bec"),s=(a("5783"),a("59a5")),o=(a("2a26"),a("768f")),n=(a("ee00"),a("bb76")),r=(a("eb14"),a("39ab")),l=(a("5136"),a("681b")),c=(a("9a33"),a("f933")),d=(a("68c7"),a("de1b")),u=(a("1273"),a("f2ca")),p=(a("d2a3"),a("4df5")),m=(a("c119"),a("d865")),h=(a("4a96"),a("a071")),f=(a("55ec"),a("a79d")),g=(a("c68a"),a("0020")),b=(a("b97c3"),a("7571")),v=(a("922d"),a("09d9")),_=(a("5704"),a("b558")),y=(a("f2ef"),a("3af3")),C=(a("7f6b"),a("8592")),O=(a("9d5c"),a("a600")),A=(a("8fb1"),a("0c63")),I=(a("af3d"),a("27fd")),D=(a("34c0"),a("9fd0")),S=(a("fbd8"),a("55f1")),w=(a("1a62"),a("98c5")),k=(a("0032"),a("e32c")),M=(a("de6a"),a("9a63")),x=(a("2ef0"),a("9839")),j=(a("6ba6"),a("5efb")),T=(a("cd17"),a("ed3b")),L=(a("17ac"),a("ff57")),P=(a("7d24"),a("dfae")),R=(a("3b18"),a("f64c")),E=a("2b0e"),$=a("8c4f"),F=a("5b9e"),U=a.n(F),G=(a("154d"),a("ce19")),Y=a("3f08"),N=(a("6030"),a("3e84")),V=a("85fe"),q=a("2eed"),B=a("8c0a"),z=a.n(B),H=a("1443"),Q=new class{install(t){t.prototype.$twDateTimeFormatter={stringify:t=>{if(!t)return"";const e=Object(H.a)(t,"YYYY"),a=parseInt(e,10)-1911;return Object(H.a)(t,a+"/MM/DD HH:mm")},parse:t=>{if(!t)return null;const e=t.match(/(\d+)(\/\d+\/\d+ \d+:\d+:\d+)/);if(!e)return null;const a=`${parseInt(e[1])+1911}${e[2]}`;return Object(H.c)(a,"YYYY/MM/DD HH:mm")}},t.prototype.$twDateFormatter={stringify:t=>{if(!t)return"";const e=Object(H.a)(t,"YYYY"),a=parseInt(e,10)-1911;return Object(H.a)(t,a+"/MM/DD")},parse:t=>{if(!t)return null;const e=t.match(/(\d+)(\/\d+\/\d+)/);if(!e)return null;const a=`${parseInt(e[1])+1911}${e[2]}`;return Object(H.c)(a,"YYYY/MM/DD")}},t.prototype.$twYearFormatter={stringify:t=>{if(!t)return"";const e=Object(H.a)(t,"YYYY"),a=parseInt(e,10)-1911;return Object(H.a)(t,""+a)},parse:t=>{if(!t)return null;if(!t.match(/^[0-1]?\d{1,2}/))return null;const e=""+(parseInt(t)+1911);return Object(H.c)(e,"YYYY")}},t.prototype.$twMonthFormatter={stringify:t=>{if(!t)return"";const e=Object(H.a)(t,"MM");return Object(H.a)(t,""+e)},parse:t=>{if(!t)return null;if(!t.match(/^(0?[1-9]|1[012])$/))return null;const e=""+parseInt(t);return Object(H.c)(e,"MM")}},t.prototype.$adDateTimeFormatter={stringify:t=>t?Object(H.a)(t,"YYYY/MM/DD HH:mm"):"",parse:t=>t?Object(H.c)(t,"YYYY/MM/DD HH:mm"):null},t.prototype.$adDateFormatter={stringify:t=>t?Object(H.a)(t,"YYYY/MM/DD"):"",parse:t=>t?Object(H.c)(t,"YYYY/MM/DD"):null},t.prototype.$adDateTimeLocale={yearFormat:t=>t+" 年"}}};a("ab98"),a("18f2"),a("5b81");var W=new class{download(t,e,a){const i=new Blob([t],{type:a||t.type||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)return void window.navigator.msSaveBlob(i,e);const s=window.URL.createObjectURL(i),o=document.createElement("a");o.style.display="none",o.href=s,o.setAttribute("download",e),void 0===o.download&&o.setAttribute("target","_blank"),document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>{window.URL.revokeObjectURL(s)},100)}downloadFile(t,e){const a=t.data,i=URL.createObjectURL(a),s=document.createElement("a"),o=e||this.getContentDisposition(t.headers)||"未知檔名";s.setAttribute("href",i),s.setAttribute("download",""+o),s.click(),s.remove()}getContentDisposition(t){const e=t["content-disposition"];if(e){const t=e.substring(e.indexOf("filename=")+9).replaceAll('"',"");return decodeURI(t)}return null}convertErrorBlobToString(t){return new Promise((e,a)=>{const i=new FileReader;i.onload=t=>{const a=t.target.result,i=JSON.parse(a);e(i)},i.onerror=t=>{a(t)},i.readAsText(t)})}install(t,e){t.prototype.$blobUtils=this}},K=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step row g-0"},[e("div",{staticClass:"col-6 col-md-4 col-lg"},[e("img",{attrs:{src:a("9e57"),alt:""}})]),e("div",{staticClass:"col-6 col-md-4 col-lg"},[e("img",{attrs:{src:a("339f"),alt:""}})]),e("div",{staticClass:"col-6 col-md-4 col-lg"},[e("img",{attrs:{src:a("4961"),alt:""}})]),e("div",{staticClass:"col-6 col-md-4 col-lg"},[e("img",{attrs:{src:a("32cf"),alt:""}})]),e("div",{staticClass:"col-6 col-md-4 col-lg"},[e("img",{attrs:{src:a("f437"),alt:""}})]),e("div",{staticClass:"col-6 col-md-4 col-lg"},[e("img",{attrs:{src:a("ea59"),alt:""}})]),e("div",{staticClass:"col-6 col-md-4 col-lg"},[e("img",{attrs:{src:a("3817"),alt:""}})])])}],J=a("9ab4"),Z=a("2bd2"),X=a("9f2d"),tt=a("4bb5"),et=a("60a3");let at=class extends et.d{constructor(){super(...arguments),this.unsubscribe$=new Z.a,this.isShowPassword=!1,this.isSSO=!1,this.form={username:"",password:""},this.formRules={username:[{required:!0,message:"請輸入帳號",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"}]},this.resultMsg={type:"error",title:"登入失敗",visible:!1}}created(){this.$user.loginState$.pipe(Object(X.a)(this.unsubscribe$)).subscribe(t=>{t&&t.me&&this.$router.replace({path:"/"})}),this.$route.query.Token?(this.loginWithSSOToken(this.$route.query.Token),this.isSSO=!0):this.isSSO=!1,this.form.username="B1060",this.form.password="1"}handleSubmit(t){t.preventDefault(),this.$refs.formRef.validate(t=>{if(!t)return!1;this.login()})}loginLdap(){this.setLoading(!0);const t={username:this.form.username,password:this.form.password};this.$authApi.crowdLdapLoginUsingPOST(t).then(t=>{this.$user.signIn(t.data.jwtTokenPair.accessToken),localStorage.setItem("sign-out-time","login")}).catch(t=>{if(500===t.response.status||403===t.response.status)return this.$router.replace({path:"/no-authorization"})}).finally(()=>{this.setLoading(!1)})}login(){this.setLoading(!0);const t={username:this.form.username,password:this.form.password};this.$authApi.crowdLoginUsingPOST(t).then(t=>{this.$user.signIn(t.data.jwtTokenPair.accessToken),localStorage.setItem("sign-out-time","login")}).catch(t=>{if(500===t.response.status||403===t.response.status)return this.$router.replace({path:"/no-authorization"})}).finally(()=>{this.setLoading(!1)})}loginWithSSOToken(t){this.setLoading(!0);const e={token:t};this.$authApi.eipSsoLoginUsingPOST(e).then(t=>{this.$user.signIn(t.data.jwtTokenPair.accessToken),localStorage.setItem("sign-out-time","login")}).catch(t=>{if(500===t.response.status||403===t.response.status)return this.$router.replace({path:"/no-authorization"})}).finally(()=>{this.setLoading(!1)})}destroyed(){this.unsubscribe$.next(),this.unsubscribe$.complete()}};Object(J.a)([Object(tt.a)("setLoading")],at.prototype,"setLoading",void 0),at=Object(J.a)([Object(et.a)({components:{}})],at);var it=at,st=(a("22ef"),a("2877")),ot=Object(st.a)(it,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"login-container d-flex flex-column container-fluid"},[i("img",{staticClass:"login-container__leftbg",attrs:{src:a("98393")}}),i("img",{staticClass:"login-container__rightbg",attrs:{src:a("4b0d")}}),i("div",{staticClass:"title"},[t._v(" 內部稽核管理系統 ")]),t.isSSO?t._e():i("div",{staticClass:"login"},[i("a-form-model",{ref:"formRef",staticClass:"login-form",attrs:{model:t.form,rules:t.formRules}},[i("a-form-model-item",{attrs:{prop:"username"}},[i("a-input",{attrs:{type:"text",placeholder:"請輸入AD帳號",size:"large"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}},[i("template",{slot:"addonBefore"},[i("div",{staticClass:"input-info"},[i("img",{attrs:{src:a("f153"),alt:""}}),i("span",[t._v(" 帳號 ")])])])],2)],1),i("a-form-model-item",{attrs:{prop:"password"}},[i("a-input",{attrs:{type:t.isShowPassword?"test":"password",placeholder:"請輸入密碼",size:"large"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[i("div",{staticClass:"input-info",attrs:{slot:"addonBefore"},slot:"addonBefore"},[i("img",{attrs:{src:a("495c"),alt:""}}),i("span",[t._v(" 密碼 ")])]),i("img",{directives:[{name:"show",rawName:"v-show",value:t.form.password&&!t.isShowPassword,expression:"form.password && !isShowPassword"}],staticClass:"suffix-img",attrs:{slot:"suffix",src:a("fe1a"),alt:""},on:{click:function(e){t.isShowPassword=!0}},slot:"suffix"}),i("img",{directives:[{name:"show",rawName:"v-show",value:t.form.password&&t.isShowPassword,expression:"form.password && isShowPassword"}],staticClass:"suffix-img",attrs:{slot:"suffix",src:a("f02c"),alt:""},on:{click:function(e){t.isShowPassword=!1}},slot:"suffix"})])],1),i("a-form-model-item",[i("button",{staticClass:"btn--login",on:{click:t.handleSubmit}},[t._v(" 登入 ")])])],1)],1),t._m(0)])}),K,!1,null,"11ccc4dd",null).exports;a("13d5");let nt=class extends et.d{constructor(){super(...arguments),this.totalCount=0,this.todoListData=null}created(){this.getTodoList()}getTodoList(){this.setLoading(!0),this.$roleApi.getConfirmItemByRoleUsingGET().then(t=>{const e=Object.values(t.data.result).reduce((t,e)=>t.concat(e),[]);this.todoListData=e.map(t=>({img:a("1048")(`./${t.route}.svg`),title:t.title,routerName:t.route,count:t.count})),this.todoListData.forEach(t=>{this.totalCount+=t.count})}).catch(console.error).finally(()=>{this.setLoading(!1)})}};Object(J.a)([Object(tt.a)("setLoading")],nt.prototype,"setLoading",void 0),nt=Object(J.a)([et.a],nt);var rt=nt,lt=(a("5526"),Object(st.a)(rt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main-contain index-container container-fluid"},[i("img",{staticClass:"login-container__leftbg",attrs:{src:a("edf9")}}),i("img",{staticClass:"login-container__rightbg",attrs:{src:a("db05")}}),i("div",{staticClass:"title"},[t._v(" 內部稽核管理系統 ")]),i("div",{staticClass:"todo d-flex"},[i("img",{staticClass:"todo__img",attrs:{src:a("640c"),alt:""}}),i("div",{staticClass:"todo__text flex-center"},[t._v(" 待辦事項： "),i("span",[t._v(" "+t._s(t.totalCount)+" ")])])]),i("div",{staticClass:"todo-list flex-center row"},t._l(t.todoListData,(function(e){return i("div",{key:e.title,staticClass:"col-12 col-md-6 col-lg-4"},[i("router-link",{staticClass:"todo-list__item",attrs:{to:{name:e.routerName,params:e.count?{type:"todo"}:""}}},[i("img",{staticClass:"todo-list__item__img",attrs:{src:e.img,alt:""}}),i("div",{staticClass:"d-flex justify-content-between align-items-end flex-grow-1"},[i("div",{staticClass:"todo-list__item__title"},[t._v(" "+t._s(e.title)+" ")]),i("div",[i("span",{staticClass:"todo-list__item__count"},[t._v(t._s(e.count))]),i("span",{staticClass:"todo-list__item__text"},[t._v(" 筆")])])])])],1)})),0)])}),[],!1,null,"0f91c7ce",null).exports);let ct=class extends et.d{};ct=Object(J.a)([Object(et.a)({})],ct);var dt=ct,ut=Object(st.a)(dt,(function(){var t=this.$createElement;return(this._self._c||t)("router-view")}),[],!1,null,"62bf2f7a",null).exports,pt=a("dba1"),mt=(a("caad"),a("9612"));let ht=class extends et.d{constructor(){super(...arguments),this.renderColumns=[]}onColumnsChanged(){this.renderColumns=this.columns.filter(t=>!t.hidden),this.$nextTick(()=>{if(this.$refs.tableRef){const t=this.$refs.tableRef.$el;this.renderColumns.forEach((e,a)=>{const i=t.querySelector(`.ant-table-thead tr th[key="${a}"]`);e.minWidth?i.style.minWidth=""+e.minWidth:i.style.minWidth=void 0})}})}handleActionClick(t,e){this.$emit("actionClick",{row:{data:t},action:e})}handleMoreActionClick(t,e,a){const i=a.filter(e=>e.name===t.key)[0];this.handleActionClick(e,i)}handleInspectClick(t){this.$emit("inspectClick",{data:t})}handleTableChange(t,e,a){const i=this.renderColumns[parseInt(a.columnKey)],s=a&&a.order?{selector:i.sortProperty?i.sortProperty:i.property?i.property.toString():null,desc:"descend"===a.order}:void 0;this.$emit("tableChange",{pagination:t,sort:s})}handleRowClick(t){this.$emit("rowClick",{data:t})}exposedActionsOf(t){return t.filter(t=>!t.more)}moreActionsOf(t){return t.filter(t=>t.more)}widthOf(t){return""+t.width}plainTextOf(t,e){if(e.formatter)return e.formatter(t);const a=e.property.toString().split(".");let i=t[a[0]];return a.forEach((t,e)=>{e>0&&null!=i&&(i=i[a[e]])}),i}badgeColorOf(t,e){return e.badgeColor?"function"==typeof e.badgeColor?e.badgeColor(t):e.badgeColor:null}tagColorOf(t,e){return e.tagColor?"function"==typeof e.tagColor?e.tagColor(t):e.tagColor:null}customRenderOf(t){return t.rowSpanKey?(e,a,i,s)=>{const o=this.data.indexOf(e),n=t.rowSpanKey(e),r=this.plainTextOf(e,t);if(o>0){const e=o-1,a=this.data[e];if(t.rowSpanKey(a)==n)return{children:r,attrs:{rowSpan:0}}}let l=1;for(let e=o+1;e<this.data.length;e++){const a=e,i=this.data[a];if(t.rowSpanKey(i)!=n)break;l++}return{children:r,attrs:{rowSpan:l}}}:t.customRender?t.customRender:void 0}shouldDisableAction(t,e,a){return"function"==typeof e.disabled?e.disabled({data:t}):e.disabled}ellipsisString(t,e){return"xxl"!==this.getWindowSize&&e.length>t?e.slice(0,t-1)+"...":e}uuid(){return mt.a.v4()}created(){this.onColumnsChanged()}};Object(J.a)([tt.b],ht.prototype,"getWindowSize",void 0),Object(J.a)([Object(et.b)({default:"key"})],ht.prototype,"rowKey",void 0),Object(J.a)([Object(et.b)({default:!1})],ht.prototype,"bordered",void 0),Object(J.a)([Object(et.b)()],ht.prototype,"rowSelection",void 0),Object(J.a)([Object(et.b)()],ht.prototype,"scroll",void 0),Object(J.a)([Object(et.b)({default:"default"})],ht.prototype,"size",void 0),Object(J.a)([Object(et.b)({default:[]})],ht.prototype,"columns",void 0),Object(J.a)([Object(et.b)({default:[]})],ht.prototype,"data",void 0),Object(J.a)([Object(et.b)()],ht.prototype,"pagination",void 0),Object(J.a)([Object(et.b)({default:!1})],ht.prototype,"loading",void 0),Object(J.a)([Object(et.b)()],ht.prototype,"countersign",void 0),Object(J.a)([Object(et.e)("columns")],ht.prototype,"onColumnsChanged",null),ht=Object(J.a)([et.a],ht);var ft=ht,gt=Object(st.a)(ft,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-table",{ref:"tableRef",attrs:{"row-key":t.rowKey,bordered:t.bordered,size:t.size,"row-selection":t.rowSelection,"data-source":t.data,loading:t.loading,pagination:t.pagination,scroll:t.scroll},on:{change:t.handleTableChange}},t._l(t.renderColumns,(function(e,i){return a("a-table-column",{key:i.toString(),attrs:{title:e.title,sorter:e.sorter,width:t.widthOf(e),fixed:e.fixed,"custom-render":t.customRenderOf(e)},scopedSlots:t._u([{key:"default",fn:function(i,s,o){return["TEMPLATE"===e.type?a("div",[t._t(e.template,null,{index:o,data:s,property:e.property,text:e.property?t.plainTextOf(s,e):""})],2):"PLAIN"===e.type?a("div",[e.inspect?a("a",{on:{click:function(e){return t.handleInspectClick(s)}}},[t._v(t._s(t.plainTextOf(s,e)))]):("function"==typeof e.pendingEdit&&e.pendingEdit(s)||"boolean"==typeof e.pendingEdit&&e.pendingEdit)&&!t.plainTextOf(s,e)?a("span",{staticClass:"pendingEdit"},[t._v("待編輯")]):a("span",[t._v(t._s(t.plainTextOf(s,e)))])]):"ACTION"===e.type?a("div",[t._l(t.exposedActionsOf(e.actions),(function(i){return a("a-button",{key:i.name,attrs:{type:e.actionButtonType?e.actionButtonType:"link",disabled:t.shouldDisableAction(s,i,e)},on:{click:function(e){return t.handleActionClick(s,i)}}},[t._v(" "+t._s(i.title)+" ")])})),t.moreActionsOf(e.actions).length>0?a("a-divider",{attrs:{type:"vertical"}}):t._e(),t.moreActionsOf(e.actions).length>0?a("a-dropdown",[a("a-button",{staticClass:"ant-dropdown-link",attrs:{type:e.actionButtonType?e.actionButtonType:"link"},on:{click:function(t){return t.preventDefault()}}},[t._v(" "+t._s(e.moreActionTitle?e.moreActionTitle:"更多")+" "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:function(a){return t.handleMoreActionClick(a,s,e.actions)}},slot:"overlay"},t._l(t.moreActionsOf(e.actions),(function(i){return a("a-menu-item",{key:i.name,attrs:{disabled:t.shouldDisableAction(s,i,e)}},[t._v(" "+t._s(i.title)+" ")])})),1)],1):t._e()],2):"BADGE"===e.type?a("div",[a("a-badge",{attrs:{color:t.badgeColorOf(s,e),text:t.plainTextOf(s,e)}})],1):"TAG"===e.type?a("div",[a("a-tag",{attrs:{color:t.tagColorOf(s,e)}},[t._v(" "+t._s(t.plainTextOf(s,e))+" ")])],1):"ELLIPSIS"===e.type?a("div",[("function"==typeof e.pendingEdit&&e.pendingEdit(s)||"boolean"==typeof e.pendingEdit&&e.pendingEdit)&&!t.plainTextOf(s,e)?a("span",{staticClass:"pendingEdit"},[t._v("待編輯")]):[a("a-popover",{attrs:{"overlay-class-name":"popover--summary",placement:"top",trigger:t.plainTextOf(s,e).length<e.ellipsisNum||"xxl"==t.getWindowSize?"":"hover"}},[a("template",{slot:"content"},[a("span",[t._v(" "+t._s(t.plainTextOf(s,e))+" ")])]),t._v(" "+t._s(t.ellipsisString(e.ellipsisNum,t.plainTextOf(s,e)))+" ")],2)]],2):t._e()]}}],null,!0)})})),1)],1)}),[],!1,null,null,null).exports;let bt=class extends et.d{constructor(){super(...arguments),this.modalClass=""}get wrapClassName(){return this.closable?"modal__primary hasClose":"modal__primary"}created(){this.autoClose&&this.autoCloseModal(this.autoClose),this.heightFullScreen&&(this.modalClass+="modal--height--full"),this.paddingSize?this.modalClass+=" modal--padding--"+this.paddingSize:this.modalClass+=" modal--padding--normal",this.bodySize&&(this.modalClass+=" modal__body--"+this.bodySize)}handleConfirm(){this.$emit("confirmModal")}handleCancel(){this.$emit("closeModal")}autoCloseModal(t){setTimeout(this.handleCancel,1e3*t)}};Object(J.a)([Object(et.b)()],bt.prototype,"title",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"content",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"autoClose",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"width",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"closable",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"centered",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"paddingSize",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"bodySize",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"heightFullScreen",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"footer",void 0),Object(J.a)([Object(et.b)()],bt.prototype,"maskClosable",void 0),bt=Object(J.a)([Object(et.a)({})],bt);var vt=bt,_t=(a("e207"),Object(st.a)(vt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{class:t.modalClass,attrs:{visible:t.visible,closable:!1,footer:null,"wrap-class-name":t.wrapClassName,width:t.bodySize?null:t.width||600,centered:t.centered||!1,"mask-closable":!1!==t.maskClosable},on:{cancel:t.handleCancel}},[t.closable?i("div",{staticClass:"modal__close flex-center",on:{click:t.handleCancel}},[i("img",{attrs:{src:a("194e"),alt:""}})]):t._e(),i("div",{staticClass:"modal__content"},[t.title?i("div",{staticClass:"modal__content__title"},[t._v(" "+t._s(t.title)+" ")]):t._e(),t._t("content"),t.footer?i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.handleConfirm}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.handleCancel}},[t._v(" 取消 ")])]):t._e()],2)])}),[],!1,null,"02b87333",null).exports),yt=a("57a4"),Ct=a.n(yt);let Ot=class extends et.d{constructor(){super(...arguments),this.compareData=[]}get getCompareData(){return Object.keys(this.nowData).length>0&&this.oldData.length>0?[{...this.nowData},...this.oldData]:Object.keys(this.nowData).length>0?[{...this.nowData}]:this.oldData.length>0?[...this.oldData]:[]}close(){this.$emit("closeModal")}onGetCompareDataChanged(t){this.compareData=t,this.compareData=this.compareData.map((t,e)=>{const a=e+1;if(a==this.compareData.length)return{...t};const i=Ct.a.execute(this.compareData[a].text,t.text);return{...t,text:i}})}};Object(J.a)([Object(et.b)()],Ot.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],Ot.prototype,"nowData",void 0),Object(J.a)([Object(et.b)()],Ot.prototype,"oldData",void 0),Object(J.a)([Object(et.e)("getCompareData",{deep:!0})],Ot.prototype,"onGetCompareDataChanged",null),Ot=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],Ot);var At=Ot,It=(a("4e1a"),Object(st.a)(At,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"比對資料",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,"height-full-screen":!0,centered:!1},on:{closeModal:t.close}},[i("template",{slot:"content"},[i("div",{staticClass:"modal__list"},[t.compareData.length>0?t._l(t.compareData,(function(e,a){return i("div",{key:a,staticClass:"modal__list__item"},[i("div",{staticClass:"modal__list__item__title"},[i("span",[t._v(t._s(e.dateTime))]),i("span",[t._v(t._s(e.title)+"/"+t._s(e.staffname))])]),i("p",{staticClass:"content",domProps:{innerHTML:t._s(e.text)}})])})):i("div",{staticClass:"d-flex flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無比對資料 ")])])],2)])],2)}),[],!1,null,"656f04c1",null).exports);let Dt=class extends et.d{close(){this.$emit("closeModal")}handleExport(t){this.$emit("click",t)}};Object(J.a)([Object(et.b)()],Dt.prototype,"visible",void 0),Dt=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],Dt);var St=Dt,wt=(a("274f"),Object(st.a)(St,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"匯出檔案",visible:t.visible,width:544,"padding-size":"normal",closable:!0,centered:!0},on:{closeModal:t.close}},[a("template",{slot:"content"},[a("div",{staticClass:"modal__subtitle"},[t._v(" 請選擇要不要匯出組別 ! ")]),a("div",{staticClass:"d-flex justify-content-between"},[a("a-button",{staticClass:"btn__icon--export flex-center",on:{click:function(e){return t.handleExport(!0)}}},[a("div",{staticClass:"btn__icon--export-icon btn__icon-text--export2",attrs:{alt:""}}),a("div",[a("p",{staticClass:"btn__icon--export-text"},[t._v(" 匯出組別 ")])])]),a("a-button",{staticClass:"btn__icon--export flex-center",on:{click:function(e){return t.handleExport(!1)}}},[a("div",{staticClass:"btn__icon--export-icon btn__icon-text--export1",attrs:{alt:""}}),a("div",[a("p",{staticClass:"btn__icon--export-text"},[t._v(" 匯出無組別 ")])])])],1)])],2)}),[],!1,null,"98b15f9e",null).exports);let kt=class extends et.d{close(){this.$emit("closeModal")}};Object(J.a)([Object(et.b)()],kt.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],kt.prototype,"message",void 0),kt=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],kt);var Mt=kt,xt=(a("1b53"),Object(st.a)(Mt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"組長退回意見",visible:t.visible,width:544,closable:!0,centered:!0},on:{closeModal:t.close}},[a("template",{slot:"content"},[a("div",{staticClass:"modal__content-opinion"},[t._v(" "+t._s(t.message)+" ")])])],2)}),[],!1,null,"149baf51",null).exports);let jt=class extends et.d{get getDataType(){return this.propData.caseType?Object.values(this.propData.caseType)[0]:""}};Object(J.a)([Object(et.b)()],jt.prototype,"propData",void 0),Object(J.a)([Object(et.b)({default:!1})],jt.prototype,"showCrawlerDataId",void 0),jt=Object(J.a)([Object(et.a)({})],jt);var Tt=jt,Lt=(a("c646"),Object(st.a)(Tt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-form-model",{staticClass:"dataType_1"},[a("div",{staticClass:"d-flex flex-wrap dataType__page",class:{hasCrawlerDataId:t.showCrawlerDataId}},[a("a-form-model-item",{attrs:{label:"資料型態"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.getDataType,callback:function(e){t.getDataType=e},expression:"getDataType"}})],1),a("a-form-model-item",{attrs:{label:"修正日期"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.propData.releaseDate,callback:function(e){t.$set(t.propData,"releaseDate",e)},expression:"propData.releaseDate"}})],1),t.showCrawlerDataId?a("a-form-model-item",{staticClass:"align-items-center",attrs:{label:"代碼"}},[a("span",[t._v(t._s(t.propData.crawlerDataId))])]):t._e(),a("a-form-model-item",{attrs:{label:"法規名稱"}},[a("a-textarea",{attrs:{"auto-size":{minRows:1,maxRows:7},disabled:""},model:{value:t.propData.subject,callback:function(e){t.$set(t.propData,"subject",e)},expression:"propData.subject"}})],1),a("div",{staticClass:"detail__link__wrap d-flex"},[a("span",{staticClass:"detail__link__label"},[t._v("連結")]),a("a",{staticClass:"detail__link col",attrs:{href:t.propData.pageUrl,target:"_blank"}},[t._v(t._s(t.propData.pageUrl))])]),t._t("claimGroup")],2)])}),[],!1,null,"3bdd0ea8",null).exports);let Pt=class extends et.d{get getDataType(){return this.propData.caseType?Object.values(this.propData.caseType)[0]:""}};Object(J.a)([Object(et.b)()],Pt.prototype,"propData",void 0),Object(J.a)([Object(et.b)({default:!1})],Pt.prototype,"showCrawlerDataId",void 0),Pt=Object(J.a)([Object(et.a)({})],Pt);var Rt=Pt,Et=(a("39a1"),Object(st.a)(Rt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-form-model",{staticClass:"dataType_2"},[a("div",{staticClass:"d-flex flex-wrap dataType__page",class:{hasCrawlerDataId:t.showCrawlerDataId}},[a("a-form-model-item",{attrs:{label:"資料型態"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.getDataType,callback:function(e){t.getDataType=e},expression:"getDataType"}})],1),a("a-form-model-item",{attrs:{label:"標題"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.propData.subject,callback:function(e){t.$set(t.propData,"subject",e)},expression:"propData.subject"}})],1),t.showCrawlerDataId?a("a-form-model-item",{staticClass:"align-items-center",attrs:{label:"代碼"}},[a("span",[t._v(t._s(t.propData.crawlerDataId))])]):t._e(),a("a-form-model-item",{attrs:{label:"內容"}},[a("a-textarea",{attrs:{"auto-size":{minRows:1,maxRows:7},disabled:""},model:{value:t.propData.content,callback:function(e){t.$set(t.propData,"content",e)},expression:"propData.content"}})],1),a("div",{staticClass:"detail__link__wrap d-flex"},[a("span",{staticClass:"detail__link__label"},[t._v("連結")]),a("a",{staticClass:"detail__link col",attrs:{href:t.propData.pageUrl,target:"_blank"}},[t._v(t._s(t.propData.pageUrl))])]),t._t("claimGroup")],2)])}),[],!1,null,"2335cc2d",null).exports);let $t=class extends et.d{clickHandler(){this.$emit("click")}};Object(J.a)([Object(et.b)()],$t.prototype,"text",void 0),Object(J.a)([Object(et.b)()],$t.prototype,"type",void 0),Object(J.a)([Object(et.b)()],$t.prototype,"disabled",void 0),$t=Object(J.a)([Object(et.a)({})],$t);var Ft=$t,Ut=Object(st.a)(Ft,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"btn__icon-text",attrs:{disabled:t.disabled},on:{click:t.clickHandler}},[a("div",{class:"btn__icon-text__img btn__icon-text--"+t.type,attrs:{alt:""}}),a("div",{staticClass:"btn__icon-text__text"},[t._v(t._s(t.text))])])}),[],!1,null,"113ed754",null).exports;const Gt=Object(tt.c)("crawlerDataDetailVuex"),Yt=Object(tt.c)("modalControl");let Nt=class extends et.d{constructor(){super(...arguments),this.dataType=[]}filterGroupOptions(t,e){return e.componentOptions.children[0].text.indexOf(t)>=0}async getApi_Group(){this.setLoading(!0),await this.$dataCollectApi.getGroupInDataCollectUsingGET().then(t=>{const e=t.data;this.setEnumData({groupOptions:e.result})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}async getApi_SetClaimGroup(){this.setLoading(!0),await this.$dataCollectApi.setClaimGroupInDataCollectUsingPOST({crawlerDataId:this.crawlerDataId,groups:this.dataType}).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"設定認列組別成功",autoClose:3}})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"設定認列組別失敗"}})}).finally(()=>{this.setLoading(!1)})}async confirm(){await this.getApi_SetClaimGroup(),this.setDetailData({claimGroup:this.dataType}),this.close()}close(){this.setDetailModalState({confirmGroupModal:{visible:!1}})}async watchVisible(t){t&&await this.getApi_Group()}};Object(J.a)([Object(tt.a)("setLoading")],Nt.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Nt.prototype,"crawlerDataId",void 0),Object(J.a)([Gt.Getter("getGroupOptions")],Nt.prototype,"getGroupOptions",void 0),Object(J.a)([Gt.Getter("getClaimGroup")],Nt.prototype,"getClaimGroup",void 0),Object(J.a)([Gt.Action("setDetailData")],Nt.prototype,"setDetailData",void 0),Object(J.a)([Gt.Getter("getConfirmGroupModal")],Nt.prototype,"getConfirmGroupModal",void 0),Object(J.a)([Gt.Action("setDetailModalState")],Nt.prototype,"setDetailModalState",void 0),Object(J.a)([Gt.Action("setEnumData")],Nt.prototype,"setEnumData",void 0),Object(J.a)([Gt.Action("updateDetailData")],Nt.prototype,"updateDetailData",void 0),Object(J.a)([Yt.Action("setModalState")],Nt.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("getConfirmGroupModal.visible",{immediate:!0})],Nt.prototype,"watchVisible",null),Nt=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t}})],Nt);var Vt=Nt,qt=Object(st.a)(Vt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"設定認列組別",visible:t.getConfirmGroupModal.visible,width:470,"padding-size":"normal",footer:!0,"mask-closable":!1},on:{confirmModal:t.confirm,closeModal:t.close}},[a("template",{slot:"content"},[a("a-form-model",{staticClass:"mt-2 mb-2 form--light"},[a("a-form-model-item",{attrs:{"label-col":{span:5},"wrapper-col":{span:19}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 設定組別 ")]),t.getGroupOptions.length>0?a("a-select",{staticClass:"input--select",attrs:{"show-search":"",options:t.getGroupOptions,mode:"multiple","filter-option":t.filterGroupOptions,"dropdown-match-select-width":!1,placeholder:"請選擇認列組別","allow-clear":!0,"show-arrow":!0},model:{value:t.dataType,callback:function(e){t.dataType=e},expression:"dataType"}}):t._e()],1)],1)],1)],2)}),[],!1,null,"54c87723",null).exports;let Bt=class extends et.d{constructor(){super(...arguments),this.inspectedUnit=[]}onUnitsListChanged(t){if(t&&t.length>0){this.inspectedUnit=[];const e=[...t],a=t.length;for(let t=0,i=0;t<a;t+=2,i++)this.inspectedUnit[i]=e.splice(0,2)}else this.inspectedUnit=[]}close(){this.$emit("closeModal")}};Object(J.a)([Object(et.b)()],Bt.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],Bt.prototype,"validYapUnits",void 0),Object(J.a)([Object(et.b)()],Bt.prototype,"unitsList",void 0),Object(J.a)([Object(et.e)("unitsList",{immediate:!0})],Bt.prototype,"onUnitsListChanged",null),Bt=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],Bt);var zt=Bt,Ht=(a("0f47"),Object(st.a)(zt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"計劃受檢單位",visible:t.visible,closable:!0,centered:!0},on:{closeModal:t.close}},[a("template",{slot:"content"},[a("div",{staticClass:"modal__content-opinion d-flex flex-wrap"},[a("table",{staticClass:"table table-bordered table-hover customTable"},[a("tbody",[t._l(t.inspectedUnit,(function(e,i){return[a("tr",{key:i,staticClass:"customTable__tr"},[e[0]?a("td",{staticClass:"customTable__td customTable__td__left",class:{changeStyle:!1===e[0].isValid}},[a("span",[t._v(t._s(e[0].value+" "+e[0].label)+t._s(!1===e[0].isValid?"(組織異動)":""))])]):t._e(),e[1]?a("td",{staticClass:"customTable__td customTable__td__right",class:{changeStyle:!1===e[1].isValid}},[a("span",[t._v(t._s(e[1].value+" "+e[1].label)+t._s(!1===e[1].isValid?"(組織異動)":""))])]):a("td")])]}))],2)])])])],2)}),[],!1,null,"1e5b1e64",null).exports);Object(tt.c)("crawlerDataDetailVuex");let Qt=class extends et.d{get getDataType(){return this.propData.caseType?Object.values(this.propData.caseType)[0]:""}};Object(J.a)([Object(et.b)()],Qt.prototype,"propData",void 0),Object(J.a)([Object(et.b)({default:!1})],Qt.prototype,"showCrawlerDataId",void 0),Qt=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,ConfirmGroupForm:qt,InspectedUnitModal:Ht}})],Qt);var Wt=Qt,Kt=(a("126a"),Object(st.a)(Wt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("fragment",[a("a-form-model",{staticClass:"dataType_3"},[a("div",{staticClass:"d-flex flex-wrap dataType__page",class:{hasCrawlerDataId:t.showCrawlerDataId}},[a("a-form-model-item",{attrs:{label:"資料型態"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.getDataType,callback:function(e){t.getDataType=e},expression:"getDataType"}})],1),a("a-form-model-item",{attrs:{label:"發布日期"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.propData.releaseDate,callback:function(e){t.$set(t.propData,"releaseDate",e)},expression:"propData.releaseDate"}})],1),t.showCrawlerDataId?a("a-form-model-item",{staticClass:"align-items-center",attrs:{label:"代碼"}},[a("span",[t._v(t._s(t.propData.crawlerDataId))])]):t._e(),a("a-form-model-item",{attrs:{label:"標題"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.propData.subject,callback:function(e){t.$set(t.propData,"subject",e)},expression:"propData.subject"}})],1),a("a-form-model-item",{attrs:{label:"內容"}},[a("a-textarea",{attrs:{"auto-size":{minRows:1,maxRows:7},disabled:""},model:{value:t.propData.content,callback:function(e){t.$set(t.propData,"content",e)},expression:"propData.content"}})],1),a("div",{staticClass:"detail__link__wrap d-flex"},[a("span",{staticClass:"detail__link__label"},[t._v("連結")]),a("a",{staticClass:"detail__link col",attrs:{href:t.propData.pageUrl,target:"_blank"}},[t._v(t._s(t.propData.pageUrl))])]),t._t("claimGroup")],2)])],1)}),[],!1,null,"3186c472",null).exports);let Jt=class extends et.d{get getDataType(){return this.propData.caseType?Object.values(this.propData.caseType)[0]:""}};Object(J.a)([Object(et.b)()],Jt.prototype,"propData",void 0),Object(J.a)([Object(et.b)({default:!1})],Jt.prototype,"showCrawlerDataId",void 0),Jt=Object(J.a)([Object(et.a)({})],Jt);var Zt=Jt,Xt=(a("5c9f"),Object(st.a)(Zt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-form-model",{staticClass:"dataType_4"},[a("div",{staticClass:"d-flex flex-wrap dataType__page",class:{hasCrawlerDataId:t.showCrawlerDataId}},[a("a-form-model-item",{attrs:{label:"資料型態"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.getDataType,callback:function(e){t.getDataType=e},expression:"getDataType"}})],1),a("a-form-model-item",{attrs:{label:"資料檔案"}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:t.propData.fileName,callback:function(e){t.$set(t.propData,"fileName",e)},expression:"propData.fileName"}})],1),t.showCrawlerDataId?a("a-form-model-item",{staticClass:"align-items-center",attrs:{label:"代碼"}},[a("span",[t._v(t._s(t.propData.crawlerDataId))])]):t._e(),t._t("claimGroup")],2)])}),[],!1,null,"4a2053d2",null).exports);const te=Object(tt.c)("crawlerDataDetailVuex");let ee=class extends et.d{constructor(){super(...arguments),this.attatchments={}}getCurrentView({caseType:t}){var e;return(null===(e=Object.keys(t))||void 0===e?void 0:e.length)>0?"DataType__"+this.$enum.getDataTypeComp(Object.keys(t)[0]):"DataType__comp1"}getApi_GetAttachment(t){this.setLoading(!0),this.$dataCollectApi.getAttachmentUsingGET(t).then(e=>{this.$set(this.attatchments,t,e.data.result)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}onDownload({attachmentId:t,fileName:e}){this.setLoading(!0),this.$auditPlanApi.downloadAttachmentInAuditPlanUsingGET(t,{responseType:"blob"}).then(t=>{const a=document.createElement("a"),i=(window.URL||window.webkitURL).createObjectURL(t.data),s=e;a.setAttribute("href",i),a.setAttribute("download",""+s),a.click(),a.remove()}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}close(){this.$emit("closeModal")}watchVisible(t){t&&(this.attatchments={},this.contentData.length>0&&this.contentData.map(t=>{this.getApi_GetAttachment(t.crawlerDataId)}))}};Object(J.a)([te.Getter("getDetailData")],ee.prototype,"getDetailData",void 0),Object(J.a)([Object(tt.a)("setLoading")],ee.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],ee.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],ee.prototype,"contentData",void 0),Object(J.a)([Object(et.b)()],ee.prototype,"dataId",void 0),Object(J.a)([Object(et.e)("visible")],ee.prototype,"watchVisible",null),ee=Object(J.a)([Object(et.a)({components:{InfoModal:_t,DataType__comp1:Lt,DataType__comp2:Et,DataType__comp3:Kt,DataType__comp4:Xt}})],ee);var ae=ee,ie=(a("70e1"),Object(st.a)(ae,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{visible:t.visible,"body-size":"large","padding-size":"normal",closable:!0,centered:!0},on:{closeModal:t.close}},[i("template",{slot:"content"},[t.contentData&&t.contentData.length>0?t._l(t.contentData,(function(e,a){return i("div",{key:a,staticClass:"main__contentItem"},[i("div",{staticClass:"main__content"},[e.caseType?i(t.getCurrentView(e),{tag:"component",attrs:{"prop-data":e}}):t._e()],1),t.attatchments[e.crawlerDataId]&&t.attatchments[e.crawlerDataId].length>0?i("div",{staticClass:"file__content"},[i("div",{staticClass:"file__header"},[i("div",{staticClass:"file__header-img"}),i("span",{staticClass:"file__header-title"},[t._v("資料檔案")])]),i("div",{staticClass:"file__list"},t._l(t.attatchments[e.crawlerDataId],(function(e,a){return i("div",{key:a,staticClass:"file__list__item"},[i("a",{staticClass:"file__list__text",on:{click:function(a){return t.onDownload(e)}}},[t._v(" "+t._s(e.fileName)+" ")])])})),0)]):t._e()])})):i("div",{staticClass:"d-flex m-3 flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無關聯資料 ")])])],2)],2)}),[],!1,null,"0d223c9d",null).exports);let se=class extends et.d{handleStore(){this.$emit("click")}};se=Object(J.a)([Object(et.a)({})],se);var oe=se,ne=(a("3cd1"),Object(st.a)(oe,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"btn--store btn__icon--store--circle",on:{click:t.handleStore}})}),[],!1,null,"78fa8dcb",null).exports);let re=class extends et.d{onHandleDelete(t){this.$emit("confirm")}};Object(J.a)([Object(et.b)({default:"確認刪除？"})],re.prototype,"title",void 0),Object(J.a)([Object(et.b)({default:"exclamation-circle"})],re.prototype,"iconType",void 0),Object(J.a)([Object(et.b)({default:"exclamation-circle"})],re.prototype,"iconColor",void 0),Object(J.a)([Object(et.b)({default:!1})],re.prototype,"disabled",void 0),re=Object(J.a)([Object(et.a)({})],re);var le=re,ce=(a("6f14"),Object(st.a)(le,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-popconfirm",{attrs:{placement:"top","ok-text":"確定","cancel-text":"取消",icon:" ","overlay-class-name":"customPopConfirm",disabled:t.disabled},on:{confirm:t.onHandleDelete}},[a("template",{slot:"title"},[a("div",[a("a-icon",{attrs:{type:t.iconType}}),a("span",{staticClass:"custom__popConfirm__title"},[t._v(t._s(t.title))])],1),t._t("content")],2),t._t("default")],2)}),[],!1,null,null,null).exports);let de=class extends et.d{get isShowReturnBtn(){return"ROLE_Audit_Team_Head"===this.role.id&&"D"===this.role.roleUnits[0].auditorTeamCode&&"D"===this.yapStatus||!("C"!==this.yapStatus||!this.isSupervisor||!this.reviewFlag)}};Object(J.a)([Object(et.b)()],de.prototype,"role",void 0),Object(J.a)([Object(et.b)()],de.prototype,"yapStatus",void 0),Object(J.a)([Object(et.b)()],de.prototype,"isConfirmUser",void 0),Object(J.a)([Object(et.b)()],de.prototype,"isSettingAuditItems",void 0),Object(J.a)([Object(et.b)()],de.prototype,"isSupervisor",void 0),Object(J.a)([Object(et.b)()],de.prototype,"isBeenRejectedAuditItem",void 0),Object(J.a)([Object(et.b)()],de.prototype,"reviewFlag",void 0),de=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,CustomPopConfirm:ce}})],de);var ue=de,pe=(a("f700"),Object(st.a)(ue,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.isSettingAuditItems?a("IconTextButton",{staticClass:"me-3 my-1",attrs:{text:"查核項目設定",type:"set_up"},on:{click:function(e){return t.$emit("click",{type:"setAuditItems"})}}}):t._e(),a("IconTextButton",{staticClass:"me-3 my-1",attrs:{text:"匯出",type:"export"},on:{click:function(e){return t.$emit("click",{type:"export"})}}}),"ROLE_Auditor"!==t.role.id&&"ROLE_Audit_Team_Head"!==t.role.id||!("A"===t.yapStatus||"B"===t.yapStatus||"C"===t.yapStatus&&t.isBeenRejectedAuditItem)?t._e():["ROLE_Audit_Team_Head"!==t.role.id||"A"!==t.yapStatus?a("IconTextButton",{staticClass:"me-3 my-1",attrs:{text:"送出覆核",type:"edit"},on:{click:function(e){return t.$emit("click",{type:"submitReview"})}}}):t._e(),a("IconTextButton",{staticClass:"me-3 my-1",attrs:{text:"暫存",type:"save"},on:{click:function(e){return t.$emit("click",{type:"save"})}}})],t.isShowReturnBtn?a("IconTextButton",{staticClass:"me-3 my-1",attrs:{text:"退回",type:"feedback"},on:{click:function(e){return t.$emit("click",{type:"return"})}}}):t._e(),"ROLE_Audit_Team_Head"===t.role.id&&"D"===t.role.roleUnits[0].auditorTeamCode&&"D"===t.yapStatus?["ROLE_Audit_Team_Head"===t.role.id?a("CustomPopConfirm",{attrs:{title:"請確認以下事項"},on:{confirm:function(e){return t.$emit("click",{type:"caseClose"})}}},[a("template",{slot:"content"},[a("div",{staticClass:"close-info"},[a("div",{staticClass:"close-info close-info__item"},[t._v(" 1. 已送金控 ")]),a("div",{staticClass:"close-info close-info__item"},[t._v(" 2. 已送董事會 ")]),a("div",{staticClass:"close-info close-info__item"},[t._v(" 3. 已報檢查局 ")])])]),a("IconTextButton",{staticClass:"me-3 my-1",attrs:{text:"結案",type:"closed"}})],2):t._e()]:t._e(),a("IconTextButton",{attrs:{text:"編制歷程",type:"course"},on:{click:function(e){return t.$emit("click",{type:"history"})}}})],2)}),[],!1,null,"846e3246",null).exports);const me=Object(tt.c)("modalControl");let he=class extends et.d{constructor(){super(...arguments),this.activeImportantCheckKey=[],this.pointAuditItemList=null,this.checkedPointAuditItemList=null,this.form={month:"01",auditType:"1",auditItems:""}}onYapChanged(t){t&&(this.form.auditType=t.auditType,this.form.month=t.startMonth,this.form.auditItems=t.auditItem)}onVisibleChanged(t){t&&(this.checkedPointAuditItemList=this.$global.deepCopyData(this.yapPointAuditItemList).map(t=>({...t,checked:[]})),this.searchPointerAuditItem())}onYapPointAuditItemListChanged(t){this.activeImportantCheckKey=t&&t.map(t=>t.key)}onCheckedPointAuditItemListChanged(t){}searchPointerAuditItem(){this.setLoading(!0);const t={year:parseInt(this.yapYear),...this.form,auditItems:[this.form.auditItems]};this.$auditPlanApi.searchPointAuditItemInAuditPlanUsingPOST(t).then(t=>{this.covertObjectToArrayItem(t.data.result)}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:t.response.data.message||"查詢重點查核項目舊資料 失敗"}}),this.pointAuditItemList=null}).finally(()=>{this.setLoading(!1)})}covertObjectToArrayItem(t){this.pointAuditItemList=this.$global.deepCopyData(this.yapPointAuditItemList).map(e=>({...e,yapPointAuditItems:t[e.key]||[]}))}importData(){this.$emit("importData",{yapId:this.yap.yapId,importItems:this.checkedPointAuditItemList}),this.reset(),this.close()}reset(){this.pointAuditItemList=null,this.checkedPointAuditItemList=null}close(){this.$emit("closeModal")}};Object(J.a)([Object(tt.a)("setLoading")],he.prototype,"setLoading",void 0),Object(J.a)([me.Action("setModalState")],he.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],he.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],he.prototype,"typeOption",void 0),Object(J.a)([Object(et.b)()],he.prototype,"itemOption",void 0),Object(J.a)([Object(et.b)()],he.prototype,"yap",void 0),Object(J.a)([Object(et.b)()],he.prototype,"yapYear",void 0),Object(J.a)([Object(et.b)()],he.prototype,"yapPointAuditItemList",void 0),Object(J.a)([Object(et.e)("yap",{deep:!0})],he.prototype,"onYapChanged",null),Object(J.a)([Object(et.e)("visible")],he.prototype,"onVisibleChanged",null),Object(J.a)([Object(et.e)("yapPointAuditItemList",{immediate:!0})],he.prototype,"onYapPointAuditItemListChanged",null),Object(J.a)([Object(et.e)("checkedPointAuditItemList",{deep:!0})],he.prototype,"onCheckedPointAuditItemListChanged",null),he=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],he);var fe=he,ge=(a("4669"),Object(st.a)(fe,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"重點查核項目-選擇項目匯入舊資料",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,"height-full-screen":!0,centered:!1,footer:!0},on:{closeModal:t.close,confirmModal:t.importData}},[a("template",{slot:"content"},[a("div",{staticClass:"content"},[a("div",{staticClass:"search"},[a("div",{staticClass:"search__item"},[a("div",{staticClass:"search__label"},[t._v(" 月份： ")]),a("div",{staticClass:"search__input"},[a("a-select",{attrs:{placeholder:"請選擇月份",options:t.$enum.monthOption},model:{value:t.form.month,callback:function(e){t.$set(t.form,"month",e)},expression:"form.month"}})],1)]),a("div",{staticClass:"search__item"},[a("div",{staticClass:"search__label"},[t._v(" 查核性質： ")]),a("div",{staticClass:"search__input"},[a("a-select",{attrs:{placeholder:"請選擇查核性質",options:t.typeOption},model:{value:t.form.auditType,callback:function(e){t.$set(t.form,"auditType",e)},expression:"form.auditType"}})],1)]),a("div",{staticClass:"search__item"},[a("div",{staticClass:"search__label"},[t._v(" 查核項目： ")]),a("div",{staticClass:"search__input search__input--large"},[a("a-select",{attrs:{placeholder:"請選擇查核項目",options:t.itemOption},model:{value:t.form.auditItems,callback:function(e){t.$set(t.form,"auditItems",e)},expression:"form.auditItems"}})],1)]),a("button",{staticClass:"search__btn btn--search",on:{click:t.searchPointerAuditItem}},[t._v(" 查詢 ")])]),t.pointAuditItemList&&t.pointAuditItemList.length>0?a("a-collapse",{attrs:{"destroy-inactive-panel":!1},model:{value:t.activeImportantCheckKey,callback:function(e){t.activeImportantCheckKey=e},expression:"activeImportantCheckKey"}},t._l(t.pointAuditItemList,(function(e,i){return a("a-collapse-panel",{key:e.key,attrs:{header:e.headerTitle}},[a("a-checkbox-group",{staticClass:"w-100",model:{value:t.checkedPointAuditItemList[i].checked,callback:function(e){t.$set(t.checkedPointAuditItemList[i],"checked",e)},expression:"checkedPointAuditItemList[index].checked"}},t._l(e.yapPointAuditItems,(function(e){return a("div",{key:e.yapPointAuditItemId,staticClass:"import__item"},[a("a-checkbox",{staticClass:"import__item__checkbox",attrs:{value:e}}),a("div",{staticClass:"import__item__content"},[t._v(" "+t._s(e.itemContent)+" ")])],1)})),0)],1)})),1):t._e()],1)])],2)}),[],!1,null,"7eccb6dc",null).exports);let be=class extends et.d{constructor(){super(...arguments),this.isShow=!0}toggle(){this.isShow=!this.isShow}};Object(J.a)([Object(et.b)()],be.prototype,"isLine",void 0),be=Object(J.a)([Object(et.a)({components:{}})],be);var ve=be,_e=(a("ddb7"),Object(st.a)(ve,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"accordion"},[a("div",{staticClass:"d-flex "},[a("div",{staticClass:"btn-text",on:{click:t.toggle}},[t._v(" "+t._s(t.isShow?"收起":"展開")+" "),a("a-icon",{staticClass:"icon",class:{rotate:t.isShow},staticStyle:{color:"#0090FF"},attrs:{type:"down"}})],1)]),t.isLine?a("div",{staticClass:"line"}):t._e(),a("slide-up-down",{attrs:{active:t.isShow,duration:300}},[a("div",{staticClass:"body-inner"},[t._t("default")],2)])],1)}),[],!1,null,"1221f236",null).exports);const ye=Object(tt.c)("modalControl");let Ce=class extends et.d{constructor(){super(...arguments),this.activeImportantCheckKey=[],this.unitOption=[],this.currentRoleId=this.$global.getCurrentRoleId(),this.currentRole=this.$global.getCurrentRole(),this.supervisorList=["ROLE_Audit_Department_Head","ROLE_Audit_Office_Boss_Vice","ROLE_Audit_Office_Boss"],this.isNeedPointAuditItem=!1,this.isSupervisor=void 0!==this.supervisorList.find(t=>t===this.currentRoleId),this.isSave=!1,this.formRules={startMonth:[{trigger:"change",validator:this.monthVaildtor}],auditType:[{trigger:"change",validator:this.auditTypeValidator}],units:[{trigger:"change",validator:this.unitsValidator}],coAuditorTeam:[{trigger:"change",validator:this.coAuditorTeamValidator}],mainAuditorTeam:[{trigger:"change",validator:this.mainAuditorTeamValidator}],yapProjectScopeContent:[{trigger:"change",validator:this.yapProjectScopeContentValidator}]}}onUnitListChanged(t){t&&(this.unitOption=[{title:"全部",value:"all",key:"all",children:t.validYapUnits.map(t=>({title:t.value+t.label,value:t.value,key:t.value}))},{title:"無效單位",value:"invalid",key:"invalid",children:t.inValidYapUnits.map(t=>({title:t.value+t.label,value:t.value,key:t.value}))}])}onYapPointAuditItemListChanged(t){this.activeImportantCheckKey=t&&t.map(t=>t.key)}onYapFrontEndArrSyncChanged(t){"done"===t.isReviewDone&&this.$forceUpdate()}get inValidUnitList(){return this.unitList?this.unitList.inValidYapUnits.filter(t=>void 0!==this.yapFrontEndArrSync.units.find(e=>e===t.value)):null}get isEditYapItem(){return!(!("A"===this.yapFrontEndArrSync.yapStatus||"B"===this.yapFrontEndArrSync.yapStatus||"C"===this.yapFrontEndArrSync.yapStatus&&this.yapFrontEndArrSync.rejectFlag)||"ROLE_Audit_Team_Head"!==this.currentRoleId||this.role.roleUnits[0].auditorTeamCode!==this.yapFrontEndArrSync.originalMainAuditorTeam)}get isCheckEditItem(){return this.isSupervisor?this.isOnReviewLevel()&&"done"!==this.yapFrontEndArrSync.isReviewDone:"ROLE_Audit_Team_Head"===this.currentRoleId&&"C"===this.yapStatus&&"C"===this.yapFrontEndArrSync.yapStatus&&!this.yapFrontEndArrSync.rejectFlag}get isOriginalMainAuditorTeam(){var t;return(null===(t=this.currentRole.roleUnits[0])||void 0===t?void 0:t.auditorTeamCode)===this.yapFrontEndArrSync.originalMainAuditorTeam}get isEditProject(){switch(this.currentRoleId){case"ROLE_Audit_Team_Head":return!("B"===this.yapStatus&&"C"===this.yapFrontEndArrSync.yapStatus||"A"!==this.yapFrontEndArrSync.yapStatus&&"B"!==this.yapFrontEndArrSync.yapStatus&&"C"!==this.yapFrontEndArrSync.yapStatus||this.role.roleUnits[0].auditorTeamCode!==this.yapFrontEndArrSync.originalMainAuditorTeam);case"ROLE_Audit_Department_Head":return"1"===this.yapFrontEndArrSync.reviewLevel&&"C"===this.yapFrontEndArrSync.yapStatus&&!this.yapFrontEndArrSync.rejectFlag&&"done"!==this.yapFrontEndArrSync.isReviewDone;case"ROLE_Audit_Office_Boss_Vice":return"2"===this.yapFrontEndArrSync.reviewLevel&&"C"===this.yapFrontEndArrSync.yapStatus&&!this.yapFrontEndArrSync.rejectFlag&&"done"!==this.yapFrontEndArrSync.isReviewDone;case"ROLE_Audit_Office_Boss":return"3"===this.yapFrontEndArrSync.reviewLevel&&"C"===this.yapFrontEndArrSync.yapStatus&&!this.yapFrontEndArrSync.rejectFlag&&"done"!==this.yapFrontEndArrSync.isReviewDone}return!1}get isAddYapPointAuditItem(){var t;const e=null===(t=this.role.roleUnits[0])||void 0===t?void 0:t.auditorTeamCode;return!("ROLE_Auditor"===this.currentRoleId&&!this.isConfirmUser||e!==this.yapFrontEndArrSync.originalMainAuditorTeam&&void 0===this.yapFrontEndArrSync.coAuditorTeam.find(t=>t===e)||this.isSupervisor||!("A"===this.yapFrontEndArrSync.yapStatus||"B"===this.yapFrontEndArrSync.yapStatus||"C"===this.yapFrontEndArrSync.yapStatus&&this.yapFrontEndArrSync.rejectFlag))}coAuditorTeamValidator(t,e,a){if(this.isSave)return a();this.isOriginalMainAuditorTeam&&"ROLE_Audit_Team_Head"===this.currentRoleId&&void 0!==e.find(t=>t===this.yapFrontEndArrSync.mainAuditorTeam)?a("協辦組不可包含主辦組"):a()}mainAuditorTeamValidator(t,e,a){if(this.isSave)return a();this.$refs.formRef.validateField("coAuditorTeam"),a()}auditTypeValidator(t,e,a){if(this.isSave)return a();this.$refs.formRef.validateField("yapProjectScopeContent"),a()}unitsValidator(t,e,a){if(this.isSave)return a();if(this.isOriginalMainAuditorTeam&&"ROLE_Audit_Team_Head"===this.currentRoleId){if("D"===this.yapFrontEndArrSync.yapStatus||"E"===this.yapFrontEndArrSync.yapStatus)return a();if(""===e||null==e||0===e.length)return a("請選擇計畫受檢單位");a()}else a()}monthVaildtor(t,e,a){if(this.isSave)return a();if(this.isOriginalMainAuditorTeam&&"ROLE_Audit_Team_Head"===this.currentRoleId){if(!this.yapFrontEndArrSync.startMonth||!this.yapFrontEndArrSync.endMonth||void 0===this.yapFrontEndArrSync.startMonth||void 0===this.yapFrontEndArrSync.endMonth)return a("請填入月份");if(parseInt(this.yapFrontEndArrSync.startMonth,10)>parseInt(this.yapFrontEndArrSync.endMonth,10))return a("結束月份不得小於開始月份");if("0"==this.yapFrontEndArrSync.startMonth||"0"==this.yapFrontEndArrSync.endMonth)return a("請選擇1~12月");a()}else a()}yapProjectScopeContentValidator(t,e,a){if(this.isSave)return a();this.isOriginalMainAuditorTeam&&"ROLE_Audit_Team_Head"===this.currentRoleId&&"project"===this.yapFrontEndArrSync.auditType?this.yapFrontEndArrSync.yapProjectScopeContent?a():a("請輸入專案查核範圍"):a()}yapPointAuditItemValidator(t,e,a){(!e||e.length<=0)&&a("請填寫重點查核項目"),a()}hasYapPointAuditItemValidator(){if("ROLE_Audit_Team_Head"!==this.currentRoleId||this.isSave)this.isNeedPointAuditItem=!1;else{const t=this.yapFrontEndArrSync.yapPointAuditItemMap.reduce((t,e)=>t+e.yapPointAuditItems.length,0);this.isNeedPointAuditItem=0===t}}validate(t){return this.isSave=t,this.$refs.formRef.validate().then(()=>!0).catch(()=>!1)}startMonthChange(){this.yapFrontEndArrSync.endMonth=this.yapFrontEndArrSync.startMonth}isOnReviewLevel(){return!!this.reviewFlag&&("ROLE_Audit_Department_Head"===this.currentRoleId&&"1"===this.yapFrontEndArrSync.reviewLevel||"ROLE_Audit_Office_Boss_Vice"===this.currentRoleId&&"2"===this.yapFrontEndArrSync.reviewLevel||"ROLE_Audit_Office_Boss"===this.currentRoleId&&"3"===this.yapFrontEndArrSync.reviewLevel)}haveToReplyQuestion(t){return!(!this.isSupervisor||!this.isOnReviewLevel||"A"!==t)||"ROLE_Audit_Team_Head"===this.currentRoleId&&"Q"===t}onInspectedUnit(t){let e=null,a=null;this.unitList&&(e=this.unitList.validYapUnits.filter(t=>void 0!==this.yapFrontEndArrSync.units.find(e=>e===t.value)),a=this.unitList.inValidYapUnits.filter(t=>void 0!==this.yapFrontEndArrSync.units.find(e=>e===t.value))),this.$emit("slideclick",{type:"inspectedUnit",payload:{validUnits:e,inValidUnits:a}})}checkSideButton(t){var e;const a=null===(e=this.role.roleUnits[0])||void 0===e?void 0:e.auditorTeamCode;switch(t){case"edit":return!(!("A"===this.yapFrontEndArrSync.yapStatus||"B"===this.yapFrontEndArrSync.yapStatus||"C"===this.yapFrontEndArrSync.yapStatus&&this.yapFrontEndArrSync.rejectFlag)||"ROLE_Audit_Team_Head"!==this.role.id||a!==this.yapFrontEndArrSync.originalMainAuditorTeam);case"import":return!(!("A"===this.yapFrontEndArrSync.yapStatus||"B"===this.yapFrontEndArrSync.yapStatus||"C"===this.yapFrontEndArrSync.yapStatus&&this.yapFrontEndArrSync.rejectFlag)||a!==this.yapFrontEndArrSync.originalMainAuditorTeam&&void 0===this.yapFrontEndArrSync.coAuditorTeam.find(t=>t===a)||"ROLE_Audit_Team_Head"!==this.role.id&&("ROLE_Auditor"!==this.role.id||!this.isConfirmUser));case"review":return"toReview"===this.yapFrontEndArrSync.isReviewDone||"done"===this.yapFrontEndArrSync.isReviewDone;case"default":return!1}}onHandleCopy(){const t=this.$global.deepCopyData(this.yapFrontEndArrSync);this.$emit("slideclick",{type:"copy",payload:{yapId:this.yapId,copyContent:t}})}onHandleDelete(){this.$emit("slideclick",{type:"delete",payload:{yapId:this.yapId}})}onHandleImport(){this.$emit("slideclick",{type:"import",payload:{yapId:this.yapFrontEndArrSync.yapId,yap:this.yapFrontEndArrSync}})}onHandleReview(){"toReview"===this.yapFrontEndArrSync.isReviewDone&&this.$emit("slideclick",{type:"review",payload:{yapId:this.yapFrontEndArrSync.yapId}})}onComparisonProjectTextarea(){this.$emit("click",{type:"project-comparison",payload:{yapId:this.yapId,isEdit:this.isEditProject}})}onQuestionItemProjectTextarea({QAStatus:t,yapStatus:e,reviewLevel:a,rejectFlag:i}){this.$emit("click",{type:"project-questionItem",payload:{yapId:this.yapId,QAStatus:t,yapStatus:e,reviewLevel:a,rejectFlag:i,isSupervisorReaded:this.isSupervisor&&this.isOnReviewLevel&&"A"===t}})}onConfirmItemProjectTextarea(){this.$emit("click",{type:"project-confirmItem",payload:{request:{yapId:this.yapId,yapProjectScopeContent:this.yapFrontEndArrSync.yapProjectScopeContent,modify:this.yapFrontEndArrSync.yapProjectScopeContent!==this.yapFrontEndArrSync.originalYapProjectScopeContent}}})}checkEditYapPointAuditItem(t){var e;const a=null===(e=this.role.roleUnits[0])||void 0===e?void 0:e.auditorTeamCode;return"C"===this.yapFrontEndArrSync.yapStatus&&this.isSupervisor&&!this.yapFrontEndArrSync.rejectFlag?this.isOnReviewLevel()&&"done"!==this.yapFrontEndArrSync.isReviewDone:"ROLE_Audit_Team_Head"===this.currentRoleId?!("B"===this.yapStatus&&"C"===this.yapFrontEndArrSync.yapStatus||"D"==this.yapFrontEndArrSync.yapStatus||"E"===this.yapFrontEndArrSync.yapStatus||null!=t&&t.hasReviewFlag||a!==this.yapFrontEndArrSync.originalMainAuditorTeam&&void 0===this.yapFrontEndArrSync.coAuditorTeam.find(t=>t===a)):!("ROLE_Auditor"!==this.currentRoleId||!("A"===this.yapFrontEndArrSync.yapStatus||"B"===this.yapFrontEndArrSync.yapStatus||"C"===this.yapFrontEndArrSync.yapStatus&&this.yapFrontEndArrSync.rejectFlag)||!this.isConfirmUser||a!==this.yapFrontEndArrSync.originalMainAuditorTeam&&void 0===this.yapFrontEndArrSync.coAuditorTeam.find(t=>t===a)||null==t||!t.hasEditableFlag)}checkDeleteYapPointAuditItem(t){return!("ROLE_Audit_Team_Head"!==this.currentRoleId||!this.checkEditYapPointAuditItem(t)||"C"===this.yapFrontEndArrSync.yapStatus)||!("ROLE_Auditor"!==this.currentRoleId||!this.checkEditYapPointAuditItem(t))}onAddYapPointAuditItem(t,e){this.yapFrontEndArrSync.yapPointAuditItemMap.find(e=>e.key===t).yapPointAuditItems.push({yapPointAuditItemId:"add"+mt.a.v4(),itemContent:null,checkAuditor:null,dataRelId:null,itemCheckStatus:null,itemCode:t,itemName:e,itemQAStatus:"N",modify:!0,hasDeletingFlag:!1,hasEditableFlag:!0,hasRejectCommentFlag:!1,hasReviewFlag:!1,originalItemContent:""})}onDeleteYapPointAuditItem(t,e){if(e.includes("add")||e.includes("copy")){const a=this.yapFrontEndArrSync.yapPointAuditItemMap.find(e=>e.key===t).yapPointAuditItems,i=a.find(t=>t.yapPointAuditItemId===e);a.splice(a.indexOf(i),1),this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除重點查核項目 成功",autoClose:3}})}else this.$emit("click",{type:"deletePointAuditItem",payload:{yapId:this.yapId,yapPointAuditItemMapId:t,yapPointAuditItemId:e}})}onComparisonItemTextarea(t){this.$emit("click",{type:"comparison",payload:{yapId:this.yapId,...t}})}onLinkItemTextarea(t){this.$emit("click",{type:"linkItem",payload:{yapId:this.yapId,...t}})}onQuestionItemTextarea({yapPointAuditItemId:t,yapPointAuditItemMapId:e,QAStatus:a,yapStatus:i,reviewLevel:s,rejectFlag:o}){this.$emit("click",{type:"questionItem",payload:{yapId:this.yapId,yapPointAuditItemId:t,yapPointAuditItemMapId:e,QAStatus:a,yapStatus:i,reviewLevel:s,rejectFlag:o,isSupervisorReaded:this.isSupervisor&&this.isOnReviewLevel&&"A"===a}})}onConfirmItemTextarea(t,e){this.$emit("click",{type:"confirmItem",payload:{yapId:this.yapFrontEndArrSync.yapId,request:{itemContent:e.itemContent,modify:e.itemContent!==e.originalItemContent,yapPointAuditItemId:e.yapPointAuditItemId}}})}onCheckItem(t,e){this.$emit("click",{type:"reviewItem",payload:{yapId:this.yapId,yapPointAuditItemMapId:t,yapPointAuditItemId:e,type:"leaderApproval",title:"審核通過",label:"通過意見"}})}onWithdrawItem(t,e){this.$emit("click",{type:"reviewItem",payload:{yapId:this.yapId,yapPointAuditItemMapId:t,yapPointAuditItemId:e,type:"leaderReturn",title:"審核退回",label:"退回意見"}})}onLeaderOpinion(t){this.$emit("click",{type:"LeaderOpinion",payload:{yapId:this.yapId,yapPointAuditItemId:t}})}created(){}mounted(){}};Object(J.a)([ye.Action("setModalState")],Ce.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"yapId",void 0),Object(J.a)([Object(et.c)("yapFrontEndArr")],Ce.prototype,"yapFrontEndArrSync",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"role",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"itemOption",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"typeOption",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"teamOption",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"unitList",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"yapPointAuditItemList",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"isConfirmUser",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"yapStatus",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"currentYear",void 0),Object(J.a)([Object(et.b)()],Ce.prototype,"reviewFlag",void 0),Object(J.a)([Object(et.e)("unitList",{immediate:!0})],Ce.prototype,"onUnitListChanged",null),Object(J.a)([Object(et.e)("yapPointAuditItemList",{immediate:!0})],Ce.prototype,"onYapPointAuditItemListChanged",null),Object(J.a)([Object(et.e)("yapFrontEndArrSync",{deep:!0})],Ce.prototype,"onYapFrontEndArrSyncChanged",null),Ce=Object(J.a)([Object(et.a)({components:{AccordionArea:_e,CustomPopConfirm:ce}})],Ce);var Oe=Ce,Ae=(a("74a8"),Object(st.a)(Oe,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-responsive"},[a("a-form-model",{ref:"formRef",attrs:{model:t.yapFrontEndArrSync,"hide-required-mark":!0,rules:t.formRules}},[a("table",{staticClass:"table custom__table",class:{"custom__table--copy":t.yapFrontEndArrSync.yapId.includes("copy")}},[a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[t._v(" 月份 ")]),a("th",{attrs:{scope:"col"}},[t._v(" 查核性質 ")]),a("th",{attrs:{scope:"col"}},[t._v(" 查核項目 ")]),a("th",{attrs:{scope:"col"}},[t._v(" 計畫受檢單位 ")]),a("th",{attrs:{scope:"col"}},[t._v(" 主辦組 ")]),a("th",{attrs:{scope:"col"}},[t._v(" 協辦組 ")]),a("th",{attrs:{scope:"col"}})])]),a("tbody",[a("tr",{staticClass:"table__controlBar"},[a("td",[a("a-form-model-item",{ref:"startMonth",attrs:{prop:"startMonth"}},[a("a-select",{staticClass:"search__result__month search__result__month--left",attrs:{"show-search":"",placeholder:"起",options:t.$enum.monthOption,"filter-option":t.$global.filterOption,"dropdown-match-select-width":!1,disabled:!t.isEditYapItem},on:{change:t.startMonthChange},model:{value:t.yapFrontEndArrSync.startMonth,callback:function(e){t.$set(t.yapFrontEndArrSync,"startMonth",e)},expression:"yapFrontEndArrSync.startMonth"}}),a("a-input",{staticClass:"search__result__range",attrs:{placeholder:"~",disabled:""}}),a("a-select",{staticClass:"search__result__month search__result__month--right",attrs:{"filter-option":t.$global.filterOption,"show-search":"",placeholder:"迄",options:t.$enum.monthOption,"dropdown-match-select-width":!1,disabled:!t.isEditYapItem},on:{change:function(){t.$refs.startMonth.onFieldChange()}},model:{value:t.yapFrontEndArrSync.endMonth,callback:function(e){t.$set(t.yapFrontEndArrSync,"endMonth",e)},expression:"yapFrontEndArrSync.endMonth"}})],1)],1),a("td",[a("a-form-model-item",{attrs:{prop:"auditType"}},[a("a-select",{staticClass:"search__result__select",attrs:{"show-search":"","filter-option":t.$global.filterOption,options:t.typeOption,"dropdown-match-select-width":!1,disabled:!t.isEditYapItem},model:{value:t.yapFrontEndArrSync.auditType,callback:function(e){t.$set(t.yapFrontEndArrSync,"auditType",e)},expression:"yapFrontEndArrSync.auditType"}})],1)],1),a("td",[a("a-form-model-item",{attrs:{prop:"auditItem"}},[a("a-select",{staticClass:"search__result__select",attrs:{"show-search":"","filter-option":t.$global.filterOption,options:t.itemOption,"dropdown-match-select-width":!1,disabled:!t.isEditYapItem},model:{value:t.yapFrontEndArrSync.auditItem,callback:function(e){t.$set(t.yapFrontEndArrSync,"auditItem",e)},expression:"yapFrontEndArrSync.auditItem"}})],1)],1),a("td",[a("a-form-model-item",{staticClass:"item__children--flex",attrs:{prop:"units"}},[a("a-tree-select",{staticClass:"treeselect",attrs:{"tree-data":t.unitOption,"tree-checkable":"","tree-default-expand-all":!0,"tree-node-filter-prop":"title","dropdown-class-name":"treeselect","dropdown-style":{maxHeight:"300px"},disabled:!t.isEditYapItem},model:{value:t.yapFrontEndArrSync.units,callback:function(e){t.$set(t.yapFrontEndArrSync,"units",e)},expression:"yapFrontEndArrSync.units"}})],1),a("div",{staticClass:"d-flex flex-wrap-reverse align-items-end mt-3"},[a("div",{staticClass:"change__info__wrap"},t._l(t.inValidUnitList,(function(e){return a("p",{key:e.value,staticClass:"change__info"},[t._v(" "+t._s(e.label+"(組織異動)")+" ")])})),0),a("button",{staticClass:"button__showAllUnit",on:{click:function(e){return t.onInspectedUnit(t.yapFrontEndArrSync.units)}}},[t._v(" 顯示全部 ")])])],1),a("td",[a("a-form-model-item",{attrs:{prop:"mainAuditorTeam"}},[a("a-select",{staticClass:"search__result__select",attrs:{"show-search":"","filter-option":t.$global.filterOption,options:t.teamOption,"dropdown-match-select-width":!1,disabled:!t.isEditYapItem},model:{value:t.yapFrontEndArrSync.mainAuditorTeam,callback:function(e){t.$set(t.yapFrontEndArrSync,"mainAuditorTeam",e)},expression:"yapFrontEndArrSync.mainAuditorTeam"}})],1)],1),a("td",[a("a-form-model-item",{staticClass:"item__children--flex",attrs:{prop:"coAuditorTeam"}},[a("a-select",{staticClass:"search__result__select",attrs:{mode:"multiple","filter-option":t.$global.filterOption,options:t.teamOption,"dropdown-match-select-width":!1,disabled:!t.isEditYapItem},model:{value:t.yapFrontEndArrSync.coAuditorTeam,callback:function(e){t.$set(t.yapFrontEndArrSync,"coAuditorTeam",e)},expression:"yapFrontEndArrSync.coAuditorTeam"}})],1)],1),a("td",{attrs:{rowspan:"2"}},[a("div",{staticClass:"sideMenu__wrap"},[t.checkSideButton("edit")?a("button",{staticClass:"sideMenu__item button__copy",on:{click:t.onHandleCopy}},[t._v(" 複製 ")]):t._e(),t.checkSideButton("edit")?a("CustomPopConfirm",{on:{confirm:t.onHandleDelete}},[a("button",{staticClass:"sideMenu__item button__delete"},[t._v(" 刪除 ")])]):t._e(),t.checkSideButton("import")?a("button",{staticClass:"sideMenu__item button__import",on:{click:t.onHandleImport}},[t._v(" 匯入舊資料 ")]):t._e(),t.checkSideButton("review")?a("button",{staticClass:"sideMenu__item button__copy",class:{"button__copy--unclickabled":"toReview"!==t.yapFrontEndArrSync.isReviewDone},on:{click:t.onHandleReview}},[t._v(" "+t._s("toReview"===t.yapFrontEndArrSync.isReviewDone?"審畢":"已審畢")+" ")]):t._e(),t.checkSideButton("review")?a("button",{staticClass:"sideMenu__item button__copy mt-auto",class:{"button__copy--unclickabled":"toReview"!==t.yapFrontEndArrSync.isReviewDone},on:{click:t.onHandleReview}},[t._v(" "+t._s("toReview"===t.yapFrontEndArrSync.isReviewDone?"審畢":"已審畢")+" ")]):t._e()],1)])]),a("tr",[a("td",{staticClass:"p-0",attrs:{colspan:"6"}},[a("div",{staticClass:"project__wrap"},[a("div",{staticClass:"project__header"},[t._v(" 專案查核範圍 ")]),a("div",{staticClass:"textarea__wrap"},[a("div",{staticClass:"textarea__main"},[a("a-form-model-item",{attrs:{prop:"yapProjectScopeContent"}},[a("a-textarea",{staticClass:"audit__textarea",attrs:{rows:4,disabled:!t.isEditProject},model:{value:t.yapFrontEndArrSync.yapProjectScopeContent,callback:function(e){t.$set(t.yapFrontEndArrSync,"yapProjectScopeContent",e)},expression:"yapFrontEndArrSync.yapProjectScopeContent"}})],1)],1),a("div",{staticClass:"textarea__control d-flex flex-wrap"},[a("div",{staticClass:"d-flex flex-wrap mx-2 w-100"},[a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("span",[t._v("比對資料")])]),a("button",{staticClass:"textarea__control__btn btn__icon--comparison",on:{click:t.onComparisonProjectTextarea}})],2)],1),t.isSupervisor||"ROLE_Audit_Team_Head"===t.currentRoleId?a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.haveToReplyQuestion(t.yapFrontEndArrSync.yapProjectScopeQaStatus)?a("span",[t._v("待回覆")]):a("span",[t._v("回覆提問")])]),a("button",{staticClass:"textarea__control__btn",class:t.haveToReplyQuestion(t.yapFrontEndArrSync.yapProjectScopeQaStatus)?"btn__icon--question_red":"btn__icon--question",on:{click:function(e){return t.onQuestionItemProjectTextarea({QAStatus:t.yapFrontEndArrSync.yapProjectScopeQaStatus,yapStatus:t.yapFrontEndArrSync.yapStatus,reviewLevel:t.yapFrontEndArrSync.reviewLevel,rejectFlag:t.yapFrontEndArrSync.rejectFlag})}}})],2)],1):t._e(),t.isCheckEditItem?a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.yapFrontEndArrSync.redFlagOfYapProjectScopeCheckStatus?a("span",[t._v("待確認")]):a("span",[t._v("確認修改")])]),a("button",{staticClass:"textarea__control__btn",class:t.yapFrontEndArrSync.redFlagOfYapProjectScopeCheckStatus?"btn__icon--confirm":"btn__icon--enter1",on:{click:t.onConfirmItemProjectTextarea}})],2)],1):t._e()])])])]),a("div",{staticClass:"importantCheck__wrap"},[a("div",{staticClass:"importantCheck__title__group"},[a("i",{staticClass:"importantCheck__title__required"},[t._v("＊")]),a("span",{staticClass:"importantCheck__title"},[t._v("重點查核項目")]),a("a-popover",{attrs:{placement:"bottomLeft",trigger:"hover","overlay-class-name":"whitePopover"}},[a("template",{slot:"title"},[a("span",{staticClass:"custom__popConfirm__title"},[t._v("註：重點查核項目包括：")])]),a("template",{slot:"content"},[a("ul",{staticClass:"numListStyle"},[a("li",[t._v(t._s("主管機關公佈之"+(parseInt(t.currentYear)-1)+"年度檢查重點、近一年主要檢失。 "))]),a("li",[t._v("同業近一年常見裁罰案。")]),a("li",[t._v("公司重要風險或內控事件。")]),a("li",[t._v("母公司近一年辦理查核提列中風險以上之稽核議題。")]),a("li",[t._v(" 加強辦理查核事項： "),a("ul",[a("li",[t._v("-主管機關要求加強辦理查核事項")]),a("li",[t._v("-經本室評估應加強查核事項")]),a("li",[t._v("-主管機關裁罰案")])])]),a("li",[t._v("其他，如主管機關函示個別提案之重大缺失、其他函示等。")])])]),a("button",{staticClass:"importantCheck__icon"})],2),t.isNeedPointAuditItem?a("div",{staticClass:"has-error ps-3"},[t._v(" 請至少輸入一個重點查核項目 ")]):t._e()],1),a("AccordionArea",[a("a-collapse",{model:{value:t.activeImportantCheckKey,callback:function(e){t.activeImportantCheckKey=e},expression:"activeImportantCheckKey"}},t._l(t.yapFrontEndArrSync.yapPointAuditItemMap,(function(e,i){return a("a-collapse-panel",{key:e.key,attrs:{header:e.headerTitle}},[t._l(e.yapPointAuditItems,(function(s,o){return a("div",{key:s.yapPointAuditItemId,staticClass:"textarea__wrap"},[a("div",{staticClass:"textarea__main mb-2"},[a("a-form-model-item",{attrs:{rules:{trigger:"blur",validator:t.yapPointAuditItemValidator},prop:"yapPointAuditItemMap."+i+".yapPointAuditItems."+o+".itemContent"}},[a("a-textarea",{staticClass:"audit__textarea",attrs:{rows:4,disabled:!t.checkEditYapPointAuditItem(s)},model:{value:s.itemContent,callback:function(e){t.$set(s,"itemContent",e)},expression:"yapPointAuditItem.itemContent"}})],1),s.hasEditableFlag||"ROLE_Auditor"!==t.currentRoleId?t._e():a("p",{staticClass:"info__message"},[t._v(" 欲"+t._s(s.hasDeletingFlag?"刪除":"變更")+"此項目，待組長覆核完成，此筆資料才會"+t._s(s.hasDeletingFlag?"刪除":"變更")+"。 ")]),s.hasReviewFlag&&"ROLE_Audit_Team_Head"===t.currentRoleId?a("p",{staticClass:"info__message"},[t._v(" 查核人員欲"+t._s(s.hasDeletingFlag?"刪除":"變更")+"此項目，請組長覆核。 ")]):t._e()],1),a("div",{staticClass:"textarea__control d-flex flex-wrap"},[a("div",{staticClass:"d-flex flex-wrap mx-2 w-100"},[t.checkDeleteYapPointAuditItem(s)?a("div",{staticClass:"col-6"},[a("CustomPopConfirm",{attrs:{disabled:!t.checkDeleteYapPointAuditItem(s)},on:{confirm:function(a){return t.onDeleteYapPointAuditItem(e.key,s.yapPointAuditItemId)}}},[a("button",{staticClass:"textarea__control__btn btn__icon--small_delete"})])],1):t._e(),a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("span",[t._v("比對資料")])]),a("button",{staticClass:"textarea__control__btn btn__icon--comparison",on:{click:function(a){t.onComparisonItemTextarea({isEdit:t.checkEditYapPointAuditItem(s),item:e.yapPointAuditItems,yapPointAuditItemMapId:e.key,yapPointAuditItemId:s.yapPointAuditItemId})}}})],2)],1),a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("span",[t._v("連結資料")])]),a("button",{staticClass:"textarea__control__btn btn__icon--small_link",on:{click:function(a){return t.onLinkItemTextarea({itemPointKey:e.key,yapPointAuditItemId:s.yapPointAuditItemId,copyYapPointAuditItemId:s.copyYapPointAuditItemId})}}})],2)],1),t.isSupervisor||"ROLE_Audit_Team_Head"===t.currentRoleId?a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.haveToReplyQuestion(s.itemQAStatus)?a("span",[t._v("待回覆")]):a("span",[t._v("回覆提問")])]),a("button",{staticClass:"textarea__control__btn",class:t.haveToReplyQuestion(s.itemQAStatus)?"btn__icon--question_red":"btn__icon--question",on:{click:function(a){return t.onQuestionItemTextarea({yapPointAuditItemId:s.yapPointAuditItemId,yapPointAuditItemMapId:e.key,QAStatus:s.itemQAStatus,yapStatus:t.yapFrontEndArrSync.yapStatus,reviewLevel:t.yapFrontEndArrSync.reviewLevel,rejectFlag:t.yapFrontEndArrSync.rejectFlag})}}})],2)],1):t._e(),t.isCheckEditItem?a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[s.redFlagOfItemCheckStatus?a("span",[t._v("待確認")]):a("span",[t._v("確認修改")])]),a("button",{staticClass:"textarea__control__btn",class:s.redFlagOfItemCheckStatus?"btn__icon--confirm":"btn__icon--enter1",on:{click:function(a){return t.onConfirmItemTextarea(e.key,s)}}})],2)],1):t._e(),"ROLE_Audit_Team_Head"===t.currentRoleId&&s.hasReviewFlag?a("div",{staticClass:"w-100"},[a("div",{staticClass:"col-12"},[a("button",{staticClass:"textarea__control__text__btn",on:{click:function(a){return t.onCheckItem(e.key,s.yapPointAuditItemId)}}},[t._v(" 通過 ")])]),a("div",{staticClass:"col-12"},[a("button",{staticClass:"textarea__control__text__btn",on:{click:function(a){return t.onWithdrawItem(e.key,s.yapPointAuditItemId)}}},[t._v(" 退回 ")])])]):t._e()]),s.hasRejectCommentFlag?a("div",{staticClass:"col-12 withdrawComments__wrap"},[a("button",{staticClass:"withdrawComments__btn",on:{click:function(e){return t.onLeaderOpinion(s.yapPointAuditItemId)}}},[t._v(" 退回意見 ")])]):t._e()])])})),t.isAddYapPointAuditItem?a("div",{staticClass:"footer__button__wrap"},[a("button",{staticClass:"textarea__controlBtn__add",on:{click:function(a){return t.onAddYapPointAuditItem(e.key,e.headerTitle)}}},[a("a-icon",{staticClass:"textarea__controlBtn__icon",attrs:{type:"plus"}}),a("span",{staticClass:"textarea__controlBtn__txt"},[t._v("新增")])],1)]):t._e()],2)})),1)],1)],1)])])])])])],1)}),[],!1,null,"3cb62e51",null).exports);const Ie=Object(tt.c)("modalControl");let De=class extends et.d{constructor(){super(...arguments),this.name="",this.role="",this.roleId="",this.form={message:""},this.modalQAStatus="",this.formRules={message:[{required:!0,message:"請填寫訊息",trigger:"change"}]}}get isEdit(){if("C"===this.yapStatus&&!this.rejectFlag){if("ROLE_Audit_Team_Head"===this.roleId&&"Q"===this.QAStatus)return!0;if("Q"!==this.QAStatus){if("ROLE_Audit_Department_Head"===this.roleId&&"1"===this.reviewLevel)return!0;if("ROLE_Audit_Office_Boss_Vice"===this.roleId&&"2"===this.reviewLevel)return!0;if("ROLE_Audit_Office_Boss"===this.roleId&&"3"===this.reviewLevel)return!0}}return!1}getApi_createYapProjectScopeQA(){this.$auditPlanApi.createQAOfYapProjectScopeInAuditPlanUsingPOST({qaContent:this.form.message,yapId:this.yapId}).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"新增提問/回覆提問成功",autoClose:3}}),this.form.message="",this.$emit("getYapProjectScopeQA",{yapId:this.yapId,QAStatus:this.QAStatus,yapStatus:this.yapStatus}),this.$emit("changeYapProjectScopeQAStatus",this.yapId)}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}getApi_createYapItemScopeQA(){this.$auditPlanApi.createQAOfYapPointAuditItemInAuditPlanUsingPOST({qaContent:this.form.message,yapPointAuditItemId:this.yapPointAuditItemId}).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"新增提問/回覆提問成功",autoClose:3}}),this.form.message="",this.$emit("getYapItemScopeQA",{yapPointAuditItemId:this.yapPointAuditItemId,QAStatus:this.QAStatus,yapStatus:this.yapStatus}),this.$emit("changeYapItemScopeQAStatus",this.yapId)}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}confirm(){this.$refs.formRef.validate(async t=>{t&&(this.yapPointAuditItemId?this.getApi_createYapItemScopeQA():this.getApi_createYapProjectScopeQA())})}close(){this.$emit("closeModal")}watchVisible(t){t&&(this.form.message="",this.name=this.$user.getMe().employee.name,this.role=this.$global.getCurrentRole().name,this.roleId=this.$global.getCurrentRoleId())}};Object(J.a)([Object(tt.a)("setLoading")],De.prototype,"setLoading",void 0),Object(J.a)([Ie.Action("setModalState")],De.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],De.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],De.prototype,"QAStatus",void 0),Object(J.a)([Object(et.b)()],De.prototype,"QAData",void 0),Object(J.a)([Object(et.b)()],De.prototype,"yapId",void 0),Object(J.a)([Object(et.b)()],De.prototype,"yapStatus",void 0),Object(J.a)([Object(et.b)()],De.prototype,"yapPointAuditItemId",void 0),Object(J.a)([Object(et.b)()],De.prototype,"isSupervisor",void 0),Object(J.a)([Object(et.b)()],De.prototype,"reviewLevel",void 0),Object(J.a)([Object(et.b)()],De.prototype,"rejectFlag",void 0),Object(J.a)([Object(et.e)("visible",{deep:!0,immediate:!0})],De.prototype,"watchVisible",null),De=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],De);var Se=De,we=(a("a6fb"),Object(st.a)(Se,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"提問及回覆問題",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,centered:!1},on:{closeModal:t.close}},[i("template",{slot:"content"},[i("div",{staticClass:"content mt-2"},[i("div",{staticClass:"list"},[t.isEdit?i("div",{staticClass:"list__item"},[i("div",{staticClass:"list__item__info"},[i("img",{staticClass:"list__item__img",attrs:{src:a("31d9"),alt:""}}),i("div",{staticClass:"list__item__title mt-3"},[t._v(" "+t._s(t.role)+" ")]),i("div",{staticClass:"list__item__title"},[t._v(" "+t._s(t.name)+" ")])]),i("div",{staticClass:"list__item__content d-flex flex-column justify-content-end"},[i("div",{staticClass:"list__item__subtitle"},[i("a-form-model",{ref:"formRef",attrs:{model:t.form,"hide-required-mark":!0,rules:t.formRules}},[i("a-form-model-item",{attrs:{prop:"message"}},[i("a-textarea",{staticClass:"list__item__textarea",attrs:{rows:4},model:{value:t.form.message,callback:function(e){t.$set(t.form,"message",e)},expression:"form.message"}})],1)],1)],1),i("button",{staticClass:"btn--primary mt-2 align-self-end",on:{click:t.confirm}},[t._v(" 送出 ")])])]):t._e(),t._l(t.QAData,(function(e,s){return i("div",{key:s,staticClass:"list__item"},[i("div",{staticClass:"list__item__info"},[i("img",{staticClass:"list__item__img",attrs:{src:a(s%2==0?"ff46":"31d9"),alt:""}}),i("div",{staticClass:"list__item__title mt-3"},[t._v(" "+t._s(e.updateRole)+" ")]),i("div",{staticClass:"list__item__title"},[t._v(" "+t._s(e.updateUser)+" ")])]),i("div",{staticClass:"list__item__content align-self-start"},[i("div",{staticClass:"list__item__subtitle"},[i("span",[t._v(t._s(e.updateDatetime))])]),i("div",{staticClass:"list__item__text"},[t._v(" "+t._s(t.yapPointAuditItemId?e.yapPointAuditItemQAContent:e.yapProjectScopeQAContent)+" ")])])])})),t.QAData&&0!==t.QAData.length||t.isEdit?t._e():i("div",{staticClass:"d-flex m-3 flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無資料 ")])])],2)])])],2)}),[],!1,null,"7efe3352",null).exports),ke=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"btn--dark message__btn"},[i("img",{staticClass:"message__btn__icon",attrs:{src:a("85cc"),alt:""}}),t._v(" 罐頭語 ")])}],Me=a("6062");const xe=Object(tt.c)("modalControl");let je=class extends et.d{constructor(){super(...arguments),this.isShow=!1,this.searchValue=null,this.addValue=null,this.filterList=null,this.messageList=null,this.userId=this.$user.getMe().employee.domainId}created(){this.getTextTemp()}getTextTemp(){this.setLoading(!0);const t={userId:this.userId};this.$dataCollectApi.getTextTempInDataCollectUsingPOST(t).then(t=>{this.messageList=t.data.result,this.filterList=this.messageList}).catch(console.error).finally(()=>{this.setLoading(!1)})}deleteMsg(t){this.setLoading(!0),this.$dataCollectApi.deleteTextTempInDataCollectUsingPOST({sysCodeDetailId:t.detailId,sysCodeMainId:t.mainId,sysCodeGroupId:t.groupId}).then(t=>{this.getTextTemp()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除罐頭語失敗",autoClose:"0"}})}).finally(()=>{this.setLoading(!1)})}addMsg(){this.setLoading(!0);const t={userId:this.userId,value:this.addValue};this.$dataCollectApi.saveTextTempInDataCollectUsingPOST(t).then(t=>{this.getTextTemp(),this.addValue=void 0}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"新增罐頭語失敗",autoClose:"0"}})}).finally(()=>{this.setLoading(!1)})}selectMsg(t){this.$emit("select",t)}fuzzySearch(){if(this.searchValue){const t={includeScore:!0,keys:["value"]},e=new Me.a(this.messageList,t).search(this.searchValue);this.filterList=e.map(t=>t.item)}else this.filterList=this.messageList}};Object(J.a)([xe.Action("setModalState")],je.prototype,"setModalState",void 0),Object(J.a)([Object(tt.a)("setLoading")],je.prototype,"setLoading",void 0),je=Object(J.a)([Object(et.a)({components:{CustomPopConfirm:ce}})],je);var Te=je,Le=(a("3968"),Object(st.a)(Te,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"message"},[t._m(0),i("div",{staticClass:"search"},[i("a-input-search",{on:{input:t.fuzzySearch},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),i("div",{staticClass:"message__list"},[t.filterList&&t.filterList.length>0?t._l(t.filterList,(function(e){return i("div",{key:e.detailId+e.mainId,staticClass:"list__item"},[i("div",{staticClass:"list__item__text",on:{click:function(a){return t.selectMsg(e.value)}}},[t._v(" "+t._s(e.value)+" ")]),i("CustomPopConfirm",{on:{confirm:function(a){return t.deleteMsg(e)}}},[e.shared?t._e():i("a-icon",{staticClass:"btn-minus__icon",attrs:{type:"minus-square"}})],1)],1)})):t._e()],2),i("div",{staticClass:"list__input"},[i("a-input",{attrs:{placeholder:"新增罐頭語"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addMsg.apply(null,arguments)}},model:{value:t.addValue,callback:function(e){t.addValue=e},expression:"addValue"}}),i("div",{staticClass:"btn-add flex-center",on:{click:t.addMsg}},[i("img",{attrs:{src:a("9925"),alt:""}})])],1)])}),ke,!1,null,"0e97cc24",null)).exports;let Pe=class extends et.d{constructor(){super(...arguments),this.itemOptions=[],this.form={applyRemark:void 0,auditItems:void 0},this.formRules={auditItems:[{required:!0,message:"請選擇查核項目",trigger:"change"}],applyRemark:[{trigger:"change",validator:this.applyRemarkValidator}]}}watchVisible(t){t&&"adminReturn"===this.type&&this.setAuditItemsData(),t&&"supervisorReturn"===this.type&&this.getSupervisorReturnAuditItem()}applyRemarkValidator(t,e,a){if(!e)return"leaderReturn"===this.type||"supervisorReturn"===this.type||"adminReturn"===this.type?a("請輸入退回意見"):"leaderDelete"===this.type?a("請輸入刪除意見"):a();a()}setAuditItemsData(){this.setLoading(!0),this.$auditPlanApi.searchAuditItemInAuditPlanUsingGET(this.year.toString(),!1).then(t=>{this.itemOptions=t.data.result}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getSupervisorReturnAuditItem(){this.setLoading(!0),this.$auditPlanApi.searchYapModifiableInAuditPlanUsingGET(this.year.toString(),!1).then(t=>{this.itemOptions=t.data.result}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}close(){this.reset(),this.$emit("closeModal")}reset(){this.form={auditItems:void 0,applyRemark:void 0}}submit(){this.$refs.formRef.validate(t=>{if(t){switch(this.type){case"adminReturn":case"supervisorReturn":this.$emit("click",{type:"return",payload:this.form});break;case"leaderDelete":this.$emit("click",{type:"leaderDelete",payload:this.form.applyRemark});break;case"leaderReturn":this.$emit("click",{type:"leaderReturn",payload:{yapId:this.yapId,remark:this.form.applyRemark}});break;case"leaderApproval":this.$emit("click",{type:"leaderApproval",payload:{yapId:this.yapId,remark:this.form.applyRemark}})}this.close()}})}addResponseMessage(t){this.form.applyRemark?this.form.applyRemark+=t:this.form.applyRemark=t}};Object(J.a)([Object(tt.a)("setLoading")],Pe.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Pe.prototype,"visible",void 0),Object(J.a)([Object(et.b)({default:"approval"})],Pe.prototype,"type",void 0),Object(J.a)([Object(et.b)()],Pe.prototype,"title",void 0),Object(J.a)([Object(et.b)()],Pe.prototype,"label",void 0),Object(J.a)([Object(et.b)()],Pe.prototype,"year",void 0),Object(J.a)([Object(et.b)()],Pe.prototype,"yapId",void 0),Object(J.a)([Object(et.e)("visible",{immediate:!0})],Pe.prototype,"watchVisible",null),Pe=Object(J.a)([Object(et.a)({components:{ResponseMessage:Le,InfoModal:_t}})],Pe);var Re,Ee=Pe,$e=(a("746d"),Object(st.a)(Ee,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:t.title,visible:t.visible,centered:!0,width:950},on:{closeModal:t.close}},[i("template",{slot:"content"},[i("div",["adminReturn"!==t.type&&"supervisorReturn"!==t.type||t.itemOptions&&0!==t.itemOptions.length?i("a-form-model",{ref:"formRef",staticClass:"mt-4 form--light",attrs:{model:t.form,rules:t.formRules,"hide-required-mark":!0}},["adminReturn"===t.type||"supervisorReturn"===t.type?i("a-form-model-item",{attrs:{prop:"auditItems","label-col":{span:2},"wrapper-col":{span:6}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核項目： ")]),i("a-select",{staticClass:"w-100",attrs:{placeholder:"請選擇查核項目","allow-clear":!0,options:t.itemOptions,mode:"multiple","dropdown-match-select-width":!1},model:{value:t.form.auditItems,callback:function(e){t.$set(t.form,"auditItems",e)},expression:"form.auditItems"}})],1):t._e(),i("div",{staticClass:"row"},[i("a-form-model-item",{staticClass:"col-7",attrs:{prop:"applyRemark","label-col":{span:24},"wrapper-col":{span:24}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.label+"：")+" ")]),i("div",{staticClass:"confirm-message"},[i("img",{staticClass:"confirm-message__img",attrs:{src:"approval"===t.type?a("5430"):a("e536"),alt:""}}),i("a-textarea",{attrs:{"auto-size":{minRows:14}},model:{value:t.form.applyRemark,callback:function(e){t.$set(t.form,"applyRemark",e)},expression:"form.applyRemark"}})],1)]),i("ResponseMessage",{staticClass:"content__msg ps-2 col-5",on:{select:t.addResponseMessage}})],1)],1):i("div",{staticClass:"d-flex my-3 flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無可退回的查核項目 ")])]),i("div",{staticClass:"d-flex mt- justify-content-end"},["adminReturn"!==t.type&&"supervisorReturn"!==t.type||t.itemOptions&&0!==t.itemOptions.length?i("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]):t._e(),i("button",{staticClass:"btn--dark ms-2",on:{click:t.close}},[t._v(" 取消 ")])])],1)])],2)}),[],!1,null,"bf8a831e",null).exports);!function(t){t.PLAIN="PLAIN",t.TEMPLATE="TEMPLATE",t.BADGE="BADGE",t.TAG="TAG",t.ACTION="ACTION",t.ELLIPSIS="ELLIPSIS"}(Re||(Re={}));const Fe=Object(tt.c)("modalControl");let Ue=class extends et.d{constructor(){super(...arguments),this.itemOption=[],this.form={year:null,month:null,auditType:null,auditItems:null,auditorTeam:null},this.rules={year:[{required:!0,message:"請選擇年度",trigger:"change"}]},this.grid={rowKey:"yapLogId",data:[],pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","25","50"],showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{type:Re.PLAIN,property:"month",title:"月份",width:"95px"},{type:Re.PLAIN,property:"auditItem",title:"查核項目",width:"117px"},{type:Re.PLAIN,property:"updateTeam",title:"編輯組別",width:"150px"},{type:Re.PLAIN,property:"updateUser",title:"編輯人員",width:"108px"},{type:Re.PLAIN,property:"updateDate",title:"編輯日期",width:"163px"},{type:Re.PLAIN,property:"operate",title:"執行動作",width:"210px"},{type:Re.PLAIN,property:"remark",title:"備註",width:"210px"}]}}watchSearchForm(){this.form=this.$global.deepCopyData(this.initSearchForm)}async watchVisible(t){t&&(await this.handleYearChange(),await this.onSearch())}handleTableChange(t){this.grid.pagination.current=t.pagination.current,this.grid.pagination.pageSize=t.pagination.pageSize,this.onSearch()}closeModal(){this.$emit("closeModal")}async handleYearChange(){await this.$auditPlanApi.searchAuditItemInAuditPlanUsingGET(String(this.form.year),!0).then(t=>{this.itemOption=t.data.result}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}async onSearch(){this.setLoading(!0),this.request={pageIndex:this.grid.pagination.current-1,pageSize:this.grid.pagination.pageSize,...this.form,auditItems:[]},this.form.auditItems?this.request.auditItems.push(this.form.auditItems):this.request.auditItems=[],await this.$auditPlanApi.searchYapLogInAuditPlanUsingPOST(this.request).then(t=>{this.grid.data=[],this.grid.data=t.data.result.content,this.grid.pagination.total=parseInt(t.data.result.totalElements)}).catch(t=>{this.grid.data=t.response.data.result,this.grid.pagination.total=t.response.data.total,this.setModalState({resultModal:{visible:!0,title:t.response.data.message,type:"error"}})}).finally(()=>{this.setLoading(!1)})}onSubmit(){this.$refs.formRef.validate(t=>{t&&(this.grid.pagination.current=1,this.onSearch())})}};Object(J.a)([Fe.Action("setModalState")],Ue.prototype,"setModalState",void 0),Object(J.a)([Object(tt.a)("setLoading")],Ue.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Ue.prototype,"initOptions",void 0),Object(J.a)([Object(et.b)()],Ue.prototype,"initSearchForm",void 0),Object(J.a)([Object(et.b)()],Ue.prototype,"visible",void 0),Object(J.a)([Object(et.e)("initSearchForm",{deep:!0})],Ue.prototype,"watchSearchForm",null),Object(J.a)([Object(et.e)("visible",{deep:!0})],Ue.prototype,"watchVisible",null),Ue=Object(J.a)([Object(et.a)({components:{InfoModal:_t,FblDataGrid:gt,AccordionArea:_e}})],Ue);var Ge=Ue,Ye=(a("3ac8"),Object(st.a)(Ge,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"編制歷程",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("div",{staticClass:"container historyModal__container mt-2"},[a("accordion-area",[a("div",{staticClass:"search-form mt-2 row align-items-end"},[a("a-form-model",{ref:"formRef",staticClass:"col-11 row",attrs:{rules:t.rules,model:t.form,"hide-required-mark":!0}},[a("div",{staticClass:"search-form__item col"},[a("div",{staticClass:"search-form__label"},[t._v(" 年度 ")]),a("a-form-model-item",{attrs:{prop:"year"}},[a("a-select",{staticClass:"w-100",attrs:{placeholder:"請選擇年度","filter-option":t.$global.filterOption,options:t.initOptions.yearOptions,"dropdown-match-select-width":!1},on:{change:t.handleYearChange},model:{value:t.form.year,callback:function(e){t.$set(t.form,"year",e)},expression:"form.year"}})],1)],1),a("div",{staticClass:"search-form__item col"},[a("div",{staticClass:"search-form__label"},[t._v(" 月份 ")]),a("a-form-model-item",{attrs:{prop:"month"}},[a("a-select",{staticClass:"w-100",attrs:{"filter-option":t.$global.filterOption,placeholder:"請選擇月份","allow-clear":!0,options:t.$enum.monthOption},model:{value:t.form.month,callback:function(e){t.$set(t.form,"month",e)},expression:"form.month"}})],1)],1),a("div",{staticClass:"search-form__item col"},[a("div",{staticClass:"search-form__label"},[t._v(" 查核性質 ")]),a("a-form-model-item",{attrs:{prop:"auditType"}},[a("a-select",{staticClass:"w-100",attrs:{"filter-option":t.$global.filterOption,options:t.initOptions.typeOption,"allow-clear":!0,placeholder:"請選擇查核性質"},model:{value:t.form.auditType,callback:function(e){t.$set(t.form,"auditType",e)},expression:"form.auditType"}})],1)],1),a("div",{staticClass:"search-form__item col"},[a("div",{staticClass:"search-form__label"},[t._v(" 查核項目 ")]),a("a-form-model-item",{attrs:{prop:"auditItems"}},[a("a-select",{staticClass:"w-100",attrs:{options:t.itemOption,"allow-clear":!0,placeholder:"請選擇查核項目","filter-option":t.$global.filterOption},model:{value:t.form.auditItems,callback:function(e){t.$set(t.form,"auditItems",e)},expression:"form.auditItems"}})],1)],1),a("div",{staticClass:"search-form__item col"},[a("div",{staticClass:"search-form__label"},[t._v(" 組別 ")]),a("a-form-model-item",{attrs:{prop:"auditorTeam"}},[a("a-select",{staticClass:"w-100",attrs:{"filter-option":t.$global.filterOption,"allow-clear":!0,placeholder:"請選擇查核組別",options:t.initOptions.teamOption},model:{value:t.form.auditorTeam,callback:function(e){t.$set(t.form,"auditorTeam",e)},expression:"form.auditorTeam"}})],1)],1)]),a("a-button",{staticClass:"mb-1 btn--search col-1",on:{click:t.onSubmit}},[t._v(" 查詢 ")])],1)]),a("fbl-data-grid",{staticClass:"query__table mt-3",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:t.grid.pagination,"custom-row":t.grid.customRow,scroll:{x:!0}},on:{tableChange:t.handleTableChange}},[a("div",[t._v("底部文字")])])],1)])],2)}),[],!1,null,"88f60536",null).exports);let Ne=class extends et.d{constructor(){super(...arguments),this.form={confirmUser:null,crawlerDataId:null,group:null,applyRemark:""},this.formRules={confirmUser:[{required:!0,message:"請選擇查核項目",trigger:"change"}]},this.confirmUserList=null,this.currentRole=null}getAuditorTeam(){this.setLoading(!0),this.currentRole=this.$global.getCurrentRole();const t={roleId:this.currentRole.id,unitCode:this.currentRole.roleUnits[0].auditorTeamCode};this.$dataCollectApi.getAuditorTeamInDataCollectUsingPOST(t).then(t=>{this.confirmUserList=t.data.result}).catch(console.error).finally(()=>{this.setLoading(!1)})}submit(){this.$refs.formRef.validate(t=>{t&&(this.isClaim?this.$emit("claim",this.form.confirmUser):this.$emit("notClaim",this.form.applyRemark))})}clearForm(){this.form={confirmUser:null,crawlerDataId:null,group:null,applyRemark:""}}closeModal(){this.$emit("closeModal")}addResponseMessage(t){this.form.applyRemark+=t}};Object(J.a)([Object(tt.a)("setLoading")],Ne.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Ne.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],Ne.prototype,"isClaim",void 0),Object(J.a)([Object(et.b)()],Ne.prototype,"crawlerDataId",void 0),Ne=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t,ResponseMessage:Le}})],Ne);var Ve=Ne,qe=(a("8234"),Object(st.a)(Ve,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"審核退回",visible:t.visible,centered:!0,width:950},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("fragment",[i("div",{staticClass:"d-flex"},[i("a-form-model",{ref:"formRef",staticClass:"mt-4 form--light content__form",attrs:{model:t.form,rules:t.formRules,"hide-required-mark":!0}},[i("a-form-model-item",{attrs:{prop:"message","label-col":{span:24},"wrapper-col":{span:24}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 退回意見： ")]),i("div",{staticClass:"confirm-message"},[i("img",{staticClass:"confirm-message__img",attrs:{src:t.isClaim?a("5430"):a("e536"),alt:""}}),i("a-textarea",{attrs:{"auto-size":{minRows:14}},model:{value:t.form.applyRemark,callback:function(e){t.$set(t.form,"applyRemark",e)},expression:"form.applyRemark"}})],1)])],1),t.isClaim?t._e():i("ResponseMessage",{staticClass:"content__msg ps-2",on:{select:t.addResponseMessage}})],1),i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],1)],2)}),[],!1,null,"249b9218",null).exports);const Be=Object(tt.c)("modalControl");let ze=class extends et.d{constructor(){super(...arguments),this.keyword="",this.auditItemsList=[],this.filterAuditItemsList=[],this.grid={columns:[{title:"查核項目",dataIndex:"auditItem",width:"75%",key:"auditItem.value",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"auditItem"}},{title:"",dataIndex:"auditItem",key:"action",width:"25%",scopedSlots:{customRender:"action"}}]}}onAuditItemsOptionChanged(t){t&&0!==t.length&&(this.auditItemsList=t.map(t=>({name:t.label,editName:t.label,value:t.value,isEdit:!1})),this.filterAuditItemsList=this.auditItemsList)}addNewItem(){this.filterAuditItemsList.unshift({name:"",editName:"",value:"add"+mt.a.v4(),isEdit:!0})}setEdit(t,e){this.filterAuditItemsList.find(e=>e.value===t).isEdit=e}save(t){if(this.auditItemNameValidtor(t.editName)){const e={auditItemName:t.editName,auditItem:t.value.includes("add")?void 0:t.value,year:this.year};this.$emit("save",e)}else this.setModalState({resultModal:{visible:!0,type:"warning",title:"查核項目名稱不得重複"}})}fuzzySearch(){if(this.keyword){const t={includeScore:!0,keys:["name"]},e=new Me.a(this.auditItemsList,t).search(this.keyword);this.filterAuditItemsList=e.map(t=>t.item)}else this.filterAuditItemsList=this.auditItemsList}searchReset(t){t(),this.keyword=""}deleteAuditItem(t){const e=this.filterAuditItemsList.findIndex(e=>e.value===t);this.filterAuditItemsList.splice(e,1)}auditItemNameValidtor(t){return void 0===this.auditItemsList.find(e=>e.name===t)}close(){this.$emit("closeModal")}};Object(J.a)([Object(tt.a)("setLoading")],ze.prototype,"setLoading",void 0),Object(J.a)([Be.Action("setModalState")],ze.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],ze.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],ze.prototype,"auditItemsOption",void 0),Object(J.a)([Object(et.b)()],ze.prototype,"year",void 0),Object(J.a)([Object(et.e)("auditItemsOption",{immediate:!0,deep:!0})],ze.prototype,"onAuditItemsOptionChanged",null),ze=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],ze);var He=ze,Qe=(a("827f"),Object(st.a)(He,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"查核項目設定",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,centered:!1,footer:!1},on:{closeModal:t.close}},[i("template",{slot:"content"},[i("div",{staticClass:"content"},[i("div",{staticClass:"d-flex"},[t._v(" 年度："+t._s(t.year)+" "),i("button",{staticClass:"btn--action ms-auto mb-1",on:{click:t.addNewItem}},[t._v(" 新增 ")])]),i("a-table",{staticClass:"table__wrap",attrs:{"row-key":"value",bordered:"","data-source":t.filterAuditItemsList,columns:t.grid.columns,scroll:{x:!1,y:"500px"},pagination:!1},scopedSlots:t._u([{key:"filterDropdown",fn:function(e){var a=e.clearFilters;return i("div",{staticClass:"search__wrap"},[i("a-input",{staticClass:"input__search",on:{pressEnter:t.fuzzySearch},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),i("div",{staticClass:"d-flex"},[i("button",{staticClass:"btn--dark--small btn__search flex-center",attrs:{type:"primary"},on:{click:t.fuzzySearch}},[t._v(" 查詢 ")]),i("button",{staticClass:"btn--light--small btn__search flex-center",on:{click:function(e){return t.searchReset(a)}}},[t._v(" 取消 ")])])],1)}},{key:"auditItem",fn:function(e,a){return[i("div",{staticClass:"table__tbody__item"},[a.isEdit?i("a-input",{model:{value:a.editName,callback:function(e){t.$set(a,"editName",e)},expression:"record.editName"}}):[t._v(" "+t._s(a.name)+" ")]],2)]}},{key:"action",fn:function(e,a){return[a.isEdit?t._e():i("button",{staticClass:"btn--action",on:{click:function(e){return t.setEdit(a.value,!0)}}},[t._v(" 編輯 ")]),a.isEdit?i("button",{staticClass:"btn--action",attrs:{disabled:!a.editName&&0==a.editName.length},on:{click:function(e){return t.save(a)}}},[t._v(" 儲存 ")]):t._e(),a.isEdit?i("button",{staticClass:"btn--action ms-2",on:{click:function(e){a.value.includes("add")?t.deleteAuditItem(a.value):t.setEdit(a.value,!1)}}},[t._v(" 取消 ")]):t._e()]}}])},[i("a-icon",{staticClass:"icon--filter",attrs:{slot:"filterIcon",type:"search"},slot:"filterIcon"}),i("template",{slot:"icon"},[i("div",{staticClass:"table__tbody-icon"},[i("img",{attrs:{src:a("91f3"),alt:""}})])])],2)],1)])],2)}),[],!1,null,"e9d9f4d8",null).exports);const We=Object(tt.c)("modalControl");let Ke=class extends et.d{constructor(){super(...arguments),this.renderKey=0,this.compareModal={visible:!1,nowData:{},oldData:[]},this.leaderOpinionModal={visible:!1,message:""},this.connectDataModal={visible:!1,data:[]},this.exportModalShow=!1,this.importModal={visiable:!1,yap:null,yapYear:""},this.setAuditItemsModal={visiable:!1,auditItemsOption:null},this.QAModal={visiable:!1,QAStatus:null,yapId:null,yapPointAuditItemId:null,yapStatus:"",QAData:[],reviewLevel:"",rejectFlag:!1},this.inspectedUnitModal={visiable:!1,unitsList:[]},this.reviewCommitModal={yapId:"",type:"approval",visible:!1,title:"審核通過",label:"通過意見",auditItemList:null},this.historyshow=!1,this.currentRole=null,this.currentRoleId=null,this.currentYapId=null,this.currentYapPointAuditItem={yapId:null,yapPointAuditItemMapId:null,yapPointAuditItemId:null,yapPointAuditItem:null},this.isConfirmUser=!1,this.yapReviewFlag=!1,this.infoData={year:"",status:{value:"",label:""}},this.searchForm={year:void 0,month:void 0,auditType:void 0,auditItems:void 0,auditorTeam:void 0},this.formRules={year:[{required:!0,message:"請選擇查詢年份",trigger:"change"}]},this.yearOptions=null,this.itemOption=null,this.itemOptionCom=null,this.typeOption=null,this.unitList=null,this.unitInValidOption=null,this.teamOption=null,this.supervisorList=["ROLE_Audit_Department_Head","ROLE_Audit_Office_Boss_Vice","ROLE_Audit_Office_Boss"],this.isSupervisor=!1,this.searchItem="todo",this.yapOriArr=[],this.yapOriFrontEndArr=[],this.yapFrontEndArr=[],this.filterYapFrontEndArr=[],this.yapSumbitArr=null,this.isYapModify=!1,this.isYapVaild=!1,this.showYapFrontEndArr=[],this.showYapArrCount=3,this.yapPointAuditItemList=[],this.dataId="",this.inspectedUnitList=[]}onSearchItemChanged(){this.setLoading(!0),this.showYapFrontEndArr=[],this.showYapArrCount=3,this.forceNextTick(()=>{this.getFilterYapFrontEndArr(),this.setLoading(!1)})}onYapFrontEndArrChanged(t){this.getFilterYapFrontEndArr()}get searchItemOption(){return this.isSupervisor?[{value:"todo",label:"待確認查核項目"},{value:"toReview",label:"未審畢查核項目"},{value:"all",label:"全查核項目"}]:[{value:"todo",label:"待確認查核項目"},{value:"doing",label:"進行中查核項目"},{value:"all",label:"全查核項目"}]}getFilterYapFrontEndArr(){this.filterYapFrontEndArr=this.yapFrontEndArr.filter(t=>this.isShowYapCom(t))}get isSettingAuditItems(){return!("A"!==this.infoData.status.value&&"B"!==this.infoData.status.value&&"C"!==this.infoData.status.value||!("ROLE_Audit_Team_Head"===this.currentRoleId||"ROLE_Auditor"===this.currentRoleId&&this.isConfirmUser))}get isBeenRejectedAuditItem(){return"C"===this.infoData.status.value&&!!this.filterYapFrontEndArr.find(t=>t.rejectFlag)}async created(){await this.searchOptionInit()}mounted(){this.currentRole=this.$global.getCurrentRole(),this.currentRoleId=this.$global.getCurrentRoleId(),this.isSupervisor=void 0!==this.supervisorList.find(t=>t===this.currentRole.id)}searchOptionInit(){this.setLoading(!0),this.$auditPlanApi.initInAuditPlanUsingGET().then(t=>{var e,a;const i=t.data.result;this.yearOptions=i.auditYearOptions,this.itemOption=i.auditItemOptions,this.itemOptionCom=i.auditItemOptions,this.typeOption=i.auditTypeOptions,this.teamOption=i.auditorTeamOptions,this.searchForm.year=parseInt(this.yearOptions[0].value),this.searchForm.auditorTeam=null===(e=this.currentRole)||void 0===e||null===(a=e.roleUnits[0])||void 0===a?void 0:a.auditorTeamCode,this.yapPointAuditItemList=i.pointAuditItemOptions.map(t=>({key:t.value,headerTitle:t.label,yapPointAuditItems:[]})),this.onHandleSearch(),this.getYapUnit()}).catch(console.error).finally(()=>{this.setLoading(!1)})}onHandleSearch(){this.$refs.formRef.validate(t=>{if(t){this.itemOptionCom=this.itemOption,this.getYapUnit(),this.setLoading(!0);const t={...this.searchForm,auditItems:[]};this.searchForm.auditItems?t.auditItems.push(this.searchForm.auditItems):t.auditItems=void 0,this.$auditPlanApi.searchYapInAuditPlanUsingPOST(t).then(t=>{const e=t.data.result;this.infoData.year=e.year.toString(),this.infoData.status.label=e.status,this.infoData.status.value=this.$enum.getValue("yapStatusEnum",e.status),this.isConfirmUser=e.confirmUser,this.yapReviewFlag=e.reviewFlag,this.yapFrontEndArr=this.convertYapToFrontEndYap(e.values),this.yapFrontEndArr=this.$global.deepCopyData(this.yapFrontEndArr),this.yapOriFrontEndArr=this.$global.deepCopyData(this.yapFrontEndArr),this.isSupervisor&&(this.yapFrontEndArr=this.yapFrontEndArr.map(t=>({...t,isReviewDone:this.checkIsReviewDone(t)}))),this.showYapFrontEndArr=[],this.showYapArrCount=3}).catch(t=>{var e,a,i,s;0==(null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.total)?(this.yapOriArr=[],this.yapFrontEndArr=[],this.yapFrontEndArr=[]):this.setModalState({resultModal:{visible:!0,type:"error",title:null===(i=t.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.message}})}).finally(()=>{this.setLoading(!1)})}})}async getAuditItem(){this.setLoading(!0);const t=this.searchForm.year.toString();return this.$auditPlanApi.searchAuditItemInAuditPlanUsingGET(t,!1).then(t=>{const e=t.data.result;this.itemOption=e}).catch(console.error).finally(()=>{this.setLoading(!1)})}getYapUnit(){this.setLoading(!0);const t=this.searchForm.year.toString();this.$auditPlanApi.searchYapUnitByYearInAuditPlanUsingGET(t).then(t=>{this.unitList=t.data.result}).catch(console.error).finally(()=>{this.setLoading(!1)})}modifyAuditItem(t){this.setLoading(!0),this.$auditPlanApi.modifyAuditItemInAuditPlanUsingPOST(t).then(async e=>{this.setModalState({resultModal:{visible:!0,type:"success",title:(t.auditItem?"編輯":"新增")+"查核項目成功",autoClose:3}}),await this.getAuditItem(),this.itemOptionCom=this.itemOption}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:(t.auditItem?"編輯":"新增")+"查核項目失敗"}})}).finally(()=>{this.setLoading(!1)})}deleteYap(t){this.setLoading(!0),this.$auditPlanApi.removeYapInAuditPlanUsingGET(t,this.currentYapId).then(t=>{this.yapFrontEndArr.splice(this.yapFrontEndArr.findIndex(t=>t.yapId===this.currentYapId),1),this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除失敗"}})}).finally(()=>{this.setLoading(!1)})}reviewYaps({yapId:t}){this.setLoading(!0);const e={year:parseInt(this.infoData.year),yapIds:[]},a=this.filterYapFrontEndArr.findIndex(e=>e.yapId===t),i=this.filterYapFrontEndArr.filter((t,i)=>{if("toReview"===t.isReviewDone&&i<=a)return e.yapIds.push(t.yapId),!0});this.$auditPlanApi.approveYapByBossInAuditPlanUsingPOST(e).then(t=>{let e="審畢成功";i.forEach(t=>{t.isReviewDone="done"}),this.renderKey++,"已全部審閱完畢"===t.data.message&&(this.onHandleSearch(),e="已全部審閱完畢"),this.setModalState({resultModal:{visible:!0,type:"success",title:e,autoClose:3}})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"審畢失敗"}})}).finally(()=>{this.setLoading(!1)})}async saveYap(){this.setLoading(!0),await this.forceNextTick(async()=>{await this.vaildateAllyapComp(!0)?this.filterYapFrontEndArr&&this.filterYapFrontEndArr.length>0?(this.checkHasModify(this.filterYapFrontEndArr),this.convertFrontEndYapToYap(this.filterYapFrontEndArr),this.$auditPlanApi.modifyYapInAuditPlanUsingPOST(this.yapSumbitArr).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"暫存成功",autoClose:3}}),this.onHandleSearch()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"暫存失敗"}})}).finally(()=>{this.setLoading(!1)})):(this.setLoading(!1),this.setModalState({resultModal:{visible:!0,type:"warning",title:"無可暫存的資料"}})):this.setLoading(!1)})}handleExport(t){this.setLoading(!0),this.searchForm.includeAuditTeam=t;const e=`${this.searchForm.year}年度富邦人壽稽核計畫一覽表${t?"(有組別)":"(無組別)"}.docx`,a={...this.searchForm,auditItems:void 0};this.$auditPlanApi.exportWordOfYapReportInAuditPlanUsingPOST(a,{responseType:"blob"}).then(t=>{this.$blobUtils.download(t.data,e),this.setModalState({resultModal:{visible:!0,type:"success",title:"下載成功",autoClose:3}})}).catch(async t=>{this.setModalState({resultModal:{title:"匯出失敗",visible:!0,type:"error"}})}).finally(()=>{this.setLoading(!1)}),this.exportModalShow=!1}closeYapByTeamHead(){this.setLoading(!0),this.$auditPlanApi.closeYapByTeamHeadInAuditPlanUsingGET(String(this.infoData.year)).then(t=>{this.$router.push({name:"AuditPlanResult"})}).catch(t=>{this.setModalState({resultModal:{visible:!0,title:"結案失敗",content:t.response.data.message,type:"error"}})}).finally(()=>{this.setLoading(!1)})}rejectByAdminHead(t){this.setLoading(!0);const e={auditItems:t.auditItems,remark:t.applyRemark,year:Number(this.infoData.year)};this.$auditPlanApi.rejectYapByTeamHeadInAuditPlanUsingPOST(e).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"審核退回成功",autoClose:3}}),this.onHandleSearch()}).catch(t=>{this.setModalState({resultModal:{visible:!0,content:t.response.data.message,title:"審核退回失敗",type:"error"}})}).finally(()=>{this.setLoading(!1)})}getSupervisorReturnAuditItem(){this.setLoading(!0);const t=this,e={year:parseInt(this.infoData.year)};this.$auditPlanApi.searchYapInAuditPlanUsingPOST(e).then(e=>{const a=e.data.result,i=[];this.convertYapToFrontEndYap(a.values).forEach(t=>{t.isReviewDone=this.checkIsReviewDone(t),"toReview"===t.isReviewDone&&void 0===i.find(e=>e.value===t.auditItem)&&i.push({label:t.auditItem,value:t.auditItem})}),t.reviewCommitModal.auditItemList=i.map(e=>t.itemOptionCom.find(t=>e.value===t.value))}).catch(t=>{var e,a;this.setModalState({resultModal:{visible:!0,type:"error",title:null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,autoClose:3}})}).finally(()=>{this.setLoading(!1)})}projectScopeContentModify({request:t}){this.setLoading(!0),this.$auditPlanApi.modifyYapProjectScopeContentInAuditPlanUsingPOST(t).then(async e=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"確認修改專案查核範圍成功",autoClose:3}});const a=this.findYap(this.yapFrontEndArr,t.yapId),i=await this.findYapFromDatabase(a);i.isReviewDone=this.checkIsReviewDone(i),this.updateYapArr({yapArr:this.yapFrontEndArr,yapId:a.yapId,updatedValue:i})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"確認修改專案查核範圍失敗"}})}).finally(()=>{this.setLoading(!1)})}getRejectReason({yapPointAuditItemId:t}){this.setLoading(!0),this.$auditPlanApi.searchRejectOfYapPointAuditItemInAuditPlanUsingGET(t).then(t=>{this.leaderOpinionModal.message=t.data.result.remark,this.leaderOpinionModal.visible=!0}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}getYapProjectScopeLog({yapId:t,isEdit:e}){this.setLoading(!0),this.compareModal.nowData={},this.compareModal.oldData=[],this.$auditPlanApi.searchYapProjectScopeLogInAuditPlanUsingGET(t).then(t=>{this.compareModal.oldData=t.data.result.map(t=>({dateTime:t.updateDatetime,title:t.updateRole,staffname:t.updateUser,text:t.yapProjectScopeContent||""}))}).catch(t=>{var e,a;0===(null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.total)?this.compareModal.visible=!0:this.setModalState({resultModal:{visible:!0,type:"error",title:t.response.data.message}})}).finally(()=>{if(e){const e=this.yapFrontEndArr.find(e=>e.yapId===t);e.yapProjectScopeContent&&(this.compareModal.nowData={dateTime:"當前編輯項目",title:JSON.parse(sessionStorage.currentRoleData).name||"",staffname:this.$user.getMe().employee.name,text:e.yapProjectScopeContent})}(this.compareModal.oldData.length>0||Object.keys(this.compareModal.nowData).length>0)&&(this.compareModal.visible=!0),this.setLoading(!1)})}getYapProjectScopeQA({yapId:t,QAStatus:e,yapStatus:a,reviewLevel:i,rejectFlag:s}){this.QAModal.QAData=[],this.QAModal.yapId=t,this.QAModal.yapPointAuditItemId=null,this.QAModal.QAStatus=e,this.QAModal.yapStatus=a,this.QAModal.reviewLevel=i,this.QAModal.rejectFlag=s,this.$auditPlanApi.searchQAOfYapProjectScopeInAuditPlanUsingGET(t).then(t=>{this.QAModal.QAData=t.data.result}).catch(t=>{}).finally(()=>{this.QAModal.visiable=!0,this.setLoading(!1)})}changeQAStatusToNull({yapId:t,id:e,type:a}){return this.setLoading(!0),this.$auditPlanApi.modifyYapQaStatusInAuditPlanUsingGET(e,a).then(e=>{this.changeYapProjectScopeQAStatus(t)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}async changeYapProjectScopeQAStatus(t){const e=this.findYap(this.yapFrontEndArr,t),a=await this.findYapFromDatabase(e);this.QAModal.QAStatus=a.yapProjectScopeQaStatus,a.isReviewDone=this.checkIsReviewDone(a),this.updateYapArr({yapArr:this.yapFrontEndArr,yapId:e.yapId,updatedValue:a})}deletePointAuditItem({yapPointAuditItemId:t,yapId:e}){this.setLoading(!0),this.$auditPlanApi.removeYapPointAuditItemInAuditPlanUsingGET(t).then(async t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除重點查核項目成功",autoClose:3}});const a=this.findYap(this.yapFrontEndArr,e),i=await this.findYapFromDatabase(a);this.updateYapArr({yapArr:this.yapFrontEndArr,yapId:a.yapId,updatedValue:i})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除重點查核項目失敗"}})}).finally(()=>{this.setLoading(!1)})}getYapPointAuditItemLog({isEdit:t}){this.setLoading(!0),this.compareModal.nowData={},this.compareModal.oldData=[],this.$auditPlanApi.searchYapPointAuditItemLogInAuditPlanUsingGET(this.currentYapPointAuditItem.yapPointAuditItemId).then(t=>{this.compareModal.oldData=t.data.result.map(t=>({dateTime:t.applyDatetime,title:t.applyRole,staffname:t.applyUser,text:t.itemContent||""}))}).catch(t=>{var e,a;0===(null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.total)?this.compareModal.visible=!0:this.setModalState({resultModal:{visible:!0,type:"error",title:t.response.data.message}})}).finally(()=>{t&&this.currentYapPointAuditItem.yapPointAuditItem.itemContent&&(this.compareModal.nowData={dateTime:"當前編輯項目",title:JSON.parse(sessionStorage.currentRoleData).name||"",staffname:this.$user.getMe().employee.name,text:this.currentYapPointAuditItem.yapPointAuditItem.itemContent||""}),this.compareModal.oldData.length>0&&(this.compareModal.visible=!0),this.setLoading(!1)})}getDataCollectDetail({yapPointAuditItemId:t,copyYapPointAuditItemId:e}){this.setLoading(!0),this.connectDataModal.data=[];const a=t.includes("copy")?e:t;this.$auditPlanApi.searchDataCollectDetailInAuditPlanUsingGET(a).then(t=>{this.connectDataModal.data=t.data.result,this.connectDataModal.visible=!0}).catch(t=>{var e,a,i,s;0===(null==t||null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.total)?this.connectDataModal.visible=!0:this.setModalState({resultModal:{visible:!0,type:"error",title:null==t||null===(i=t.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.message}})}).finally(()=>{this.setLoading(!1)})}getYapItemScopeQA({yapId:t,yapPointAuditItemId:e,QAStatus:a,yapStatus:i,reviewLevel:s,rejectFlag:o}){this.QAModal.QAData=[],this.QAModal.yapId=t,this.QAModal.yapPointAuditItemId=e,this.QAModal.QAStatus=a,this.QAModal.yapStatus=i,this.QAModal.reviewLevel=s,this.QAModal.rejectFlag=o,this.$auditPlanApi.searchQAOfYapPointAuditItemInAuditPlanUsingGET(e).then(t=>{this.QAModal.QAData=t.data.result}).catch(t=>{}).finally(()=>{this.QAModal.visiable=!0,this.setLoading(!1)})}confirmPointAuditItem({agree:t,remark:e,yapId:a}){this.setLoading(!0);const i={agree:t,remark:e,yapPointAuditItemId:this.currentYapPointAuditItem.yapPointAuditItemId,itemContent:this.currentYapPointAuditItem.yapPointAuditItem.itemContent};this.$auditPlanApi.modifyYapPointAuditItemInAuditPlanUsingPOST(i).then(async t=>{const e=this.findYap(this.yapFrontEndArr,a),i=await this.findYapFromDatabase(e);i.isReviewDone=this.checkIsReviewDone(i),this.updateYapArr({yapArr:this.yapFrontEndArr,yapId:e.yapId,updatedValue:i}),this.setModalState({resultModal:{visible:!0,type:"success",title:"組長覆核重點查核項目成功",autoClose:3}})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"組長覆核重點查核項目失敗"}})}).finally(()=>{this.setLoading(!1)})}yapPointAuditItemModify({request:t,yapId:e}){this.setLoading(!0),this.$auditPlanApi.modifyContentOfYapPointAuditItemInAuditPlanUsingPOST(t).then(async t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"確認修改重點查核項目成功",autoClose:3}});const a=this.findYap(this.yapFrontEndArr,e),i=await this.findYapFromDatabase(a);i.isReviewDone=this.checkIsReviewDone(i),this.updateYapArr({yapArr:this.yapFrontEndArr,yapId:a.yapId,updatedValue:i})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"確認修改重點查核項目失敗"}})}).finally(()=>{this.setLoading(!1)})}async changeYapItemScopeQAStatus(t){const e=this.findYap(this.yapFrontEndArr,t),a=await this.findYapFromDatabase(e);this.QAModal.QAStatus=a.yapProjectScopeQaStatus,a.isReviewDone=this.checkIsReviewDone(a),this.updateYapArr({yapArr:this.yapFrontEndArr,yapId:e.yapId,updatedValue:a})}async auditorApplyYaps(){this.setLoading(!0),await this.forceNextTick(async()=>{await this.vaildateAllyapComp()?(this.checkHasModify(this.filterYapFrontEndArr),this.convertFrontEndYapToYap(this.filterYapFrontEndArr),this.$auditPlanApi.applyYapByAuditorInAuditPlanUsingPOST(this.yapSumbitArr).then(t=>{this.onHandleSearch(),this.setModalState({resultModal:{visible:!0,type:"success",title:"送出覆核成功",autoClose:3}})}).catch(t=>{const e=t.response.data.message;this.setModalState({resultModal:{visible:!0,type:"error",title:"送出覆核失敗",content:e}})}).finally(()=>{this.setLoading(!1)})):this.setLoading(!1)})}async teamHeadApplyYaps(){this.setLoading(!0),this.forceNextTick(async()=>{await this.vaildateAllyapComp()?(this.checkHasModify(this.filterYapFrontEndArr),this.convertFrontEndYapToYap(this.filterYapFrontEndArr),this.$auditPlanApi.applyYapByTeamHeadInAuditPlanUsingPOST(this.yapSumbitArr).then(t=>{this.onHandleSearch(),this.setModalState({resultModal:{visible:!0,type:"success",title:"送出覆核成功",autoClose:3}})}).catch(t=>{const e=t.response.data.message;this.setModalState({resultModal:{visible:!0,type:"error",title:"送出覆核失敗",content:e}})}).finally(()=>{this.setLoading(!1)}),this.setLoading(!1)):this.setLoading(!1)})}actionBarEmitEvent({type:t,payload:e}){switch(t){case"setAuditItems":this.setAuditItemsModal.visiable=!0;break;case"export":this.exportModalShow=!0;break;case"submitReview":this.filterYapFrontEndArr&&0!==this.filterYapFrontEndArr.length?("ROLE_Audit_Team_Head"===this.currentRoleId&&this.teamHeadApplyYaps(),"ROLE_Auditor"===this.currentRoleId&&this.auditorApplyYaps()):this.setModalState({resultModal:{visible:!0,type:"warning",title:"無可送出的資料"}});break;case"save":this.saveYap();break;case"return":this.reviewCommitModal={yapId:null,visible:!0,type:this.isSupervisor?"supervisorReturn":"adminReturn",title:"審核退回",label:"退回意見",auditItemList:null};break;case"caseClose":this.closeYapByTeamHead();break;case"history":this.historyshow=!0}}slideClickEvent({type:t,payload:e}){switch(t){case"inspectedUnit":this.showInspectedUnit(e.validUnits,e.inValidUnits);break;case"import":this.importModal={yap:e.yap,yapYear:this.infoData.year,visiable:!0};break;case"delete":this.currentYapId=e.yapId,e.yapId.includes("copy")?this.deleteYapOnFrontEnd(e.yapId):this.reviewCommitModal={yapId:null,type:"leaderDelete",visible:!0,title:"刪除查核項目",label:"刪除意見",auditItemList:null};break;case"copy":this.addCopyYap({yapId:e.yapId,copyContent:e.copyContent});break;case"review":this.reviewYaps({yapId:e.yapId})}}async emitEvent({type:t,payload:e}){switch(t){case"project-comparison":this.getYapProjectScopeLog(e);break;case"project-questionItem":e.isSupervisorReaded&&await this.changeQAStatusToNull({yapId:e.yapId,id:e.yapId,type:"yap"}),this.getYapProjectScopeQA(e);break;case"comparison":this.currentYapPointAuditItem={yapId:e.yapId,yapPointAuditItemMapId:e.yapPointAuditItemMapId,yapPointAuditItemId:e.yapPointAuditItemId,yapPointAuditItem:this.findYapPointAuditItem({frontEndYapArr:this.filterYapFrontEndArr,yapId:e.yapId,yapPointAuditItemMapId:e.yapPointAuditItemMapId,yapPointAuditItemId:e.yapPointAuditItemId})},this.getYapPointAuditItemLog({isEdit:e.isEdit});break;case"linkItem":this.getDataCollectDetail(e);break;case"project-confirmItem":this.projectScopeContentModify(e);break;case"questionItem":this.currentYapPointAuditItem={yapId:e.yapId,yapPointAuditItemMapId:e.yapPointAuditItemMapId,yapPointAuditItemId:e.yapPointAuditItemId,yapPointAuditItem:this.findYapPointAuditItem({frontEndYapArr:this.filterYapFrontEndArr,yapId:e.yapId,yapPointAuditItemMapId:e.yapPointAuditItemMapId,yapPointAuditItemId:e.yapPointAuditItemId})},e.isSupervisorReaded&&await this.changeQAStatusToNull({yapId:e.yapId,id:e.yapPointAuditItemId,type:"yapPointAuditItem"}),this.getYapItemScopeQA(e);break;case"confirmItem":this.yapPointAuditItemModify(e);break;case"reviewItem":this.currentYapPointAuditItem={yapId:e.yapId,yapPointAuditItemMapId:e.yapPointAuditItemMapId,yapPointAuditItemId:e.yapPointAuditItemId,yapPointAuditItem:this.findYapPointAuditItem({frontEndYapArr:this.filterYapFrontEndArr,yapId:e.yapId,yapPointAuditItemMapId:e.yapPointAuditItemMapId,yapPointAuditItemId:e.yapPointAuditItemId})},this.reviewCommitModal={yapId:e.yapId,type:e.type,visible:!0,title:e.title,label:e.label,auditItemList:null};break;case"LeaderOpinion":this.getRejectReason(e);break;case"deletePointAuditItem":this.deletePointAuditItem({yapPointAuditItemId:e.yapPointAuditItemId,yapId:e.yapId})}}reviewModalClickEvent({type:t,payload:e}){switch(t){case"return":this.rejectByAdminHead(e);break;case"leaderDelete":this.deleteYap(e);break;case"leaderApproval":this.confirmPointAuditItem({agree:!0,remark:e.remark,yapId:e.yapId});break;case"leaderReturn":this.confirmPointAuditItem({agree:!1,yapId:e.yapId,remark:e.remark})}}convertYapToFrontEndYap(t){return t.map(t=>{const e=this.$global.deepCopyData(this.yapPointAuditItemList).map(e=>({...e,yapPointAuditItems:t.yapPointAuditItemMap[e.key]||[]}));return e.forEach(t=>{t.yapPointAuditItems.forEach(t=>{t.originalItemContent=t.itemContent})}),{...t,yapPointAuditItemMap:e,isReviewDone:"N",originalYapProjectScopeContent:t.yapProjectScopeContent,isShow:!1}})}convertFrontEndYapToYap(t){this.yapSumbitArr={year:parseInt(this.infoData.year),values:null},this.yapSumbitArr.values=t.map(t=>{delete t.isReviewDone,delete t.isShow,delete t.originalYapProjectScopeContent,t.yapPointAuditItemMap.forEach(t=>{t.yapPointAuditItems.forEach(t=>{delete t.originalItemContent})});const e=t.yapPointAuditItemMap.reduce((t,e)=>e.yapPointAuditItems.length>=1?{...t,[e.key]:e.yapPointAuditItems}:t,{});return{...t,yapPointAuditItemMap:e}})}checkHasModify(t){this.isYapModify=!1,t.forEach(t=>{var e;let a=null;if(t.modify&&(this.isYapModify=!0),!t.modify){if(a=this.yapOriFrontEndArr.find(e=>e.yapId===t.yapId),null==a)return;const e={...a};delete e.yapPointAuditItemMap,delete e.isShow;const i={...t};delete i.yapPointAuditItemMap,delete i.isShow,t.modify=JSON.stringify(e)!==JSON.stringify(i),!0===t.modify&&(this.isYapModify=!0)}null===(e=t.yapPointAuditItemMap)||void 0===e||e.forEach((t,e)=>{0!==t.yapPointAuditItems.length&&t.yapPointAuditItems.forEach(t=>{var i;if(t.modify)return void(this.isYapModify=!0);const s=null===(i=a)||void 0===i?void 0:i.yapPointAuditItemMap[e].yapPointAuditItems.find(e=>e.yapPointAuditItemId===t.yapPointAuditItemId);null!=s&&(t.modify=t.itemContent!==s.itemContent,!0===t.modify&&(this.isYapModify=!0))})})})}shallowEqual(t,e){const a=Object.keys(t),i=Object.keys(e);for(const t of a)if(!i.includes(t))return!1;for(const t of i)if(!a.includes(t))return!1;for(const i of a)if(t[i]!==e[i])return!1;return!0}isShowYapCom(t){var e;const a=null===(e=this.currentRole.roleUnits[0])||void 0===e?void 0:e.auditorTeamCode,i=a===t.originalMainAuditorTeam,s=void 0!==t.coAuditorTeam.find(t=>t===a),o=t.yapPointAuditItemMap.map(t=>[...t.yapPointAuditItems]).reduce((t,e)=>t.concat(e));switch(this.currentRole.id){case"ROLE_Auditor":if("all"===this.searchItem)return!0;if("toReview"===this.searchItem)return!1;if("todo"===this.searchItem&&("A"===t.yapStatus||"B"===t.yapStatus)&&(i||s)&&void 0!==o.find(t=>t.checkAuditor===this.$user.getMe().employee.domainId))return!0;if("doing"===this.searchItem){if("B"===t.yapStatus)return!0;if("C"===t.yapStatus&&t.rejectFlag)return!0}return!1;case"ROLE_Audit_Team_Head":if("all"===this.searchItem)return!0;if("toReview"===this.searchItem)return!1;if("todo"===this.searchItem&&(i||s)&&("Q"===t.yapProjectScopeQaStatus||"LEADER"===t.yapProjectScopeCheckStatus||o.find(t=>"LEADER"===t.itemCheckStatus)||o.find(t=>"Q"===t.itemQAStatus)||o.find(t=>!0===t.hasReviewFlag)))return!0;if("doing"===this.searchItem){if("B"===t.yapStatus)return!0;if("C"===t.yapStatus&&t.rejectFlag)return!0}return!1;case"ROLE_Audit_Department_Head":if("all"===this.searchItem)return!0;if("toReview"===this.searchItem&&"C"===t.yapStatus&&"1"===t.reviewLevel&&"done"!==t.isReviewDone)return!0;if("todo"===this.searchItem){if(t.rejectFlag)return!1;if("1"===t.reviewLevel&&"C"===t.yapStatus&&("MASTER"===t.yapProjectScopeCheckStatus||"A"===t.yapProjectScopeQaStatus||o.find(t=>"MASTER"===t.itemCheckStatus)||o.find(t=>"A"===t.itemQAStatus)||"toReview"===t.isReviewDone))return!0}return!1;case"ROLE_Audit_Office_Boss_Vice":if("all"===this.searchItem)return!0;if("toReview"===this.searchItem&&"C"===t.yapStatus&&"2"===t.reviewLevel&&"done"!==t.isReviewDone)return!0;if("todo"===this.searchItem){if(t.rejectFlag)return!1;if("2"===t.reviewLevel&&"C"===t.yapStatus&&("MASTER"===t.yapProjectScopeCheckStatus||"A"===t.yapProjectScopeQaStatus||o.find(t=>"MASTER"===t.itemCheckStatus)||o.find(t=>"A"===t.itemQAStatus)||"toReview"===t.isReviewDone))return!0}return!1;case"ROLE_Audit_Office_Boss":if("all"===this.searchItem)return!0;if("toReview"===this.searchItem&&"C"===t.yapStatus&&"3"===t.reviewLevel&&"done"!==t.isReviewDone)return!0;if("todo"===this.searchItem){if(t.rejectFlag)return!1;if("3"===t.reviewLevel&&"C"===t.yapStatus&&("MASTER"===t.yapProjectScopeCheckStatus||"A"===t.yapProjectScopeQaStatus||o.find(t=>"MASTER"===t.itemCheckStatus)||o.find(t=>"A"===t.itemQAStatus)||"toReview"===t.isReviewDone))return!0}return!1}}async vaildateAllyapComp(t){this.setLoading(!0);const e=[],a=this.$refs.yapComp;let i=!0;return a&&a.length>0?(this.$refs.yapComp.forEach(a=>{t?e.push(a.validate(t)):e.push(a.validate())}),await Promise.all(e).then(t=>{if(i=void 0===t.find(t=>!1===t),i)this.setLoading(!1);else{const t=this.$el.querySelector(".has-error");t&&t.scrollIntoView({block:"center",inline:"nearest"}),this.setLoading(!1)}}).catch(()=>{i=!1,this.setLoading(!1)})):(this.setLoading(!1),i=!0),i}showInspectedUnit(t,e){const a=t?t.map(t=>({...t,isValid:!0})):[],i=e?e.map(t=>({...t,isValid:!1})):[];this.inspectedUnitModal.unitsList=a.concat(i),this.inspectedUnitModal.visiable=!0}addCopyYap({yapId:t,copyContent:e}){const a=this.yapFrontEndArr.findIndex(e=>e.yapId===t)+1,i={...e,yapId:"copy"+mt.a.v4(),modify:!0,startMonth:"0",endMonth:"0"};i.yapPointAuditItemMap.map(t=>{t.yapPointAuditItems.map(t=>{t.copyYapPointAuditItemId=t.yapPointAuditItemId,t.yapPointAuditItemId="copy"+mt.a.v4(),t.modify=!0})}),this.yapFrontEndArr.splice(a,0,i)}deleteYapOnFrontEnd(t){const e=this.yapFrontEndArr.findIndex(e=>e.yapId===t);this.yapFrontEndArr.splice(e,1),this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}})}importYapPointAuditItem({yapId:t,importItems:e}){const a=this.yapFrontEndArr.findIndex(e=>e.yapId===t);this.yapFrontEndArr[a].yapPointAuditItemMap.forEach((t,a)=>{const i=e[a].checked.map(t=>({...t,copyYapPointAuditItemId:t.yapPointAuditItemId,yapPointAuditItemId:"copy"+mt.a.v4(),itemQAStatus:"N",modify:!0}));t.yapPointAuditItems=[...t.yapPointAuditItems,...i]})}checkIsReviewDone(t){const e=t.yapPointAuditItemMap.reduce((t,e)=>t.concat(e.yapPointAuditItems),[]);return"ROLE_Audit_Department_Head"===this.currentRoleId?"1"===t.reviewLevel&&"C"==this.infoData.status.value?this.yapReviewFlag?t.rejectFlag||null!==t.yapProjectScopeCheckStatus&&"FINISH"!==t.yapProjectScopeCheckStatus||null!==t.yapProjectScopeQaStatus&&"N"!==t.yapProjectScopeQaStatus||e.find(t=>null!==t.itemCheckStatus&&"FINISH"!==t.itemCheckStatus&&"N"!==t.itemCheckStatus)||e.find(t=>null!==t.itemQAStatus&&"N"!==t.itemQAStatus)?"N":"toReview":"N":"2"===t.reviewLevel||"3"===t.reviewLevel?"done":"N":"ROLE_Audit_Office_Boss_Vice"===this.currentRoleId?"2"===t.reviewLevel&&"C"==this.infoData.status.value?this.yapReviewFlag?t.rejectFlag||null!==t.yapProjectScopeCheckStatus&&"FINISH"!==t.yapProjectScopeCheckStatus||null!==t.yapProjectScopeQaStatus&&"N"!==t.yapProjectScopeQaStatus||e.find(t=>null!==t.itemCheckStatus&&"FINISH"!==t.itemCheckStatus&&"N"!==t.itemCheckStatus)||e.find(t=>null!==t.itemQAStatus&&"N"!==t.itemQAStatus)?"N":"toReview":"N":"3"===t.reviewLevel?"done":"N":"ROLE_Audit_Office_Boss"===this.currentRoleId?"3"===t.reviewLevel&&"C"==this.infoData.status.value?this.yapReviewFlag?t.rejectFlag||null!==t.yapProjectScopeCheckStatus&&"FINISH"!==t.yapProjectScopeCheckStatus||null!==t.yapProjectScopeQaStatus&&"N"!==t.yapProjectScopeQaStatus||e.find(t=>null!==t.itemCheckStatus&&"FINISH"!==t.itemCheckStatus&&"N"!==t.itemCheckStatus)||e.find(t=>null!==t.itemQAStatus&&"N"!==t.itemQAStatus)?"N":"toReview":"N":"ROLE_Audit_Office_Boss"===this.currentRole&&"D"===t.yapStatus?"done":"N":"N"}findYap(t,e){return this.yapFrontEndArr.find(t=>t.yapId===e)}findYapPointAuditItem({frontEndYapArr:t,yapId:e,yapPointAuditItemMapId:a,yapPointAuditItemId:i}){var s;return null===(s=t.find(t=>t.yapId===e).yapPointAuditItemMap.find(t=>t.key===a))||void 0===s?void 0:s.yapPointAuditItems.find(t=>t.yapPointAuditItemId===i)}deleteYapPointAuditItem({yapId:t,yapPointAuditItemMapId:e,yapPointAuditItemId:a}){const i=this.yapFrontEndArr.find(e=>e.yapId===t).yapPointAuditItemMap.find(t=>t.key===e),s=i.yapPointAuditItems.findIndex(t=>t.yapPointAuditItemId===a);i.yapPointAuditItems.splice(s,1)}async findYapFromDatabase(t){let e=null;const a={year:parseInt(this.infoData.year),month:t.startMonth,auditType:t.auditType,auditItems:[t.auditItem],auditorTeam:t.mainAuditorTeam};return await this.$auditPlanApi.searchYapInAuditPlanUsingPOST(a).then(a=>{const i=a.data.result.values.find(e=>e.yapId===t.yapId);e=this.convertYapToFrontEndYap([i])}).catch(t=>{}).finally(()=>{this.setLoading(!1)}),e[0]}updateYapArr({yapArr:t,yapId:e,updatedValue:a}){const i=t.findIndex(t=>t.yapId===e);et.d.set(t,i,a)}checkYapNeedsYapPointAuditItem(t){let e=null;for(let a=0;a<t.length;a++)if(0===t[a].yapPointAuditItemMap.reduce((t,e)=>t+e.yapPointAuditItems.length,0)){e=t[a].yapId;break}return e}renderToYap(t,e){const a=t.findIndex(t=>t.yapId===e);this.showYapArrCount<a&&(this.showYapArrCount=a+2)}scrollToYap(t){const e=document.getElementById(t);e&&e.scrollIntoView({block:"center",inline:"nearest",behavior:"smooth"})}doubleRequestAnimationFrame(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}forceNextTick(t){if(!t||"function"!=typeof t)return new Promise(t=>{this.doubleRequestAnimationFrame(t)});this.doubleRequestAnimationFrame(t)}watchRouterParamsType(t){this.searchItem="todo"===t?"todo":"all"}watchForm(t){}watchfilterYapFrontEndArr(t){this.handleShowYapArr()}handleScrolledToBottom(t){t&&0!=this.filterYapFrontEndArr.length&&this.filterYapFrontEndArr.length>this.showYapArrCount&&(this.showYapArrCount+=3,this.handleShowYapArr())}async handleShowYapArr(){this.filterYapFrontEndArr.forEach((t,e)=>{e<=this.showYapArrCount-1?t.isShow=!0:t.isShow=!1}),this.showYapFrontEndArr=await this.filterYapFrontEndArr.filter(t=>1==t.isShow)}};Object(J.a)([Object(tt.a)("setLoading")],Ke.prototype,"setLoading",void 0),Object(J.a)([We.Action("setModalState")],Ke.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("searchItem")],Ke.prototype,"onSearchItemChanged",null),Object(J.a)([Object(et.e)("yapFrontEndArr",{immediate:!0,deep:!0})],Ke.prototype,"onYapFrontEndArrChanged",null),Object(J.a)([Object(et.e)("$route.params.type",{immediate:!0})],Ke.prototype,"watchRouterParamsType",null),Object(J.a)([Object(et.e)("form",{deep:!0})],Ke.prototype,"watchForm",null),Object(J.a)([Object(et.e)("filterYapFrontEndArr",{deep:!0})],Ke.prototype,"watchfilterYapFrontEndArr",null),Ke=Object(J.a)([Object(et.a)({components:{AccordionArea:_e,FblDataGrid:gt,CompareDataModal:It,ExportModal:wt,ImportDataModal:ge,TemporaryStoreButton:ne,LeaderOpinionModal:xt,ConnectDataModal:ie,QAModal:we,InspectedUnitModal:Ht,ReviewCommitModal:$e,ActionBar:pe,YapComp:Ae,HistoryModal:Ye,AdminReturnModal:qe,SetAuditItemsModal:Qe}})],Ke);var Je=Ke,Ze=(a("83e4"),Object(st.a)(Je,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container auditPlanIndexPage"},[i("AccordionArea",[i("div",{staticClass:"search-form mt-2 w-100"},[i("a-form-model",{ref:"formRef",staticClass:"d-flex align-items-start flex-wrap w-100",attrs:{model:t.searchForm,rules:t.formRules,"hide-required-mark":!0}},[i("div",{staticClass:"d-flex col w-100"},[i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 年度 ")]),i("a-form-model-item",{attrs:{prop:"year"}},[i("a-select",{staticClass:"search-form__input--select",attrs:{"filter-option":t.$global.filterOption,options:t.yearOptions,"dropdown-match-select-width":!1,"show-search":"",placeholder:"請選擇年度"},on:{change:t.getAuditItem},model:{value:t.searchForm.year,callback:function(e){t.$set(t.searchForm,"year",e)},expression:"searchForm.year"}})],1)],1),i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 月份 ")]),i("a-form-model-item",[i("a-select",{staticClass:"search-form__input--select",attrs:{"filter-option":t.$global.filterOption,"allow-clear":!0,options:t.$enum.monthOption,"dropdown-match-select-width":!1,"show-search":"",placeholder:"請選擇月份"},model:{value:t.searchForm.month,callback:function(e){t.$set(t.searchForm,"month",e)},expression:"searchForm.month"}})],1)],1),i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 查核性質 ")]),i("a-form-model-item",[i("a-select",{staticClass:"search-form__input--select",attrs:{"filter-option":t.$global.filterOption,"allow-clear":!0,options:t.typeOption,"dropdown-match-select-width":!1,placeholder:"請選擇查核性質","show-search":""},model:{value:t.searchForm.auditType,callback:function(e){t.$set(t.searchForm,"auditType",e)},expression:"searchForm.auditType"}})],1)],1),i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 查核項目 ")]),i("a-form-model-item",[i("a-select",{staticClass:"search-form__input--select",attrs:{placeholder:"請選擇查核項目","show-search":"","allow-clear":!0,"filter-option":t.$global.filterOption,options:t.itemOption,"dropdown-match-select-width":!1},model:{value:t.searchForm.auditItems,callback:function(e){t.$set(t.searchForm,"auditItems",e)},expression:"searchForm.auditItems"}})],1)],1),i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 組別 ")]),i("a-form-model-item",[i("a-select",{staticClass:"search-form__input--select",attrs:{"show-search":"",placeholder:"請選擇查核組別","filter-option":t.$global.filterOption,"allow-clear":!0,options:t.teamOption,"dropdown-match-select-width":!1},model:{value:t.searchForm.auditorTeam,callback:function(e){t.$set(t.searchForm,"auditorTeam",e)},expression:"searchForm.auditorTeam"}})],1)],1)]),i("button",{staticClass:"btn--search align-self-start",on:{click:t.onHandleSearch}},[t._v(" 查詢 ")])])],1)]),t.yapFrontEndArr.length>0?i("div",{staticClass:"controlBar d-flex flex-wrap-reverse"},[i("div",{staticClass:"search__result__info d-inline-flex align-items-center"},[i("div",{staticClass:"result__info__year"},[t._v(" "+t._s(t.infoData.year)+"年 ")]),i("div",{staticClass:"result__info__state d-flex align-items-center"},[i("img",{staticClass:"result__info__state__img",attrs:{src:a("851d")}}),i("span",{staticClass:"result__info__state__txt"},[t._v("狀態："+t._s(t.infoData.status.label))])])]),i("div",{staticClass:"btnGroup ms-auto"},[i("a-select",{staticClass:"search__result__select my-1",attrs:{placeholder:"請選擇查核項目",options:t.searchItemOption},model:{value:t.searchItem,callback:function(e){t.searchItem=e},expression:"searchItem"}},t._l(t.searchItemOption,(function(e){return i("a-select-option",{key:e.value},[t._v(" "+t._s(e.label)+" ")])})),1),i("ActionBar",{attrs:{role:t.currentRole,"yap-status":t.infoData.status.value,"is-confirm-user":t.isConfirmUser,"is-supervisor":t.isSupervisor,"is-setting-audit-items":t.isSettingAuditItems,"is-been-rejected-audit-item":t.isBeenRejectedAuditItem,"review-flag":t.yapReviewFlag},on:{click:t.actionBarEmitEvent}})],1)]):t._e(),t.filterYapFrontEndArr&&t.filterYapFrontEndArr.length>0?t._l(t.showYapFrontEndArr,(function(e,a){return i("YapComp",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:a===t.showYapFrontEndArr.length-1&&t.handleScrolledToBottom,expression:"index === showYapFrontEndArr.length - 1 ? handleScrolledToBottom : false"}],key:e.yapId,ref:"yapComp",refInFor:!0,attrs:{id:e.yapId,role:t.currentRole,"yap-id":e.yapId,"yap-status":t.infoData.status.value,"yap-front-end-arr":t.filterYapFrontEndArr[a],"type-option":t.typeOption,"item-option":t.itemOptionCom,"team-option":t.teamOption,"unit-list":t.unitList,"yap-point-audit-item-list":t.yapPointAuditItemList,"is-confirm-user":t.isConfirmUser,"current-year":t.infoData.year,"review-flag":t.yapReviewFlag},on:{"update:yapFrontEndArr":function(e){return t.$set(t.filterYapFrontEndArr,a,e)},"update:yap-front-end-arr":function(e){return t.$set(t.filterYapFrontEndArr,a,e)},click:t.emitEvent,slideclick:t.slideClickEvent}})})):t._e(),0===t.filterYapFrontEndArr.length?i("div",{staticClass:"comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 查無資料 ")])]):t._e(),"ROLE_Auditor"!==t.currentRoleId&&"ROLE_Audit_Team_Head"!==t.currentRoleId||!("A"===t.infoData.status.value||"B"===t.infoData.status.value||"C"===t.infoData.status.value&&t.isBeenRejectedAuditItem)?t._e():i("TemporaryStoreButton",{on:{click:t.saveYap}}),i("SetAuditItemsModal",{attrs:{visible:t.setAuditItemsModal.visiable,"audit-items-option":t.itemOptionCom,year:t.infoData.year},on:{closeModal:function(e){t.setAuditItemsModal.visiable=!1},save:t.modifyAuditItem}}),i("LeaderOpinionModal",{attrs:{visible:t.leaderOpinionModal.visible,message:t.leaderOpinionModal.message},on:{closeModal:function(e){t.leaderOpinionModal.visible=!1}}}),i("CompareDataModal",{attrs:{visible:t.compareModal.visible,"now-data":t.compareModal.nowData,"old-data":t.compareModal.oldData},on:{closeModal:function(e){t.compareModal.visible=!1}}}),i("ExportModal",{attrs:{visible:t.exportModalShow},on:{closeModal:function(e){t.exportModalShow=!1},click:t.handleExport}}),i("ConnectDataModal",{attrs:{visible:t.connectDataModal.visible,"content-data":t.connectDataModal.data,"data-id":t.dataId},on:{closeModal:function(e){t.connectDataModal.visible=!1}}}),i("ImportDataModal",{attrs:{"type-option":t.typeOption,"item-option":t.itemOptionCom,"yap-point-audit-item-list":t.yapPointAuditItemList,yap:t.importModal.yap,"yap-year":t.importModal.yapYear,visible:t.importModal.visiable},on:{closeModal:function(e){t.importModal.visiable=!1},importData:t.importYapPointAuditItem}}),i("QAModal",{attrs:{visible:t.QAModal.visiable,"q-a-status":t.QAModal.QAStatus,"yap-id":t.QAModal.yapId,"q-a-data":t.QAModal.QAData,"yap-status":t.QAModal.yapStatus,"yap-point-audit-item-id":t.QAModal.yapPointAuditItemId,"is-supervisor":t.isSupervisor,"review-level":t.QAModal.reviewLevel,"reject-flag":t.QAModal.rejectFlag,"role-id":t.currentRoleId},on:{closeModal:function(e){t.QAModal.visiable=!1},getYapProjectScopeQA:t.getYapProjectScopeQA,getYapItemScopeQA:t.getYapItemScopeQA,changeYapProjectScopeQAStatus:t.changeYapProjectScopeQAStatus,changeYapItemScopeQAStatus:t.changeYapItemScopeQAStatus}}),i("InspectedUnitModal",{attrs:{"units-list":t.inspectedUnitModal.unitsList,visible:t.inspectedUnitModal.visiable},on:{closeModal:function(e){t.inspectedUnitModal.visiable=!1}}}),i("ReviewCommitModal",{attrs:{year:t.infoData.year,"yap-id":t.reviewCommitModal.yapId,visible:t.reviewCommitModal.visible,type:t.reviewCommitModal.type,title:t.reviewCommitModal.title,label:t.reviewCommitModal.label,"audit-item-list":t.reviewCommitModal.auditItemList},on:{closeModal:function(e){t.reviewCommitModal.visible=!1},click:t.reviewModalClickEvent,getSupervisorReturnAuditItem:t.getSupervisorReturnAuditItem}}),i("HistoryModal",{attrs:{visible:t.historyshow,"init-search-form":t.searchForm,"init-options":{teamOption:t.teamOption,typeOption:t.typeOption,yearOptions:t.yearOptions}},on:{closeModal:function(e){t.historyshow=!1}}})],2)}),[],!1,null,"3ea01954",null).exports),Xe=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-6"},[e("img",{staticClass:"result__img",attrs:{src:a("51bc"),alt:""}})])}];let ta=class extends et.d{backHome(){this.$router.push("/index")}};ta=Object(J.a)([Object(et.a)({})],ta);var ea=ta,aa=(a("5054"),Object(st.a)(ea,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"result__row row"},[t._m(0),a("div",{staticClass:"result__content col-6"},[a("p",{staticClass:"result__title"},[t._v(" 恭喜結案成功! ")]),a("p",{staticClass:"result__text"},[t._v(" 確認年度稽核已結案 ")]),a("button",{staticClass:"btn--backhome",on:{click:t.backHome}},[t._v(" 回首頁 ")])])])])}),Xe,!1,null,"4738fcca",null).exports);let ia=class extends et.d{constructor(){super(...arguments),this.resultModalVisible=!1,this.fileList=[],this.promiseArray=[],this.uploadErr=[],this.modalData={content:"",title:"",type:"",autoClose:null},this.grid={rowKey:"uid",data:[],columns:[{type:Re.TEMPLATE,property:"fileName",title:"檔案上傳",template:"fileName"},{type:Re.PLAIN,property:"user",title:"上傳人員"},{type:Re.PLAIN,property:"time",title:"上傳時間",formatter:t=>this.$twDateTimeFormatter.stringify(t.time)},{type:Re.TEMPLATE,property:"delete",template:"delete",title:"刪除",width:100}]}}created(){this.user=this.$user.getMe()}closeModal(){this.$emit("closeModal")}add(){this.$emit("confirmModal")}async getApi_authorizationFileType(){return(await this.$parameterApi.searchAllowedFileExtensionsInParameterUsingGET()).data.result}async beforeUpload(t){const e=(await this.getApi_authorizationFileType()).reduce((t,e)=>`${t}|${e}`);if(!new RegExp(`(${e})$`).test(t.name))return this.modalData={autoClose:null,content:"檔案格式不符，請重新選擇檔案",type:"warning",title:"上傳提示"},this.$emit("setModal",this.modalData),!1;if(!(200/1024/1024<t.size))return this.modalData={autoClose:null,content:"檔案大小超過200MB，請重新選擇檔案",type:"warning",title:"上傳提示"},this.$emit("setModal",this.modalData),!1;this.fileList=[...this.fileList,t];const a={uid:t.uid,fileName:t.name,time:new Date,user:this.user.employee.name};this.grid.data.push(a)}async confirmUpload(){this.uploadErr=[],0!=this.fileList.length?(this.setLoading(!0),this.fileList.forEach(t=>{this.promiseArray.push(this.uploadData(t.originFileObj))}),await Promise.all(this.promiseArray).then(t=>{}).catch(console.error).finally(()=>{this.setLoading(!1)}),this.grid.data=[],this.fileList=[],0==this.uploadErr.length?(this.modalData.autoClose=3,this.modalData.type="success",this.modalData.title="上傳成功",this.$emit("setModal",this.modalData),this.$emit("closeModal")):(this.fileList=this.uploadErr,this.fileList.map(t=>{this.grid.data.push({uid:t.uid,fileName:t.name,time:new Date,user:this.user.employee.name})}),this.modalData.autoClose=3,this.modalData.type="error",this.modalData.title="上傳失敗",this.$emit("setModal",this.modalData))):(this.modalData={autoClose:null,content:"請先選擇檔案",type:"warning",title:"上傳提示"},this.$emit("setModal",this.modalData))}uploadData(t){return this.$dataCollectApi.uploadDataUsingPOST(this.caseType,t).then(t=>{}).catch(e=>{this.uploadErr.push(t)})}handleChange(t){this.fileList=this.fileList.filter(t=>"vaild"!==t.uid),"uploading"==t.file.status&&(this.fileList=t.fileList,this.fileList.map(e=>("uploading"==t.file.status&&(e.status="done"),e)))}remove(t){this.fileList=this.fileList.filter(e=>e.uid!==t.uid),this.grid.data=this.grid.data.filter(e=>e.uid!==t.uid)}};Object(J.a)([Object(tt.a)("setLoading")],ia.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],ia.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],ia.prototype,"caseType",void 0),Object(J.a)([Object(et.b)()],ia.prototype,"pageTitle",void 0),ia=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,InfoModal:_t,CustomPopConfirm:ce}})],ia);var sa=ia,oa=(a("f0bc"),Object(st.a)(sa,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:t.pageTitle,visible:t.visible,centered:!0,"body-size":"large","padding-size":"small"},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("fragment",[i("div",{staticClass:"content__wrap mt-2"},[i("a-upload-dragger",{staticClass:"upload__dragger",attrs:{"show-upload-list":!1,"file-list":t.fileList,"before-upload":t.beforeUpload,"custom-request":function(){}},on:{change:t.handleChange}},[i("p",{staticClass:"ant-upload-drag-icon"},[i("a-icon",{attrs:{type:"container"}})],1),i("p",{staticClass:"ant-upload-text"},[t._v(" 點選或將文件拖曳到這裡上傳 ")]),i("p",{staticClass:"ant-upload-hint"},[t._v(" 支援多種格式，檔案大小200MB以內 ")])]),i("fbl-data-grid",{staticClass:"upload__table mt-3",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:!1,scroll:{x:!0}},scopedSlots:t._u([{key:"fileName",fn:function(e){return[i("div",[t._v(" "+t._s(e.data.fileName)+" ")])]}},{key:"delete",fn:function(e){return[i("div",{staticClass:"flex-center"},[i("CustomPopConfirm",{on:{confirm:function(a){return t.remove(e.data)}}},[i("img",{staticClass:"table__btn-delete",attrs:{alt:"",src:a("178a")}})])],1)]}}])})],1),i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.confirmUpload}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],1)],2)}),[],!1,null,"89ce88e4",null).exports);const na=Object(tt.c)("modalControl");let ra=class extends et.d{constructor(){super(...arguments),this.modalVisible=!1,this.caseType="",this.title="",this.uploadType=[{name:"作業風險事件清單",caseType:"F"},{name:"作業委外合約清單",caseType:"G"},{name:"重大市場/信用風險事件通報清單",caseType:"H"},{name:"海外子公司信用風險事件通報清單",caseType:"I"}],this.modalData={visible:!1,content:null,title:"",type:"",autoClose:null}}backRoute(){this.$router.back()}setQuery(t){this.caseType=t.caseType,this.title=t.name,this.modalVisible=!0}result(t){this.setModalState({resultModal:{...t,visible:!0}})}};Object(J.a)([na.Action("setModalState")],ra.prototype,"setModalState",void 0),Object(J.a)([na.Getter("getResultModal")],ra.prototype,"getResultModal",void 0),ra=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,UploadModal:oa}})],ra);var la=ra,ca=(a("3e99"),Object(st.a)(la,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-contain container-fluid uploadList__container"},[a("div",{staticClass:"top__bar"},[a("IconTextButton",{attrs:{text:"上一頁",type:"return"},on:{click:t.backRoute}})],1),a("div",{staticClass:"graybar__wrap"},[t._m(0),a("div",{staticClass:"graybar__list"},t._l(t.uploadType,(function(e,i){return a("button",{key:i,staticClass:"graybar__list__item flex-center",on:{click:function(a){return t.setQuery(e)}}},[a("div",{staticClass:"list__item-text col-5"},[a("div",{staticClass:"list__item-icon"}),t._v(" "+t._s(e.name)+" ")])])})),0)]),a("UploadModal",{attrs:{visible:t.modalVisible,"case-type":t.caseType,"page-title":t.title},on:{setModal:t.result,closeModal:function(e){t.modalVisible=!1}}})],1)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"graybar__header"},[a("div",{staticClass:"graybar__header__line"}),a("div",{staticClass:"graybar__header__title"},[t._v(" 資料來源上傳 ")])])}],!1,null,"47e41103",null).exports);let da=class extends et.d{constructor(){super(...arguments),this.form={auditorTeam:void 0,caseType:void 0,claimStatus:void 0,summary:void 0,confirmStatus:void 0,toDo:!1}}get todoDisabled(){return["ROLE_Audit_Office_Boss_Vice","ROLE_Audit_Office_Boss"].includes(this.$global.getCurrentRoleId())}created(){this.todoDisabled||(this.form.toDo="todo"===this.$route.params.type),this.search()}search(){this.$emit("search",this.form)}};Object(J.a)([Object(et.b)()],da.prototype,"role",void 0),Object(J.a)([Object(et.b)()],da.prototype,"dataTypeList",void 0),Object(J.a)([Object(et.b)()],da.prototype,"dataStatusList",void 0),Object(J.a)([Object(et.b)()],da.prototype,"groupStatusList",void 0),Object(J.a)([Object(et.b)()],da.prototype,"getGroupList",void 0),da=Object(J.a)([Object(et.a)({components:{}})],da);var ua=da,pa=Object(st.a)(ua,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search-form"},["4"!==t.role?[a("div",{staticClass:"search-form__item"},[a("div",{staticClass:"search-form__label"},[t._v(" 資料類型 ")]),a("a-select",{staticClass:"search-form__input--select",attrs:{disabled:t.form.toDo,"show-search":"","filter-option":t.$global.filterOption,placeholder:"請選擇資料類型","allow-clear":!0},model:{value:t.form.caseType,callback:function(e){t.$set(t.form,"caseType",e)},expression:"form.caseType"}},t._l(t.dataTypeList,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)]:t._e(),"ROLE_Auditor"!==t.role&&"ROLE_Audit_Team_Head"!==t.role?a("div",{staticClass:"search-form__item"},[a("div",{staticClass:"search-form__label"},[t._v(" 已認列組別 ")]),a("a-select",{staticClass:"search-form__input--select",attrs:{disabled:t.form.toDo,"show-search":"","filter-option":t.$global.filterOption,"allow-clear":!0,placeholder:"請選擇已認列組別"},model:{value:t.form.auditorTeam,callback:function(e){t.$set(t.form,"auditorTeam",e)},expression:"form.auditorTeam"}},t._l(t.getGroupList,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1):t._e(),"ROLE_Audit_Team_Head"===t.role||"ROLE_Auditor"===t.role?a("div",{staticClass:"search-form__item"},[a("div",{staticClass:"search-form__label"},[t._v(" 認列狀態 ")]),a("a-select",{staticClass:"search-form__input--select",attrs:{disabled:t.form.toDo,"show-search":"","filter-option":t.$global.filterOption,"allow-clear":!0,placeholder:"請選擇認列狀態"},model:{value:t.form.claimStatus,callback:function(e){t.$set(t.form,"claimStatus",e)},expression:"form.claimStatus"}},t._l(t.groupStatusList,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1):t._e(),"ROLE_Audit_Team_Head"!==t.role&&"ROLE_Auditor"!==t.role?a("div",{staticClass:"search-form__item"},[a("div",{staticClass:"search-form__label"},[t._v(" 資料確認狀態 ")]),a("a-select",{staticClass:"search-form__input--select",attrs:{disabled:t.form.toDo,"show-search":"","filter-option":t.$global.filterOption,"allow-clear":!0,placeholder:"請選擇資料確認狀態"},model:{value:t.form.confirmStatus,callback:function(e){t.$set(t.form,"confirmStatus",e)},expression:"form.confirmStatus"}},t._l(t.dataStatusList,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1):t._e(),"4"===t.role?a("div",{staticClass:"search-form__item"},[a("div",{staticClass:"search-form__label"},[t._v(" 年度 ")]),a("a-select",{staticClass:"search-form__input--select",attrs:{disabled:t.form.toDo,"show-search":"","filter-option":t.$global.filterOption,"allow-clear":!0},model:{value:t.form.dataType,callback:function(e){t.$set(t.form,"dataType",e)},expression:"form.dataType"}},[a("a-select-option",{attrs:{value:"jack"}},[t._v(" 110年 ")])],1)],1):t._e(),"4"===t.role?a("div",{staticClass:"search-form__item"},[a("div",{staticClass:"search-form__label"},[t._v(" 月份 ")]),a("a-select",{staticClass:"search-form__input--select",attrs:{disabled:t.form.toDo,"show-search":"","filter-option":t.$global.filterOption,"allow-clear":!0},model:{value:t.form.dataType,callback:function(e){t.$set(t.form,"dataType",e)},expression:"form.dataType"}},[a("a-select-option",{attrs:{value:"１"}},[t._v(" 1月 ")])],1)],1):t._e(),a("div",{staticClass:"search-form__item"},[a("div",{staticClass:"search-form__label"},[t._v(" 資料摘要 ")]),a("a-input",{staticClass:"search-form__input--text",attrs:{disabled:t.form.toDo,"allow-clear":!0,placeholder:"請輸入摘要關鍵字"},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1),a("div",{staticClass:"search-form__item"},[a("a-form-model-item",{staticClass:"mb-0"},[a("a-checkbox",{attrs:{disabled:t.todoDisabled},model:{value:t.form.toDo,callback:function(e){t.$set(t.form,"toDo",e)},expression:"form.toDo"}},[t._v(" 待辦 ")])],1)],1),a("button",{staticClass:"btn--search",on:{click:t.search}},[t._v(" 查詢 ")])],2)}),[],!1,null,"ab3f3e3a",null).exports;let ma=class extends et.d{constructor(){super(...arguments),this.form={confirmUser:null,crawlerDataId:null,group:null,applyRemark:""},this.formRules={confirmUser:[{required:!0,message:"請選擇資料確認人員",trigger:"change"}]},this.confirmUserList=null,this.currentRole=null}onIsVisibleChanged(t){t&&this.isClaim&&null===this.confirmUserList&&this.getAuditorTeam()}getAuditorTeam(){this.setLoading(!0),this.currentRole=this.$global.getCurrentRole();const t={roleId:this.currentRole.id,unitCode:this.currentRole.roleUnits[0].auditorTeamCode};this.$dataCollectApi.getAuditorTeamInDataCollectUsingPOST(t).then(t=>{this.confirmUserList=t.data.result}).catch(console.error).finally(()=>{this.setLoading(!1)})}submit(){this.$refs.formRef.validate(t=>{t&&(this.isClaim?this.$emit("claim",this.form.confirmUser):this.$emit("notClaim",this.form.applyRemark))})}clearForm(){this.form={confirmUser:null,crawlerDataId:null,group:null,applyRemark:""}}closeModal(){this.$emit("closeModal")}addResponseMessage(t){this.form.applyRemark+=t}};Object(J.a)([Object(tt.a)("setLoading")],ma.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],ma.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],ma.prototype,"isClaim",void 0),Object(J.a)([Object(et.b)()],ma.prototype,"crawlerDataId",void 0),Object(J.a)([Object(et.e)("visible")],ma.prototype,"onIsVisibleChanged",null),ma=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t,ResponseMessage:Le}})],ma);var ha=ma,fa=(a("c8fa"),Object(st.a)(ha,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:t.isClaim?"資料蒐集(認列)":"資料蒐集(非本組認列)",visible:t.visible,centered:!0,width:t.isClaim?460:950},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("div",{staticClass:"d-flex"},[i("a-form-model",{ref:"formRef",staticClass:"mt-4 form--light content__form",attrs:{model:t.form,rules:t.formRules,"hide-required-mark":!0}},[t.isClaim?i("a-form-model-item",{attrs:{prop:"confirmUser","label-col":{span:7},"wrapper-col":{span:17}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 資料確認人員 ")]),i("a-select",{staticClass:"w-100",attrs:{"show-search":"","filter-option":t.$global.filterOption},model:{value:t.form.confirmUser,callback:function(e){t.$set(t.form,"confirmUser",e)},expression:"form.confirmUser"}},t._l(t.confirmUserList,(function(e){return i("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1):t._e(),t.isClaim?t._e():i("a-form-model-item",{attrs:{prop:"message","label-col":{span:24},"wrapper-col":{span:24}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 簽核意見： ")]),i("div",{staticClass:"confirm-message"},[i("img",{staticClass:"confirm-message__img",attrs:{src:t.isClaim?a("5430"):a("e536"),alt:""}}),i("a-textarea",{attrs:{"auto-size":{minRows:14}},model:{value:t.form.applyRemark,callback:function(e){t.$set(t.form,"applyRemark",e)},expression:"form.applyRemark"}})],1)])],1),t.isClaim?t._e():i("ResponseMessage",{staticClass:"content__msg ps-2",on:{select:t.addResponseMessage}})],1),i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],2)}),[],!1,null,"4dd8add6",null).exports);let ga=class extends et.d{constructor(){super(...arguments),this.isSelectItem=!1}onSelectItemsChanged(t){t.length>0?this.isSelectItem=!0:this.isSelectItem=!1}clickHandler(){}confirm(t){this.$emit("confirm",t)}toPage(t){this.$emit("toPage",t)}};Object(J.a)([Object(et.b)()],ga.prototype,"role",void 0),Object(J.a)([Object(et.b)()],ga.prototype,"selectItems",void 0),Object(J.a)([Object(et.e)("selectItems",{immediate:!0,deep:!0})],ga.prototype,"onSelectItemsChanged",null),ga=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut}})],ga);var ba=ga,va=(a("c7f3"),Object(st.a)(ba,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["ROLE_Audit_Team_Head"==t.role?a("div",[a("a-tooltip",{attrs:{trigger:t.isSelectItem?"":"hover",placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("a-icon",{staticClass:"tip__icon",attrs:{type:"exclamation-circle"}}),a("span",{staticClass:"tip__text"},[t._v("請先勾選")])],1),a("IconTextButton",{staticClass:"me-3",attrs:{text:"認列送出",type:"enter"},on:{click:function(e){t.isSelectItem&&t.confirm(!0)}}})],2),a("a-tooltip",{attrs:{trigger:t.isSelectItem?"":"hover",placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("a-icon",{staticClass:"tip__icon",attrs:{type:"exclamation-circle"}}),a("span",{staticClass:"tip__text"},[t._v("請先勾選")])],1),a("IconTextButton",{attrs:{text:"非本組認列",type:"close"},on:{click:function(e){t.isSelectItem&&t.confirm(!1)}}})],2)],1):t._e(),"ROLE_Auditor"==t.role?a("div",[a("IconTextButton",{staticClass:"me-3",attrs:{text:"上傳資料",type:"upload"},on:{click:function(e){return t.$router.push({name:"CrawlerDataUpload"})}}}),a("a-tooltip",{attrs:{trigger:t.isSelectItem?"":"hover",placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("a-icon",{staticClass:"tip__icon",attrs:{type:"exclamation-circle"}}),a("span",{staticClass:"tip__text"},[t._v("請先勾選")])],1),a("IconTextButton",{attrs:{text:"非本組認列",type:"close"},on:{click:function(e){t.isSelectItem&&t.confirm(!1)}}})],2)],1):t._e(),"4"==t.role?a("div",[a("IconTextButton",{staticClass:"me-3",attrs:{text:"上傳資料",type:"upload"},on:{click:function(e){return t.toPage("CrawlerDataUpload")}}})],1):t._e()])}),[],!1,null,"44130637",null).exports),_a=a("c1df"),ya=a.n(_a);class Ca{static transformRocDate(t){const e=t.split(/\D/g);return`${Number.parseInt(e[0])-1911}/${e[1]}/${e[2]}   ${e[3]}:${e[4]}`}static transformDate(t){const e=t.split(/\D/g);return`${Number.parseInt(e[0])+1911}/${e[1]}/${0===e[2].length?"**":e[2]}`}static filterRangeDate(t){const e=[...t],a=[];return e[0]||e[1]?(a[0]=ya()(e[0]).format("YYYY-MM-DDTHH:mm:ss.sssZ"),a[1]=ya()(e[1].setHours(23,59,59)).format("YYYY-MM-DDTHH:mm:ss.999Z"),a):null}static isValidDate(t){return ya()(t).isValid()?new Date(t):t}}const Oa=Object(tt.c)("crawlerDataDetailVuex"),Aa=Object(tt.c)("modalControl");let Ia=class extends et.d{constructor(){super(...arguments),this.isLoading=!1,this.ConfirmedForm={},this.claimModalSetting={visible:!1,isClaim:!1},this.currentRole=this.$global.getCurrentRole(),this.currentRoleId=null,this.dataTypeList=null,this.dataStatusList=null,this.groupStatusList=null,this.getGroupList=null,this.searchForm=null,this.isShowGrid=!1,this.isSupervisor=!1,this.teamColumns=[{type:Re.PLAIN,property:"caseType",title:"資料類型"},{type:Re.TEMPLATE,template:"summary",property:"summary",title:"資料摘要"},{type:Re.PLAIN,property:"confirmUser",title:"資料確認人員",formatter:t=>t.confirmUser&&Object.values(t.confirmUser)[0]},{type:Re.TEMPLATE,property:"dataClaimStatus",template:"dataClaimStatus",title:"認列狀態"},{type:Re.PLAIN,property:"createDatetime",title:"取得日期",formatter:t=>t.createDatetime?Ca.transformRocDate(t.createDatetime):""},{type:Re.PLAIN,property:"releaseDate",title:"發布日期",formatter:t=>t.releaseDate?Ca.transformRocDate(t.releaseDate):""}],this.supervisorColumns=[{type:Re.PLAIN,property:"caseType",title:"資料類型"},{type:Re.TEMPLATE,template:"summary",property:"summary",title:"資料摘要"},{type:Re.PLAIN,property:"claimGroup",title:"已認列組別"},{type:Re.PLAIN,property:"dataConfirmStatus",title:"資料確認狀態",formatter:t=>t.dataConfirmStatus&&Object.values(t.dataConfirmStatus)[0]},{type:Re.PLAIN,property:"createDatetime",title:"取得日期",formatter:t=>t.createDatetime?Ca.transformRocDate(t.createDatetime):""},{type:Re.PLAIN,property:"releaseDate",title:"發布日期",formatter:t=>t.releaseDate?Ca.transformRocDate(t.releaseDate):""}],this.grid={rowKey:"crawlerDataId",data:[],pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","15","25"],showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[]},this.UAOGrid={columns:[{title:"資料類型",dataIndex:"type",key:"type"},{title:"資料摘要",dataIndex:"summary",key:"summary",scopedSlots:{customRender:"summary"}},{title:"上傳日期",dataIndex:"getDate",key:"checked"}]},this.rowSelection={onChange:this.rowSelectionChange,selectedRowKeys:[],getCheckboxProps:this.getCheckboxProps}}rowSelectionChange(t,e){this.rowSelection.selectedRowKeys=t}getCheckboxProps(t){return{props:{disabled:void 0===t.dataClaimStatus.A}}}async created(){await Promise.all([this.getDataType(),this.getDataStatus(),this.getGroup(),this.getDataGroupStatus()]),this.currentRoleId=await this.$global.getCurrentRoleId(),this.grid.columns="ROLE_Audit_Team_Head"===this.currentRoleId||"ROLE_Auditor"===this.currentRoleId?this.teamColumns:this.supervisorColumns}mounted(){this.isShowGrid=!0}openConfirmModal(t){this.claimModalSetting.visible=!0,this.claimModalSetting.isClaim=t}ellipsisString(t){const e="xxl"!==this.getWindowSize?21:59;return t.length>e?t.slice(0,e)+"...":t}getDataType(){return this.$dataCollectApi.getDataTypeInDataCollectUsingGET().then(t=>{this.dataTypeList=t.data.result}).catch(t=>{})}getDataStatus(){return this.$dataCollectApi.getDataStatusInDataCollectUsingGET().then(t=>{this.dataStatusList=t.data.result}).catch(t=>{})}getDataGroupStatus(){return this.$dataCollectApi.getDataGroupStatusInDataCollectUsingGET().then(t=>{this.groupStatusList=t.data.result}).catch(t=>{})}getGroup(){return this.$dataCollectApi.getGroupInDataCollectUsingGET().then(t=>{this.getGroupList=t.data.result}).catch(t=>{})}search(t){t.toDo?this.searchForm={toDo:!0}:this.searchForm=t,this.grid.pagination.current=1,this.queryData()}queryData(t){this.rowSelection.selectedRowKeys=[],this.setLoading(!0);const e={...this.searchForm,pageIndex:this.grid.pagination.current-1,pageSize:this.grid.pagination.pageSize};return this.$dataCollectApi.queryInDataCollectUsingPOST(e).then(t=>{this.grid.data=t.data.result.content,this.grid.pagination.total=parseInt(t.data.result.totalElements)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}async onPageChange(t){this.grid.pagination.current=t.pagination.current,this.grid.pagination.pageSize=t.pagination.pageSize,this.setLoading(!0),await this.queryData(),this.setLoading(!1)}sendClaim(t){this.setLoading(!0);const e={confirmUser:t,crawlerDataId:this.rowSelection.selectedRowKeys,group:this.currentRole.roleUnits[0].auditorTeamCode};this.$dataCollectApi.sendClaimInDataCollectUsingPOST(e).then(t=>{this.queryData(),this.setModalState({resultModal:{visible:!0,type:"success",title:"資料蒐集(認列)成功",autoClose:3}}),this.claimModalSetting.visible=!1,this.$refs.claimFormRef.clearForm()}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集(認列)失敗"}})}).finally(()=>{this.setLoading(!1)})}notClaim(t){this.setLoading(!0);const e={applyRemark:t,crawlerDataId:this.rowSelection.selectedRowKeys,group:this.currentRole.roleUnits[0].auditorTeamCode};this.$dataCollectApi.notClaimInDataCollectUsingPOST(e).then(t=>{this.queryData(),this.claimModalSetting.visible=!1,this.setModalState({resultModal:{visible:!0,type:"success",title:"資料蒐集(非本組認列)成功",autoClose:3}}),this.$refs.claimFormRef.clearForm()}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集(非本組認列)失敗"}})}).finally(()=>{this.setLoading(!1)})}async onPageDetail({crawlerDataId:t}){this.setLoading(!0),this.$dataCollectApi.getDataCollectDetailInDataCollectUsingGET(t).then(e=>{const a=e.data;this.setDetailData({crawlerData:a.result}),this.$global.changeRouterAndaddParam({toRouter:"CrawlerDataDetail",query:{crawlerDataId:t}})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}};Object(J.a)([Aa.Action("setModalState")],Ia.prototype,"setModalState",void 0),Object(J.a)([Oa.Action("setDetailData")],Ia.prototype,"setDetailData",void 0),Object(J.a)([tt.b],Ia.prototype,"getWindowSize",void 0),Object(J.a)([Object(tt.a)("setLoading")],Ia.prototype,"setLoading",void 0),Ia=Object(J.a)([Object(et.a)({components:{DataConfirmSearchForm:pa,IconTextButton:Ut,ClaimForm:fa,ActionBar:va,FblDataGrid:gt}})],Ia);var Da=Ia,Sa=(a("ed50"),Object(st.a)(Da,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-contain crawlerindex-container container"},[a("ClaimForm",{ref:"claimFormRef",attrs:{visible:t.claimModalSetting.visible,"is-claim":t.claimModalSetting.isClaim,"crawler-data-id":t.rowSelection.selectedRowKeys},on:{closeModal:function(e){t.claimModalSetting.visible=!1},claim:t.sendClaim,notClaim:t.notClaim}}),a("DataConfirmSearchForm",{attrs:{role:t.currentRoleId,"data-type-list":t.dataTypeList,"data-status-list":t.dataStatusList,"get-group-list":t.getGroupList,"group-status-list":t.groupStatusList},on:{search:t.search}}),a("div",{staticClass:"d-flex justify-content-between search-header"},[a("div",{staticClass:"title"},[t._v(" 資料蒐集 ")]),a("ActionBar",{attrs:{"select-items":t.rowSelection.selectedRowKeys,role:t.currentRoleId},on:{confirm:t.openConfirmModal}})],1),t.isShowGrid?a("fbl-data-grid",{staticClass:"select-table",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:t.grid.pagination,"custom-row":t.grid.customRow,scroll:{x:!0},"row-selection":"ROLE_Auditor"===t.currentRoleId||"ROLE_Audit_Team_Head"===t.currentRoleId?t.rowSelection:null},on:{tableChange:function(e){return t.onPageChange(e)}},scopedSlots:t._u([{key:"summary",fn:function(e){return[a("a-popover",{attrs:{"overlay-class-name":"popover--summary",placement:"top",trigger:("xxl"==t.getWindowSize?e.data.summary.length<60:e.data.summary.length<22)?"":"hover"}},[a("template",{slot:"content"},[a("span",[t._v(" "+t._s(e.data.summary)+" ")])]),a("div",{staticClass:"datalink",on:{click:function(a){return t.onPageDetail(e.data)}}},[t._v(" "+t._s(t.ellipsisString(e.data.summary))+" ")])],2)]}},{key:"dataClaimStatus",fn:function(e){return[a("span",{class:{"text--warning":"A"===(e.data.dataClaimStatus&&Object.keys(e.data.dataClaimStatus)[0])}},[t._v(" "+t._s(e.data.dataClaimStatus&&Object.values(e.data.dataClaimStatus)[0])+" ")])]}}],null,!1,3548007951)}):t._e()],1)}),[],!1,null,"696a8acc",null).exports);let wa=class extends et.d{constructor(){super(...arguments),this.form={remark:""}}clearForm(){this.form={remark:""}}closeModal(){this.$emit("closeModal")}addResponseMessage(t){this.form.remark+=t}submit(){this.$emit("submit",this.form.remark)}clear(){this.form.remark=""}};Object(J.a)([Object(tt.a)("setLoading")],wa.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],wa.prototype,"visible",void 0),wa=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t,ResponseMessage:Le}})],wa);var ka=wa,Ma=(a("eb03"),Object(st.a)(ka,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"審核退回",visible:t.visible,centered:!0,width:950},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("fragment",[i("div",{staticClass:"d-flex"},[i("a-form-model",{ref:"formRef",staticClass:"mt-4 form--light content__form claim-form",attrs:{model:t.form,"hide-required-mark":!0}},[i("a-form-model-item",{attrs:{prop:"message","label-col":{span:24},"wrapper-col":{span:24}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 簽核意見： ")]),i("div",{staticClass:"confirm-message"},[i("img",{staticClass:"confirm-message__img",attrs:{src:a("e536"),alt:""}}),i("a-textarea",{attrs:{"auto-size":{minRows:11}},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)])],1),i("ResponseMessage",{staticClass:"content__msg ps-2",on:{select:t.addResponseMessage}})],1),i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],1)],2)}),[],!1,null,"6cb3c20e",null).exports);const xa=Object(tt.c)("crawlerDataDetailVuex"),ja=Object(tt.c)("modalControl");let Ta=class extends et.d{constructor(){super(...arguments),this.roleId="",this.dataTypeCom={},this.isNotClaimModal=!1,this.reviewRequset=null,this.notRecognizedForm=[],this.claimGroupObj=[]}get currentView(){return Object.keys(this.propData.caseType).length>0?"DataType__"+this.$enum.getDataTypeComp(Object.keys(this.propData.caseType)[0]):"DataType__comp1"}get getClaimGroup(){return Object.values(this.claimGroupObj.map(t=>t.auditorTeamName)).join("、")}get isClaimGroupShow(){return!(!this.roleId||!["ROLE_Audit_Department_Head"].includes(this.roleId))}get isNoClaimGroupShow(){return!(!this.roleId||!["ROLE_Audit_Department_Head"].includes(this.roleId))}getApi_NotClaimGroup(){this.setLoading(!0),this.$dataCollectApi.getNotClaimGroupUsingGET(this.crawlerDataId).then(t=>{this.notRecognizedForm=t.data.result}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getApi_reviewNotClaimGroup(t){this.setLoading(!0),this.$dataCollectApi.reviewNotClaimGroupInDataCollectUsingPOST(this.reviewRequset).then(e=>{this.$refs.notClaimModalRef.clear(),this.setModalState({resultModal:{visible:!0,type:"success",title:`審核${t?"通過":"退回"}成功`,autoClose:3}}),this.getApi_NotClaimGroup(),this.$nextTick(()=>{this.getApi_getClaimGroup()})}).catch(e=>{this.setModalState({resultModal:{visible:!0,type:"error",title:`審核${t?"通過":"退回"}失敗`}})}).finally(()=>{this.setLoading(!1)})}getApi_getClaimGroup(){this.setLoading(!0),this.$dataCollectApi.getClaimGroupInDataCollectUsingGET(this.crawlerDataId).then(t=>{const e=t.data;this.claimGroupObj=e.result}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}onReviewNotClaimGroup(t,e){if(this.reviewRequset={crawlerDataIds:this.crawlerDataId,dataGroupId:t.dataGroupId,dataGroupLogId:t.dataGroupLogId,isAgree:e?"Y":"N"},!e)return this.isNotClaimModal=!0,!1;this.getApi_reviewNotClaimGroup(!0)}onNotClaimModalEmit(t){this.reviewRequset.remark=t,this.getApi_reviewNotClaimGroup(!1)}async created(){this.roleId=this.$global.getCurrentRoleId(),"ROLE_Audit_Department_Head"===this.roleId&&this.getApi_NotClaimGroup()}watchClaimGroup(t){this.$nextTick(()=>{this.getApi_getClaimGroup()})}};Object(J.a)([Object(tt.a)("setLoading")],Ta.prototype,"setLoading",void 0),Object(J.a)([ja.Action("setModalState")],Ta.prototype,"setModalState",void 0),Object(J.a)([xa.Action("setDetailModalState")],Ta.prototype,"setDetailModalState",void 0),Object(J.a)([xa.State("detailData")],Ta.prototype,"vuexDetailData",void 0),Object(J.a)([Object(et.b)()],Ta.prototype,"propData",void 0),Object(J.a)([Object(et.b)()],Ta.prototype,"crawlerDataId",void 0),Object(J.a)([Object(et.e)("vuexDetailData.claimGroup",{immediate:!0,deep:!0})],Ta.prototype,"watchClaimGroup",null),Ta=Object(J.a)([Object(et.a)({components:{DataType__comp1:Lt,DataType__comp2:Et,DataType__comp3:Kt,DataType__comp4:Xt,IconTextButton:Ut,NotClaimModal:Ma}})],Ta);var La=Ta,Pa=(a("3112"),Object(st.a)(La,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.propData.caseType?a("div",{staticClass:"dataType__form__card"},[a("KeepAlive",[a(t.currentView,{tag:"component",attrs:{"prop-data":t.propData,"show-crawler-data-id":!0}},[t.isClaimGroupShow?a("template",{slot:"claimGroup"},[a("a-row",{staticClass:"d-flex w-100"},[a("a-col",{staticClass:"col"},[a("a-form-model-item",{staticClass:"w-100",attrs:{label:"認列組別"}},[a("a-input",{attrs:{rows:1,disabled:""},model:{value:t.getClaimGroup,callback:function(e){t.getClaimGroup=e},expression:"getClaimGroup"}})],1)],1),a("IconTextButton",{staticClass:"ms-2",attrs:{text:"設定認列組別",type:"group"},on:{click:function(e){return t.setDetailModalState({confirmGroupModal:{visible:!0}})}}})],1)],1):t._e()],2)],1)],1):t._e(),t.isNoClaimGroupShow&&t.notRecognizedForm.length>0?[a("h5",{staticClass:"notRecognized__title"},[t._v(" 不認列組別確認 ")]),a("div",{staticClass:"dataType__form__card notRecognized__form__card"},[a("a-form-model",t._l(t.notRecognizedForm,(function(e,i){return a("a-row",{key:i,staticClass:"d-flex w-100 notRecognized__wrap"},[a("a-col",{staticClass:"col"},[a("a-form-model-item",{staticClass:"w-100",attrs:{label:e.auditorTeamName}},[a("a-input",{attrs:{type:"text",disabled:""},model:{value:e.applyRemark,callback:function(a){t.$set(e,"applyRemark",a)},expression:"item.applyRemark"}})],1)],1),a("div",{staticClass:"button__wrap"},[a("button",{staticClass:"btn--dark",on:{click:function(a){return t.onReviewNotClaimGroup(e,!0)}}},[t._v(" 通過 ")]),a("button",{staticClass:"btn--primary",on:{click:function(a){return t.onReviewNotClaimGroup(e,!1)}}},[t._v(" 退回 ")])])],1)})),1)],1),a("NotClaimModal",{ref:"notClaimModalRef",attrs:{visible:t.isNotClaimModal},on:{submit:t.onNotClaimModalEmit,closeModal:function(e){t.isNotClaimModal=!1}}})]:t._e()],2)}),[],!1,null,"74d817a2",null).exports);const Ra=Object(tt.c)("crawlerDataDetailVuex");let Ea=class extends et.d{constructor(){super(...arguments),this.addAuditInput="",this.auditSideAddError=!1}get roleId(){return this.$global.getCurrentRole().id}get auditSideMenuArr(){return this.getRelProcess_1}get changeAuditArr(){return this.auditSideMenuArr.filter(t=>"add"===t.operate||t.relId)}get isEdit(){const t=this.getDetailData.groupStatus,e=[this.$user.getMe().employee.domainId,...this.getAccountAgentList].includes(this.getDetailData.confrimUser);return!(!["ROLE_Audit_Team_Head","ROLE_Auditor"].includes(this.roleId)||!e||"A"!==t)}onAddSelectAudit(t){if(!this.isEdit)return!1;{const e=this.auditSideMenuArr.find(e=>e.auditItem===t);e.operate="add"===e.operate?"modify":"add","modify"==e.operate&&this.delRelProcess({relprocessId:"relProcess_1",auditItem:t})}}onRemoveSelectAudit(t){this.auditSideMenuArr.find(e=>e.auditItem===t).operate="modify",this.delRelProcess({relprocessId:"relProcess_1",auditItem:t})}onSaveSideMenu(){const t=this.addAuditInput.trim();if(!t)return this.auditSideAddError=!0,!1;this.setLoading(!0),this.$dataCollectApi.creatAuditorItemInDataCollectUsingGET(t).then(t=>{this.addAuditInput="",this.updated({relProcess:!0})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}};Object(J.a)([Object(tt.a)("setLoading")],Ea.prototype,"setLoading",void 0),Object(J.a)([Ra.Action("setDetailData")],Ea.prototype,"setDetailData",void 0),Object(J.a)([Ra.Action("updated")],Ea.prototype,"updated",void 0),Object(J.a)([Ra.Action("delRelProcess")],Ea.prototype,"delRelProcess",void 0),Object(J.a)([Ra.Getter("getDetailData")],Ea.prototype,"getDetailData",void 0),Object(J.a)([Ra.Getter("getRelProcess_1")],Ea.prototype,"getRelProcess_1",void 0),Object(J.a)([Ra.Getter("getCheckValidation")],Ea.prototype,"getCheckValidation",void 0),Object(J.a)([Ra.Action("clearCheckValidation")],Ea.prototype,"clearCheckValidation",void 0),Object(J.a)([Ra.Getter("getAccountAgentList")],Ea.prototype,"getAccountAgentList",void 0),Object(J.a)([Object(et.b)()],Ea.prototype,"dataTypeStr",void 0),Object(J.a)([Object(et.b)()],Ea.prototype,"crawlerDataId",void 0),Ea=Object(J.a)([Object(et.a)({components:{CustomPopConfirm:ce}})],Ea);var $a=Ea,Fa=(a("5cfc"),Object(st.a)($a,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit__page"},[a("h4",[t._v("查核項目")]),a("div",{staticClass:"audit__container",class:{disabled:!t.isEdit}},[a("div",{staticClass:"audit__sideWrap"},[t.auditSideMenuArr.length>0?a("ul",{staticClass:"audit__sideMenu"},t._l(t.auditSideMenuArr,(function(e){return a("li",{key:e.auditItem,staticClass:"audit__sideMenu__item d-flex align-items-center",class:{"audit__sideMenu__item--selected":"add"===e.operate||e.relId},on:{click:function(a){return t.onAddSelectAudit(e.auditItem)}}},[a("a-icon",{staticClass:"audit__sideMenu__icon",attrs:{type:"check"}}),t._v(t._s(e.auditItemName)+" ")],1)})),0):t._e(),t.isEdit?a("div",{staticClass:"audit__sideAddControlWrap d-flex align-items-center mt-3"},[a("span",{staticClass:"audit__sideAddControl__title"},[t._v("新增查核項目")]),a("a-form-item",{staticClass:"audit__sideAddControl__input",attrs:{"validate-status":t.auditSideAddError?"error":"",help:t.auditSideAddError?"不得為空":null}},[a("a-input",{on:{change:function(e){t.auditSideAddError=!1}},model:{value:t.addAuditInput,callback:function(e){t.addAuditInput=e},expression:"addAuditInput"}})],1),a("a-button",{staticClass:"audit__sideAddControl__btn btn--primary",on:{click:t.onSaveSideMenu}},[t._v(" 儲存 ")])],1):t._e()]),a("div",{staticClass:"audit__textareaGroup"},[t._l(t.changeAuditArr,(function(e,i){return[a("div",{key:"textarea"+(i+1),staticClass:"audit__textarea__item"},[a("div",{staticClass:"audit__textarea__header"},[a("span",{staticClass:"audit__textarea__title"},[t._v(t._s(t.auditSideMenuArr.find((function(t){return t.auditItem==e.auditItem})).auditItemName))]),"delete"==e.operate?[t.isEdit?a("a-icon",{staticClass:"audit__act__icon audit__act__action__icon",attrs:{type:"delete"},on:{click:function(a){return t.onRemoveSelectAudit(e.auditItem)}}}):t._e()]:[a("CustomPopConfirm",{attrs:{title:"確認刪除？"},on:{confirm:function(a){return t.onRemoveSelectAudit(e.auditItem)}}},[t.isEdit?a("a-icon",{staticClass:"audit__act__icon",attrs:{type:"delete"}}):t._e()],1)]],2),a("a-form-item",{staticClass:"audit__textarea__input w-100 m-0",attrs:{"validate-status":t.getCheckValidation.view1.includes(e.auditItem)?"error":""}},[a("a-textarea",{staticClass:"audit__textarea",attrs:{disabled:!t.isEdit,"auto-size":{minRows:1}},on:{change:function(a){return t.clearCheckValidation({key:"1",auditItem:e.auditItem})}},model:{value:e.relContent.content,callback:function(a){t.$set(e.relContent,"content",a)},expression:"item.relContent.content"}})],1)],1),t.getCheckValidation.view1.includes(e.auditItem)?a("p",{key:"contentError"+i,staticClass:"text-end message--error"},[t._v(" 不得為空 ")]):t._e()]}))],2)])])}),[],!1,null,"4c5f0750",null).exports);const Ua=Object(tt.c)("crawlerDataDetailVuex");let Ga=class extends et.d{constructor(){super(...arguments),this.addAuditInput="",this.auditSideAddError=!1}get roleId(){return this.$global.getCurrentRole().id}get auditSideMenuArr(){return this.getRelProcess_2}get changeAuditArr(){return this.auditSideMenuArr.filter(t=>"add"===t.operate||t.relId)}get isEdit(){const t=this.getDetailData.groupStatus,e=[this.$user.getMe().employee.domainId,...this.getAccountAgentList].includes(this.getDetailData.confrimUser);return!(!["ROLE_Audit_Team_Head","ROLE_Auditor"].includes(this.roleId)||!e||"A"!==t)}onAddSelectAudit(t){if(!this.isEdit)return!1;{const e=this.auditSideMenuArr.find(e=>e.auditItem===t);e.operate="add"===e.operate?"modify":"add","modify"==e.operate&&this.delRelProcess({relprocessId:"relProcess_2",auditItem:t})}}onRemoveSelectAudit(t){this.auditSideMenuArr.find(e=>e.auditItem===t).operate="modify",this.delRelProcess({relprocessId:"relProcess_2",auditItem:t})}onSaveSideMenu(){const t=this.addAuditInput.trim();if(!t)return this.auditSideAddError=!0,!1;this.setLoading(!0),this.$dataCollectApi.creatAuditorItemInDataCollectUsingGET(t).then(t=>{this.addAuditInput="",this.updated({relProcess:!0})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}};Object(J.a)([Object(tt.a)("setLoading")],Ga.prototype,"setLoading",void 0),Object(J.a)([Ua.Action("setDetailData")],Ga.prototype,"setDetailData",void 0),Object(J.a)([Ua.Action("updated")],Ga.prototype,"updated",void 0),Object(J.a)([Ua.Action("delRelProcess")],Ga.prototype,"delRelProcess",void 0),Object(J.a)([Ua.Getter("getDetailData")],Ga.prototype,"getDetailData",void 0),Object(J.a)([Ua.Getter("getRelProcess_2")],Ga.prototype,"getRelProcess_2",void 0),Object(J.a)([Ua.Getter("getCheckValidation")],Ga.prototype,"getCheckValidation",void 0),Object(J.a)([Ua.Action("clearCheckValidation")],Ga.prototype,"clearCheckValidation",void 0),Object(J.a)([Ua.Getter("getAccountAgentList")],Ga.prototype,"getAccountAgentList",void 0),Object(J.a)([Object(et.b)()],Ga.prototype,"dataTypeStr",void 0),Object(J.a)([Object(et.b)()],Ga.prototype,"crawlerDataId",void 0),Ga=Object(J.a)([Object(et.a)({components:{CustomPopConfirm:ce}})],Ga);var Ya=Ga,Na=(a("1097"),Object(st.a)(Ya,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit__page"},[a("h4",[t._v("查核項目")]),a("div",{staticClass:"audit__container",class:{disabled:!t.isEdit}},[a("div",{staticClass:"audit__sideWrap"},[t.auditSideMenuArr.length>0?a("ul",{staticClass:"audit__sideMenu"},t._l(t.auditSideMenuArr,(function(e){return a("li",{key:e.auditItem,staticClass:"audit__sideMenu__item d-flex align-items-center",class:{"audit__sideMenu__item--selected":"add"===e.operate},on:{click:function(a){return t.onAddSelectAudit(e.auditItem)}}},[a("a-icon",{staticClass:"audit__sideMenu__icon",attrs:{type:"check"}}),t._v(t._s(e.auditItemName)+" ")],1)})),0):t._e(),t.isEdit?a("div",{staticClass:"audit__sideAddControlWrap d-flex align-items-center mt-3"},[a("span",{staticClass:"audit__sideAddControl__title"},[t._v("新增查核項目")]),a("a-form-item",{staticClass:"audit__sideAddControl__input",attrs:{"validate-status":t.auditSideAddError?"error":"",help:t.auditSideAddError?"不得為空":null}},[a("a-input",{on:{change:function(e){t.auditSideAddError=!1}},model:{value:t.addAuditInput,callback:function(e){t.addAuditInput=e},expression:"addAuditInput"}})],1),a("a-button",{staticClass:"audit__sideAddControl__btn btn--primary",on:{click:t.onSaveSideMenu}},[t._v(" 儲存 ")])],1):t._e()]),a("div",{staticClass:"audit__textareaGroup"},[t._l(t.changeAuditArr,(function(e,i){return[a("div",{key:"textarea"+(i+1),staticClass:"audit__textarea__item"},[a("div",{staticClass:"audit__textarea__header"},[a("span",{staticClass:"audit__textarea__title"},[t._v(t._s(t.auditSideMenuArr.find((function(t){return t.auditItem==e.auditItem})).auditItemName))]),"delete"==e.operate?[t.isEdit?a("a-icon",{staticClass:"audit__act__icon audit__act__action__icon",attrs:{type:"delete"},on:{click:function(a){return t.onRemoveSelectAudit(e.auditItem)}}}):t._e()]:[a("CustomPopConfirm",{attrs:{title:"確認刪除？"},on:{confirm:function(a){return t.onRemoveSelectAudit(e.auditItem)}}},[t.isEdit?a("a-icon",{staticClass:"audit__act__icon",attrs:{type:"delete"}}):t._e()],1)]],2),a("a-form-item",{staticClass:"audit__textarea__input w-100 m-0",attrs:{"validate-status":t.getCheckValidation.view2.includes(e.auditItem)?"error":""}},[a("a-textarea",{staticClass:"audit__textarea",attrs:{disabled:!t.isEdit,"auto-size":{minRows:1}},on:{change:function(a){return t.clearCheckValidation({key:"2",auditItem:e.auditItem})}},model:{value:e.relContent.content,callback:function(a){t.$set(e.relContent,"content",a)},expression:"item.relContent.content"}})],1)],1),t.getCheckValidation.view2.includes(e.auditItem)?a("p",{key:"contentError"+i,staticClass:"text-end message--error"},[t._v(" 不得為空 ")]):t._e()]}))],2)])])}),[],!1,null,"0fc544cd",null).exports);const Va=Object(tt.c)("crawlerDataDetailVuex"),qa=Object(tt.c)("modalControl");let Ba=class extends et.d{constructor(){super(...arguments),this.form={auditType:"",checkItem:void 0},this.checkItemOption=[],this.auditTypeOptions=[{label:"公版",value:"publicProgramType"},{label:"專屬",value:"privateProgramType"}],this.selectAuditArr=[],this.activeKey=[],this.addAuditInput="",this.auditCatchArr=[],this.auditSideAddError=!1}get roleId(){return this.$global.getCurrentRole().id}get isEdit(){const t=this.getDetailData.groupStatus,e=[this.$user.getMe().employee.domainId,...this.getAccountAgentList].includes(this.getDetailData.confrimUser);return!(!["ROLE_Audit_Team_Head","ROLE_Auditor"].includes(this.roleId)||!e||"A"!==t)}get auditTypeOriginData(){return"publicProgramType"===this.form.auditType?this.getRelProcess_3Data.origin.publicProgramType:this.getRelProcess_3Data.origin.privateProgramType.filter(t=>t.auditItem===this.form.checkItem)}get auditTypeSelectData(){return""}get selectAuditArrDetail(){return this.getRelProcess_3Data.flat.filter(t=>this.selectAuditArr.includes(t.auditProgramSectionId))}get_selectAuditDetail(t){return this.selectAuditArrDetail.find(e=>e.auditProgramSectionId===t)}get_activeDetail(t){return this.getRelProcess_3.filter(e=>e.relItem===t).sort((t,e)=>t.relContent.seq-e.relContent.seq)}auditorContentObj(t,e){const a=this.selectAuditArrDetail.find(t=>t.auditProgramSectionId===e);return{dataRelId:"",dataGroupId:this.getDetailData.dataGroupId||"",dataGroupLogId:"",operate:t.operate||"modify",relProcess:"3",relId:t.id||"",relItem:e||"",auditItem:a.auditItem||null,auditItemName:a.auditItemName&&"公版"!==a.auditItemName?a.auditItemName:"",relContent:{content:t.content||"",article:"",paragraph:"",subparagraph:"",item:"",seq:t.seq||0}}}selectAuditArrSort(){this.selectAuditArr.sort((t,e)=>{const a=this.getRelProcess_3Data.origin.publicProgramType.map(t=>t.auditProgramSectionId);return a.includes(t)?a.includes(e)?t.localeCompare(e):-1:a.includes(e)?1:t.localeCompare(e)})}onAddSelectAudit(t){if(!this.isEdit)return!1;this.selectAuditArr.includes(t)?(this.selectAuditArr.splice(this.selectAuditArr.indexOf(t),1),this.delRelProcess3(t)):(this.selectAuditArr.push(t),this.selectAuditArrSort(),this.getApi_getAuditProgramContents(t)),this.activeKey.map((t,e)=>{this.selectAuditArr.includes(t)||this.activeKey.splice(e,1)})}addTextareaArr(t,e){const a=t[e];t.splice(e+1,0,this.auditorContentObj({operate:"add"},a.relItem)),t.map((t,e)=>{t.relContent.seq=e+1,t.operate="add"})}removeTextareaArr(t,e){const a=t.indexOf(e),i=t.filter(t=>t.relItem===e.relItem);i.length>1?(t.splice(a,1),i.map((t,e)=>{t.relContent.seq=e+1,t.operate="add"}),i.sort((t,e)=>t.seq-e.seq)):this.onAddSelectAudit(e.relItem)}onSaveSideMenu(){if(!this.addAuditInput.trim())return this.auditSideAddError=!0,!1;const t="publicProgramType"===this.form.auditType?"public":"private";this.getApi_createSession({auditItem:this.form.checkItem,programType:t,sectionName:this.addAuditInput})}getApi_createSession({auditItem:t,programType:e,sectionName:a}){this.setLoading(!0),this.$dataCollectApi.createSessionUsingPOST({auditItem:t,programType:e,sectionName:a}).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"新增Section成功",autoClose:3}}),this.addAuditInput="",this.$emit("resetSearchSection")}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"新增Section失敗",content:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}getApi_getAuditProgramContents(t){this.setLoading(!0),this.$dataCollectApi.getAuditProgramContentsUsingGET(t).then(e=>{const a=e.data.result,i=this.$global.deepCopyData(a.auditProgramContents);let s=[];s=i.length>0?i.map(e=>this.auditorContentObj({...e,operate:"add"},t)):[this.auditorContentObj({operate:"add",seq:1},t)];const o=this.getRelProcess_3.map(t=>t.relId);s.map(t=>{o.includes(t.relId)&&t.relId||this.setrelProcess3(t)})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}async mounted(){this.form.auditType="privateProgramType";const t=this.getRelProcess_3Data.flat.filter(t=>"add"===t.operate);this.selectAuditArr=t.map(t=>t.auditProgramSectionId),this.selectAuditArrSort(),this.activeKey=[...this.selectAuditArr]}watchForm(t){this.$nextTick(()=>{var e;this.form.checkItem="privateProgramType"===t?null===(e=this.getRelProcess_3Data.privateOptions[0])||void 0===e?void 0:e.value:void 0})}};Object(J.a)([Object(tt.a)("setLoading")],Ba.prototype,"setLoading",void 0),Object(J.a)([Va.Getter("getDetailData")],Ba.prototype,"getDetailData",void 0),Object(J.a)([Va.Action("setrelProcess3")],Ba.prototype,"setrelProcess3",void 0),Object(J.a)([Va.Action("delRelProcess3")],Ba.prototype,"delRelProcess3",void 0),Object(J.a)([Va.Getter("getRelProcess_3")],Ba.prototype,"getRelProcess_3",void 0),Object(J.a)([Va.Getter("getRelProcess_3Data")],Ba.prototype,"getRelProcess_3Data",void 0),Object(J.a)([Va.Getter("getCheckValidation")],Ba.prototype,"getCheckValidation",void 0),Object(J.a)([Va.Action("clearCheckValidation")],Ba.prototype,"clearCheckValidation",void 0),Object(J.a)([qa.Action("setModalState")],Ba.prototype,"setModalState",void 0),Object(J.a)([Va.Getter("getAccountAgentList")],Ba.prototype,"getAccountAgentList",void 0),Object(J.a)([Object(et.b)()],Ba.prototype,"dataTypeStr",void 0),Object(J.a)([Object(et.e)("form.auditType",{deep:!0})],Ba.prototype,"watchForm",null),Ba=Object(J.a)([Object(et.a)({components:{CustomPopConfirm:ce}})],Ba);var za=Ba,Ha=(a("e00c"),Object(st.a)(za,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit__page"},[a("div",{staticClass:"audit__header d-flex align-items-center mb-2"},[a("h4",{staticClass:"mb-0"},[t._v(" 查核項目 ")]),t.isEdit?a("a-form-model-item",{staticClass:"ms-3 me-2"},[a("a-radio-group",{attrs:{options:t.auditTypeOptions},model:{value:t.form.auditType,callback:function(e){t.$set(t.form,"auditType",e)},expression:"form.auditType"}})],1):t._e(),t.isEdit?a("a-form-model-item",[a("a-select",{staticClass:"audit__header__select ms-1",attrs:{disabled:"privateProgramType"!==t.form.auditType,placeholder:"privateProgramType"===t.form.auditType?"請選擇查核項目":"",options:t.getRelProcess_3Data.privateOptions,"dropdown-match-select-width":!1},model:{value:t.form.checkItem,callback:function(e){t.$set(t.form,"checkItem",e)},expression:"form.checkItem"}})],1):t._e()],1),a("div",{staticClass:"audit__container",class:{disabled:!t.isEdit}},[a("div",{staticClass:"audit__sideWrap"},[t.auditTypeOriginData&&t.auditTypeOriginData.length>0?a("ul",{staticClass:"audit__sideMenu"},[t.isEdit?[t._l(t.selectAuditArr,(function(e){return a("li",{key:e.auditProgramSectionId,staticClass:"audit__sideMenu__item d-flex align-items-center audit__sideMenu__item--selected",on:{click:function(a){return t.onAddSelectAudit(e)}}},[a("a-icon",{staticClass:"audit__sideMenu__icon",attrs:{type:"check"}}),t._v(" "+t._s(t.get_selectAuditDetail(e).sectionName+" ("+("公版"!==t.get_selectAuditDetail(e).auditItemName?"專屬 ":"")+t.get_selectAuditDetail(e).auditItemName+")")+" ")],1)})),t._l(t.auditTypeOriginData.filter((function(e){return!t.selectAuditArr.includes(e.auditProgramSectionId)})),(function(e){return a("li",{key:e.auditProgramSectionId,staticClass:"audit__sideMenu__item d-flex align-items-center",class:{audit__borderTop:t.selectAuditArr.length>0},on:{click:function(a){return t.onAddSelectAudit(e.auditProgramSectionId)}}},[a("a-icon",{staticClass:"audit__sideMenu__icon",attrs:{type:"check"}}),t._v(" "+t._s(e.sectionName)+" ")],1)}))]:t._l(t.getRelProcess_3Data.flat,(function(e){return a("li",{key:e.auditProgramSectionId,staticClass:"audit__sideMenu__item d-flex align-items-center",class:{audit__borderTop:t.selectAuditArr.length>0,"audit__sideMenu__item--selected":t.selectAuditArr.includes(e.auditProgramSectionId)},on:{click:function(a){return t.onAddSelectAudit(e.auditProgramSectionId)}}},[a("a-icon",{staticClass:"audit__sideMenu__icon",attrs:{type:"check"}}),t._v(" "+t._s(e.sectionName+" ("+("公版"!==e.auditItemName?"專屬 ":"")+e.auditItemName+")")+" ")],1)}))],2):t._e(),t.isEdit?a("div",{staticClass:"audit__sideAddControlWrap d-flex align-items-start",class:{"mt-3":t.auditTypeOriginData&&t.auditTypeOriginData.length>0}},[a("span",{staticClass:"audit__sideAddControl__title"},[t._v("新增Section")]),a("a-form-item",{staticClass:"audit__sideAddControl__input",attrs:{"validate-status":t.auditSideAddError?"error":"",help:t.auditSideAddError?"不得為空":null}},[a("a-input",{on:{change:function(e){t.auditSideAddError=!1}},model:{value:t.addAuditInput,callback:function(e){t.addAuditInput=e},expression:"addAuditInput"}})],1),a("a-button",{staticClass:"audit__sideAddControl__btn btn--primary",on:{click:t.onSaveSideMenu}},[t._v(" 儲存 ")])],1):t._e()]),a("div",{staticClass:"audit__textareaGroup"},[t.selectAuditArr&&t.selectAuditArr.length>0?a("a-collapse",{model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},t._l(t.selectAuditArr,(function(e){return a("a-collapse-panel",{key:e,attrs:{header:t.get_selectAuditDetail(e).sectionName+" ("+("公版"!==t.get_selectAuditDetail(e).auditItemName?"專屬 ":"")+t.get_selectAuditDetail(e).auditItemName+")","show-arrow":!1}},[a("ul",t._l(t.get_activeDetail(e),(function(e,i){return a("li",{key:i,staticClass:"textarea__item"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"main__textarea col"},["A"==t.dataTypeStr?a("a-form-model",{staticClass:"audit__actGroup d-flex align-items-center ms-auto"},[a("a-form-model-item",[a("a-input",{attrs:{disabled:!t.isEdit},model:{value:e.relContent.article,callback:function(a){t.$set(e.relContent,"article",a)},expression:"itemLi.relContent.article"}})],1),a("p",{staticClass:"audit__actUnit"},[t._v(" 條 ")]),a("a-form-model-item",[a("a-input",{attrs:{disabled:!t.isEdit},model:{value:e.relContent.paragraph,callback:function(a){t.$set(e.relContent,"paragraph",a)},expression:"itemLi.relContent.paragraph"}})],1),a("p",{staticClass:"audit__actUnit"},[t._v(" 項 ")]),a("a-form-model-item",[a("a-input",{attrs:{disabled:!t.isEdit},model:{value:e.relContent.subparagraph,callback:function(a){t.$set(e.relContent,"subparagraph",a)},expression:"itemLi.relContent.subparagraph"}})],1),a("p",{staticClass:"audit__actUnit"},[t._v(" 款 ")]),a("a-form-model-item",[a("a-input",{attrs:{disabled:!t.isEdit},model:{value:e.relContent.item,callback:function(a){t.$set(e.relContent,"item",a)},expression:"itemLi.relContent.item"}})],1),a("p",{staticClass:"audit__actUnit"},[t._v(" 目 ")])],1):t._e(),a("a-form-item",{staticClass:"audit__textarea__input w-100 m-0",attrs:{"validate-status":t.getCheckValidation.view3.includes(e.dataRelId)?"error":""}},[a("a-textarea",{staticClass:"audit__textarea",attrs:{rows:2,disabled:!t.isEdit},on:{change:function(a){return t.clearCheckValidation({key:"3",auditItem:e.dataRelId})}},model:{value:e.relContent.content,callback:function(a){t.$set(e.relContent,"content",a)},expression:"itemLi.relContent.content"}})],1),t.getCheckValidation.view3.includes(e.dataRelId)?a("p",{key:"contentError"+i,staticClass:"text-end message--error"},[t._v(" 不得為空 ")]):t._e()],1),a("div",{staticClass:"textarea__control d-flex align-items-start"},[t.isEdit?a("button",{staticClass:"btn__icon btn__icon--add_project",on:{click:function(e){return t.addTextareaArr(t.getRelProcess_3,i)}}}):t._e(),t.isEdit?a("CustomPopConfirm",{on:{confirm:function(a){return t.removeTextareaArr(t.getRelProcess_3,e)}}},[a("button",{staticClass:"btn__icon btn__icon--delete-action"})]):t._e()],1)])])})),0)])})),1):t._e()],1)])])}),[],!1,null,"ae202442",null).exports);let Qa=class extends et.d{constructor(){super(...arguments),this.grid={rowKey:"attachmentId",data:[],pagination:!1,columns:[{type:Re.TEMPLATE,template:"handleDownload",property:"fileName",title:"檔案清單"},{type:Re.PLAIN,property:"createUserName",title:"上傳人員"},{type:Re.PLAIN,property:"createDateTime",title:"上傳日期",formatter:t=>this.$twDateTimeFormatter.stringify(t.createDateTime)}]}}getApi_GetAttachment(){this.setLoading(!0),this.$dataCollectApi.getAttachmentUsingGET(this.crawlerDataId).then(t=>{this.grid.data=t.data.result}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}onDownload({data:{attachmentId:t,fileName:e}}){this.setLoading(!0),this.$dataCollectApi.downloadAttachmentInDataCollectUsingGET(t,{responseType:"blob"}).then(t=>{const a=document.createElement("a"),i=(window.URL||window.webkitURL).createObjectURL(t.data),s=e;a.setAttribute("href",i),a.setAttribute("download",""+s),a.click(),a.remove()}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}created(){this.getApi_GetAttachment()}};Object(J.a)([Object(tt.a)("setLoading")],Qa.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Qa.prototype,"crawlerDataId",void 0),Qa=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt}})],Qa);var Wa=Qa,Ka=(a("700b"),Object(st.a)(Wa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("FblDataGrid",{attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:t.grid.pagination,"empty-data":t.grid.data.length<=0},scopedSlots:t._u([{key:"handleDownload",fn:function(e){return[a("div",{staticClass:"d-flex"},[a("a",{staticClass:"docLink",on:{click:function(a){return t.onDownload(e)}}},[t._v(" "+t._s(e.data.fileName)+" ")])])]}}])})}),[],!1,null,"4573397c",null).exports);const Ja=Object(tt.c)("crawlerDataDetailVuex");let Za=class extends et.d{constructor(){super(...arguments),this.grid={rowKey:"rowkey",data:[],scroll:{x:"auto"},pagination:!1,columns:[{type:Re.PLAIN,property:"operate",title:"執行動作"},{type:Re.PLAIN,property:"updateUser",title:"異動人員"},{type:Re.PLAIN,property:"updateDatetime",title:"異動日期",formatter:t=>this.$twDateTimeFormatter.stringify(t.updateDatetime)},{type:Re.PLAIN,property:"remark",title:"處理意見"}]},this.groupArr=[]}getApi_GetDataLogt(){this.setLoading(!0),this.$dataCollectApi.getDataLogUsingGET(this.crawlerDataId).then(t=>{this.grid.data=t.data.result,this.grid.data.map(t=>{t.rowkey=mt.a.v4()})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}created(){this.getApi_GetDataLogt()}watchDetailData(t){this.$nextTick(()=>{this.getApi_GetDataLogt()})}};Object(J.a)([Object(tt.a)("setLoading")],Za.prototype,"setLoading",void 0),Object(J.a)([Ja.Getter("getDetailData")],Za.prototype,"getDetailData",void 0),Object(J.a)([Ja.State("detailData")],Za.prototype,"detailData",void 0),Object(J.a)([Object(et.b)()],Za.prototype,"crawlerDataId",void 0),Object(J.a)([Object(et.e)("detailData",{deep:!0})],Za.prototype,"watchDetailData",null),Za=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt}})],Za);var Xa=Za,ti=(a("b0a2"),Object(st.a)(Xa,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("FblDataGrid",{attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:t.grid.pagination,"empty-data":t.grid.data.length<=0,scroll:t.grid.scroll}})}),[],!1,null,"233a96ba",null).exports);const ei=Object(tt.c)("crawlerDataDetailVuex");let ai=class extends et.d{constructor(){super(...arguments),this.$dataGroupId=""}auditorContentObj(t,e){var a;return{dataRelId:t.dataRelId||"",dataGroupId:t.dataGroupId||"",dataGroupLogId:t.dataGroupLogId||"",operate:t.operate||"modify",relProcess:e,relId:t.relId||"",relItem:t.relItem||"",auditItem:t.auditItem||"",auditItemName:t.auditItemName||"",relContent:t.relContent||{content:"",article:"",paragraph:"",subparagraph:"",item:"",seq:(null===(a=t.relContent)||void 0===a?void 0:a.seq)||0}}}get currentView(){return"ControlCurrentView"+this.activeTab}async getRelProcess_3(){this.getApi_searchSection()}getApi_getAuditSideMenuArr(){this.setLoading(!0),this.$dataCollectApi.getAuditorItemInDataCollectUsingGET().then(async t=>{const e=t.data.result,a=await this.getApi_searchAuditorContent(),i=this.$global.deepCopyData(e),s=this.$global.deepCopyData(e);i.map((t,e)=>{const s=a.filter(t=>"1"===t.relProcess).find(e=>e.auditItem===t.auditItem);i[e]=s?this.auditorContentObj({...s,auditItemName:t.auditItemName},"1"):this.auditorContentObj({...t,dataGroupId:this.getDetailData.dataGroupId},"1")}),s.map((t,e)=>{const i=a.filter(t=>"2"===t.relProcess).find(e=>e.auditItem===t.auditItem);s[e]=i?this.auditorContentObj({...i,auditItemName:t.auditItemName},"2"):this.auditorContentObj({...t,dataGroupId:this.getDetailData.dataGroupId},"2")}),this.setrelProcess({relProcess_1:i,relProcess_2:s})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getApi_searchSection(){this.setLoading(!0),this.$dataCollectApi.searchSectionUsingPOST().then(async t=>{const e=t.data.result,a=(await this.getApi_searchAuditorContent()).filter(t=>"3"===t.relProcess);a.sort((t,e)=>t.relContent.seq-e.relContent.seq);const i=this.$global.deepCopyData(e);Object.keys(i).map((t,e)=>{i[t].map(t=>{const e=a.find(e=>e.relItem===t.auditProgramSectionId);t.operate=e?"add":"modify",t.auditItemName=t.auditItemName||"公版"})}),this.setrelProcess({relProcess_3_origin:this.$global.deepCopyData(i)}),a.map(t=>{this.setrelProcess3(t)})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}async getApi_searchAuditorContent(){return this.setLoading(!0),this.$dataCollectApi.getAuditorContentInDataCollectUsingGET(this.getDetailData.dataGroupId).then(t=>t.data.result).catch(t=>{}).finally(()=>{this.setLoading(!1)})}resetSearchSection(){this.getApi_searchSection()}destroyed(){this.delAllRelProcess()}watchGetDetailData(t){t&&(this.getApi_getAuditSideMenuArr(),this.getRelProcess_3())}watchGetUpdate(t){t&&(this.getApi_getAuditSideMenuArr(),this.updated({relProcess:!1}))}};Object(J.a)([Object(tt.a)("setLoading")],ai.prototype,"setLoading",void 0),Object(J.a)([ei.Action("setDetailData")],ai.prototype,"setDetailData",void 0),Object(J.a)([ei.Action("setrelProcess")],ai.prototype,"setrelProcess",void 0),Object(J.a)([ei.Action("setrelProcess3")],ai.prototype,"setrelProcess3",void 0),Object(J.a)([ei.Getter("getUpdate")],ai.prototype,"getUpdate",void 0),Object(J.a)([ei.Action("updated")],ai.prototype,"updated",void 0),Object(J.a)([ei.Action("delAllRelProcess")],ai.prototype,"delAllRelProcess",void 0),Object(J.a)([ei.Getter("getDetailData")],ai.prototype,"getDetailData",void 0),Object(J.a)([Object(et.b)()],ai.prototype,"dataTypeStr",void 0),Object(J.a)([Object(et.b)()],ai.prototype,"activeTab",void 0),Object(J.a)([Object(et.b)()],ai.prototype,"crawlerDataId",void 0),Object(J.a)([Object(et.e)("getDetailData.dataGroupId",{immediate:!0})],ai.prototype,"watchGetDetailData",null),Object(J.a)([Object(et.e)("getUpdate.relProcess")],ai.prototype,"watchGetUpdate",null),ai=Object(J.a)([Object(et.a)({components:{ControlCurrentView1:Fa,ControlCurrentView2:Na,ControlCurrentView3:Ha,ControlCurrentView4:Ka,ControlCurrentView5:ti}})],ai);var ii=ai,si=(a("68f8"),Object(st.a)(ii,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("KeepAlive",[t.currentView?a(t.currentView,{tag:"component",attrs:{"crawler-data-id":t.crawlerDataId,"data-type-str":t.dataTypeStr},on:{resetSearchSection:t.resetSearchSection}}):t._e()],1)}),[],!1,null,"4477b960",null).exports);const oi=Object(tt.c)("crawlerDataDetailVuex");let ni=class extends et.d{get roleId(){return this.$global.getCurrentRoleId()}get confirmIsMe(){const t=this.$user.getMe().employee.domainId,e=this.getDetailData.confrimUser;return[t,...this.getAccountAgentList].includes(e)}get confirmStatus(){return this.getDetailData.groupStatus}};Object(J.a)([oi.Getter("getDetailData")],ni.prototype,"getDetailData",void 0),Object(J.a)([oi.Getter("getAccountAgentList")],ni.prototype,"getAccountAgentList",void 0),ni=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,CustomPopConfirm:ce}})],ni);var ri=ni,li=Object(st.a)(ri,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.roleId&&t.confirmStatus?["ROLE_Auditor"===t.roleId&&"A"===t.confirmStatus?[a("CustomPopConfirm",{attrs:{title:"確認覆核？"},on:{confirm:function(e){return t.$emit("click","submitReview")}}},[a("IconTextButton",{staticClass:"m-2",attrs:{text:"送出覆核",type:"edit"}})],1),a("IconTextButton",{staticClass:"m-2",attrs:{text:"暫存",type:"save"},on:{click:function(e){return t.$emit("click","save")}}}),a("IconTextButton",{staticClass:"m-2",attrs:{text:"非本組認列",type:"close"},on:{click:function(e){return t.$emit("click","notInGroup")}}})]:t._e(),"ROLE_Audit_Team_Head"===t.roleId?["A"===t.confirmStatus?[t.confirmIsMe?[a("CustomPopConfirm",{attrs:{title:"確認送出？"},on:{confirm:function(e){return t.$emit("click","submitReview")}}},[a("IconTextButton",{staticClass:"m-2",attrs:{text:"送出",type:"edit"}})],1),a("IconTextButton",{staticClass:"m-2",attrs:{text:"暫存",type:"save"},on:{click:function(e){return t.$emit("click","save")}}})]:t._e(),a("IconTextButton",{staticClass:"m-2",attrs:{text:"認列送出",type:"enter"},on:{click:function(e){return t.$emit("click","inGroup")}}}),a("IconTextButton",{staticClass:"m-2",attrs:{text:"非本組認列",type:"close"},on:{click:function(e){return t.$emit("click","notInGroup")}}})]:t._e(),"B"===t.confirmStatus?[a("IconTextButton",{staticClass:"m-2",attrs:{text:"通過",type:"enter"},on:{click:function(e){return t.$emit("click","sussess")}}}),a("IconTextButton",{staticClass:"m-2",attrs:{text:"退回",type:"feedback"},on:{click:function(e){return t.$emit("click","reject")}}})]:t._e()]:t._e(),"ROLE_Audit_Department_Head"===t.roleId?[[a("IconTextButton",{staticClass:"m-2",attrs:{text:"通過",type:"enter"},on:{click:function(e){return t.$emit("click","sussess")}}}),a("IconTextButton",{staticClass:"m-2",attrs:{text:"退回",type:"feedback"},on:{click:function(e){return t.$emit("click","reject")}}})]]:t._e()]:t._e(),a("IconTextButton",{staticClass:"m-2",attrs:{text:"上一頁",type:"return"},on:{click:function(e){return t.$emit("click","back")}}})],2)}),[],!1,null,"2c026414",null).exports;const ci=Object(tt.c)("modalControl"),di=Object(tt.c)("crawlerDataDetailVuex");let ui=class extends et.d{constructor(){super(...arguments),this.msg=""}get isConfirm(){return"confirm"===this.getReviewCommitModal.type}get typeStr(){return this.isConfirm?"通過":"退回"}reset(){this.msg=""}getApi_DataConfirm(t){this.setLoading(!0);const e=this.getConfirmData;e.agree=t,e.remark=this.msg,e.roleId=null,this.$dataCollectApi.dataConfirmInDataCollectUsingPOST(e).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:`覆核${this.typeStr}成功`,autoClose:3}}),this.$router.go(-1)}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:`覆核${this.typeStr}失敗`}})}).finally(()=>{this.setLoading(!1)})}closeModal(){this.setDetailModalState({reviewCommitModal:{visible:!1}})}addResponseMessage(t){this.msg+=t}async submit(){await this.getApi_DataConfirm(this.isConfirm),this.closeModal()}watchVisible(){this.reset()}};Object(J.a)([Object(tt.a)("setLoading")],ui.prototype,"setLoading",void 0),Object(J.a)([ci.Action("setModalState")],ui.prototype,"setModalState",void 0),Object(J.a)([di.Action("setDetailModalState")],ui.prototype,"setDetailModalState",void 0),Object(J.a)([di.Getter("getReviewCommitModal")],ui.prototype,"getReviewCommitModal",void 0),Object(J.a)([di.Getter("getConfirmData")],ui.prototype,"getConfirmData",void 0),Object(J.a)([Object(et.e)("getReviewCommitModal.visible")],ui.prototype,"watchVisible",null),ui=Object(J.a)([Object(et.a)({components:{InfoModal:_t,ResponseMessage:Le}})],ui);var pi=ui,mi=(a("b93d"),Object(st.a)(pi,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"審核"+t.typeStr,visible:t.getReviewCommitModal.visible,centered:!0,width:950},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"modal__main"},[i("div",{staticClass:"modal__main__header d-flex align-items-end justify-content-between"},[i("div",{staticClass:"main__header__label"},[t._v(" "+t._s(t.typeStr)+"意見： ")])]),i("div",{staticClass:"confirm-message"},[i("div",{staticClass:"main__header__icon"},[t.isConfirm?i("img",{staticClass:"img-fluid",attrs:{src:a("5430")}}):i("img",{staticClass:"img-fluid",attrs:{src:a("e536")}})]),i("a-textarea",{staticClass:"audit__textarea",attrs:{placeholder:"請詳細填寫內容",rows:11},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}})],1)]),i("ResponseMessage",{staticClass:"content__msg ps-2",on:{select:t.addResponseMessage}})],1),i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],2)}),[],!1,null,"2b19cfdc",null).exports);let hi=class extends et.d{constructor(){super(...arguments),this.form={confirmUser:null,crawlerDataId:null,group:null,applyRemark:""},this.formRules={confirmUser:[{required:!0,message:"請選擇資料確認人員",trigger:"change"}]},this.confirmUserList=null,this.currentRole=null}onIsClaimChanged(t){t&&this.getAuditorTeam()}async getAuditorTeam(){this.setLoading(!0),this.currentRole=await this.$global.getCurrentRole();const t={roleId:this.currentRole.id,unitCode:this.currentRole.roleUnits&&this.currentRole.roleUnits.length>0&&this.currentRole.roleUnits[0].auditorTeamCode};this.$dataCollectApi.getAuditorTeamInDataCollectUsingPOST(t).then(t=>{this.confirmUserList=t.data.result}).catch(console.error).finally(()=>{this.setLoading(!1)})}submit(){this.$refs.formRef.validate(t=>{t&&(this.isClaim?this.$emit("claim",this.form.confirmUser):this.$emit("notClaim",this.form.applyRemark))})}clearForm(){this.form={confirmUser:null,crawlerDataId:null,group:null,applyRemark:""}}closeModal(){this.$emit("closeModal")}addResponseMessage(t){this.form.applyRemark+=t}};Object(J.a)([Object(tt.a)("setLoading")],hi.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],hi.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],hi.prototype,"isClaim",void 0),Object(J.a)([Object(et.b)()],hi.prototype,"crawlerDataId",void 0),Object(J.a)([Object(et.e)("isClaim",{immediate:!0,deep:!0})],hi.prototype,"onIsClaimChanged",null),hi=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t,ResponseMessage:Le}})],hi);var fi=hi,gi=(a("b35c"),Object(st.a)(fi,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:t.isClaim?"資料蒐集(認列)":"資料蒐集(非本組認列)",visible:t.visible,centered:!0,width:t.isClaim?460:950},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("fragment",[i("div",{staticClass:"d-flex"},[i("a-form-model",{ref:"formRef",staticClass:"mt-4 form--light content__form",attrs:{model:t.form,rules:t.formRules,"hide-required-mark":!0}},[t.isClaim?i("a-form-model-item",{attrs:{prop:"confirmUser","label-col":{span:7},"wrapper-col":{span:17}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 資料確認人員 ")]),i("a-select",{staticClass:"input--select",model:{value:t.form.confirmUser,callback:function(e){t.$set(t.form,"confirmUser",e)},expression:"form.confirmUser"}},t._l(t.confirmUserList,(function(e){return i("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1):t._e(),t.isClaim?t._e():i("a-form-model-item",{attrs:{prop:"message","label-col":{span:24},"wrapper-col":{span:24}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 簽核意見： ")]),i("div",{staticClass:"confirm-message"},[i("img",{staticClass:"confirm-message__img",attrs:{src:t.isClaim?a("5430"):a("e536"),alt:""}}),i("a-textarea",{attrs:{"auto-size":{minRows:14}},model:{value:t.form.applyRemark,callback:function(e){t.$set(t.form,"applyRemark",e)},expression:"form.applyRemark"}})],1)])],1),t.isClaim?t._e():i("ResponseMessage",{staticClass:"content__msg ps-2",on:{select:t.addResponseMessage}})],1),i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],1)],2)}),[],!1,null,"55a69d67",null).exports);const bi=Object(tt.c)("crawlerDataDetailVuex"),vi=Object(tt.c)("modalControl");let _i=class extends et.d{constructor(){super(...arguments),this.h=this.$createElement,this.tabsArr=[{id:"1",title:"年度稽核計畫"},{id:"2",title:"查核行前規劃"},{id:"3",title:"工作底稿"},{id:"4",title:"資料檔案"},{id:"5",title:"歷程"}],this.confirmGroup="",this.crawlerDataId="",this.activeTab="1"}get getTabsArr(){return["ROLE_Audit_Department_Head","ROLE_Audit_Office_Boss_Vice","ROLE_Audit_Office_Boss"].includes(this.$global.getCurrentRole().id)?(this.activeTab="4",this.tabsArr.filter(t=>"4"===t.id||"5"===t.id)):this.tabsArr}get dataTypeStr(){return this.getDetailData.caseType?Object.keys(this.getDetailData.caseType)[0]:""}setParam(){const t=this.$global.getQuery();t&&(this.crawlerDataId=t.crawlerDataId)}getApi_getDataTypeInData(){this.setLoading(!0),this.$dataCollectApi.getDataTypeInDataCollectUsingGET().then(t=>{const e=t.data;this.setEnumData({dataTypeEnum:e.result})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getApi_GetAttachment(){this.setLoading(!0),this.$dataCollectApi.getDataCollectDetailInDataCollectUsingGET(this.crawlerDataId).then(t=>{const e=t.data;this.setDetailData({crawlerData:e.result})}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getApi_SendClaimInData(t){this.setLoading(!0);const e={confirmUser:t,crawlerDataId:[this.crawlerDataId],group:this.currentRole.roleUnits[0].auditorTeamCode};this.$dataCollectApi.sendClaimInDataCollectUsingPOST(e).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"資料蒐集(認列)成功",autoClose:3}}),this.$refs.claimFormRef.clearForm(),this.emitBack(),this.closeClaimFormModal(),this.setModalState({resultModal:{visible:!1}})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集(認列)失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_NotClaimInData(t){this.setLoading(!0);const e={applyRemark:t,crawlerDataId:[this.crawlerDataId],group:this.currentRole.roleUnits[0].auditorTeamCode};this.$dataCollectApi.notClaimInDataCollectUsingPOST(e).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"資料蒐集(非本組認列)成功",autoClose:3}}),this.$refs.claimFormRef.clearForm(),this.emitBack(),this.closeClaimFormModal(),this.setModalState({resultModal:{visible:!1}})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集(非本組認列)失敗"}})}).finally(()=>{this.setLoading(!1)})}async getApi_DataSubmitInData(){this.setCheckValidation();const t=this.getSubmitData.dataRelVO.filter(t=>"1"===t.relProcess&&""===t.relContent.content.trim()),e=this.getSubmitData.dataRelVO.filter(t=>"2"===t.relProcess&&""===t.relContent.content.trim()),a=this.getSubmitData.dataRelVO.filter(t=>"3"===t.relProcess&&""===t.relContent.content.trim());if([...this.getCheckValidation.view1,...this.getCheckValidation.view2,...this.getCheckValidation.view3].length>0)return this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集送出失敗",contentHtml:t.length>0||e.length>0?`<ul style="list-style:disc; white-space: initial; color:red;">\n  \t\t\t\t\t${t.length>0?"<li>年度稽核計畫，已勾選的查核項目，內容必填</li>":""}\n  \t\t\t\t\t${e.length>0?"<li>查核行前規劃，已勾選的查核項目，內容必填</li>":""}\n  \t\t\t\t\t${a.length>0?"<li>工作底稿，已勾選的Section內的查核程式，內容必填</li>":""}\n  \t\t\t\t</ul>`:null}}),!1;this.setLoading(!0);const i=await this.getSubmitData;this.$dataCollectApi.dataSubmitInDataCollectUsingPOST(i).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"資料蒐集送出成功",autoClose:3}}),this.emitBack()}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集送出失敗"}})}).finally(()=>{this.setLoading(!1)})}async getApi_SaveTemp(){this.setCheckValidation();const t=this.getSubmitData.dataRelVO.filter(t=>"1"===t.relProcess&&""===t.relContent.content.trim()),e=this.getSubmitData.dataRelVO.filter(t=>"2"===t.relProcess&&""===t.relContent.content.trim()),a=this.getSubmitData.dataRelVO.filter(t=>"3"===t.relProcess&&""===t.relContent.content.trim());if([...this.getCheckValidation.view1,...this.getCheckValidation.view2,...this.getCheckValidation.view3].length>0)return this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集暫存失敗",contentHtml:t.length>0||e.length>0||a.length>0?`<ul style="list-style:disc; white-space: initial; color:red;">\n  \t\t\t\t\t${t.length>0?"<li>年度稽核計畫，已勾選的查核項目，內容必填</li>":""}\n  \t\t\t\t\t${e.length>0?"<li>查核行前規劃，已勾選的查核項目，內容必填</li>":""}\n\t\t\t\t\t\t${a.length>0?"<li>工作底稿，已勾選的Section內的查核程式，內容必填</li>":""}\n  \t\t\t\t</ul>`:null}}),!1;this.setLoading(!0);const i=await this.getSaveData;this.$dataCollectApi.saveTempInDataCollectUsingPOST(i).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"資料蒐集暫存成功",autoClose:3}})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"資料蒐集暫存失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_accountAgent(){this.setLoading(!0),this.$accountAgentApi.searchPrincipalUsingPOST().then(t=>{this.setAccountAgentList(t.data.result)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}emitClick(t){switch(t){case"sussess":this.setDetailModalState({reviewCommitModal:{visible:!0,type:"confirm"}});break;case"reject":this.setDetailModalState({reviewCommitModal:{visible:!0,type:"reject"}});break;case"submitReview":this.getApi_DataSubmitInData();break;case"save":this.getApi_SaveTemp();break;case"inGroup":this.setDetailModalState({claimFormModal:{visible:!0,isClaim:!0}});break;case"notInGroup":this.setDetailModalState({claimFormModal:{visible:!0,isClaim:!1}});break;case"back":this.emitBack()}}emitBack(){this.$router.go(-1)}closeClaimFormModal(){this.setDetailModalState({claimFormModal:{visible:!1}})}tabChange(t){this.activeTab=t}async created(){this.currentRole=await this.$global.getCurrentRole(),this.setParam(),this.getApi_accountAgent(),await this.getApi_GetAttachment()}destroyed(){"CrawlerDataDetail"!==this.$route.name&&this.$global.clearParam()}watchGetDataTypeEnum(t){t||this.getApi_getDataTypeInData()}};Object(J.a)([Object(tt.a)("setLoading")],_i.prototype,"setLoading",void 0),Object(J.a)([bi.Action("setDetailData")],_i.prototype,"setDetailData",void 0),Object(J.a)([bi.Getter("getGroupOptions")],_i.prototype,"getGroupOptions",void 0),Object(J.a)([bi.Getter("getDetailData")],_i.prototype,"getDetailData",void 0),Object(J.a)([bi.Getter("getConfirmGroupFormShow")],_i.prototype,"getConfirmGroupFormShow",void 0),Object(J.a)([vi.Action("setModalState")],_i.prototype,"setModalState",void 0),Object(J.a)([bi.Action("setDetailModalState")],_i.prototype,"setDetailModalState",void 0),Object(J.a)([bi.Getter("getClaimFormModal")],_i.prototype,"getClaimFormModal",void 0),Object(J.a)([bi.Getter("getDataTypeEnum")],_i.prototype,"getDataTypeEnum",void 0),Object(J.a)([bi.Action("setEnumData")],_i.prototype,"setEnumData",void 0),Object(J.a)([bi.Getter("getSubmitData")],_i.prototype,"getSubmitData",void 0),Object(J.a)([bi.Getter("getSaveData")],_i.prototype,"getSaveData",void 0),Object(J.a)([bi.Action("setCheckValidation")],_i.prototype,"setCheckValidation",void 0),Object(J.a)([bi.Getter("getCheckValidation")],_i.prototype,"getCheckValidation",void 0),Object(J.a)([bi.Action("setAccountAgentList")],_i.prototype,"setAccountAgentList",void 0),Object(J.a)([Object(et.e)("getDataTypeEnum",{immediate:!0})],_i.prototype,"watchGetDataTypeEnum",null),_i=Object(J.a)([Object(et.a)({components:{AccordionArea:_e,CrawlerDataTypeChange:Pa,ControlCurrentViewChange:si,ActionBar:li,ConfirmGroupForm:qt,ReviewCommitModal:mi,ClaimForm:gi}})],_i);var yi=_i,Ci=(a("7ff9"),Object(st.a)(yi,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"crawlerDetail-container container"},[a("AccordionArea",[t.crawlerDataId?a("CrawlerDataTypeChange",{ref:"crawlerDataDetail",attrs:{"prop-data":t.getDetailData,"crawler-data-id":t.crawlerDataId}}):t._e()],1),a("div",{staticClass:"controlBar d-flex flex-wrap-reverse"},[a("div",{staticClass:"tabGroup d-flex flex-wrap"},t._l(t.getTabsArr,(function(e,i){return a("button",{key:i,staticClass:"tabGroup__item",class:{"tabGroup__item--active":t.activeTab==e.id},on:{click:function(a){return t.tabChange(e.id)}}},[t._v(" "+t._s(e.title)+" ")])})),0),a("div",{staticClass:"btnGroup ms-auto"},[a("ActionBar",{on:{click:t.emitClick}})],1)]),a("div",{staticClass:"controlMain__container"},[t.crawlerDataId?a("ControlCurrentViewChange",{attrs:{"data-type-str":t.dataTypeStr,"crawler-data-id":t.crawlerDataId,"active-tab":t.activeTab}}):t._e()],1),a("ConfirmGroupForm",{attrs:{"default-select":t.getDetailData.claimGroup,"crawler-data-id":t.crawlerDataId}}),a("ReviewCommitModal"),a("ClaimForm",{ref:"claimFormRef",attrs:{visible:t.getClaimFormModal.visible,"is-claim":t.getClaimFormModal.isClaim},on:{closeModal:t.closeClaimFormModal,claim:t.getApi_SendClaimInData,notClaim:t.getApi_NotClaimInData}})],1)}),[],!1,null,"8d61cbfe",null).exports);let Oi=class extends et.d{actionHandler(t){switch(t){case"addInsidePlan":this.$emit("openModal","addInsidePlan");break;case"addOutsidePlan":this.$emit("openModal","addOutsidePlan")}}};Object(J.a)([Object(et.b)()],Oi.prototype,"role",void 0),Oi=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut}})],Oi);var Ai=Oi,Ii=Object(st.a)(Ai,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,"60f1bbf9",null).exports;let Di=class extends et.d{};Di=Object(J.a)([Object(et.a)({components:{}})],Di);var Si=Di,wi=(a("71f8"),Object(st.a)(Si,(function(){var t=this;t.$createElement;return t._self._c,t._m(0)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"status-bar d-flex"},[a("div",{staticClass:"status-bar__item"},[a("div",{staticClass:"status-bar__item__circle status-bar__item__circle--undo"}),a("div",{staticClass:"status-bar__item__text"},[t._v(" 待處理/未完成 ")])]),a("div",{staticClass:"status-bar__item"},[a("div",{staticClass:"status-bar__item__circle status-bar__item__circle--delay"}),a("div",{staticClass:"status-bar__item__text"},[t._v(" 逾期 ")])]),a("div",{staticClass:"status-bar__item"},[a("div",{staticClass:"status-bar__item__circle status-bar__item__circle--none"}),a("div",{staticClass:"status-bar__item__text"},[t._v(" 無作業 ")])]),a("div",{staticClass:"status-bar__item"},[a("div",{staticClass:"status-bar__item__circle status-bar__item__circle--done"}),a("div",{staticClass:"status-bar__item__text"},[t._v(" 已完成 ")])])])}],!1,null,"00ca4726",null).exports);let ki=class extends et.d{constructor(){super(...arguments),this.dateFormatter=this.$twDateFormatter,this.yearFormatter=this.$twYearFormatter,this.originAuditArr=[],this.selectOption={inCharge:"",auditMenber:[],checkedUnit:[],planGroupInPreparation:[]},this.form={year:null,startMonth:null,endMonth:null,auditType:"",auditItem:"",inCharge:[],auditMenber:[],checkedUnit:[],auditTime:[],member:[],planClass:{plan:"03",classY:null,classN:null}},this.formRules={year:[{required:!0,message:"請選擇年度",trigger:"change"}],startMonth:[{required:!0,message:"請選擇預計查核月份",trigger:"change"},{trigger:"change",validator:this.monthValidator}],auditType:[{required:!0,message:"請輸入查核性質",trigger:"change"}],auditTime:[{required:!0,message:"請選擇查核期間",trigger:"change"}],auditItem:[{required:!0,message:"請輸入查核項目",trigger:"change"}],inCharge:[{required:!0,message:"請選擇領隊人員",trigger:"change"}],auditMenber:[{required:!0,message:"請選擇查核人員",trigger:"change"}],checkedUnit:[{required:!0,message:"請選擇受查單位",trigger:"change"}],"planClass.plan":[{required:!0,message:"請選擇是否加入七大流程",trigger:"change"}]}}get isEdit(){return!!this.initData}get headerTitle(){return(this.isEdit?"編輯":"新增")+"計畫（外）作業"}get mainAucitorTeam(){return this.initData.mainAucitorTeam?this.initData.mainAucitorTeam.auditorTeam:""}get coAucitorTeam(){var t;return this.initData.coAucitorTeam?null===(t=this.initData.coAucitorTeam)||void 0===t?void 0:t.map(t=>t.auditorTeam):""}get isMainAucitorTeam(){return this.mainAucitorTeam===this.$global.getCurrentRoleTeamCode()}get iscoAucitorTeam(){return this.coAucitorTeam.includes(this.$global.getCurrentRoleTeamCode())}monthValidator(t,e,a){void 0===this.form.startMonth||void 0===this.form.endMonth?a("請填入月份"):parseInt(this.form.startMonth,10)>parseInt(this.form.endMonth,10)?a("結束月份不得小於開始月份"):a()}rangeDateValidator(t,e,a){this.form[t.field].some(t=>!t)?a("請填入查核期間"):a()}isDisabledGroup(t){const e=this.$global.getCurrentRoleTeamCode();return!this.isMainAucitorTeam&&t!==e}getApi_searchAuditors(){this.setLoading(!0),this.$preparationApi.searchAuditorsUsingPOST().then(t=>{const e=t.data.result;this.selectOption.auditMenber=e.filter(t=>[this.mainAucitorTeam,...this.coAucitorTeam].includes(t.group)),this.originAuditArr=e,this.originAuditArr.sort((t,e)=>t.group.charCodeAt()-e.group.charCodeAt())}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_yapUnit(){this.setLoading(!0);const t=this.initData.year.toString();this.$preparationApi.searchUnitNameInPreparationUsingGET(t).then(t=>{var e,a;const i=t.data.result;this.selectOption.checkedUnit=[{title:"全部",value:"all",key:"all",children:null===(e=i.validYapUnits)||void 0===e?void 0:e.map(t=>({title:t.value+t.label,value:t.value,key:t.value}))},{title:"無效單位",value:"invalid",key:"invalid",children:null===(a=i.inValidYapUnits)||void 0===a?void 0:a.map(t=>({title:t.value+t.label,value:t.value,key:t.value}))}]}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_searchInsidePlanGroup(){this.setLoading(!0),this.$preparationApi.searchInsidePlanGroupInPreparationUsingGET().then(t=>{const e=t.data.result;this.selectOption.planGroupInPreparation=e.filter(t=>t.value!==this.mainAucitorTeam)}).catch(console.error).finally(()=>{this.setLoading(!1)})}createData(){Promise.all([this.getApi_searchAuditors(),this.getApi_yapUnit()]).then(()=>{var t,e,a;this.form.year=Ca.isValidDate(ya()(this.initData.year).add(1911,"year").format()),this.form.startMonth=this.initData.startMoth,this.form.endMonth=this.initData.endMoth,this.form.auditType=this.initData.auditType,this.form.auditTime=[Ca.isValidDate(ya()(this.initData.ckStartDate).format()),Ca.isValidDate(ya()(this.initData.ckEndDate).format())],this.form.inCharge=null===(t=this.initData.inCharge)||void 0===t?void 0:t.map(t=>t.domainId),this.form.auditMenber=null===(e=this.initData.checkMan)||void 0===e?void 0:e.map(t=>t.domainId),this.form.checkedUnit=null===(a=this.initData.checkedUnit)||void 0===a?void 0:a.map(t=>t.departmentId)})}submit(){this.$refs.formRef.validate(t=>{})}closeModal(){this.$refs.formRef.clearValidate(),this.$emit("closeModal")}changeAuditMenber(){this.form.auditMenber.includes(this.form.inCharge)||(this.form.inCharge=void 0,this.$refs.formRef.validateField("inCharge"))}watchForm(t){}watchVisible(t){t&&this.createData()}};Object(J.a)([Object(tt.a)("setLoading")],ki.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],ki.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],ki.prototype,"initData",void 0),Object(J.a)([Object(et.e)("form",{deep:!0})],ki.prototype,"watchForm",null),Object(J.a)([Object(et.e)("visible")],ki.prototype,"watchVisible",null),ki=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],ki);var Mi=ki,xi=(a("28a9"),Object(st.a)(Mi,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:t.headerTitle,visible:t.visible,centered:!0,width:650,"padding-size":"small"},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("div",[a("div",{staticClass:"form mt-2"},[a("a-form-model",{ref:"formRef",attrs:{model:t.form,rules:t.formRules,"wrapper-col":{span:18,offset:6}}},[a("a-form-model-item",{attrs:{prop:"year","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 年度 ")]),a("date-picker",{staticClass:"w-100",attrs:{formatter:t.yearFormatter,type:"year","allow-clear":!0},model:{value:t.form.year,callback:function(e){t.$set(t.form,"year",e)},expression:"form.year"}})],1),a("a-form-model-item",{ref:"startMonth",attrs:{prop:"startMonth","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 預計查核月份 ")]),a("a-select",{staticClass:"search__result__month search-form__select--month--left",attrs:{options:t.$enum.monthOption,placeholder:"起","dropdown-match-select-width":!1},model:{value:t.form.startMonth,callback:function(e){t.$set(t.form,"startMonth",e)},expression:"form.startMonth"}}),a("a-input",{staticClass:"search-form__range",attrs:{placeholder:"~",disabled:""}}),a("a-select",{staticClass:"search__result__month search-form__select--month--right",attrs:{placeholder:"迄",options:t.$enum.monthOption,"dropdown-match-select-width":!1},on:{change:function(){t.$refs.startMonth.onFieldChange()}},model:{value:t.form.endMonth,callback:function(e){t.$set(t.form,"endMonth",e)},expression:"form.endMonth"}})],1),a("a-form-model-item",{attrs:{prop:"auditType","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核性質 ")]),a("a-input",{staticClass:"w-100",model:{value:t.form.auditType,callback:function(e){t.$set(t.form,"auditType",e)},expression:"form.auditType"}})],1),a("a-form-model-item",{attrs:{prop:"auditTime","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核期間 ")]),a("date-picker",{staticClass:"w-100",attrs:{formatter:t.dateFormatter,range:!0,type:"date","allow-clear":!0},model:{value:t.form.auditTime,callback:function(e){t.$set(t.form,"auditTime",e)},expression:"form.auditTime"}})],1),t.initData?t._e():a("a-form-model-item",{attrs:{prop:"auditItem","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核項目 ")]),a("a-input",{staticClass:"w-100",model:{value:t.form.auditItem,callback:function(e){t.$set(t.form,"auditItem",e)},expression:"form.auditItem"}})],1),a("a-form-model-item",{attrs:{prop:"inCharge","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 領隊人員 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"","show-arrow":!0,"allow-clear":!0,"filter-option":t.$global.filterOption},model:{value:t.form.inCharge,callback:function(e){t.$set(t.form,"inCharge",e)},expression:"form.inCharge"}},t._l(t.selectOption.auditMenber.filter((function(e){return t.form.auditMenber.includes(e.domainId)})),(function(e){return a("a-select-option",{key:e.domainId,attrs:{value:e.domainId}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("a-form-model-item",{attrs:{prop:"auditMenber","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核人員 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"",mode:"multiple","show-arrow":!0,"filter-option":t.$global.filterOption},on:{change:t.changeAuditMenber},model:{value:t.form.auditMenber,callback:function(e){t.$set(t.form,"auditMenber",e)},expression:"form.auditMenber"}},t._l(t.selectOption.auditMenber,(function(e){return a("a-select-option",{key:e.domainId,attrs:{value:e.domainId}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),t.initData?a("a-form-model-item",{attrs:{prop:"checkedUnit","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 受查單位 ")]),a("a-tree-select",{attrs:{mode:"multiple","tree-data":t.selectOption.checkedUnit,"tree-checkable":"","tree-default-expand-all":!0,"tree-node-filter-prop":"title","dropdown-class-name":"treeselect","dropdown-style":{maxHeight:"300px"},"show-arrow":!0,"dropdown-match-select-width":!1,placeholder:"請選擇受查單位"},model:{value:t.form.checkedUnit,callback:function(e){t.$set(t.form,"checkedUnit",e)},expression:"form.checkedUnit"}})],1):t._e()],1)],1),a("div",{staticClass:"d-flex mt-4 justify-content-end"},[a("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" "+t._s(t.initData?"確認":"新增")+" ")]),a("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])])],2)}),[],!1,null,"08d08864",null).exports);const ji=Object(tt.c)("modalControl");let Ti=class extends et.d{constructor(){super(...arguments),this.dateFormatter=this.$twDateFormatter,this.yearFormatter=this.$twYearFormatter,this.originAuditArr=[],this.selectOption={auditType:[],auditItem:[],checkedUnit:[],planGroupInPreparation:[]},this.form={startMonth:"",endMonth:"",auditTime:[],checkMans:[],groupTeams:[],inChargeMan:"",itemDescs:[],quarterPlanMId:""},this.formRules={year:[{required:!0,message:"請選擇年度",trigger:"change"}],startMonth:[{required:!0,message:"請選擇預計查核月份",trigger:"change"},{trigger:"change",validator:this.monthValidator}],auditType:[{required:!0,message:"請選擇查核性質",trigger:"change"}],auditTime:[{required:!0,message:"請選擇查核時間",trigger:"change"},{trigger:"change",validator:this.rangeDateValidator}],auditItem:[{required:!0,message:"請選擇查核項目",trigger:"change"}],checkMans:[{required:!0,message:"請選擇查核人員",trigger:"change"}],inChargeMan:[{required:!0,message:"請選擇領隊人員",trigger:"change"}],itemDescs:[{required:!0,message:"請選擇受查單位",trigger:"change"}]},this.fakeItemOption=[{item:"項目1"},{item:"項目23"},{item:"項木3966"}]}get isEdit(){return!!this.initData}get headerTitle(){return(this.isEdit?"編輯":"新增")+"計畫（內）作業"}get mainAucitorTeam(){return this.initData.mainAucitorTeam?this.initData.mainAucitorTeam.auditorTeam:""}get isMainAucitorTeam(){return this.mainAucitorTeam===this.$global.getCurrentRoleTeamCode()}get iscoAucitorTeam(){return this.form.groupTeams.includes(this.$global.getCurrentRoleTeamCode())}get auditOption(){return this.originAuditArr.filter(t=>[this.mainAucitorTeam,...this.form.groupTeams].includes(t.group))}monthValidator(t,e,a){void 0===this.form.startMonth||void 0===this.form.endMonth?a("請填入月份"):parseInt(this.form.startMonth,10)>parseInt(this.form.endMonth,10)?a("結束月份不得小於開始月份"):a()}rangeDateValidator(t,e,a){this.form[t.field].some(t=>!t)?a("請填入查核期間"):a()}isDisabledGroup(t){const e=this.$global.getCurrentRoleTeamCode();return this.isMainAucitorTeam?![this.mainAucitorTeam,...this.form.groupTeams].includes(t):t!==e}disableDate(t,e){const a=new Date(ya()({year:this.initData.year,month:this.initData.startMoth-1,date:1}).add(1911,"year").format());return t&&t<=ya()(a).subtract(1,"day")}getApi_searchAuditors(){this.setLoading(!0),this.$preparationApi.searchAuditorsUsingPOST().then(t=>{const e=t.data.result;this.originAuditArr=e,this.originAuditArr.sort((t,e)=>t.group.charCodeAt()-e.group.charCodeAt())}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_yapUnit(){this.setLoading(!0);const t=this.initData.year.toString();this.$preparationApi.searchUnitNameInPreparationUsingGET(t).then(t=>{var e,a;const i=t.data.result;this.selectOption.checkedUnit=[{title:"全部",value:"all",key:"all",children:null===(e=i.validYapUnits)||void 0===e?void 0:e.map(t=>({title:t.value+t.label,value:t.value,key:t.value}))},{title:"無效單位",value:"invalid",key:"invalid",children:null===(a=i.inValidYapUnits)||void 0===a?void 0:a.map(t=>({title:t.value+t.label,value:t.value,key:t.value}))}]}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_searchInsidePlanGroup(){this.setLoading(!0),this.$preparationApi.searchInsidePlanGroupInPreparationUsingGET().then(t=>{const e=t.data.result;this.selectOption.planGroupInPreparation=e.filter(t=>t.value!==this.mainAucitorTeam)}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_submitQuarterPlanModify(){const t={checkMans:this.form.checkMans,ckStartDate:ya()(this.form.auditTime[0]).isValid()?ya()(this.form.auditTime[0]).format("YYYY-MM-DD[T]HH:mm:ss[.]SSS[Z]"):"1000-01-01T00:00:00.000Z",ckEndDate:ya()(this.form.auditTime[0]).isValid()?ya()(this.form.auditTime[1]).format("YYYY-MM-DD[T]HH:mm:ss[.]SSS[Z]"):"1000-01-01T00:00:00.000Z",groupTeams:this.form.groupTeams,inChargeMan:this.form.inChargeMan,itemDescs:this.form.itemDescs,quarterPlanMId:this.form.quarterPlanMId};this.$preparationApi.setQuarterPlanUsingPOST(t).then(t=>{this.closeModal(),this.$emit("reload"),this.setModalState({resultModal:{visible:!0,type:"success",title:"儲存成功",autoClose:3}})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"儲存失敗"}})}).finally(()=>{this.setLoading(!1)})}returnTwYearFormatter(t){if(Ca.isValidDate(t))return new Date(ya()(t).add(1911,"year").format())}createData(){Promise.all([this.getApi_searchAuditors(),this.getApi_yapUnit(),this.getApi_searchInsidePlanGroup()]).then(()=>{var t,e,a,i;this.form.auditTime=[this.initData.ckStartDate?this.returnTwYearFormatter(this.initData.ckStartDate):new Date(ya()({year:this.initData.year,month:this.initData.startMoth-1,date:1}).add(1911,"year").format()),this.initData.ckEndDate?this.returnTwYearFormatter(this.initData.ckEndDate):new Date(ya()({year:this.initData.year,month:this.initData.endMoth-1,date:1}).add(1911,"year").format())],this.form.checkMans=null===(t=this.initData.checkMan)||void 0===t?void 0:t.map(t=>t.domainId),this.form.groupTeams=null===(e=this.initData.coAucitorTeam)||void 0===e?void 0:e.map(t=>t.auditorTeam),this.form.inChargeMan=null===(a=this.initData.incharge[0])||void 0===a?void 0:a.domainId,this.form.itemDescs=null===(i=this.initData.checkedUnit)||void 0===i?void 0:i.map(t=>t.departmentId),this.form.quarterPlanMId=this.initData.quarterPlanMId})}submit(){this.$refs.formRef.validate(t=>{t&&this.getApi_submitQuarterPlanModify()})}closeModal(){this.$refs.formRef.clearValidate(),this.$emit("closeModal")}changeAuditMenber(){this.form.checkMans.includes(this.form.inChargeMan)||(this.form.inChargeMan=void 0)}changeInChargeMan(t){t&&this.form.checkMans.length<1&&this.$refs.formRef.validateField("checkMans")}watchVisible(t){t?this.createData():this.$refs.formRef.clearValidate()}};Object(J.a)([Object(tt.a)("setLoading")],Ti.prototype,"setLoading",void 0),Object(J.a)([ji.Action("setModalState")],Ti.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],Ti.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],Ti.prototype,"initData",void 0),Object(J.a)([Object(et.e)("visible")],Ti.prototype,"watchVisible",null),Ti=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],Ti);var Li=Ti,Pi=(a("45da"),Object(st.a)(Li,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:t.headerTitle,visible:t.visible,centered:!0,width:650,"padding-size":"small"},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("div",[a("div",{staticClass:"form mt-2"},[a("a-form-model",{ref:"formRef",attrs:{model:t.form,rules:t.formRules,"wrapper-col":{span:18,offset:6}}},[t.initData?[t.isMainAucitorTeam?a("a-form-model-item",{attrs:{prop:"auditTime","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核期間 ")]),a("date-picker",{staticClass:"w-100",attrs:{formatter:t.dateFormatter,"disabled-date":t.disableDate,range:!0,type:"date","allow-clear":!0},model:{value:t.form.auditTime,callback:function(e){t.$set(t.form,"auditTime",e)},expression:"form.auditTime"}})],1):t._e(),a("a-form-model-item",{attrs:{prop:"checkMans","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核人員 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"",mode:"multiple","show-arrow":!0,"filter-option":t.$global.filterOption},on:{change:t.changeAuditMenber},model:{value:t.form.checkMans,callback:function(e){t.$set(t.form,"checkMans",e)},expression:"form.checkMans"}},t._l(t.auditOption,(function(e){return a("a-select-option",{key:e.domainId,attrs:{value:e.domainId,disabled:t.isDisabledGroup(e.group)}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),t.isMainAucitorTeam?a("a-form-model-item",{attrs:{prop:"inChargeMan","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 領隊人員 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"","show-arrow":!0,"allow-clear":!0,"filter-option":t.$global.filterOption},on:{dropdownVisibleChange:t.changeInChargeMan},model:{value:t.form.inChargeMan,callback:function(e){t.$set(t.form,"inChargeMan",e)},expression:"form.inChargeMan"}},t._l(t.auditOption.filter((function(e){return t.form.checkMans.includes(e.domainId)})),(function(e){return a("a-select-option",{key:e.domainId,attrs:{value:e.domainId}},[t._v(" "+t._s(e.name)+" ")])})),1)],1):t._e(),t.isMainAucitorTeam?a("a-form-model-item",{attrs:{prop:"itemDescs","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 受查單位 ")]),a("a-tree-select",{attrs:{mode:"multiple","tree-data":t.selectOption.checkedUnit,"tree-checkable":"","tree-default-expand-all":!0,"tree-node-filter-prop":"title","dropdown-class-name":"treeselect","dropdown-style":{maxHeight:"300px"},"show-arrow":!0,"dropdown-match-select-width":!1,placeholder:"請選擇受查單位"},model:{value:t.form.itemDescs,callback:function(e){t.$set(t.form,"itemDescs",e)},expression:"form.itemDescs"}})],1):t._e(),t.isMainAucitorTeam?a("a-form-model-item",{attrs:{prop:"groupTeams","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 協辦組 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"",mode:"multiple","show-arrow":!0,"filter-option":t.$global.filterOption},model:{value:t.form.groupTeams,callback:function(e){t.$set(t.form,"groupTeams",e)},expression:"form.groupTeams"}},t._l(t.selectOption.planGroupInPreparation,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1):t._e()]:[t.initData?t._e():a("a-form-model-item",{attrs:{prop:"year","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 年度 ")]),a("date-picker",{staticClass:"w-100",attrs:{formatter:t.yearFormatter,type:"year","allow-clear":!0},model:{value:t.form.year,callback:function(e){t.$set(t.form,"year",e)},expression:"form.year"}})],1),t.initData?t._e():a("a-form-model-item",{ref:"startMonth",attrs:{prop:"startMonth","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 預計查核月份 ")]),a("a-select",{staticClass:"search__result__month search-form__select--month--left",attrs:{options:t.$enum.monthOption,placeholder:"起","dropdown-match-select-width":!1},model:{value:t.form.startMonth,callback:function(e){t.$set(t.form,"startMonth",e)},expression:"form.startMonth"}}),a("a-input",{staticClass:"search-form__range",attrs:{placeholder:"~",disabled:""}}),a("a-select",{staticClass:"search__result__month search-form__select--month--right",attrs:{placeholder:"迄",options:t.$enum.monthOption,"dropdown-match-select-width":!1},on:{change:function(){t.$refs.startMonth.onFieldChange()}},model:{value:t.form.endMonth,callback:function(e){t.$set(t.form,"endMonth",e)},expression:"form.endMonth"}})],1),t.initData?t._e():a("a-form-model-item",{attrs:{prop:"auditType","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核性質 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"","filter-option":t.$global.filterOption},model:{value:t.form.auditType,callback:function(e){t.$set(t.form,"auditType",e)},expression:"form.auditType"}},[a("a-select-option",{attrs:{value:"jack"}},[t._v(" Jack ")])],1)],1),t.initData?t._e():a("a-form-model-item",{attrs:{prop:"auditItem","label-col":{span:6},"wrapper-col":{span:18}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核項目 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"","filter-option":t.$global.filterOption,disabled:!!t.initData},model:{value:t.form.auditItem,callback:function(e){t.$set(t.form,"auditItem",e)},expression:"form.auditItem"}},t._l(t.fakeItemOption,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.item}},[t._v(" "+t._s(e.item)+" ")])})),1)],1)]],2)],1),a("div",{staticClass:"d-flex mt-4 justify-content-end"},[a("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" "+t._s(t.initData?"確認":"新增")+" ")]),a("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])])],2)}),[],!1,null,"8df213c0",null).exports);const Ri=Object(tt.c)("modalControl");let Ei=class extends et.d{constructor(){super(...arguments),this.formatter=this.$twDateFormatter,this.yearFormatter=this.$twYearFormatter,this.isLoading=!1,this.currentRole=null,this.isAddOutsidePlan=!1,this.isAddInsidePlan=!1,this.sit_hideDelete=!0,this.selectorOption={auditType:[],auditItem:[]},this.sidePlanModal={visible:"",initData:{}},this.resultModalSetting={visible:!1,title:"title",content:"",type:"error",autoClose:null},this.searchForm={year:void 0,quarter:void 0,auditType:void 0,range:[],auditItem:void 0,checkStatus:!1},this.rules={year:[{required:!0,message:"請選擇年度",trigger:"change"}],quarter:[{required:!0,message:"請選擇季",trigger:"change"}]},this.grid={rowKey:"rowKey",data:[],pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","15","25"],showQuickJumper:!0,showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{type:Re.PLAIN,property:"year",title:"年度"},{type:Re.TEMPLATE,template:"month",title:"月份"},{type:Re.PLAIN,property:"auditType",title:"查核性質"},{type:Re.TEMPLATE,template:"ckData",title:"查核期間"},{type:Re.ELLIPSIS,property:"auditItemName",title:"查核項目",ellipsisNum:8,pendingEdit:t=>this.isEdit(t)},{type:Re.ELLIPSIS,property:"incharge",title:"領隊人員",ellipsisNum:8,pendingEdit:t=>this.isEdit(t),formatter:t=>Array.isArray(t.incharge)&&t.incharge.length>0&&t.incharge.map(t=>t.name).join("、")||""},{type:Re.ELLIPSIS,property:"checkMan",title:"查核人員",ellipsisNum:8,pendingEdit:t=>this.isEdit(t),formatter:t=>Array.isArray(t.checkMan)&&t.checkMan.length>0&&t.checkMan.map(t=>t.name).join("、")||""},{type:Re.ELLIPSIS,property:"checkedUnit",title:"受查單位",ellipsisNum:8,pendingEdit:t=>this.isEdit(t),formatter:t=>t.checkedUnit.map(t=>t.departmentName).join("、")},{type:Re.PLAIN,property:"mainAucitorTeam",title:"主辦組",pendingEdit:t=>this.isEdit(t),formatter:t=>t.mainAucitorTeam.auditorName},{type:Re.ELLIPSIS,property:"coAucitorTeam",title:"協辦組",ellipsisNum:8,pendingEdit:t=>this.isEdit(t),formatter:t=>t.coAucitorTeam.map(t=>t.auditorName).join("、")},{type:Re.PLAIN,property:"planClass",title:"計畫",formatter:t=>t.planClass.valueName},{type:Re.TEMPLATE,property:"edit",template:"edit",title:"編輯",fixed:"right"},{type:Re.TEMPLATE,property:"delete",template:"delete",title:"刪除",fixed:"right"},{type:Re.TEMPLATE,property:"workPlanFlag",title:"工作規劃",template:"status",fixed:"right",width:"50px"}]}}get todoDisabled(){return["ROLE_Audit_Office_Boss_Vice","ROLE_Audit_Office_Boss"].includes(this.$global.getCurrentRoleId())}openModal(t){switch(t){case"humanResourcePlanning":this.$emit("openModal","humanResourcePlanning");break;case"addInsidePlan":this.isAddInsidePlan=!0;break;case"addOutsidePlan":this.isAddOutsidePlan=!0}}toPage(t){this.$router.push({name:t})}handleFlagStatus(t){switch(t){case"01":return"status-bar__item__circle--none";case"02":return"status-bar__item__circle--undo";case"03":return"status-bar__item__circle--done";case"04":return"status-bar__item__circle--delay"}}handleChangeRoute({property:t,text:e,data:a}){let i="";if("workPlanFlag"===t&&(i="WorkPlanning"),"01"!==e){const t=i.slice(0,1).toUpperCase()+i.slice(1);this.setLoading(!0),this.$preparationApi.searchWorkPlanUsingGET(a.quarterPlanMId).then(e=>{var i;e.data.result?this.$global.changeRouterAndaddParam({toRouter:t,query:{year:a.year,quarterPlanMId:a.quarterPlanMId,mainAucitorTeam:a.mainAucitorTeam.auditorTeam,coAucitorTeam:null===(i=a.coAucitorTeam)||void 0===i?void 0:i.map(t=>t.auditorTeam)}}):this.setModalState({resultModal:{visible:!0,type:"error",title:"查無資料"}})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查無資料"}})}).finally(()=>{this.setLoading(!1)})}}initSearchForm(){this.searchForm.year=void 0,this.searchForm.quarter=void 0,this.searchForm.auditType=void 0,this.searchForm.range=[],this.searchForm.auditItem=void 0}isEdit(t){const e=ya()(new Date),a="ROLE_Audit_Team_Head"===this.$global.getCurrentRoleId();let i=!1;if(ya()(t.ckStartDate).isValid()){const a=ya()(t.ckStartDate).add(1911,"year");i=e.diff(a,"day")<-10}else i=""===t.ckStartDate;return i&&a}getApi_quarterPlanAuditType(){this.$preparationApi.searchQuarterPlanAuditTypeInPreparationUsingGET().then(t=>{const e=t.data.result;this.selectorOption.auditType=e}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_quarterPlanAuditItem(){this.$preparationApi.searchQuarterPlanAuditItemInPreparationUsingGET().then(t=>{const e=t.data.result;this.selectorOption.auditItem=e}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_searchQuarterPlan(){this.setLoading(!0),this.grid.data=[],this.grid.pagination.total=0;const t={};t.checkStatus=this.searchForm.checkStatus,t.pageIndex=this.grid.pagination.current-1,t.pageSize=this.grid.pagination.pageSize,this.searchForm.checkStatus?(t.year=null,t.auditType=null,t.auditItem=null,t.startMonth=null,t.end_MONTH=null,t.ckStartDate=null,t.ckEndDate=null):(t.year=(ya()(this.searchForm.year).year()-1911).toString(),t.startMonth=ya()().quarter(Number(this.searchForm.quarter)).startOf("quarter").format("MM"),t.end_MONTH=ya()().quarter(Number(this.searchForm.quarter)).endOf("quarter").format("MM"),t.ckStartDate=this.searchForm.range[0]?ya()(this.searchForm.range[0]).format("YYYY-MM-DD"):null,t.ckEndDate=this.searchForm.range[1]?ya()(this.searchForm.range[1]).format("YYYY-MM-DD"):null,t.auditType=this.searchForm.auditType||null,t.auditItem=this.searchForm.auditItem||null),this.$preparationApi.searchQuarterPlanInPreparationUsingPOST(t).then(t=>{const e=this.$global.deepCopyData(t.data.result).content;e.map(t=>{t.rowKey=mt.a.v4()}),this.grid.data=e,this.grid.pagination.total=parseInt(t.data.result.totalElements)}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_deleteQuarterPlan({quarterPlanMId:t}){this.setLoading(!0),this.$preparationApi.deleteQuarterPlanInPreparationUsingPOST(t).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}}),this.getApi_searchQuarterPlan()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除失敗"}})}).finally(()=>{this.setLoading(!1)})}handleTableChange(t){this.grid.pagination.current=t.pagination.current,this.grid.pagination.pageSize=t.pagination.pageSize,this.getApi_searchQuarterPlan()}onGridActionClick(t,e){var a;switch(t){case"edit":this.sidePlanModal.visible="02"===(null===(a=e.planClass)||void 0===a?void 0:a.keyId)?"outSide":"inSide",this.sidePlanModal.initData={...e};break;case"delete":this.getApi_deleteQuarterPlan(e);break;case"history":break;case"reload":this.getApi_searchQuarterPlan()}}onSearch(){this.searchForm.checkStatus?this.getApi_searchQuarterPlan():this.$refs.formRef.validate(t=>{t&&this.getApi_searchQuarterPlan()})}todoChange(){this.$refs.formRef.clearValidate()}created(){this.currentRole=this.$global.getCurrentRole(),this.getApi_quarterPlanAuditType(),this.getApi_quarterPlanAuditItem()}mounted(){this.initSearchForm(),this.todoDisabled||(this.searchForm.checkStatus="todo"===this.$route.params.type),this.searchForm.checkStatus||(this.searchForm.year=new Date,this.searchForm.quarter=""+(ya()().quarter()+1)%4),this.onSearch()}watchDeep(t){}};Object(J.a)([Object(tt.a)("setLoading")],Ei.prototype,"setLoading",void 0),Object(J.a)([Ri.Action("setModalState")],Ei.prototype,"setModalState",void 0),Object(J.a)([tt.b],Ei.prototype,"getWindowSize",void 0),Object(J.a)([Object(et.e)("searchForm",{deep:!0})],Ei.prototype,"watchDeep",null),Ei=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,ActionBar:Ii,FblDataGrid:gt,StatusBar:wi,AddOutsidePlan:xi,AddInsidePlan:Pi,CustomPopConfirm:ce}})],Ei);var $i=Ei,Fi=(a("d6dc"),Object(st.a)($i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-contain crawlerindex-container container"},[a("div",{staticClass:"search-form form d-flex"},[a("a-form-model",{ref:"formRef",staticClass:"row flex-grow-1",attrs:{rules:t.rules,model:t.searchForm,"hide-required-mark":!0}},[a("div",{staticClass:"col-6 col-lg-3 col-xl-2"},[a("div",{staticClass:"search-form__label"},[t._v(" 年度 ")]),a("a-form-model-item",{attrs:{prop:"year"}},[a("date-picker",{staticClass:"w-100",attrs:{formatter:t.yearFormatter,disabled:t.searchForm.checkStatus,type:"year","allow-clear":!0},model:{value:t.searchForm.year,callback:function(e){t.$set(t.searchForm,"year",e)},expression:"searchForm.year"}})],1)],1),a("div",{staticClass:"col-6 col-lg-3 col-xl-2"},[a("div",{staticClass:"search-form__label"},[t._v(" 季 ")]),a("a-form-model-item",{attrs:{prop:"quarter"}},[a("a-select",{staticClass:"w-100",attrs:{"show-search":"",options:t.$enum.quarter,disabled:t.searchForm.checkStatus,"allow-clear":!0,"filter-option":t.$global.filterOption},model:{value:t.searchForm.quarter,callback:function(e){t.$set(t.searchForm,"quarter",e)},expression:"searchForm.quarter"}})],1)],1),a("div",{staticClass:"col-6 col-lg-3 col-xl-2"},[a("div",{staticClass:"search-form__label"},[t._v(" 查核性質 ")]),a("a-select",{staticClass:"w-100",attrs:{disabled:t.searchForm.checkStatus,"show-search":"",options:t.selectorOption.auditType,"dropdown-match-select-width":!1,"filter-option":t.$global.filterOption,"allow-clear":!0},model:{value:t.searchForm.auditType,callback:function(e){t.$set(t.searchForm,"auditType",e)},expression:"searchForm.auditType"}})],1),a("div",{staticClass:"col-6 col-lg-3 col-xl-2"},[a("div",{staticClass:"search-form__label"},[t._v(" 查核期間 ")]),a("date-picker",{staticClass:"w-100",attrs:{disabled:t.searchForm.checkStatus,placeholder:"請選擇資料期間",formatter:t.formatter,range:!0,type:"date","allow-clear":!0},model:{value:t.searchForm.range,callback:function(e){t.$set(t.searchForm,"range",e)},expression:"searchForm.range"}})],1),a("div",{staticClass:"col-6 col-lg-6 col-xl-2"},[a("div",{staticClass:"search-form__label"},[t._v(" 查核項目 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"",disabled:t.searchForm.checkStatus,options:t.selectorOption.auditItem,"dropdown-match-select-width":!1,"filter-option":t.$global.filterOption,"allow-clear":!0},model:{value:t.searchForm.auditItem,callback:function(e){t.$set(t.searchForm,"auditItem",e)},expression:"searchForm.auditItem"}})],1),a("div",{staticClass:"col-6 col-lg-auto col-xl-2 d-flex align-items-center pt-3"},[a("div",{staticClass:"d-flex align-items-center w-auto"},[a("a-checkbox",{attrs:{disabled:t.todoDisabled},on:{change:t.todoChange},model:{value:t.searchForm.checkStatus,callback:function(e){t.$set(t.searchForm,"checkStatus",e)},expression:"searchForm.checkStatus"}},[t._v(" 待辦 ")])],1),a("div",{},[a("button",{staticClass:"btn--search",on:{click:t.onSearch}},[t._v(" 查詢 ")])])])])],1),a("div",{staticClass:"search-header d-flex flex-wrap-reverse align-items-center"},[a("div",{staticClass:"titleBar d-flex flex-wrap"},[a("div",{staticClass:"search-header__title"},[t._v(" 季工作規劃 ")]),a("StatusBar")],1),a("div",{staticClass:"btnGroup ms-auto"},[a("ActionBar",{attrs:{role:t.currentRole.id},on:{openModal:t.openModal}})],1)]),a("fbl-data-grid",{staticClass:"preparation-table",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:t.grid.pagination,scroll:{x:!0}},on:{tableChange:t.handleTableChange},scopedSlots:t._u([{key:"month",fn:function(e){return[a("span",[t._v(t._s(e.data.startMoth)+" ~ "+t._s(e.data.endMoth))])]}},{key:"ckData",fn:function(e){return[a("span",[t._v(" "+t._s(e.data.ckStartDate)+" "),e.data.ckStartDate&&e.data.ckEndDate?a("span",[t._v(" ~ ")]):t._e(),t._v(" "+t._s(e.data.ckEndDate)+" ")])]}},{key:"edit",fn:function(e){return[a("button",{staticClass:"acion-icon btn__icon--edit-acion",attrs:{disabled:!t.isEdit(e.data)},on:{click:function(a){return t.onGridActionClick("edit",e.data)}}})]}},{key:"delete",fn:function(e){return[t.isEdit(e.data)&&!t.sit_hideDelete?a("CustomPopConfirm",{attrs:{disabled:t.sit_hideDelete},on:{confirm:function(a){return t.onGridActionClick("delete",e.data)}}},[a("button",{staticClass:"acion-icon btn__icon--delete-action"})]):a("button",{staticClass:"acion-icon btn__icon--delete-action",attrs:{disabled:""}})]}},{key:"status",fn:function(e){return[a("div",{staticClass:"status-bar__item__circle",class:t.handleFlagStatus(e.data[e.property]),on:{click:function(a){return t.handleChangeRoute(e)}}})]}}])}),a("AddOutsidePlan",{attrs:{visible:"outSide"===t.sidePlanModal.visible,"init-data":t.sidePlanModal.initData},on:{closeModal:function(e){t.sidePlanModal.visible=""}}}),a("AddInsidePlan",{attrs:{visible:"inSide"===t.sidePlanModal.visible,"init-data":t.sidePlanModal.initData},on:{closeModal:function(e){t.sidePlanModal.visible=""},reload:function(e){return t.onGridActionClick("reload")}}})],1)}),[],!1,null,"af202b7e",null).exports);let Ui=class extends et.d{clickHandler(){}confirm(t){this.$emit("confirm",t)}toPage(t){this.$emit("toPage",t)}watchIsLeader(t){}};Object(J.a)([Object(et.b)()],Ui.prototype,"role",void 0),Object(J.a)([Object(et.b)()],Ui.prototype,"isLeader",void 0),Object(J.a)([Object(et.b)()],Ui.prototype,"workMStatus",void 0),Object(J.a)([Object(et.e)("isLeader",{immediate:!0})],Ui.prototype,"watchIsLeader",null),Ui=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,CustomPopConfirm:ce}})],Ui);var Gi=Ui,Yi=Object(st.a)(Gi,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex justify-content-end"},["ROLE_Auditor"===t.role&&t.isLeader&&["01","04","05"].includes(t.workMStatus)?a("div",[a("CustomPopConfirm",{attrs:{title:"確認覆核？"},on:{confirm:function(e){return t.$emit("click",{type:"submitReview"})}}},[a("IconTextButton",{staticClass:"me-3",attrs:{text:"送出覆核",type:"edit"}})],1),a("IconTextButton",{staticClass:"me-3",attrs:{text:"暫存",type:"save"},on:{click:function(e){return t.$emit("click",{type:"save"})}}})],1):t._e(),"ROLE_Audit_Team_Head"===t.role&&["02"].includes(t.workMStatus)?a("div",[a("IconTextButton",{staticClass:"me-3",attrs:{text:"通過",type:"enter"},on:{click:function(e){return t.$emit("click",{type:"sussess"})}}}),a("IconTextButton",{staticClass:"me-3",attrs:{text:"退回",type:"feedback"},on:{click:function(e){return t.$emit("click",{type:"reject"})}}})],1):t._e(),"ROLE_Audit_Department_Head"===t.role&&["03"].includes(t.workMStatus)?a("div",[a("IconTextButton",{staticClass:"me-3",attrs:{text:"通過",type:"enter"},on:{click:function(e){return t.$emit("click",{type:"sussess"})}}}),a("IconTextButton",{staticClass:"me-3",attrs:{text:"退回",type:"feedback"},on:{click:function(e){return t.$emit("click",{type:"reject"})}}})],1):t._e(),["06","07"].includes(t.workMStatus)?a("IconTextButton",{staticClass:"me-3",attrs:{text:"下載檔案(word)",type:"download"},on:{click:function(e){return t.$emit("click",{type:"download"})}}}):t._e(),a("IconTextButton",{attrs:{text:"上一頁",type:"return"},on:{click:function(e){return t.$emit("click",{type:"back"})}}})],1)}),[],!1,null,"fbe22e7a",null).exports;let Ni=class extends et.d{};Object(J.a)([Object(et.b)()],Ni.prototype,"role",void 0),Object(J.a)([Object(et.c)("tabsData")],Ni.prototype,"tabsDataSync",void 0),Object(J.a)([Object(et.b)()],Ni.prototype,"isLeader",void 0),Ni=Object(J.a)([Object(et.a)({})],Ni);var Vi=Ni,qi=Object(st.a)(Vi,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-form-model",{ref:"formRef",attrs:{model:t.tabsDataSync,"hide-required-mark":!0,"wrapper-col":{span:18,offset:6}}},[a("a-form-model-item",{attrs:{prop:"member","label-col":{span:6},"wrapper-col":{span:18}}},[a("a-textarea",{staticClass:"w-100",attrs:{"auto-size":{minRows:10},disabled:!t.isLeader},model:{value:t.tabsDataSync.textarea,callback:function(e){t.$set(t.tabsDataSync,"textarea",e)},expression:"tabsDataSync.textarea"}})],1)],1)],1)}),[],!1,null,"875043ae",null).exports;let Bi=class extends et.d{};Object(J.a)([Object(et.b)()],Bi.prototype,"role",void 0),Object(J.a)([Object(et.c)("tabsData")],Bi.prototype,"tabsDataSync",void 0),Object(J.a)([Object(et.b)()],Bi.prototype,"isLeader",void 0),Bi=Object(J.a)([Object(et.a)({})],Bi);var zi=Bi,Hi=Object(st.a)(zi,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-form-model",{ref:"formRef",attrs:{model:t.tabsDataSync,"hide-required-mark":!0,"wrapper-col":{span:18,offset:6}}},[a("a-form-model-item",{attrs:{prop:"member","label-col":{span:6},"wrapper-col":{span:18}}},[a("a-textarea",{staticClass:"w-100",attrs:{"auto-size":{minRows:10},disabled:!t.isLeader},model:{value:t.tabsDataSync.textarea,callback:function(e){t.$set(t.tabsDataSync,"textarea",e)},expression:"tabsDataSync.textarea"}})],1)],1)],1)}),[],!1,null,"25af4fd0",null).exports;const Qi=Object(tt.c)("modalControl");let Wi=class extends et.d{constructor(){super(...arguments),this.addAndEditData={visible:!1,type:""},this.form={workContent:"",workPoint:"",itemDescs:[],auditors:[]},this.formRules={workContent:[{required:!0,message:"請填寫查核內容",trigger:"change"}],workPoint:[{required:!0,message:"請填寫查核重點",trigger:"change"}]},this.grid={rowKey:"quarterWorkDId",data:[],columns:[{type:Re.PLAIN,property:"workContent",title:"查核內容"},{type:Re.PLAIN,property:"workPoint",title:"查核重點"},{type:Re.PLAIN,property:"itemDescs",title:"相關部門",width:"150px",formatter:t=>{var e;return null===(e=t.itemDescs)||void 0===e?void 0:e.map(t=>""+t.departmentName).join("、")}},{type:Re.PLAIN,property:"auditors",title:"查核人員",width:"150px",formatter:t=>{var e;return null===(e=t.auditors)||void 0===e?void 0:e.map(t=>t.name).join("、")}},{type:Re.TEMPLATE,property:"",template:"handleTemp",title:"",width:"90px",fixed:"right"}]}}get modelTitle(){switch(this.addAndEditData.type){case"add":return"新增";case"edit":return"編輯";default:return""}}resetFormData(){this.form={workContent:"",workPoint:"",itemDescs:[],auditors:[]}}addRow(){this.resetFormData(),this.addAndEditData={visible:!0,type:"add"}}editRow(t){var e,a;this.addAndEditData={visible:!0,type:"edit",quarterWorkDId:t.quarterWorkDId},this.form={workContent:t.workContent,workPoint:t.workPoint,itemDescs:null===(e=t.itemDescs)||void 0===e?void 0:e.map(t=>t.departmentId.toUpperCase()),auditors:null===(a=t.auditors)||void 0===a?void 0:a.map(t=>t.domainId.toUpperCase())}}deleteRow({quarterWorkDId:t}){if(/^workNew/.test(t)){const e=this.tabsDataSync.find(e=>e.quarterWorkDId===t);this.tabsDataSync.splice(this.tabsDataSync.indexOf(e),1),this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}})}else this.$emit("click",{type:"deleteAssignment",params:{quarterWorkDId:t}})}submit(){this.$refs.formRef.validate(t=>{var e,a,i,s;if(t)switch(this.addAndEditData.visible=!1,this.addAndEditData.type){case"add":this.tabsDataSync.push({quarterWorkDId:"workNew"+mt.a.v4(),delete:!1,seq:1,workContent:this.form.workContent,workPoint:this.form.workPoint,itemDescs:null===(e=this.form.itemDescs)||void 0===e?void 0:e.map(t=>({departmentId:t,departmentName:[...this.selectOption.units[0].children,...this.selectOption.units[1].children].find(e=>e.key===t).title})),auditors:null===(a=this.form.auditors)||void 0===a?void 0:a.map(t=>this.selectOption.member.find(e=>e.domainId===t)),operate:"add"});break;case"edit":const t=this.tabsDataSync.find(t=>t.quarterWorkDId===this.addAndEditData.quarterWorkDId);t.workContent=this.form.workContent,t.workPoint=this.form.workPoint,t.itemDescs=null===(i=this.form.itemDescs)||void 0===i?void 0:i.map(t=>({departmentId:t,departmentName:[...this.selectOption.units[0].children,...this.selectOption.units[1].children].find(e=>e.key===t)?[...this.selectOption.units[0].children,...this.selectOption.units[1].children].find(e=>e.key===t).title:""})).filter(t=>""!==t.departmentName),t.auditors=null===(s=this.form.auditors)||void 0===s?void 0:s.map(t=>this.selectOption.member.find(e=>e.domainId===t)),t.operate="modify"}})}closeModal(){this.addAndEditData.visible=!1}created(){}watchTabsData(t){this.grid.data=t}};Object(J.a)([Object(tt.a)("setLoading")],Wi.prototype,"setLoading",void 0),Object(J.a)([Qi.Action("setModalState")],Wi.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],Wi.prototype,"role",void 0),Object(J.a)([Object(et.c)("tabsData")],Wi.prototype,"tabsDataSync",void 0),Object(J.a)([Object(et.b)()],Wi.prototype,"selectOption",void 0),Object(J.a)([Object(et.b)()],Wi.prototype,"isLeader",void 0),Object(J.a)([Object(et.e)("tabsData",{immediate:!0,deep:!0})],Wi.prototype,"watchTabsData",null),Wi=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,InfoModal:_t,CustomPopConfirm:ce}})],Wi);var Ki=Wi,Ji=(a("87e7"),Object(st.a)(Ki,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"d-flex justify-content-end"},[t.isLeader?a("a-button",{staticClass:"add__btn",on:{click:function(e){return t.addRow()}}},[t._v(" 新增 ")]):t._e()],1),a("fbl-data-grid",{staticClass:"preparation-table",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:!1,scroll:{x:!0}},scopedSlots:t._u([{key:"handleTemp",fn:function(e){return[a("div",{staticClass:"table__control d-flex mx-auto"},[a("i",{staticClass:"btn__icon--edit-acion",attrs:{disabled:!t.isLeader},on:{click:function(){return!!t.isLeader&&t.editRow(e.data)}}}),a("CustomPopConfirm",{attrs:{title:"確認刪除？",disabled:!t.isLeader},on:{confirm:function(a){return t.deleteRow(e.data)}}},[a("i",{staticClass:"btn__icon--delete-action ms-3",attrs:{disabled:!t.isLeader}})])],1)]}}])}),a("InfoModal",{attrs:{title:t.modelTitle+"查核範圍與工作分配",visible:t.addAndEditData.visible,centered:!0,width:768}},[a("template",{slot:"content"},[a("div",{staticClass:"container modal__main  mt-2"},[a("a-form-model",{ref:"formRef",attrs:{model:t.form,"hide-required-mark":!0,rules:t.formRules,"label-col":{span:5},"wrapper-col":{span:19},"label-align":"right"}},[a("a-form-model-item",{attrs:{prop:"workContent",label:"查核內容"}},[a("a-input",{model:{value:t.form.workContent,callback:function(e){t.$set(t.form,"workContent",e)},expression:"form.workContent"}})],1),a("a-form-model-item",{attrs:{prop:"workPoint",label:"查核重點"}},[a("a-textarea",{staticClass:"list__item__textarea",attrs:{rows:8},model:{value:t.form.workPoint,callback:function(e){t.$set(t.form,"workPoint",e)},expression:"form.workPoint"}})],1),a("a-form-model-item",{attrs:{prop:"itemDescs",label:"相關部門"}},[a("a-tree-select",{staticClass:"itemDescs__select",attrs:{mode:"multiple","tree-data":t.selectOption.units,"tree-checkable":"","tree-default-expand-all":!0,"tree-node-filter-prop":"title","dropdown-class-name":"treeselect","dropdown-style":{maxHeight:"300px"},"show-arrow":!0,"dropdown-match-select-width":!1,disabled:!t.isLeader,placeholder:"請選擇相關部門"},model:{value:t.form.itemDescs,callback:function(e){t.$set(t.form,"itemDescs",e)},expression:"form.itemDescs"}})],1),a("a-form-model-item",{attrs:{prop:"auditors",label:"查核人員"}},[a("a-select",{attrs:{placeholder:"請選擇查核人員",mode:"multiple","show-arrow":!0,"dropdown-match-select-width":!1},model:{value:t.form.auditors,callback:function(e){t.$set(t.form,"auditors",e)},expression:"form.auditors"}},t._l(t.selectOption.member,(function(e){return a("a-select-option",{key:e.domainId,attrs:{value:e.domainId}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1)],1),a("div",{staticClass:"d-flex mt-4 justify-content-end"},[a("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),a("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],2)],1)}),[],!1,null,"ba1b0980",null).exports);let Zi=class extends et.d{};Object(J.a)([Object(et.b)()],Zi.prototype,"tabsData",void 0),Zi=Object(J.a)([Object(et.a)({})],Zi);var Xi=Zi,ts=(a("ba7a"),Object(st.a)(Xi,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row g-0"},t._l(t.tabsData,(function(e,s){return i("div",{key:s,staticClass:"col-6 col-md-4"},[i("div",{staticClass:"contact-item"},[i("img",{staticClass:"contact-item__img",attrs:{src:a("0f11"),alt:""}}),t._v(" "+t._s(e.unit)+" "),i("div",{staticClass:"contact-item__name"},[t._v(" "+t._s(e.name)+" ")]),t._v(" "+t._s(e.phone)+" ")])])})),0)}),[],!1,null,"8ca2a324",null).exports);const es=Object(tt.c)("modalControl");let as=class extends et.d{constructor(){super(...arguments),this.activeImportantCheckKey=["A"]}onComparisonAll(){this.$emit("click",{type:"comparisonAll"})}onDeleteItemTextarea(t,e){const a=this.tabsDataSync.find(e=>e.groupId===t),i=a.noticeChildrenDescs.find(t=>t.quarterWorkDId===e);/workNew/.test(i.quarterWorkDId)?(a.noticeChildrenDescs.splice(a.noticeChildrenDescs.indexOf(i),1),this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}})):this.$emit("click",{type:"deleteNoticeItem",params:{quarterWorkDId:i.quarterWorkDId}})}onComparisonItemTextarea(t,e){}onLinkItemTextarea(t,e){this.$emit("click",{type:"linkItem",params:{groupId:t,quarterWorkDId:e}})}onQuestionItemTextarea(t,e){}onAddItemTextarea(t){const e=this.tabsDataSync.find(e=>e.groupId===t);e.noticeChildrenDescs.push({delete:!1,operate:"add",quarterWorkDId:"workNew"+mt.a.v4(),sysCodeGroupId:e.groupId,workClass:e.workClasses[1],workDesc:""})}editTextareaItem(t){/workNew/.test(t.quarterWorkDId)||"modify"!==t.operate&&(t.operate="modify")}};Object(J.a)([es.Action("setModalState")],as.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],as.prototype,"role",void 0),Object(J.a)([Object(et.c)("tabsData")],as.prototype,"tabsDataSync",void 0),Object(J.a)([Object(et.b)()],as.prototype,"isLeader",void 0),as=Object(J.a)([Object(et.a)({components:{CustomPopConfirm:ce}})],as);var is=as,ss=(a("ac2b"),Object(st.a)(is,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table custom__table"},[a("tbody",[a("tr",[a("td",{staticClass:"w-100 p-0"},[a("div",{staticClass:"importantCheck__wrap"},[t._m(0),a("a-collapse",{attrs:{"destroy-inactive-panel":!1},model:{value:t.activeImportantCheckKey,callback:function(e){t.activeImportantCheckKey=e},expression:"activeImportantCheckKey"}},t._l(t.tabsDataSync,(function(e){return a("a-collapse-panel",{key:e.groupId,attrs:{header:e.groupName}},[t._l(e.noticeChildrenDescs,(function(i){return a("div",{key:i.quarterWorkDId,staticClass:"textarea__wrap"},[a("div",{staticClass:"textarea__main"},[a("a-textarea",{staticClass:"notice__textarea",attrs:{rows:4,disabled:!t.isLeader},on:{change:function(e){return t.editTextareaItem(i)}},model:{value:i.workDesc,callback:function(e){t.$set(i,"workDesc",e)},expression:"textareaItem.workDesc"}})],1),a("div",{staticClass:"textarea__control d-flex flex-wrap"},[a("div",{staticClass:"d-flex flex-wrap mx-2 w-100"},[t.isLeader?a("div",{staticClass:"col-6"},[a("CustomPopConfirm",{attrs:{disabled:!t.isLeader},on:{confirm:function(a){return t.onDeleteItemTextarea(e.groupId,i.quarterWorkDId)}}},[a("i",{staticClass:"textarea__control__btn btn__icon--small_delete",class:{"btn__icon--small_delete--disabled":!t.isLeader}})])],1):t._e(),a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("span",[t._v("連結資料")])]),a("button",{staticClass:"textarea__control__btn btn__icon--small_link",on:{click:function(a){return t.onLinkItemTextarea(e.groupId,i.quarterWorkDId)}}})],2)],1)])])])})),a("div",{staticClass:"footer__button__wrap"},[t.isLeader?a("button",{staticClass:"textarea__controlBtn__add",on:{click:function(a){return t.onAddItemTextarea(e.groupId)}}},[a("a-icon",{staticClass:"textarea__controlBtn__icon",attrs:{type:"plus"}}),a("span",{staticClass:"textarea__controlBtn__txt"},[t._v("新增")])],1):t._e()])],2)})),1)],1)])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"importantCheck__title__group"},[a("i",{staticClass:"importantCheck__title__required"},[t._v("＊")]),a("span",{staticClass:"importantCheck__title"},[t._v("應注意事項")])])}],!1,null,"519d7eb2",null).exports);const os=Object(tt.c)("modalControl");let ns=class extends et.d{constructor(){super(...arguments),this.msg=""}get typeStr(){return"pass"===this.type?"通過":"退回"}get isConfirm(){return"pass"===this.type}reset(){this.msg=""}getApi_passWorkPlanInPreparation(){this.$preparationApi.passWorkPlanInPreparationUsingPOST({quarterWorkMId:this.quarterWorkMId,remark:this.msg}).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:`覆核${this.typeStr}成功`,autoClose:3}}),this.$router.go(-1)}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:`覆核${this.typeStr}失敗`}})}).finally(()=>{this.setLoading(!1)})}getApi_rejectWorkPlanInPreparation(){this.$preparationApi.rejectWorkPlanInPreparationUsingPOST({quarterWorkMId:this.quarterWorkMId,remark:this.msg}).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:`覆核${this.typeStr}成功`,autoClose:3}}),this.$router.go(-1)}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:`覆核${this.typeStr}失敗`}})}).finally(()=>{this.setLoading(!1)})}closeModal(){this.syncedVisible=!1}addResponseMessage(t){this.msg+=t}async submit(){"pass"===this.type?await this.getApi_passWorkPlanInPreparation():"reject"===this.type&&await this.getApi_rejectWorkPlanInPreparation(),this.closeModal()}watchVisible(t){t&&this.reset()}};Object(J.a)([os.Action("setModalState")],ns.prototype,"setModalState",void 0),Object(J.a)([Object(tt.a)("setLoading")],ns.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("visible")],ns.prototype,"syncedVisible",void 0),Object(J.a)([Object(et.b)({default:"reject"})],ns.prototype,"type",void 0),Object(J.a)([Object(et.b)()],ns.prototype,"quarterWorkMId",void 0),Object(J.a)([Object(et.b)()],ns.prototype,"status",void 0),Object(J.a)([Object(et.e)("syncedVisible")],ns.prototype,"watchVisible",null),ns=Object(J.a)([Object(et.a)({components:{InfoModal:_t,ResponseMessage:Le}})],ns);var rs=ns,ls=(a("50bf"),Object(st.a)(rs,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"覆核"+t.typeStr,visible:t.visible,centered:!0,width:950},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"modal__main"},[i("div",{staticClass:"modal__main__header d-flex align-items-end justify-content-between"},[i("div",{staticClass:"main__header__label"},[t._v(" "+t._s(t.typeStr)+"意見： ")])]),i("div",{staticClass:"confirm-message"},[i("div",{staticClass:"main__header__icon"},[t.isConfirm?i("img",{staticClass:"img-fluid",attrs:{src:a("5430")}}):i("img",{staticClass:"img-fluid",attrs:{src:a("e536")}})]),i("a-textarea",{staticClass:"audit__textarea",attrs:{placeholder:"請詳細填寫內容",rows:11},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}})],1)]),i("ResponseMessage",{staticClass:"content__msg ps-2",on:{select:t.addResponseMessage}})],1),i("div",{staticClass:"d-flex mt-4 justify-content-end"},[i("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),i("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],2)}),[],!1,null,"e2d4393e",null).exports);let cs=class extends et.d{constructor(){super(...arguments),this.compareData=[]}get getCompareData(){return Object.keys(this.nowData).length>0&&this.oldData.length>0?[{...this.nowData},...this.oldData]:Object.keys(this.nowData).length>0?[{...this.nowData}]:this.oldData.length>0?[...this.oldData]:[]}close(){this.$emit("closeModal")}onGetCompareDataChanged(t){this.compareData=t,this.compareData=this.compareData.map((t,e)=>{const a=e+1;if(a==this.compareData.length)return{...t};const i=Ct.a.execute(this.compareData[a].text,t.text);return{...t,text:i}})}};Object(J.a)([Object(et.b)()],cs.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],cs.prototype,"nowData",void 0),Object(J.a)([Object(et.b)()],cs.prototype,"oldData",void 0),Object(J.a)([Object(et.e)("getCompareData",{deep:!0})],cs.prototype,"onGetCompareDataChanged",null),cs=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],cs);var ds=cs,us=(a("7e87"),Object(st.a)(ds,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"比對資料",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,"height-full-screen":!0,centered:!1},on:{closeModal:t.close}},[a("template",{slot:"content"},[a("div",{staticClass:"modal__list"},[t.compareData.length>0?t._l(t.compareData,(function(e,i){return a("div",{key:i,staticClass:"modal__list__item"},[a("div",{staticClass:"modal__list__item__title"},[a("span",[t._v(t._s(e.dateTime))]),a("span",[t._v(t._s(e.title)+"/"+t._s(e.staffname))])]),a("p",{staticClass:"content",domProps:{innerHTML:t._s(e.text)}})])})):a("div",{staticClass:"modal__list__item"})],2)])],2)}),[],!1,null,"85135c04",null).exports);const ps=Object(tt.c)("crawlerDataDetailVuex");let ms=class extends et.d{constructor(){super(...arguments),this.attatchments={}}getCurrentView({caseType:t}){var e;return(null===(e=Object.keys(t))||void 0===e?void 0:e.length)>0?"DataType__"+this.$enum.getDataTypeComp(Object.keys(t)[0]):"DataType__comp1"}getApi_GetAttachment(t){this.setLoading(!0),this.$preparationApi.searchAttachmentsUsingPOST(t).then(e=>{this.$set(this.attatchments,t,e.data.result)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}onDownload({attachmentId:t,fileName:e}){this.setLoading(!0),this.$preparationApi.searchAttachmentUsingPOST(t,{responseType:"blob"}).then(t=>{const a=document.createElement("a"),i=(window.URL||window.webkitURL).createObjectURL(t.data),s=e;a.setAttribute("href",i),a.setAttribute("download",""+s),a.click(),a.remove()}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}close(){this.$emit("closeModal")}watchVisible(t){var e;t&&(this.attatchments={},(null===(e=this.contentData)||void 0===e?void 0:e.length)>0&&this.contentData.map(t=>{this.getApi_GetAttachment(t.crawlerDataId)}))}};Object(J.a)([ps.Getter("getDetailData")],ms.prototype,"getDetailData",void 0),Object(J.a)([Object(tt.a)("setLoading")],ms.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],ms.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],ms.prototype,"contentData",void 0),Object(J.a)([Object(et.e)("visible")],ms.prototype,"watchVisible",null),ms=Object(J.a)([Object(et.a)({components:{InfoModal:_t,DataType__comp1:Lt,DataType__comp2:Et,DataType__comp3:Kt,DataType__comp4:Xt}})],ms);var hs=ms,fs=(a("8715"),Object(st.a)(hs,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{visible:t.visible,"body-size":"large","padding-size":"normal",closable:!0,centered:!0},on:{closeModal:t.close}},[i("template",{slot:"content"},[t.contentData&&t.contentData.length>0?t._l(t.contentData,(function(e,a){return i("div",{key:a,staticClass:"main__contentItem"},[i("div",{staticClass:"main__content"},[e.caseType?i(t.getCurrentView(e),{tag:"component",attrs:{"prop-data":e}}):t._e()],1),t.attatchments[e.crawlerDataId]&&t.attatchments[e.crawlerDataId].length>0?i("div",{staticClass:"file__content"},[i("div",{staticClass:"file__header"},[i("div",{staticClass:"file__header-img"}),i("span",{staticClass:"file__header-title"},[t._v("資料檔案")])]),i("div",{staticClass:"file__list"},t._l(t.attatchments[e.crawlerDataId],(function(e,a){return i("div",{key:a,staticClass:"file__list__item"},[i("a",{staticClass:"file__list__text",on:{click:function(a){return t.onDownload(e)}}},[t._v(" "+t._s(e.fileName)+" ")])])})),0)]):t._e()])})):i("div",{staticClass:"d-flex m-3 flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無關聯資料 ")])])],2)],2)}),[],!1,null,"3bad48e7",null).exports);const gs=Object(tt.c)("modalControl");let bs=class extends et.d{constructor(){super(...arguments),this.queryData={year:"",quarterPlanMId:"",mainAucitorTeam:"",coAucitorTeam:[]},this.inChargeMan={domainId:"",group:"",groupName:"",name:""},this.reviewCommitModal={visible:!1,type:"reject",quarterWorkMId:"",status:""},this.connectDataModal={visible:!1,data:[]},this.compareModal={visible:!1,nowData:{},oldData:[]},this.formatter=this.$twDateFormatter,this.currentRole=null,this.tabsArr=[{id:"reference",title:"查核依據"},{id:"riskAnalysis",title:"風險分析"},{id:"notice",title:"應注意事項"},{id:"assignment",title:"查核範圍與工作分配"},{id:"contact",title:"查核窗口"}],this.activeTab="notice",this.originData={},this.showData={itemDescs:[],baseDate:void 0,ckDateArr:[],ckRangeDateArr:[],inChargeMan:void 0,checkMansArr:[]},this.rules={itemDescs:[{required:!0,message:"請選擇受查單位",trigger:"change"}]},this.tabsData={reference:{textarea:""},riskAnalysis:{textarea:""},notice:[],assignment:[],contact:[]},this.noticeOld=[],this.selectOption={units:[],member:[]}}get isLeader(){const t=this.$user.getMe().employee.domainId;return!("ROLE_Auditor"!==this.currentRole.id||this.inChargeMan.domainId!==t||!["01","04","05"].includes(this.originData.workMStatus))}get isMainAucitorTeam(){return this.queryData.mainAucitorTeam===this.$global.getCurrentRoleTeamCode()}get iscoAucitorTeam(){return this.queryData.coAucitorTeam.includes(this.$global.getCurrentRoleTeamCode())}isDisabledGroup(t){const e=this.$global.getCurrentRoleTeamCode();return!this.isMainAucitorTeam&&t!==e}changeAuditMenber(){this.showData.checkMansArr.includes(this.showData.inChargeMan)||(this.showData.inChargeMan=void 0)}getApi_yapUnit(){this.setLoading(!0);const t=this.queryData.year.toString();this.$preparationApi.searchUnitNameInPreparationUsingGET(t).then(t=>{var e,a;const i=t.data.result;this.selectOption.units=[{title:"全部",value:"all",key:"all",children:null===(e=i.validYapUnits)||void 0===e?void 0:e.map(t=>({title:t.value+t.label,value:t.value,label:t.label,key:t.value}))},{title:"無效單位",value:"invalid",key:"invalid",children:null===(a=i.inValidYapUnits)||void 0===a?void 0:a.map(t=>({title:t.value+t.label,value:t.value,label:t.label,key:t.value}))}]}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_Auditors(){this.setLoading(!0),this.$preparationApi.searchAuditorsUsingPOST().then(t=>{const e=t.data.result;this.selectOption.member=e.filter(t=>[this.queryData.mainAucitorTeam,...this.queryData.coAucitorTeam].includes(t.group)),this.selectOption.member.sort((t,e)=>t.group.charCodeAt()-e.group.charCodeAt())}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_searchWorkPlan({quarterPlanMId:t,updateScope:e="all"}){this.setLoading(!0),this.$preparationApi.searchWorkPlanUsingGET(t).then(t=>{const a=this.$global.deepCopyData(t.data.result);var i,s,o,n;if(this.originData=a,["all"].includes(e)&&(this.showData.itemDescs=a.itemDescs?null===(i=a.itemDescs)||void 0===i?void 0:i.map(t=>t.departmentId.toUpperCase()):a.itemDescs,this.showData.baseDate=Ca.isValidDate(a.ckBaseDate),this.showData.ckDateArr=[Ca.isValidDate(a.ckStartDate),Ca.isValidDate(a.ckEndDate)],this.showData.ckRangeDateArr=[Ca.isValidDate(a.ckRangeStrDate),Ca.isValidDate(a.ckRangeEndDate)],this.showData.inChargeMan=a.inChargeMan.domainId,this.inChargeMan=a.inChargeMan,this.showData.checkMansArr=(null===(s=a.auditors)||void 0===s?void 0:s.length)>0?null===(o=a.auditors)||void 0===o?void 0:o.map(t=>t.domainId):[]),["all","reference"].includes(e)&&(this.tabsData.reference.textarea=a.checkBase),["all","riskAnalysis"].includes(e)&&(this.tabsData.riskAnalysis.textarea=a.riskAnaly),["all","notice"].includes(e)){const t=this.$global.deepCopyData(a.noticeDescs);t.map(t=>{t.noticeChildrenDescs||(t.noticeChildrenDescs=[])}),this.tabsData.notice=t}["all","assignment"].includes(e)&&(this.tabsData.assignment=a.checkDescs),["all","contact"].includes(e)&&(this.tabsData.contact=[],null===(n=a.auditContact)||void 0===n||n.map(t=>{var e;t.auditees.length<=0?this.tabsData.contact.push({unit:`${t.itemDesc.departmentId.toUpperCase()} ${t.itemDesc.departmentName}`,name:""}):null===(e=t.auditees)||void 0===e||e.map(e=>{this.tabsData.contact.push({unit:`${t.itemDesc.departmentId.toUpperCase()} ${t.itemDesc.departmentName}`,name:e})})}))}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getApi_removeNotice(t){this.setLoading(!0),this.$preparationApi.removeNoticeUsingPOST(t).then(e=>{if(e.data.success){for(const e of this.tabsData.notice){const a=e.noticeChildrenDescs.find(e=>e.quarterWorkDId===t);a&&e.noticeChildrenDescs.splice(e.noticeChildrenDescs.indexOf(a),1)}this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}})}}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_assignmentRemove(t){this.setLoading(!0),this.$preparationApi.removeAssignmentOfWorkPlanInPreparationUsingGET(t).then(e=>{if(e.data.success){this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}});const e=this.tabsData.assignment.find(e=>e.quarterWorkDId===t);this.tabsData.assignment.splice(this.tabsData.assignment.indexOf(e),1)}}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除失敗"}})}).finally(()=>{this.setLoading(!1)})}async setParam(){this.queryData&&(this.queryData=await this.$global.getQuery())}getApi_download(){this.setLoading(!0),this.$preparationApi.downloadWorkPlanUsingPOST(this.createFormData(),{responseType:"blob"}).then(t=>{const e=document.createElement("a"),a=(window.URL||window.webkitURL).createObjectURL(t.data);e.setAttribute("href",a),e.setAttribute("download",`workPlan_${this.originData.quarterPlanMId}.docx`),e.click(),e.remove()}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getApi_saveTemp(){this.setLoading(!0),this.$preparationApi.modifyWorkPlanUsingPOST(this.createFormData()).then(t=>{t.data.success&&(this.setModalState({resultModal:{visible:!0,type:"success",title:"暫存成功",autoClose:3}}),this.getApi_searchWorkPlan({quarterPlanMId:this.queryData.quarterPlanMId}))}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"暫存失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_dataSubmitInData(){this.$refs.formRef.validate(t=>{t&&(this.setLoading(!0),this.$preparationApi.reviewWorkPlanInPreparationUsingPOST(this.createFormData()).then(t=>{t.data.success&&(this.setModalState({resultModal:{visible:!0,type:"success",title:"送出覆核成功",autoClose:3}}),this.$router.go(-1))}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"送出覆核失敗"}})}).finally(()=>{this.setLoading(!1)}))})}getApi_dataCollectDetail({quarterWorkDId:t}){this.setLoading(!0),this.connectDataModal.data=[],this.$preparationApi.searchNoticeUsingPOST(t).then(t=>{const e=t.data.result;this.connectDataModal.data=e,this.connectDataModal.visible=!0}).catch(t=>{var e,a,i,s;0===(null==t||null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.total)?this.connectDataModal.visible=!0:this.setModalState({resultModal:{visible:!0,type:"error",title:null==t||null===(i=t.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.message}})}).finally(()=>{this.setLoading(!1)})}createFormData(){return{checkBase:this.tabsData.reference.textarea,checkDescs:this.tabsData.assignment,checkMans:this.showData.checkMansArr,ckBaseDate:this.showData.baseDate?ya()(this.showData.baseDate).format("YYYY-MM-DD[T]HH:mm:ss"):this.showData.baseDate,ckRangeStrDate:this.showData.ckRangeDateArr[0]?ya()(this.showData.ckRangeDateArr[0]).format("YYYY-MM-DD[T]HH:mm:ss"):this.showData.ckRangeDateArr[0],ckRangeEndDate:this.showData.ckRangeDateArr[1]?ya()(this.showData.ckRangeDateArr[1]).format("YYYY-MM-DD[T]HH:mm:ss"):this.showData.ckRangeDateArr[1],ckStartDate:this.showData.ckDateArr[0]?ya()(this.showData.ckDateArr[0]).format("YYYY-MM-DD[T]HH:mm:ss"):this.showData.ckDateArr[0],ckEndDate:this.showData.ckDateArr[1]?ya()(this.showData.ckDateArr[1]).format("YYYY-MM-DD[T]HH:mm:ss"):this.showData.ckDateArr[1],inChargeMan:this.showData.inChargeMan,itemDescs:this.showData.itemDescs?this.showData.itemDescs.map(t=>{const e=[...this.selectOption.units[0].children,...this.selectOption.units[1].children].find(e=>e.key===t);return{departmentId:e?e.key:t,departmentName:e?e.label:""}}):this.showData.itemDescs,noticeDescs:this.tabsData.notice,quarterPlanMId:this.originData.quarterPlanMId,quarterWorkMId:this.originData.quarterWorkMId,riskAnaly:this.tabsData.riskAnalysis.textarea,workMStatus:this.originData.workMStatus}}emitBack(){this.$router.go(-1)}emitClick({type:t,params:e}){switch(t){case"submitReview":this.getApi_dataSubmitInData();break;case"save":this.getApi_saveTemp();break;case"meeting":case"search":break;case"sussess":this.reviewCommitModal.type="pass",this.reviewCommitModal.visible=!0;break;case"reject":this.reviewCommitModal.type="reject",this.reviewCommitModal.visible=!0;break;case"download":this.getApi_download();break;case"back":this.emitBack();break;case"comparisonAll":this.compareModal.visible=!0,this.compareModal.oldData=[{dateTime:"當前編輯項目",title:"test old1",staffname:this.$user.getMe().employee.name,text:"test old1"},{dateTime:"當前編輯項目",title:"test old2",staffname:this.$user.getMe().employee.name,text:"test old2"}],this.compareModal.nowData={dateTime:"當前編輯項目",title:"test now",staffname:this.$user.getMe().employee.name,text:"test now"};break;case"deleteNoticeItem":this.getApi_removeNotice(e.quarterWorkDId);break;case"linkItem":this.getApi_dataCollectDetail(e);break;case"deleteAssignment":this.getApi_assignmentRemove(e.quarterWorkDId)}}async created(){this.currentRole=this.$global.getCurrentRole(),await this.setParam().then(()=>{Promise.all([this.getApi_yapUnit(),this.getApi_Auditors()]),this.getApi_searchWorkPlan({quarterPlanMId:this.queryData.quarterPlanMId})})}watchShowData(t){}};Object(J.a)([Object(tt.a)("setLoading")],bs.prototype,"setLoading",void 0),Object(J.a)([gs.Action("setModalState")],bs.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("showData",{deep:!0})],bs.prototype,"watchShowData",null),bs=Object(J.a)([Object(et.a)({components:{AccordionArea:_e,ActionBar:Yi,Comp_reference:qi,Comp_riskAnalysis:Hi,Comp_assignment:Ji,Comp_contact:ts,Comp_notice:ss,ReviewCommitModal:ls,CompareDataModal:us,ConnectDataModal:fs}})],bs);var vs=bs,_s=(a("04db"),Object(st.a)(vs,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"workplanning-container container"},[a("div",{staticClass:"dataType__form__card"},[a("a-form-model",{ref:"formRef",attrs:{rules:t.rules,model:t.showData}},[a("div",{staticClass:"d-flex flex-wrap mainDataType__page"},[a("a-form-model-item",{attrs:{label:"受查單位",prop:"itemDescs"}},[a("a-tree-select",{attrs:{mode:"multiple","tree-data":t.selectOption.units,"tree-checkable":"","tree-default-expand-all":!0,"tree-node-filter-prop":"title","dropdown-class-name":"treeselect","dropdown-style":{maxHeight:"300px"},"show-arrow":!0,"dropdown-match-select-width":!1,disabled:!t.isLeader,placeholder:"請選擇受查單位"},model:{value:t.showData.itemDescs,callback:function(e){t.$set(t.showData,"itemDescs",e)},expression:"showData.itemDescs"}})],1),a("a-form-model-item",{attrs:{label:"查核基準日"}},[a("date-picker",{attrs:{formatter:t.formatter,type:"date","allow-clear":!0,disabled:!t.isLeader,placeholder:"請選擇查核基準日"},model:{value:t.showData.baseDate,callback:function(e){t.$set(t.showData,"baseDate",e)},expression:"showData.baseDate"}})],1),a("a-form-model-item",{attrs:{label:"查核期間"}},[a("date-picker",{attrs:{formatter:t.formatter,range:!0,type:"date","allow-clear":!0,disabled:!t.isLeader,placeholder:"請選擇查核期間"},model:{value:t.showData.ckDateArr,callback:function(e){t.$set(t.showData,"ckDateArr",e)},expression:"showData.ckDateArr"}})],1),a("a-form-model-item",{attrs:{label:"受查範圍期間"}},[a("date-picker",{attrs:{formatter:t.formatter,range:!0,type:"date","allow-clear":!0,disabled:!t.isLeader},model:{value:t.showData.ckRangeDateArr,callback:function(e){t.$set(t.showData,"ckRangeDateArr",e)},expression:"showData.ckRangeDateArr"}})],1),a("a-form-model-item",{attrs:{label:"領隊人員"}},[a("a-select",{attrs:{"show-search":"","show-arrow":!0,"allow-clear":!0,"filter-option":t.$global.filterOption,"dropdown-match-select-width":!1,disabled:!t.isLeader},model:{value:t.showData.inChargeMan,callback:function(e){t.$set(t.showData,"inChargeMan",e)},expression:"showData.inChargeMan"}},t._l(t.selectOption.member.filter((function(e){return t.showData.checkMansArr.includes(e.domainId)})),(function(e){return a("a-select-option",{key:e.domainId,attrs:{value:e.domainId}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"查核人員"}},[a("a-select",{attrs:{"show-search":"",mode:"multiple","show-arrow":!0,"dropdown-match-select-width":!1,"filter-option":t.$global.filterOption,disabled:!t.isLeader},on:{change:t.changeAuditMenber},model:{value:t.showData.checkMansArr,callback:function(e){t.$set(t.showData,"checkMansArr",e)},expression:"showData.checkMansArr"}},t._l(t.selectOption.member,(function(e){return a("a-select-option",{key:e.domainId,attrs:{value:e.domainId,disabled:t.isDisabledGroup(e.group)}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1)])],1),a("div",{staticClass:"d-flex flex-wrap-reverse mt-3"},[a("div",{staticClass:"tabGroup d-flex"},t._l(t.tabsArr,(function(e,i){return a("button",{key:i,staticClass:"tabGroup__item",class:{"tabGroup__item--active":t.activeTab==e.id},on:{click:function(){return t.activeTab=e.id}}},[t._v(" "+t._s(e.title)+" ")])})),0),a("div",{staticClass:"ms-auto align-self-center"},[a("ActionBar",{attrs:{role:t.currentRole.id,"is-leader":t.isLeader,"work-m-status":t.originData.workMStatus},on:{click:t.emitClick}})],1)]),a("div",{staticClass:"controlMain__container"},[a("KeepAlive",[a("Comp_"+t.activeTab,{tag:"component",attrs:{role:t.currentRole.id,"is-leader":t.isLeader,"tabs-data":t.tabsData[t.activeTab],"select-option":t.selectOption},on:{"update:tabsData":function(e){return t.$set(t.tabsData,t.activeTab,e)},"update:tabs-data":function(e){return t.$set(t.tabsData,t.activeTab,e)},click:t.emitClick}})],1)],1),a("ReviewCommitModal",{attrs:{visible:t.reviewCommitModal.visible,type:t.reviewCommitModal.type,"quarter-work-m-id":t.originData.quarterWorkMId,status:t.originData.workMStatus},on:{"update:visible":function(e){return t.$set(t.reviewCommitModal,"visible",e)}}}),a("CompareDataModal",{attrs:{visible:t.compareModal.visible,"now-data":t.compareModal.nowData,"old-data":t.compareModal.oldData},on:{closeModal:function(e){t.compareModal.visible=!1}}}),a("ConnectDataModal",{attrs:{visible:t.connectDataModal.visible,"content-data":t.connectDataModal.data},on:{closeModal:function(e){t.connectDataModal.visible=!1}}})],1)}),[],!1,null,"f2316972",null).exports);let ys=class extends et.d{get isCheckProgram(){return!1}};Object(J.a)([Object(et.b)()],ys.prototype,"role",void 0),ys=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,CustomPopConfirm:ce}})],ys);var Cs=ys,Os=(a("5cb7"),Object(st.a)(Cs,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.isCheckProgram?a("IconTextButton",{staticClass:"my-1",attrs:{text:"公版查核程式",type:"version"},on:{click:function(e){return t.$emit("openModal",{type:"checkProgram"})}}}):t._e()],1)}),[],!1,null,"63b7ae00",null).exports);const As=Object(tt.c)("modalControl");let Is=class extends et.d{constructor(){super(...arguments),this.dateFormatter=this.$twDateFormatter,this.yearFormatter=this.$twYearFormatter,this.isLoading=!1,this.currentRole=null,this.selectorOption={year:[],auditItem:[],checkedUnit:[],groups:[]},this.searchForm={year:void 0,startMonth:void 0,endMonth:void 0,auditItem:void 0,auditorTeam:void 0,unit:void 0,toDo:!1,hasOpinion:!1},this.cacheSearch={toDo:!1,hasOpinion:!1},this.grid={rowKey:"auditDraftId",data:[],pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","15","25"],showQuickJumper:!0,showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{type:Re.PLAIN,property:"year",title:"年度",fixed:"left"},{type:Re.TEMPLATE,template:"month",title:"月份",fixed:"left"},{type:Re.TEMPLATE,template:"auditItemName",title:"查核項目",fixed:"left"},{type:Re.ELLIPSIS,property:"units",title:"受查單位",ellipsisNum:6,formatter:t=>t.units.map(t=>t.departmentName).join("、")},{type:Re.ELLIPSIS,property:"inChargeMan",title:"領隊",ellipsisNum:5,formatter:t=>t.inChargeMan.name},{type:Re.ELLIPSIS,property:"checkMan",title:"查核人員",ellipsisNum:5,formatter:t=>t.checkMan.map(t=>t.name).join("、")},{type:Re.PLAIN,property:"mainAucitorTeam",title:"主辦組",formatter:t=>t.mainAucitorTeam.auditorName},{type:Re.ELLIPSIS,property:"coAucitorTeam",title:"協辦組",ellipsisNum:6,formatter:t=>t.coAucitorTeam.map(t=>t.auditorName).join("、")},{type:Re.PLAIN,property:"ckBaseDate",title:"查核基準日",formatter:t=>this.dateFormatter.stringify(t.ckBaseDate)},{type:Re.TEMPLATE,template:"ckData",title:"查核期間"},{type:Re.TEMPLATE,template:"ckRangeDateArr",title:"受查範圍期間"},{type:Re.PLAIN,property:"status",title:"查核狀態",formatter:t=>t.status.valueName}]}}get todoDisabled(){return["ROLE_Audit_Office_Boss"].includes(this.$global.getCurrentRoleId())}get isGroupShow(){return!["ROLE_Audit_Team_Head","ROLE_Auditor"].includes(this.$global.getCurrentRoleId())}openModal(t){}initSearchForm(){this.searchForm.year=void 0,this.searchForm.startMonth=void 0,this.searchForm.endMonth=void 0,this.searchForm.auditItem=void 0,this.searchForm.auditorTeam=void 0,this.searchForm.unit=void 0}getRangeDate(t,e){return`${this.dateFormatter.stringify(t)}-${this.dateFormatter.stringify(e)}`}getApi_year(){this.setLoading(!0),this.$workPaperApi.searchYearInWorkPaperUsingGET().then(t=>{const e=t.data.result;this.selectorOption.year=e}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_auditItem(t){this.setLoading(!0),this.$workPaperApi.searchAuditItemInWorkPaperUsingGET(t).then(t=>{const e=t.data.result;this.selectorOption.auditItem=e}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_checkedUnit(t){this.setLoading(!0),this.$workPaperApi.searchUnitInWorkPaperUsingGET(t).then(t=>{const e=t.data.result;this.selectorOption.checkedUnit=e}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_groups(){this.setLoading(!0),this.$auditPlanApi.searchAuditorTeamInAuditPlanUsingGET().then(t=>{const e=t.data.result;this.selectorOption.groups=e}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_auditingList(){this.setLoading(!0),this.grid.data=[],this.grid.pagination.total=0;const t={toDo:this.searchForm.toDo,hasOpinion:this.searchForm.hasOpinion,year:null,startMonth:null,endMonth:null,auditItem:null,auditorTeam:null,unit:null,pageIndex:this.grid.pagination.current-1,pageSize:this.grid.pagination.pageSize};this.searchForm.toDo||(t.year=this.searchForm.year?ya()(this.searchForm.year).year()+1911:null,t.startMonth=this.searchForm.startMonth||null,t.endMonth=this.searchForm.endMonth||null,t.auditItem=this.searchForm.auditItem||null,t.auditorTeam=this.searchForm.auditorTeam||null,t.unit=this.searchForm.unit||null),this.$workPaperApi.searchWorkPaperDataInWorkPaperUsingPOST(t).then(t=>{const e=t.data.result;this.grid.data=e.content,this.grid.pagination.total=parseInt(e.totalElements)}).catch(console.error).finally(()=>{this.setLoading(!1)}),this.cacheSearch.toDo=this.searchForm.toDo,this.cacheSearch.hasOpinion=this.searchForm.hasOpinion}handleTableChange(t){this.grid.pagination.current=t.pagination.current,this.grid.pagination.pageSize=t.pagination.pageSize,this.getApi_auditingList()}auditItemDetail(t){this.$global.changeRouterAndaddParam({toRouter:"AuditingDetail",query:{...t,cacheData:{toDo:this.cacheSearch.toDo,hasOpinion:this.cacheSearch.hasOpinion,auditDraftId:t.auditDraftId,quarterPlanMId:t.quarterPlanMId,inCharge:t.inCharge,status:t.status}}})}handleYearChange(){this.searchForm.year&&(this.getApi_auditItem(this.searchForm.year),this.getApi_checkedUnit(this.searchForm.year))}onSearch(){this.getApi_auditingList()}todoChange(){this.$refs.formRef.clearValidate()}created(){this.currentRole=this.$global.getCurrentRole(),this.getApi_year()}async mounted(){this.initSearchForm(),await this.getApi_groups(),["ROLE_Audit_Team_Head","ROLE_Auditor"].includes(this.$global.getCurrentRoleId())&&(this.searchForm.auditorTeam=this.$global.getCurrentRoleTeamCode()),this.todoDisabled||(this.searchForm.toDo="todo"===this.$route.params.type),this.onSearch()}watchDeep(t){}};Object(J.a)([Object(tt.a)("setLoading")],Is.prototype,"setLoading",void 0),Object(J.a)([As.Action("setModalState")],Is.prototype,"setModalState",void 0),Object(J.a)([tt.b],Is.prototype,"getWindowSize",void 0),Object(J.a)([Object(et.e)("searchForm",{deep:!0})],Is.prototype,"watchDeep",null),Is=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,ActionBar:Os,FblDataGrid:gt}})],Is);var Ds=Is,Ss=(a("87ba"),Object(st.a)(Ds,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-contain crawlerindex-container container"},[a("div",{staticClass:"search-form form d-flex"},[a("a-form-model",{ref:"formRef",staticClass:"row flex-grow-1",attrs:{model:t.searchForm,"hide-required-mark":!0}},[a("div",{staticClass:"col-6 col-lg-6 col-xl"},[a("div",{staticClass:"search-form__label"},[t._v(" 年度 ")]),a("a-form-model-item",{attrs:{prop:"year"}},[a("a-select",{staticClass:"w-100",attrs:{placeholder:"請選擇年度",disabled:t.searchForm.toDo,"filter-option":t.$global.filterOption,options:t.selectorOption.year,"dropdown-match-select-width":!1,"allow-clear":!0},on:{change:t.handleYearChange},model:{value:t.searchForm.year,callback:function(e){t.$set(t.searchForm,"year",e)},expression:"searchForm.year"}})],1)],1),a("div",{staticClass:"col-6 col-lg-6 col-xl"},[a("div",{staticClass:"search-form__label"},[t._v(" 月份 ")]),a("a-form-model-item",{ref:"startMonth",attrs:{prop:"startMonth"}},[a("a-input-group",{staticClass:"d-flex",attrs:{compact:""}},[a("a-select",{staticClass:"col search__result__month search__result__month--left",attrs:{"show-search":"",placeholder:"起",disabled:t.searchForm.toDo,options:t.$enum.monthOption,"filter-option":t.$global.filterOption,"allow-clear":!0,"dropdown-match-select-width":!1},model:{value:t.searchForm.startMonth,callback:function(e){t.$set(t.searchForm,"startMonth",e)},expression:"searchForm.startMonth"}}),a("a-input",{staticClass:"search__result__range",attrs:{placeholder:"~",disabled:""}}),a("a-select",{staticClass:"col search__result__month search__result__month--right",attrs:{"show-search":"",placeholder:"迄",disabled:t.searchForm.toDo,options:t.$enum.monthOption,"allow-clear":!0,"filter-option":t.$global.filterOption,"dropdown-match-select-width":!1},model:{value:t.searchForm.endMonth,callback:function(e){t.$set(t.searchForm,"endMonth",e)},expression:"searchForm.endMonth"}})],1)],1)],1),a("div",{staticClass:"col-6 col-lg-6 col-xl"},[a("div",{staticClass:"search-form__label"},[t._v(" 查核項目 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"",disabled:t.searchForm.toDo||t.selectorOption.auditItem.length<=0,options:t.selectorOption.auditItem,"dropdown-match-select-width":!1,"filter-option":t.$global.filterOption,"allow-clear":!0,placeholder:t.searchForm.toDo||t.selectorOption.auditItem.length<=0?null:"請選擇查核項目"},model:{value:t.searchForm.auditItem,callback:function(e){t.$set(t.searchForm,"auditItem",e)},expression:"searchForm.auditItem"}})],1),a("div",{staticClass:"col-6 col-lg-6 col-xl"},[a("div",{staticClass:"search-form__label"},[t._v(" 受查單位 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"",disabled:t.searchForm.toDo||[].concat(t.selectorOption.checkedUnit)<=0,"dropdown-match-select-width":!1,"filter-option":t.$global.filterOption,"allow-clear":!0,placeholder:t.searchForm.toDo||[].concat(t.selectorOption.checkedUnit)<=0?null:"請選擇受查單位"},model:{value:t.searchForm.unit,callback:function(e){t.$set(t.searchForm,"unit",e)},expression:"searchForm.unit"}},t._l(t.selectorOption.checkedUnit,(function(e){return a("a-select-option",{key:e.departmentId,attrs:{value:e.departmentName}},[t._v(" "+t._s(e.departmentName)+" ")])})),1)],1),t.isGroupShow?a("div",{staticClass:"col-6 col-lg-6 col-xl"},[a("div",{staticClass:"search-form__label"},[t._v(" 組別 ")]),a("a-select",{staticClass:"w-100",attrs:{"show-search":"",disabled:t.searchForm.toDo||!(t.selectorOption.groups&&t.selectorOption.groups.length>0),options:t.selectorOption.groups,"dropdown-match-select-width":!1,"filter-option":t.$global.filterOption,"allow-clear":!0,placeholder:t.searchForm.toDo||!(t.selectorOption.groups&&t.selectorOption.groups.length>0)?null:"請選擇組別"},model:{value:t.searchForm.auditorTeam,callback:function(e){t.$set(t.searchForm,"auditorTeam",e)},expression:"searchForm.auditorTeam"}})],1):t._e(),a("div",{staticClass:"col-6 col-lg-auto d-flex align-items-start pt-3"},[a("div",{staticClass:"d-flex align-items-center w-auto mt-2"},[a("a-checkbox",{attrs:{disabled:t.todoDisabled},on:{change:t.todoChange},model:{value:t.searchForm.toDo,callback:function(e){t.$set(t.searchForm,"toDo",e)},expression:"searchForm.toDo"}},[t._v(" 待辦 ")])],1),a("div",{staticClass:"d-flex align-items-center w-auto mt-2"},[a("a-checkbox",{model:{value:t.searchForm.hasOpinion,callback:function(e){t.$set(t.searchForm,"hasOpinion",e)},expression:"searchForm.hasOpinion"}},[t._v(" 有查核意見 ")])],1),a("div",{staticClass:"mt-1"},[a("button",{staticClass:"btn--search",on:{click:t.onSearch}},[t._v(" 查詢 ")])])])])],1),a("div",{staticClass:"search-header d-flex flex-wrap-reverse align-items-center"},[t._m(0),a("div",{staticClass:"btnGroup ms-auto"},[a("ActionBar",{attrs:{role:t.currentRole.id},on:{openModal:t.openModal}})],1)]),a("fbl-data-grid",{attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:t.grid.pagination,scroll:{x:!0}},on:{tableChange:t.handleTableChange},scopedSlots:t._u([{key:"month",fn:function(e){return[a("span",[t._v(t._s(e.data.startMoth)+" ~ "+t._s(e.data.endMoth))])]}},{key:"auditItemName",fn:function(e){return[a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.auditItemDetail(e.data)}}},[t._v(t._s(e.data.auditItemName))])]}},{key:"ckData",fn:function(e){return[a("span",[t._v(t._s(t.getRangeDate(e.data.ckStartDate,e.data.ckEndDate)))])]}},{key:"ckRangeDateArr",fn:function(e){return[a("span",[t._v(t._s(t.getRangeDate(e.data.ckRangeStrDate,e.data.ckRangeEndDate)))])]}}])})],1)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"titleBar d-flex flex-wrap"},[a("div",{staticClass:"search-header__title"},[t._v(" 查核項目 ")])])}],!1,null,"8140ecae",null).exports);let ws=class extends et.d{constructor(){super(...arguments),this.webSiteLinkArr=[]}get isDisabledAuditOpinionStatus(){return["99"].includes(this.auditOpinionStatus)}get showAddButton(){const t=["ROLE_Auditor","ROLE_Audit_Team_Head"].includes(this.$global.getCurrentRoleId()),e=this.checkMan.map(t=>t.domainId).includes(this.$user.getMe().employee.domainId);return t&&e&&!this.isDisabledAuditOpinionStatus}getApi_websiteLink(){this.setLoading(!0),this.$workPaperApi.searchWebsiteLinkUsingGET().then(t=>{const e=t.data.result;this.webSiteLinkArr=e}).catch(()=>{}).finally(()=>{this.setLoading(!1)})}handleClick(t){this.$emit("click",t)}created(){this.getApi_websiteLink()}};Object(J.a)([Object(tt.a)("setLoading")],ws.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],ws.prototype,"role",void 0),Object(J.a)([Object(et.b)()],ws.prototype,"communicateType",void 0),Object(J.a)([Object(et.b)()],ws.prototype,"auditDraftSectionId",void 0),Object(J.a)([Object(et.b)()],ws.prototype,"showButtonStatus",void 0),Object(J.a)([Object(et.b)()],ws.prototype,"sortDataNum",void 0),Object(J.a)([Object(et.b)()],ws.prototype,"auditOpinionStatus",void 0),Object(J.a)([Object(et.b)()],ws.prototype,"checkMan",void 0),ws=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,CustomPopConfirm:ce}})],ws);var ks=ws,Ms=(a("97af"),a("6cb2"),Object(st.a)(ks,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"actionBarWrap d-flex align-items-center flex-wrap justify-content-end"},[t.auditDraftSectionId?[a("a-dropdown",{attrs:{"overlay-class-name":"linkButtonDropdown",placement:"bottomLeft"}},[a("IconTextButton",{attrs:{text:"網站連結",type:"web_linke"}}),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},t._l(t.webSiteLinkArr,(function(e,i){return a("a-menu-item",{key:i},[a("a",{attrs:{href:e.link,target:"_blank"}},[t._v(t._s(e.name))])])})),1)],1),a("IconTextButton",{attrs:{text:"上傳資料",type:"upload"},on:{click:function(e){return t.handleClick("upload")}}}),t.showButtonStatus.commnuicateStartButton?a("IconTextButton",{attrs:{text:"溝通啟動",type:"communicate"},on:{click:function(e){return t.handleClick("commnuicateStart")}}}):t._e(),t.showButtonStatus.commnuicateEndButton?a("IconTextButton",{attrs:{text:"溝通結束",type:"communicate1"},on:{click:function(e){return t.handleClick("commnuicateEnd")}}}):t._e(),t.showButtonStatus.reportFinishButton?a("IconTextButton",{attrs:{text:"稽核報告審閱完畢",type:"complete"},on:{click:function(e){return t.handleClick("reportFinish")}}}):t._e(),t.showButtonStatus.auditFinishButton?a("IconTextButton",{attrs:{text:"查核結束",type:"check_fin"},on:{click:function(e){return t.handleClick("auditFinishButton")}}}):t._e(),t.showAddButton?a("IconTextButton",{attrs:{text:"新增查核",type:"add"},on:{click:function(e){return t.handleClick("add")}}}):t._e(),t.sortDataNum?a("IconTextButton",{attrs:{text:"查核內容排序",type:"sort"},on:{click:function(e){return t.handleClick("sort")}}}):t._e(),t.showButtonStatus.submitButton?a("CustomPopConfirm",{attrs:{title:"確認覆核？"},on:{confirm:function(e){return t.handleClick("submit")}}},[a("IconTextButton",{attrs:{text:"送出覆核",type:"edit"}})],1):t._e(),t.showButtonStatus.reviewButton?a("CustomPopConfirm",{attrs:{title:"確認審畢？"},on:{confirm:function(e){return t.handleClick("review")}}},[a("IconTextButton",{attrs:{text:"審畢",type:"enter"}})],1):t._e(),a("IconTextButton",{attrs:{text:"匯出總表",type:"export"},on:{click:function(e){return t.handleClick("export")}}})]:t._e(),a("IconTextButton",{attrs:{text:"上一頁",type:"return"},on:{click:function(e){return t.handleClick("back")}}})],2)}),[],!1,null,"178a26dd",null).exports);const xs=Object(tt.c)("modalControl");let js=class extends et.d{constructor(){super(...arguments),this.grid={rowKey:"auditDraftContentId",data:[],columns:[{type:Re.TEMPLATE,template:"seq",width:"80px",title:"序號"},{type:Re.PLAIN,property:"content",title:"查核內容"}]},this.seqError={empty:[],type:[],repeat:[]}}validateStatus({auditDraftContentId:t}){return this.seqError.empty.includes(t)||this.seqError.type.includes(t)||this.seqError.repeat.includes(t)?"error":""}get_auditingContent(){this.grid.data=[],this.grid.data=this.$global.deepCopyData(this.slotData).filter(t=>"90"!==t.status.keyId)}getApi_setAuditDraftContentSeq(){this.setLoading(!0);const t=this.grid.data.map(t=>({auditDraftContentId:t.auditDraftContentId,seq:t.seq}));this.$workPaperApi.setAuditDraftContentSeqUsingPOST(t).then(t=>{t.data?(this.setModalState({resultModal:{visible:!0,type:"success",title:"調整排序成功",autoClose:3}}),this.closeModal(),this.$emit("updateData")):this.setModalState({resultModal:{visible:!0,type:"error",title:"調整排序失敗"}})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"調整排序失敗"}})}).finally(()=>{this.setLoading(!1)})}closeModal(){this.syncedVisible=!1}clearSeqError(){this.seqError.empty=[],this.seqError.type=[],this.seqError.repeat=[]}seqValidate(){this.seqError.type=this.grid.data.filter(t=>isNaN(Number(t.seq))).map(t=>t.auditDraftContentId),this.seqError.empty=this.grid.data.filter(t=>!t.seq).map(t=>t.auditDraftContentId);const t=this.grid.data.map(t=>t.seq).filter((t,e,a)=>a.indexOf(t)!==e);this.seqError.repeat=this.grid.data.filter(e=>t.includes(e.seq)).map(t=>t.auditDraftContentId)}submit(){this.clearSeqError(),this.seqValidate(),this.seqError.empty.length>0||this.seqError.type.length>0||this.seqError.repeat.length>0||this.getApi_setAuditDraftContentSeq()}watchVisible(t){t&&(this.clearSeqError(),this.get_auditingContent())}};Object(J.a)([xs.Action("setModalState")],js.prototype,"setModalState",void 0),Object(J.a)([Object(tt.a)("setLoading")],js.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("visible")],js.prototype,"syncedVisible",void 0),Object(J.a)([Object(et.b)()],js.prototype,"slotData",void 0),Object(J.a)([Object(et.e)("syncedVisible")],js.prototype,"watchVisible",null),js=Object(J.a)([Object(et.a)({components:{InfoModal:_t,ResponseMessage:Le,FblDataGrid:gt}})],js);var Ts=js,Ls=(a("dd21"),Object(st.a)(Ts,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"查核內容排序",visible:t.visible,centered:!0,width:950},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("div",{staticClass:"bgLight__wrap mt-4"},[a("div",{staticClass:"precautions"},[a("div",{staticClass:"d-flex precautions__title"},[a("a-icon",{staticClass:"precautions__icon",attrs:{type:"exclamation-circle"}}),t._v("查核內容排序的方法 ")],1),a("ul",{staticClass:"precautions__listGroup"},[a("li",{staticClass:"precautions__list"},[t._v(" 請於序號欄位，輸入欲移到的位置輸入序號介於之間的數字ex.1.5 ，點選「確定」存檔後會將此筆移到序號1後面。 ")]),a("li",{staticClass:"precautions__list"},[t._v(" 可以多筆一起移動，請於序號欄位，輸入欲移到的位置輸入序號介於之間的數字ex.1.1~1.9，點選「確定」存檔後會將多筆資料移到序號1後面。 ")])])]),a("fbl-data-grid",{staticClass:"table--pale table--auditingSort",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,bordered:!0,pagination:!1},scopedSlots:t._u([{key:"seq",fn:function(e){return[a("a-form-model-item",{staticClass:"d-flex justify-content-center mb-0",attrs:{"validate-status":t.validateStatus(e.data)}},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.data.seq,expression:"slotData.data.seq",modifiers:{number:!0}}],staticClass:"precautions__seq__input",attrs:{type:"number",min:1},domProps:{value:e.data.seq},on:{change:t.seqValidate,input:function(a){a.target.composing||t.$set(e.data,"seq",t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})])]}}])}),t.seqError.empty.length>0||t.seqError.type.length>0||t.seqError.repeat.length>0?a("p",{staticClass:"message--error"},[t.seqError.empty.length>0||t.seqError.type.length>0?[t._v(" 請填寫有效序號！ ")]:t._e(),t.seqError.repeat.length>0?[t._v(" 序號不得重複！ ")]:t._e()],2):t._e()],1),a("div",{staticClass:"d-flex mt-4 justify-content-end"},[a("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 確認 ")]),a("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],2)}),[],!1,null,"89d7aae2",null).exports);const Ps=Object(tt.c)("modalControl");let Rs=class extends et.d{constructor(){super(...arguments),this.form={auditContent:""},this.formRules={auditContent:[{required:!0,message:"請選擇查核內容",trigger:"change"}]}}getApi_addAuditing(){this.setLoading(!0),this.$workPaperApi.createAuditDraftUsingGET(this.auditDraftSectionId,this.form.auditContent).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"新增查核成功",autoClose:3}}),this.closeModal(),this.$emit("updateData")}).catch(console.error).finally(()=>{this.setLoading(!1)})}closeModal(){this.syncedVisible=!1}async submit(){this.$refs.formRef.validate(t=>{t&&this.getApi_addAuditing()})}watchVisible(t){t&&(this.form.auditContent="")}};Object(J.a)([Object(tt.a)("setLoading")],Rs.prototype,"setLoading",void 0),Object(J.a)([Ps.Action("setModalState")],Rs.prototype,"setModalState",void 0),Object(J.a)([Object(et.c)("visible")],Rs.prototype,"syncedVisible",void 0),Object(J.a)([Object(et.b)({required:!0})],Rs.prototype,"auditDraftSectionId",void 0),Object(J.a)([Object(et.e)("syncedVisible")],Rs.prototype,"watchVisible",null),Rs=Object(J.a)([Object(et.a)({components:{InfoModal:_t,ResponseMessage:Le,FblDataGrid:gt}})],Rs);var Es=Rs,$s=(a("b1f4"),Object(st.a)(Es,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"新增查核",visible:t.visible,centered:!0,width:950},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("div",{staticClass:"bgLight__wrap mt-4"},[a("a-form-model",{ref:"formRef",staticClass:"content__form",attrs:{model:t.form,rules:t.formRules,"hide-required-mark":!0}},[a("a-form-model-item",{attrs:{prop:"auditContent","label-col":{span:3},"wrapper-col":{span:21}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 查核內容： ")]),a("div",{staticClass:"confirm-message"},[a("a-textarea",{attrs:{"auto-size":{minRows:6}},model:{value:t.form.auditContent,callback:function(e){t.$set(t.form,"auditContent",e)},expression:"form.auditContent"}})],1)])],1)],1),a("div",{staticClass:"d-flex mt-4 justify-content-end"},[a("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" 送出 ")]),a("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],2)}),[],!1,null,"249612b0",null).exports);Object(tt.c)("modalControl");let Fs=class extends et.d{constructor(){super(...arguments),this.form={auditContent:""},this.formRules={auditContent:[{required:!0,message:"請選擇查核內容",trigger:"change"}]}}closeModal(){this.syncedVisible=!1}async submit(t){this.$emit("updateData",t),this.syncedVisible=!1}watchVisible(t){}};Object(J.a)([Object(tt.a)("setLoading")],Fs.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("visible")],Fs.prototype,"syncedVisible",void 0),Object(J.a)([Object(et.e)("syncedVisible")],Fs.prototype,"watchVisible",null),Fs=Object(J.a)([Object(et.a)({components:{InfoModal:_t,ResponseMessage:Le,FblDataGrid:gt}})],Fs);var Us=Fs,Gs=(a("f8fa"),Object(st.a)(Us,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"資料覆核",visible:t.visible,centered:!0,width:500,closable:!0},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("div",[a("p",{staticClass:"notes"},[t._v(" 是否給副總稽核確認 ")]),a("div",{staticClass:"sobv__buttonBarWrap d-flex justify-content-center"},[a("div",{staticClass:"col sobv__buttonWrap"},[a("button",{staticClass:"sobv__button d-flex justify-content-center align-items-center",on:{click:function(e){return t.submit(!0)}}},[a("i",{staticClass:"sobv__icon sobv__confirm"}),a("span",{staticClass:"sobv__text"},[t._v("是")])]),a("span",{staticClass:"caption"},[t._v("提供副總稽核確認！")])]),a("div",{staticClass:"col sobv__buttonWrap"},[a("button",{staticClass:"sobv__button d-flex justify-content-center align-items-center",on:{click:function(e){return t.submit(!1)}}},[a("i",{staticClass:"sobv__icon sobv__close"}),a("span",{staticClass:"sobv__text"},[t._v("否")])])])])])])],2)}),[],!1,null,"44d9700e",null).exports);const Ys=Object(tt.c)("modalControl");let Ns=class extends et.d{constructor(){super(...arguments),this.form={fileType:void 0},this.showDelete=!1,this.fileList=[],this.canType=[],this.formRules={fileType:[{required:!0,message:"請選擇資料類型",trigger:"change"}]},this.fileTypeList=[],this.promiseArray=[],this.uploadErr=[],this.modalData={content:"",title:"",type:"",autoClose:null},this.grid={rowKey:"auditDraftFileId",data:[],columns:[{type:Re.TEMPLATE,property:"fileName",title:"檔案名稱",template:"fileName"},{type:Re.PLAIN,property:"fileTypeCn",title:"資料類型"},{type:Re.PLAIN,property:"updateUserCn",title:"上傳人員"},{type:Re.PLAIN,property:"updateDateTime",title:"上傳時間",formatter:t=>this.$twDateTimeFormatter.stringify(t.updateDateTime)},{type:Re.TEMPLATE,property:"delete",template:"delete",title:"刪除",width:100}]}}initData(){this.form={fileType:void 0},this.fileList=[],this.grid.data=[]}validatorFileTypeExt(t){const e=this.canType.reduce((t,e)=>`${t}|${e}`);return!!new RegExp(`(${e})$`).test(t.name)}uploadFileTypeValidationMsg(){this.setModalState({resultModal:{autoClose:null,content:"檔案格式不符，請重新選擇檔案",type:"warning",title:"上傳提示",visible:!0}})}validatorFileSizeTypeExt(t){return 200/1024/1024<t.size}uploadFileSizeValidationMsg(){this.setModalState({resultModal:{autoClose:null,content:"檔案大小超過200MB，請重新選擇檔案",type:"warning",title:"上傳提示",visible:!0}})}async getApi_docType(){this.setLoading(!0),await this.$workPaperApi.searchDocTypeUsingPOST().then(t=>{const e=this.$global.deepCopyData(t.data.result);e&&e.length>0&&(this.fileTypeList=e.map(t=>({label:t.name,value:t.id})))}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_authorizationFileType(){this.$parameterApi.searchAllowedFileExtensionsInParameterUsingGET().then(t=>{this.canType=t.data.result})}getApi_searchAudifDraftFile(){this.setLoading(!0),this.$workPaperApi.searchAudifDraftFileUsingPOST(this.auditDraftId).then(t=>{const e=this.$global.deepCopyData(t.data.result),a=e.auditDraftFileVOS;e&&e.length>0&&a.map(t=>{t.fileType=this.fileTypeList.find(e=>e.value===t.fileType).label}),this.grid.data=a,this.showDelete=e.showDelete}).catch(console.error).finally(()=>{this.setLoading(!1)})}uploadFile({onSuccess:t,onError:e,file:a}){this.$refs.formRef.validate().then(()=>this.validatorFileTypeExt(a)?this.validatorFileSizeTypeExt(a)?void this.$workPaperApi.uploadAudifDraftFileUsingPOST(this.auditDraftId,a.name,this.form.fileType,a).then(e=>{this.getApi_searchAudifDraftFile(),this.setModalState({resultModal:{visible:!0,type:"success",title:"上傳成功",autoClose:3}}),t(e.data)}).catch(t=>{e(t)}):(this.uploadFileSizeValidationMsg(),e("fail"),!1):(this.uploadFileTypeValidationMsg(),e("fail"),!1)).catch(()=>(this.setModalState({resultModal:{visible:!0,type:"error",title:"請先選擇檔案類型"}}),!1))}remove({auditDraftFileId:t}){this.setLoading(!0),this.$workPaperApi.removeAuditDraftFileUsingPOST(t).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}}),this.getApi_searchAudifDraftFile()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除失敗"}})}).finally(()=>{this.setLoading(!1)})}onDownload({auditDraftFileId:t,fileName:e}){this.setLoading(!0),this.$workPaperApi.downloadAuditDraftFileUsingPOST(t,{responseType:"blob"}).then(t=>{const a=document.createElement("a"),i=(window.URL||window.webkitURL).createObjectURL(t.data),s=e;a.setAttribute("href",i),a.setAttribute("download",""+s),a.click(),a.remove()}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}closeModal(){this.syncedVisible=!1}async created(){this.user=this.$user.getMe(),this.getApi_authorizationFileType(),await this.getApi_docType(),this.initData(),this.getApi_searchAudifDraftFile()}watchVisible(t){t&&this.getApi_searchAudifDraftFile()}};Object(J.a)([Object(tt.a)("setLoading")],Ns.prototype,"setLoading",void 0),Object(J.a)([Ys.Action("setModalState")],Ns.prototype,"setModalState",void 0),Object(J.a)([Object(et.c)("visible")],Ns.prototype,"syncedVisible",void 0),Object(J.a)([Object(et.b)()],Ns.prototype,"auditDraftId",void 0),Object(J.a)([Object(et.e)("syncedVisible")],Ns.prototype,"watchVisible",null),Ns=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,InfoModal:_t,CustomPopConfirm:ce}})],Ns);var Vs=Ns,qs=(a("9114"),Object(st.a)(Vs,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"上傳資料",visible:t.visible,centered:!0,"body-size":"large","padding-size":"small",closable:!0},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("div",{staticClass:"content__wrap mt-2"},[i("a-form-model",{ref:"formRef",staticClass:"content__form",attrs:{model:t.form,rules:t.formRules,"hide-required-mark":!1}},[i("a-form-model-item",{staticClass:"d-flex justify-content-center",attrs:{prop:"fileType","label-col":{span:4},"wrapper-col":{span:8},label:"資料類型"}},[i("a-select",{staticClass:"input--select",attrs:{placeholder:"請選擇資料類型"},model:{value:t.form.fileType,callback:function(e){t.$set(t.form,"fileType",e)},expression:"form.fileType"}},t._l(t.fileTypeList,(function(e){return i("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1),i("a-upload-dragger",{staticClass:"upload__dragger",attrs:{"show-upload-list":!1,"file-list":t.fileList,"custom-request":t.uploadFile,multiple:!0}},[i("p",{staticClass:"ant-upload-drag-icon"},[i("a-icon",{attrs:{type:"container"}})],1),i("p",{staticClass:"ant-upload-text"},[t._v(" 點選或將文件拖曳到這裡上傳 ")]),i("p",{staticClass:"ant-upload-hint"},[t._v(" 支援多種格式，檔案大小200MB以內 ")])]),i("fbl-data-grid",{staticClass:"upload__table mt-3",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:!1,scroll:{x:!0}},scopedSlots:t._u([{key:"fileName",fn:function(e){return[i("a",{staticClass:"file__list__text",on:{click:function(a){return t.onDownload(e.data)}}},[t._v(" "+t._s(e.data.fileName)+" ")])]}},{key:"delete",fn:function(e){return[i("div",{staticClass:"flex-center"},[t.showDelete&&e.data.canDeleteFlag?i("CustomPopConfirm",{on:{confirm:function(a){return t.remove(e.data)}}},[i("img",{staticClass:"table__btn-delete",attrs:{alt:"",src:a("178a")}})]):t._e()],1)]}}])})],1)])],2)}),[],!1,null,"9425a962",null).exports);Object(tt.c)("modalControl");let Bs=class extends et.d{constructor(){super(...arguments),this.uploadType=[],this.$query={auditDraftId:"",year:"",auditItemName:""}}reset(){this.uploadType=[],this.$query={auditDraftId:"",year:"",auditItemName:""}}getApi_docType(){this.setLoading(!0),this.$workPaperApi.searchDocTypeUsingPOST().then(t=>{const e=this.$global.deepCopyData(t.data.result);this.uploadType=e.map(t=>({label:t.name,value:t.id}))}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_exportDoc(t){this.setLoading(!0);const e={auditDraftId:this.$query.auditDraftId,docType:t};let a=`${this.$query.year}年度_${this.$query.auditItemName}_`;switch(t){case"01":a+="工作底稿";break;case"02":a+="初步查核發現匯總表";break;case"03":a+="初步查核發現及溝通紀錄";break;case"04":a+="稽核報告";break;case"05":a+="查核意見確認表"}this.$workPaperApi.exportWorkPaperDocUsingPOST(e,{responseType:"blob"}).then(t=>{const e=document.createElement("a"),i=(window.URL||window.webkitURL).createObjectURL(t.data),s=a;e.setAttribute("href",i),e.setAttribute("download",""+s),e.click(),e.remove()}).catch(console.error).finally(()=>{this.setLoading(!1)})}closeModal(){this.syncedVisible=!1}exportDoc({label:t,value:e}){this.getApi_exportDoc(e)}watchVisible(t){t&&(this.reset(),this.$query=this.$global.getQuery(),this.getApi_docType())}};Object(J.a)([Object(tt.a)("setLoading")],Bs.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("visible")],Bs.prototype,"syncedVisible",void 0),Object(J.a)([Object(et.e)("syncedVisible")],Bs.prototype,"watchVisible",null),Bs=Object(J.a)([Object(et.a)({components:{InfoModal:_t,ResponseMessage:Le,FblDataGrid:gt}})],Bs);var zs=Bs,Hs=(a("a207"),Object(st.a)(zs,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"匯出檔案",visible:t.visible,centered:!0,width:950,closable:!0},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("div",{staticClass:"bgLight__wrap mt-4"},[a("div",{staticClass:"graybar__wrap"},[a("div",{staticClass:"graybar__list"},t._l(t.uploadType,(function(e,i){return a("button",{key:i,staticClass:"graybar__list__item flex-center",on:{click:function(a){return t.exportDoc(e)}}},[a("div",{staticClass:"list__item-text col-7"},[a("div",{staticClass:"list__item-icon"}),t._v(t._s(e.label)+" ")])])})),0)])])])],2)}),[],!1,null,"52908405",null).exports);const Qs=Object(tt.c)("modalControl");let Ws=class extends et.d{constructor(){super(...arguments),this.formatter=this.$twDateFormatter,this.yearFormatter=this.$twYearFormatter,this.isLoading=!1,this.currentRole=null,this.auditingDetailData={},this.auditItemTitle="保費帳務處理作業",this.communicateType="A",this.selectorOption={section:[]},this.noOpionComment={cache:"",value:"",isEdit:!1,editStatus:!0},this.submitForm={toDo:!1,hasOpinion:!1,auditDraftSectionId:void 0,auditDraftId:"",quarterPlanMId:""},this.showButtonStatus={auditFinishButton:!1,commnuicateEndButton:!1,commnuicateStartButton:!1,reportFinishButton:!1,reviewButton:!1,submitButton:!1},this.inCharge={},this.grid={rowKey:"auditDraftContentId",data:[],pagination:!1,columns:[{type:Re.TEMPLATE,template:"seq",title:"序號"},{type:Re.PLAIN,property:"content",inspect:!0,title:"查核內容"},{type:Re.PLAIN,property:"opinion",title:"查核意見",formatter:t=>t.opinion.valueName},{type:Re.PLAIN,property:"status",title:"查核狀態",formatter:t=>t.status.valueName},{type:Re.TEMPLATE,template:"actions",width:"130px",title:"刪除"}]},this.upLoadModal={visible:!1},this.auditingSortModal={visible:!1},this.addAuditModal={visible:!1},this.sendOfficeBossViceModal={visible:!1,auditDraftContentIds:[]},this.exportModal={visible:!1},this.rowSelection={onChange:this.rowSelectionChange,selectedRowKeys:[],getCheckboxProps:this.getCheckboxProps}}get todoDisabled(){return["ROLE_Audit_Office_Boss"].includes(this.$global.getCurrentRoleId())}get selectSection(){return this.selectorOption.section.find(t=>t.value===this.submitForm.auditDraftSectionId)}get checkMan(){return this.selectSection&&"checkMan"in this.selectSection?this.selectSection.checkMan:[]}get sectionAuditors(){return this.selectSection&&"checkMan"in this.selectSection?this.selectSection.checkMan.map(t=>t.name):[]}get sortDataNum(){return this.grid.data.length}get auditOpinionStatus(){return this.$global.getQuery().status.keyId}get changeSection(){return{toDo:this.submitForm.toDo,hasOpinion:this.submitForm.hasOpinion}}rowSelectionChange(t,e){this.rowSelection.selectedRowKeys=t}getCheckboxProps(t){return{props:{disabled:!1===t.showCheckboxEnabled}}}emitClick(t){switch(t){case"upload":this.upLoadModal.visible=!0;break;case"commnuicateStart":this.getApi_commnuicateStart();break;case"commnuicateEnd":this.getApi_commnuicateEnd();break;case"reportFinish":this.getApi_reportFinish();break;case"auditFinishButton":this.getApi_auditFinish();break;case"add":this.addAuditModal.visible=!0;break;case"sort":this.auditingSortModal.visible=!0;break;case"submit":this.onSubmit(this.rowSelection.selectedRowKeys);break;case"review":this.sendOfficeBossViceModal.auditDraftContentIds=this.rowSelection.selectedRowKeys,null===this.selectSection.viceCheck?this.sendOfficeBossViceModal.visible=!0:this.onReview(this.selectSection.viceCheck);break;case"export":this.exportModal.visible=!0;break;case"back":this.$router.go(-1)}}initSearchForm(){this.submitForm.toDo=!1,this.submitForm.hasOpinion=!1,this.submitForm.auditDraftSectionId=void 0,this.submitForm.auditDraftId="",this.submitForm.quarterPlanMId=""}setParam(){const t=this.$global.getQuery(),e=t.cacheData;t&&(this.submitForm.toDo=e.toDo,this.submitForm.hasOpinion=e.hasOpinion,this.submitForm.auditDraftId=e.auditDraftId,this.submitForm.quarterPlanMId=e.quarterPlanMId,this.inCharge=t.inCharge,this.auditItemTitle=t.auditItemName)}resultModal(t){this.setModalState({resultModal:{...t,visible:!0}})}async getApi_section(){this.setLoading(!0);const t={toDo:this.submitForm.toDo,hasOpinion:this.submitForm.hasOpinion,auditDraftId:this.submitForm.auditDraftId,quarterPlanMId:this.submitForm.quarterPlanMId};await this.$workPaperApi.searchAuditDraftSectionDataInWorkPaperUsingPOST(t).then(t=>{const e=t.data.result;this.selectorOption.section=e.sectionResponseVos.map(t=>({label:`${this.$enum.intNumToCh(t.seq)}、${t.auditDraftSectionName}`,value:t.auditDraftSectionId,checkMan:t.checkMan,noOptionComment:t.noOptionComment,viceCheck:t.isViceCheck})),this.$global.getQuery().cacheData.auditDraftSectionId&&this.selectorOption.section.map(t=>t.value).includes(this.$global.getQuery().cacheData.auditDraftSectionId)?this.submitForm.auditDraftSectionId=this.$global.getQuery().cacheData.auditDraftSectionId:this.selectorOption.section.length>0?this.submitForm.auditDraftSectionId=this.selectorOption.section[0].value:this.submitForm.auditDraftSectionId=void 0}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_auditItemList(){this.setLoading(!0),this.grid.data=[],this.rowSelection.selectedRowKeys=[],this.$workPaperApi.searchAuditDraftContentInWorkPaperUsingPOST(this.submitForm).then(t=>{const e=t.data.result;e&&(this.grid.data=e.contentResponseVos,this.showButtonStatus.auditFinishButton=e.showAuditFinishButton,this.showButtonStatus.commnuicateEndButton=e.showCommnuicateEndButton,this.showButtonStatus.commnuicateStartButton=e.showCommnuicateStartButton,this.showButtonStatus.reportFinishButton=e.showReportFinishButton,this.showButtonStatus.reviewButton=e.showReviewButton,this.showButtonStatus.submitButton=e.showSubmitButton)}).catch(console.error).finally(()=>{this.setLoading(!1)})}getApi_updateComment(){this.setLoading(!0);const t={auditDraftSectionId:this.submitForm.auditDraftSectionId,noOpinionComment:this.noOpionComment.value};this.$workPaperApi.setSectionOpinionUsingPOST(t).then(t=>{this.getApi_section()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除失敗"}})}).finally(()=>{this.setLoading(!1)}),this.noOpionComment.cache=this.noOpionComment.value}onRemoveSelectAuditItem(t){this.setLoading(!0),this.$workPaperApi.deleteAudifDraftContentUsingPOST(t.auditDraftContentId).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除失敗"}})}).finally(()=>{this.setLoading(!1)})}onRecoveryAuditItem(t){this.setLoading(!0),this.$workPaperApi.recoveryAudifDraftContentUsingPOST(t.auditDraftContentId).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"復原成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"復原失敗"}})}).finally(()=>{this.setLoading(!1)})}onSubmit(t){t.length?(this.setLoading(!0),this.$workPaperApi.reviewAuditDraftUsingPOST(t).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"覆核成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"覆核失敗"}})}).finally(()=>{this.setLoading(!1)})):this.setModalState({resultModal:{visible:!0,type:"error",title:"覆核失敗，請先勾選查核內容"}})}onReview(t){this.sendOfficeBossViceModal.auditDraftContentIds.length?(this.setLoading(!0),this.$workPaperApi.reviewEndsAuditDraftUsingPOST(this.sendOfficeBossViceModal.auditDraftContentIds,t).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"審畢成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"審畢失敗"}})}).finally(()=>{this.setLoading(!1)})):this.setModalState({resultModal:{visible:!0,type:"error",title:"審畢失敗，請先勾選查核內容"}})}getApi_commnuicateStart(){this.setLoading(!0),this.$workPaperApi.communicateStartUsingPOST(this.submitForm.auditDraftId).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"溝通啟動成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"溝通啟動失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_commnuicateEnd(){this.setLoading(!0),this.$workPaperApi.communicateEndUsingPOST(this.submitForm.auditDraftId).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"溝通結束成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"溝通結束失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_reportFinish(){this.setLoading(!0),this.$workPaperApi.reviewCompletedUsingPOST(this.submitForm.auditDraftId).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"稽核報告審閱完畢結束成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"稽核報告審閱完畢結束失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_auditFinish(){this.setLoading(!0),this.$workPaperApi.auditEndUsingPOST(this.submitForm.auditDraftId).then(t=>{t.data.result,this.setModalState({resultModal:{visible:!0,type:"success",title:"查核結束成功",autoClose:3}}),this.getApi_auditItemList()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查核結束失敗"}})}).finally(()=>{this.setLoading(!1)})}todoChange(){this.$refs.formRef.clearValidate()}workContent(t){this.$global.addParam({toRouter:"AuditingDetail",query:{...this.$global.getQuery(),cacheData:{toDo:this.submitForm.toDo,hasOpinion:this.submitForm.hasOpinion,auditDraftId:this.submitForm.auditDraftId,quarterPlanMId:this.submitForm.quarterPlanMId,auditDraftSectionId:this.submitForm.auditDraftSectionId}}}),this.$global.changeRouterAndaddParam({toRouter:"AuditingContent",query:{...t.data,checkMan:this.selectorOption.section.find(t=>t.value===this.submitForm.auditDraftSectionId).checkMan,inCharge:this.inCharge}})}onEditComment(){this.noOpionComment.editStatus=!0}onSaveComment(){this.getApi_updateComment(),this.noOpionComment.editStatus=!1}onCancelComment(){this.noOpionComment.editStatus=!1,this.noOpionComment.value=this.noOpionComment.cache}created(){this.currentRole=this.$global.getCurrentRole()}async mounted(){await this.setParam(),await this.getApi_section()}destroyed(){this.initSearchForm()}watchSearchFormSection(t){this.$nextTick(()=>{t.auditDraftSectionId&&this.selectorOption.section.length>0&&(this.noOpionComment.value=this.selectSection.noOptionComment,this.noOpionComment.cache=this.selectSection.noOptionComment,this.noOpionComment.editStatus=!1,this.getApi_auditItemList())})}watchChangeSection(t){this.getApi_section()}};Object(J.a)([Object(tt.a)("setLoading")],Ws.prototype,"setLoading",void 0),Object(J.a)([Qs.Action("setModalState")],Ws.prototype,"setModalState",void 0),Object(J.a)([Qs.Getter("getResultModal")],Ws.prototype,"getResultModal",void 0),Object(J.a)([tt.b],Ws.prototype,"getWindowSize",void 0),Object(J.a)([Object(et.e)("submitForm",{deep:!0})],Ws.prototype,"watchSearchFormSection",null),Object(J.a)([Object(et.e)("changeSection",{deep:!0})],Ws.prototype,"watchChangeSection",null),Ws=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,ActionBar:Ms,FblDataGrid:gt,CustomPopConfirm:ce,AuditingSortModal:Ls,AddAuditModal:$s,SendOfficeBossViceModal:Gs,UpLoadModal:qs,ExportModal:Hs}})],Ws);var Ks=Ws,Js=(a("53f8"),Object(st.a)(Ks,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-contain crawlerindex-container container"},[a("a-form-model",{ref:"formRef",staticClass:"row flex-grow-1",attrs:{"hide-required-mark":!0}},[a("div",{staticClass:"d-flex align-items-center"},[a("section",{staticClass:"auditItem__titleWrap me-4"},[a("span",{staticClass:"auditItem__title"},[t._v("查核項目：")]),a("span",[t._v(t._s(t.auditItemTitle))])]),a("div",{staticClass:"col-6 col-lg-auto d-flex align-items-center"},[a("div",{staticClass:"d-flex align-items-center w-auto"},[a("a-form-model-item",{staticClass:"mb-0"},[a("a-checkbox",{attrs:{disabled:t.todoDisabled},on:{change:t.todoChange},model:{value:t.submitForm.toDo,callback:function(e){t.$set(t.submitForm,"toDo",e)},expression:"submitForm.toDo"}},[t._v(" 待辦 ")])],1)],1),a("div",{staticClass:"d-flex align-items-center w-auto ms-4"},[a("a-form-model-item",{staticClass:"mb-0"},[a("a-checkbox",{model:{value:t.submitForm.hasOpinion,callback:function(e){t.$set(t.submitForm,"hasOpinion",e)},expression:"submitForm.hasOpinion"}},[t._v(" 有查核意見 ")])],1)],1)])]),a("div",{staticClass:"d-flex align-items-center flex-wrap mt-3"},[a("div",{staticClass:"col-12 col-lg-5"},[a("a-form-model-item",{staticClass:"mb-0"},[a("div",{staticClass:"d-flex align-items-center"},[a("div",{staticClass:"search-form__label"},[t._v(" Section： ")]),a("a-select",{staticClass:"col section__selectWidth",attrs:{placeholder:"請選擇Section",options:t.selectorOption.section},model:{value:t.submitForm.auditDraftSectionId,callback:function(e){t.$set(t.submitForm,"auditDraftSectionId",e)},expression:"submitForm.auditDraftSectionId"}})],1)])],1),t.sectionAuditors.length>0?a("div",{staticClass:"col ms-lg-3 mt-3 mt-lg-0"},[a("span",{staticClass:"search-form__label"},[t._v("Section查核人員：")]),a("span",[t._v(t._s(t.sectionAuditors.join("、")))])]):t._e()]),a("div",{staticClass:"d-flex align-items-center mt-3"},[a("div",{staticClass:"col"},[a("a-form-model-item",{staticClass:"mb-0"},[a("div",{staticClass:"d-flex align-items-start"},[a("div",{staticClass:"search-form__label"},[t._v(" 無意見綜合評述： ")]),a("a-textarea",{staticClass:"col",attrs:{"auto-size":{minRows:4},disabled:!t.submitForm.auditDraftSectionId||!t.noOpionComment.editStatus},model:{value:t.noOpionComment.value,callback:function(e){t.$set(t.noOpionComment,"value",e)},expression:"noOpionComment.value"}}),a("div",{staticClass:"noOpionComment__btnGroup d-flex flex-column justify-content-center"},[t.submitForm.auditDraftSectionId?[t.noOpionComment.editStatus?[a("button",{staticClass:"btn--action py-2",on:{click:t.onSaveComment}},[t._v(" 儲存 ")]),a("button",{staticClass:"btn--action py-2",on:{click:t.onCancelComment}},[t._v(" 取消 ")])]:a("button",{staticClass:"btn--action py-2",on:{click:t.onEditComment}},[t._v(" 編輯 ")])]:t._e()],2)],1)])],1)])]),a("div",{staticClass:"search-header d-flex flex-wrap align-items-center"},[t._m(0),a("div",{staticClass:"btnGroup ms-auto"},[a("ActionBar",{attrs:{"audit-opinion-status":t.auditOpinionStatus,"check-man":t.checkMan,"communicate-type":t.communicateType,"show-button-status":t.showButtonStatus,"audit-draft-section-id":t.submitForm.auditDraftSectionId,"sort-data-num":t.sortDataNum,role:t.currentRole.id},on:{click:t.emitClick}})],1)]),a("fbl-data-grid",{staticClass:"preparation-table",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:t.grid.pagination,scroll:{x:!0},"row-selection":t.rowSelection},on:{inspectClick:t.workContent},scopedSlots:t._u([{key:"seq",fn:function(e){return[a("span",{class:{rowNo__deleteStyle:"90"==e.data.status.keyId}},[t._v(t._s(e.data.seq))])]}},{key:"actions",fn:function(e){return["Y"===e.data.showDeleteButton?a("CustomPopConfirm",{on:{confirm:function(a){return t.onRemoveSelectAuditItem(e.data)}}},[a("i",{staticClass:"btn__icon--delete-action"})]):"N"===e.data.showDeleteButton?a("CustomPopConfirm",{attrs:{title:"確認復原"},on:{confirm:function(a){return t.onRecoveryAuditItem(e.data)}}},[a("button",{staticClass:"btn--action py-2"},[t._v(" 復原 ")])]):t._e()]}}])}),a("UpLoadModal",{attrs:{visible:t.upLoadModal.visible,"audit-draft-id":t.submitForm.auditDraftId},on:{"update:visible":function(e){return t.$set(t.upLoadModal,"visible",e)},setModal:t.resultModal}}),a("AuditingSortModal",{attrs:{visible:t.auditingSortModal.visible,"slot-data":t.grid.data},on:{"update:visible":function(e){return t.$set(t.auditingSortModal,"visible",e)},updateData:t.getApi_auditItemList}}),a("AddAuditModal",{attrs:{visible:t.addAuditModal.visible,"audit-draft-section-id":t.submitForm.auditDraftSectionId},on:{"update:visible":function(e){return t.$set(t.addAuditModal,"visible",e)},updateData:t.getApi_auditItemList}}),a("SendOfficeBossViceModal",{attrs:{visible:t.sendOfficeBossViceModal.visible},on:{"update:visible":function(e){return t.$set(t.sendOfficeBossViceModal,"visible",e)},updateData:t.onReview}}),a("ExportModal",{attrs:{visible:t.exportModal.visible},on:{"update:visible":function(e){return t.$set(t.exportModal,"visible",e)}}})],1)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"titleBar d-flex"},[a("div",{staticClass:"search-header__title"},[t._v(" 查核內容 ")])])}],!1,null,"762ecb48",null).exports);const Zs=Object(tt.c)("modalControl");let Xs=class extends et.d{constructor(){super(...arguments),this.compareData=null}diffCompareData(t){return t=t.map((e,a)=>{const i=a+1;if(i==t.length)return{...e};const s=Ct.a.execute(t[i].content,e.content);return{...e,content:s}})}formatRawData(t){return(t=t.map(t=>({...t,updateDatetime:Ca.transformRocDate(t.updateDatetime)}))).unshift(this.currentData),t}close(){this.compareData=null,this.$emit("closeModal")}getDraftCompareDate(t){this.setLoading(!0),this.$workPaperApi.getDraftContentLogUsingGET(t).then(t=>{this.compareData=this.diffCompareData(this.formatRawData(t.data.result))}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"取得比對資料失敗"}})}).finally(()=>{this.setLoading(!1)})}onVisibleChanged(t){this.visible&&this.getDraftCompareDate(this.auditDraftContentId)}};Object(J.a)([Zs.Action("setModalState")],Xs.prototype,"setModalState",void 0),Object(J.a)([Object(tt.a)("setLoading")],Xs.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Xs.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],Xs.prototype,"auditDraftContentId",void 0),Object(J.a)([Object(et.b)()],Xs.prototype,"currentData",void 0),Object(J.a)([Object(et.e)("visible",{deep:!0})],Xs.prototype,"onVisibleChanged",null),Xs=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],Xs);var to=Xs,eo=(a("443f"),Object(st.a)(to,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"比對資料",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,"height-full-screen":!0,centered:!1},on:{closeModal:t.close}},[i("template",{slot:"content"},[i("div",{staticClass:"modal__list"},[t.compareData&&t.compareData.length>0?t._l(t.compareData,(function(e,a){return i("div",{key:a,staticClass:"modal__list__item"},[i("div",{staticClass:"modal__list__item__title"},[i("span",[t._v(t._s(e.updateDatetime))]),i("span",[t._v(t._s(e.updateRole.name)+"/"+t._s(e.updateUser.name))])]),i("p",{staticClass:"content",domProps:{innerHTML:t._s(e.content)}})])})):i("div",{staticClass:"d-flex flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無比對資料 ")])])],2)])],2)}),[],!1,null,"a692c248",null).exports);let ao=class extends et.d{constructor(){super(...arguments),this.history=[],this.diffList=[]}onVisible(t){t&&this.getHistory(this.auditDraftContentId)}addEarliestDiff(){const t=this.history.length-1,e={version:this.history[t].version,auditOpinions:this.history[t].auditOpinions};this.diffList.push(e)}generateDiff(t,e,a){const i={version:t,auditOpinions:[]};if(e.length!==a.length)return;const s=e.length;for(let t=0;t<s;t++){const s=e[t].subAuditOpinions,o=a[t].subAuditOpinions,n=s.length,r=[];for(let t=0;t<n;t++)r.push({auditOpinionId:s[t].auditOpinionId,seq:Ct.a.execute(s[t].seq||"",o[t].seq||""),auditOpinionUnits:Ct.a.execute(s[t].auditOpinionUnits||"",o[t].auditOpinionUnits||""),riskLevel:Ct.a.execute(s[t].riskLevel||"",o[t].riskLevel||""),improveDeadLine:Ct.a.execute(s[t].improveDeadLine||"",o[t].improveDeadLine||""),content:Ct.a.execute(s[t].content||"",o[t].content||""),suggestion:Ct.a.execute(s[t].suggestion||"",o[t].suggestion||""),opinionSummary:Ct.a.execute(s[t].opinionSummary||"",o[t].opinionSummary||"")});i.auditOpinions.push({auditOpinionId:e[t].auditOpinionId,seq:Ct.a.execute(e[t].seq||"",a[t].seq||""),auditOpinionUnits:Ct.a.execute(e[t].auditOpinionUnits||"",a[t].auditOpinionUnits||""),riskLevel:Ct.a.execute(e[t].riskLevel||"",a[t].riskLevel||""),improveDeadLine:Ct.a.execute(e[t].improveDeadLine||"",a[t].improveDeadLine||""),content:Ct.a.execute(e[t].content||"",a[t].content||""),suggestion:Ct.a.execute(e[t].suggestion||"",a[t].suggestion||""),opinionSummary:Ct.a.execute(e[t].opinionSummary||"",a[t].opinionSummary||""),subAuditOpinions:r})}return i}createEmptyOpinion(t){return{auditOpinionId:t,seq:"",auditOpinionUnits:"",riskLevel:"",improveDeadLine:"",content:"",suggestion:"",subAuditOpinions:[]}}createEmptySubOpinion(t){return{auditOpinionId:t,seq:"",auditOpinionUnits:"",riskLevel:"",improveDeadLine:"",content:"",suggestion:""}}format(){for(const t of this.history)for(const e of t.auditOpinions){e.seq=String(e.seq),e.auditOpinionUnits=e.auditOpinionUnits.join("、");for(const t of e.subAuditOpinions)t.seq=String(t.seq),t.auditOpinionUnits=t.auditOpinionUnits.join("、")}const t=this.history.length;for(let e=0;e<t-1;e++){const t=this.$global.deepCopyData(this.history[e+1].auditOpinions),a=this.$global.deepCopyData(this.history[e].auditOpinions),i=t.map(t=>t.auditOpinionId),s=a.map(t=>t.auditOpinionId),o=[...new Set([...i,...s])],n=o.filter(t=>!s.includes(t));if(0!==n.length)for(const t of n){const e=this.createEmptyOpinion(t);a.push(e)}const r=o.filter(t=>!i.includes(t));if(0!==r.length)for(const e of r){const a=this.createEmptyOpinion(e);t.push(a)}t.sort((t,e)=>o.indexOf(t.auditOpinionId)-o.indexOf(e.auditOpinionId)),a.sort((t,e)=>o.indexOf(t.auditOpinionId)-o.indexOf(e.auditOpinionId));for(let e=0;e<o.length;e++){const i=t[e].subAuditOpinions,s=a[e].subAuditOpinions,o=i.map(t=>t.auditOpinionId),n=s.map(t=>t.auditOpinionId),r=[...new Set([...o,...n])],l=r.filter(t=>!n.includes(t));if(0!==l.length)for(const t of l){const e=this.createEmptySubOpinion(t);s.push(e)}const c=r.filter(t=>!o.includes(t));if(0!==c.length)for(const t of c){const e=this.createEmptySubOpinion(t);i.push(e)}i.sort((t,e)=>r.indexOf(t.auditOpinionId)-r.indexOf(e.auditOpinionId)),s.sort((t,e)=>r.indexOf(t.auditOpinionId)-r.indexOf(e.auditOpinionId))}const l=this.generateDiff(this.history[e].version,t,a);this.diffList.push(l)}this.addEarliestDiff()}close(){this.$emit("closeModal"),this.history=[],this.diffList=[]}getHistory(t){this.setLoading(!0),this.$workPaperApi.compareAuditOpinionUsingGET(t).then(t=>{this.history=t.data,this.format()}).catch(t=>{console.error}).finally(()=>{this.setLoading(!1)})}created(){}};Object(J.a)([Object(tt.a)("setLoading")],ao.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],ao.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],ao.prototype,"auditDraftContentId",void 0),Object(J.a)([Object(et.e)("visible")],ao.prototype,"onVisible",null),ao=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],ao);var io=ao,so=(a("1490"),Object(st.a)(io,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"比對資料",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,"height-full-screen":!0,centered:!1},on:{closeModal:t.close}},[i("template",{slot:"content"},[i("div",{staticClass:"modal__list"},[t.history.length>0?[i("div",{staticClass:"row modal__header"},[i("div",{staticClass:"col-9 modal__header__item"},[t._v(" 查核意見/風險等級/改善期限/負責部門 ")]),i("div",{staticClass:"col-3 modal__header__item"},[t._v(" 建議事項 ")])]),t._l(t.diffList,(function(e,a){return i("div",{key:a,staticClass:"modal__list__item"},[i("div",{staticClass:"row",attrs:{type:"flex"}},[i("div",{staticClass:"col-9 cell version_info"},[i("div",{staticClass:"modal__list__item__title"},[i("span",[t._v(t._s(t.history[a].updateDatetime))]),i("span",[t._v(t._s(t.history[a].updateRole)+"/"+t._s(t.history[a].updateUser))])])]),i("div",{staticClass:"col-3 cell suggestion"})]),t._l(e.auditOpinions,(function(e){return i("div",{key:e.auditOpinionId,staticClass:"row",attrs:{type:"flex"}},[i("div",{staticClass:"col-9 cell"},[i("div",{staticClass:"modal__list__item__subtitle"},[i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight",domProps:{innerHTML:t._s(e.seq)}}),i("span",{staticClass:"highlight"},[t._v(". 主項：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(e.content)}})]),i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("負責部門：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(e.auditOpinionUnits)}})]),i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("意見摘要：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(e.suggestion)}})]),i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("風險等級：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(e.riskLevel)}})]),i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("改善期限：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(e.improveDeadLine)}})])])]),i("div",{staticClass:"col-3 cell suggestion"},[i("span",{staticClass:"content",domProps:{innerHTML:t._s(e.seq)}}),t._v("."),i("br"),i("p",{staticClass:"content",domProps:{innerHTML:t._s(e.suggestion)}})]),t._l(e.subAuditOpinions,(function(a){return i("div",{key:a.auditOpinionId,staticClass:"row row_sub",attrs:{type:"flex"}},[i("div",{staticClass:"offset-1 col-8 cell__sub cell modal__list__item__subtitle"},[i("div",{staticClass:"row g-0"},[i("div",{staticClass:"col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("("),i("span",{domProps:{innerHTML:t._s(a.seq)}}),t._v("). 子項：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(a.content)}})]),i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("負責部門：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(a.auditOpinionUnits)}})]),i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("風險等級：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(a.riskLevel)}})]),i("div",{staticClass:"row g-0"},[i("div",{staticClass:"highlight col-auto text-end"},[i("span",{staticClass:"highlight"},[t._v("改善期限：")])]),i("span",{staticClass:"col-10",domProps:{innerHTML:t._s(a.improveDeadLine)}})])]),i("div",{staticClass:"col-3 cell__sub cell suggestion"},[i("span",{staticClass:"content"},[i("span",{domProps:{innerHTML:t._s(e.seq)}}),t._v("("),i("span",{domProps:{innerHTML:t._s(a.seq)}}),t._v("). ")]),i("br"),i("p",{staticClass:"content",domProps:{innerHTML:t._s(a.suggestion)}})])])}))],2)}))],2)}))]:i("div",{staticClass:"d-flex flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無比對資料 ")])])],2)])],2)}),[],!1,null,"79ed1d3c",null).exports);const oo=Object(tt.c)("modalControl");let no=class extends et.d{constructor(){super(...arguments),this.canSendFlag=!1,this.name="",this.role="",this.roleId="",this.QAData=null,this.form={message:""},this.formRules={message:[{required:!0,message:"請填寫訊息",trigger:"change"}]}}watchVisible(t){t&&("opinion"===this.type?this.getOpinionQAContent(this.auditOpinionSync.auditOpinionId):"draft"===this.type&&this.getDraftQAContent(this.auditDraftContentSync.auditDraftContentId))}created(){this.name=this.$user.getMe().employee.name,this.role=this.$global.getCurrentRole().name,this.roleId=this.$global.getCurrentRoleId()}getOpinionQAContent(t){this.setLoading(!0),this.$workPaperApi.getAuditOpinionQaUsingGET(t).then(t=>{this.QAData=t.data.auditOpinions.map(t=>({...t,updateDateTime:Ca.transformRocDate(t.updateDateTime)})),this.canSendFlag=t.data.canSendFlag,this.auditOpinionSync.redQaStatusFlag&&"ROLE_Auditor"!==this.roleId&&this.updateOpinionQAStatus(this.auditOpinionSync)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查詢提問/回覆提問內容失敗",content:null}})}).finally(()=>{this.setLoading(!1)})}getDraftQAContent(t){this.setLoading(!0),this.$workPaperApi.getDraftContentQaUsingGET(t).then(t=>{this.QAData=t.data.result.auditDraftContentQas.map(t=>({...t,updateDateTime:Ca.transformRocDate(t.updateDatetime)})),this.canSendFlag=t.data.result.canSendFlag,this.auditDraftContentSync.redQaStatusFlag&&"ROLE_Auditor"!==this.roleId&&this.updateDraftQAStatus(this.auditDraftContentSync)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查詢提問/回覆提問內容失敗"}})}).finally(()=>{this.setLoading(!1)})}updateOpinionQAStatus(t){this.setLoading(!0),this.$workPaperApi.setOpinionQaStatusInWorkPaperUsingPOST({auditOpinionId:t.auditOpinionId}).then(e=>{e.data?this.$emit("updateAuditOpinion",{auditOpinionId:t.auditOpinionId,subRelMainId:t.subRelMainId}):this.setModalState({resultModal:{visible:!0,type:"error",title:"已讀訊息失敗"}})}).catch(()=>{}).finally(()=>{this.setLoading(!1)})}updateDraftQAStatus(t){this.setLoading(!0),this.$workPaperApi.updateDraftContentQaUsingPOST({auditDraftContentId:t.auditDraftContentId}).then(t=>{t.data?this.$emit("reloadDraft"):this.setModalState({resultModal:{visible:!0,type:"error",title:"已讀訊息失敗"}})}).catch(()=>{}).finally(()=>{this.setLoading(!1)})}sendOpinionMessage(){this.setLoading(!0);const t={auditOpinionId:this.auditOpinionSync.auditOpinionId,content:this.form.message};this.$workPaperApi.addAuditorOpinionQaUsingPOST(t).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"新增提問/回覆提問成功",autoClose:3}}),this.form.message=null,"ROLE_Auditor"===this.roleId&&this.$emit("updateAuditOpinion",{auditOpinionId:this.auditOpinionSync.auditOpinionId,subRelMainId:this.auditOpinionSync.subRelMainId}),this.getOpinionQAContent(this.auditOpinionSync.auditOpinionId)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"新增提問/回覆提問失敗",autoClose:3}})}).finally(()=>{this.setLoading(!1)})}sendDraftMessage(){this.setLoading(!0);const t={auditDraftContentId:this.auditDraftContentSync.auditDraftContentId,content:this.form.message};this.$workPaperApi.addDraftContentQaUsingPOST(t).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"新增提問/回覆提問成功",autoClose:3}}),this.form.message=null,"ROLE_Auditor"===this.roleId&&(this.auditDraftContentSync.redQaStatusFlag=!1),this.getDraftQAContent(this.auditDraftContentSync.auditDraftContentId)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"新增提問/回覆提問失敗",autoClose:3}})}).finally(()=>{this.setLoading(!1)})}confirm(){this.$refs.formRef.validate(async t=>{t&&("draft"===this.type?this.sendDraftMessage():this.sendOpinionMessage())})}reset(){this.form.message=null,this.QAData=null,this.canSendFlag=!1}close(){this.reset(),this.$emit("closeModal")}};Object(J.a)([Object(tt.a)("setLoading")],no.prototype,"setLoading",void 0),Object(J.a)([oo.Action("setModalState")],no.prototype,"setModalState",void 0),Object(J.a)([Object(et.c)("auditOpinion")],no.prototype,"auditOpinionSync",void 0),Object(J.a)([Object(et.c)("auditDraftContent")],no.prototype,"auditDraftContentSync",void 0),Object(J.a)([Object(et.b)()],no.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],no.prototype,"type",void 0),Object(J.a)([Object(et.e)("visible",{deep:!0,immediate:!0})],no.prototype,"watchVisible",null),no=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],no);var ro=no,lo=(a("e3db3"),Object(st.a)(ro,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"提問及回覆問題",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,centered:!0},on:{closeModal:t.close}},[i("template",{slot:"content"},[i("div",{staticClass:"content mt-2"},[i("div",{staticClass:"list"},[t.canSendFlag?i("div",{staticClass:"list__item"},[i("div",{staticClass:"list__item__info"},[i("img",{staticClass:"list__item__img",attrs:{src:a("31d9"),alt:""}}),i("div",{staticClass:"list__item__title mt-3"},[t._v(" "+t._s(t.role)+" ")]),i("div",{staticClass:"list__item__title"},[t._v(" "+t._s(t.name)+" ")])]),i("div",{staticClass:"list__item__content d-flex flex-column justify-content-end"},[i("div",{staticClass:"list__item__subtitle"},[i("a-form-model",{ref:"formRef",attrs:{model:t.form,"hide-required-mark":!0,rules:t.formRules}},[i("a-form-model-item",{attrs:{prop:"message"}},[i("a-textarea",{staticClass:"list__item__textarea",attrs:{rows:4},model:{value:t.form.message,callback:function(e){t.$set(t.form,"message",e)},expression:"form.message"}})],1)],1)],1),i("button",{staticClass:"btn--primary mt-2 align-self-end",on:{click:t.confirm}},[t._v(" 送出 ")])])]):t._e(),t._l(t.QAData,(function(e,s){return i("div",{key:"draft"===t.type?e.auditDraftContentQaId+s:e.auditOpinionId+s,staticClass:"list__item"},[i("div",{staticClass:"list__item__info"},[i("img",{staticClass:"list__item__img",attrs:{src:a(s%2==0?"ff46":"31d9"),alt:""}}),i("div",{staticClass:"list__item__title mt-3"},[t._v(" "+t._s(e.updateRole.name)+" ")]),i("div",{staticClass:"list__item__title"},[t._v(" "+t._s(e.updateUser.name)+" ")])]),i("div",{staticClass:"list__item__content align-self-start"},[i("div",{staticClass:"list__item__subtitle"},[i("span",[t._v(t._s(e.updateDateTime))])]),i("div",{staticClass:"list__item__text"},[t._v(" "+t._s(e.content)+" ")])])])})),t.QAData&&0===t.QAData.length&&!t.canSendFlag?i("div",{staticClass:"d-flex m-3 flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無資料 ")])]):t._e()],2)])])],2)}),[],!1,null,"46223dc4",null).exports);const co=Object(tt.c)("modalControl");let uo=class extends et.d{constructor(){super(...arguments),this.hasValidatedOnce=!1,this.dateFormatter=this.$twDateFormatter,this.isLoading=!1,this.activecollapseKey=null,this.subAuditOpinionHavingValue=!1,this.mainAuditOpinionHavingValue=!1,this.formRules={content:[{required:!0,message:"此為必填欄位",trigger:"change"}],auditOpinionUnits:[{validator:this.mainAuditOpinionValidator}],suggestion:[{validator:this.mainAuditOpinionValidator}],opinionSummary:[{validator:this.mainAuditOpinionValidator}],riskLevel:[{validator:this.mainAuditOpinionValidator}],imporveOption:[{validator:this.mainImporveOptionValidator}],improveDeadline:[{validator:this.mainImproveDeadLineValidator}],improveDate:[{validator:this.mainImproveDateValidator}]},this.opinionOptions=[{label:"有",value:"y"},{label:"無",value:"n"},{label:"無此項",value:"null"}]}get isShowMainModifyAuditorBtn(){return"99"!==this.auditDraftContentStatus&&"90"!=this.auditDraftContentStatus&&"ROLE_Auditor"===this.currentRoleId&&!(this.checkIfInAuditor(this.auditOpinionSync.auditors,this.currentUserDomainId)&&1===this.auditOpinionSync.auditors.length&&this.auditOpinionSync.subAuditOpinions&&this.auditOpinionSync.subAuditOpinions.length>0)}created(){this.currentRoleId=this.$global.getCurrentRoleId(),this.currentUser=this.$user.getMe(),this.currentUserDomainId=this.currentUser.employee.domainId}modifyAuditOpinion(t){this.setLoading(!0);const e=this.$global.deepCopyData(t);delete e.subAuditOpinions;const a=e;this.$workPaperApi.setSureAuditOpinionUsingPOST(a).then(e=>{e.data?(this.setModalState({resultModal:{visible:!0,type:"success",title:"確認修改查核意見成功",autoClose:3}}),this.$emit("updateAuditOpinion",{auditOpinionId:t.auditOpinionId,subRelMainId:t.subRelMainId})):this.setModalState({resultModal:{visible:!0,type:"error",title:"確認修改查核意見失敗"}})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"確認修改查核意見失敗"}})}).finally(()=>{this.setLoading(!1)})}deleteAuditorFormServer(t,e){const a={auditOpinionId:t.auditOpinionId,auditor:e};this.$workPaperApi.killAuditOpinionAuditorUsingPOST(a).then(a=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除查核人員成功",autoClose:3}}),this.deleteAuditor(t,e)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除查核人員失敗"}})}).finally(()=>{this.setLoading(!1)})}addAuditorFormServer(t,e,a){const i={auditOpinionId:t.auditOpinionId,auditor:a};this.$workPaperApi.createAuditOpinionAuditorUsingPOST(i).then(i=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"新增查核人員成功",autoClose:3}}),this.addAuditor(t,e,a)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"新增查核人員失敗"}})}).finally(()=>{this.setLoading(!1)})}mainAuditOpinionValidator(t,e,a){return(!this.mainAuditOpinionHavingValue||e&&0!==e.length&&"null"!==e)&&(this.auditOpinionSync.subAuditOpinions&&0!==this.auditOpinionSync.subAuditOpinions.length||e&&0!==e.length&&"null"!==e)&&(this.subAuditOpinionHavingValue||e&&0!==e.length&&"null"!==e)?void a():a("此為必填欄位")}subAuditOpinionValidator(t,e,a){this.subAuditOpinionHavingValue&&(e&&0!==e.length&&"null"!==e||a("此為必填欄位"),a()),a()}mainImporveOptionValidator(t,e,a){return this.$refs.formRef.validateField(["improveDeadline","improveDate"]),(this.auditOpinionSync.subAuditOpinions&&0!==this.auditOpinionSync.subAuditOpinions.length||e&&0!==e.length&&"null"!==e)&&(this.subAuditOpinionHavingValue||e&&0!==e.length&&"null"!==e)&&(!this.mainAuditOpinionHavingValue||e&&0!==e.length&&"null"!==e)?void a():a("此為必填欄位")}mainImproveDeadLineValidator(t,e,a){if("deadLine"===this.auditOpinionSync.imporveOption&&(!this.auditOpinionSync.improveDeadline||null===this.auditOpinionSync.improveDeadline||0===this.auditOpinionSync.improveDeadline.length))return a("請填寫改善期限");a()}mainImproveDateValidator(t,e,a){if("imporved"===this.auditOpinionSync.imporveOption&&(!this.auditOpinionSync.improveDate||null===this.auditOpinionSync.improveDate||0===this.auditOpinionSync.improveDate.length))return a("請填寫已改善期限");a()}subImporveOptionValidator(t,e,a){const i=t.field.split("."),s=parseInt(i[1]);if(this.$refs.formRef.validateField([`subAuditOpinions.${s}.improveDeadline`,`subAuditOpinions.${s}.improveDate`]),this.subAuditOpinionHavingValue&&(e&&0!==e.length&&"null"!==e||a("此為必填欄位"),a()),a(),!(this.subAuditOpinionHavingValue||e&&0!==e.length&&"null"!==e))return a("此為必填欄位");a()}subImproveDeadLineValidator(t,e,a){const i=t.field.split("."),s=parseInt(i[1]),o=this.auditOpinionSync.subAuditOpinions[s];if("deadLine"===o.imporveOption&&(!o.improveDeadline||null===o.improveDeadline||0===o.improveDeadline.length))return a("請填寫改善期限");a()}subImproveDateValidator(t,e,a){const i=t.field.split("."),s=parseInt(i[1]),o=this.auditOpinionSync.subAuditOpinions[s];if("imporved"===o.imporveOption&&(!o.improveDate||null===o.improveDate||0===o.improveDate.length))return a("請填寫已改善期限");a()}checkMainAuditOpinionHavingValue(t){return!!(t.auditOpinionUnits&&t.auditOpinionUnits.length>0||t.suggestion&&t.suggestion.length>0||t.riskLevel&&t.riskLevel.length>0&&"null"!==t.riskLevel||t.imporveOption&&t.imporveOption.length>0&&"null"!==t.imporveOption)}checkSubAuditOpinionHavingValue(t){for(let e=0;e<t.length;e++){if(t[e].auditOpinionUnits&&t[e].auditOpinionUnits.length>0)return!0;if(t[e].suggestion&&t[e].suggestion.length>0)return!0;if(t[e].riskLevel&&t[e].riskLevel.length>0&&"null"!==t[e].riskLevel)return!0;if(t[e].imporveOption&&t[e].imporveOption.length>0&&"null"!==t[e].imporveOption)return!0}return!1}validateForm(){return"Y"===this.opinion&&(this.hasValidatedOnce=!0,this.getSubAuditOpinionHavingValue(),this.getMainAuditOpinionHavingValue()),this.$refs.formRef.validate().then(()=>!0).catch(()=>!1)}opinionImproveOptionChange(t,e){const a=t.target.value;if("null"===a&&(e.improveDeadline=null,e.improveDate=null,e.improve=!1,e.improveSituation=null),"deadLine"===a){const t=new Date;e.improveDeadline=new Date(t.setMonth(t.getMonth()+3)),e.improveDeadline.setDate(25),e.improve=!1,e.improveDate=null}"imporved"===a&&(e.improveDeadline=null,e.improve=!0),this.mainFormItemChange(e),this.hasValidatedOnce&&this.validateForm()}setIsModify(t,e){t.modify=e}mainFormItemChange(t,e){t.modify||this.setIsModify(t,!0),e&&e()}getSubAuditOpinionHavingValue(){this.subAuditOpinionHavingValue=this.checkSubAuditOpinionHavingValue(this.auditOpinionSync.subAuditOpinions)}getMainAuditOpinionHavingValue(){this.mainAuditOpinionHavingValue=this.checkMainAuditOpinionHavingValue(this.auditOpinionSync)}getAuditorsListString(t,e){let a="";return t.forEach((t,i)=>{a+=0===i?t.value:`${e}${t.value}`}),""+a}checkIfInAuditor(t,e){return void 0!==t.find(t=>t.key===e)}modifyAuditor(t,e){t?e.auditOpinionId.includes("add")?this.deleteAuditor(e,this.currentUserDomainId):this.deleteAuditorFormServer(e,this.currentUserDomainId):this.addAuditorFormServer(e,this.currentUser.employee.name,this.currentUserDomainId)}addAuditor(t,e,a){t.auditors.push({value:e,key:a}),this.$emit("updateAuditOpinion",{auditOpinionId:t.auditOpinionId,subRelMainId:t.subRelMainId})}deleteAuditor(t,e){const a=t.auditors.findIndex(t=>t.key===e);t.auditors.splice(a,1),0===t.auditors.length?this.removeOpinion({opinion:t,itemType:t.itemType}):this.$emit("updateAuditOpinion",{auditOpinionId:t.auditOpinionId,subRelMainId:t.subRelMainId})}removeOpinion({opinion:t,itemType:e}){let a=null;"MAIN"===e&&this.$emit("removeMainAuditOpinion",t.auditOpinionId),"SUB"===e&&(a=this.auditOpinionSync.subAuditOpinions.findIndex(e=>e.auditOpinionId===t.auditOpinionId),this.auditOpinionSync.subAuditOpinions.splice(a,1))}QAHandler(t){this.$emit("openOpinionQAModal",{auditOpinion:t})}addSubAuditOpinion(t){const e={auditOpinionId:"add"+mt.a.v4(),canModifyFlag:!0,canQaFlag:null,redCheckStatusFlag:null,redQaStatusFlag:null,auditors:[{key:this.currentUser.employee.domainId,value:this.currentUser.employee.name}],itemType:"SUB",subRelMainId:this.auditOpinionSync.auditOpinionId,seq:t.length+1,content:null,auditOpinionUnits:[],suggestion:null,opinionSummary:null,riskLevel:"null",improveDeadline:null,improve:null,improveDate:null,improveSituation:null,subAuditOpinions:[],modify:!0,imporveOption:"null"};t.push(e)}};Object(J.a)([co.Action("setModalState")],uo.prototype,"setModalState",void 0),Object(J.a)([Object(tt.a)("setLoading")],uo.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("auditOpinion")],uo.prototype,"auditOpinionSync",void 0),Object(J.a)([Object(et.b)()],uo.prototype,"riskLevelOptions",void 0),Object(J.a)([Object(et.b)()],uo.prototype,"auditDraftContentStatus",void 0),Object(J.a)([Object(et.b)()],uo.prototype,"auditOpinionUnitOptions",void 0),Object(J.a)([Object(et.b)()],uo.prototype,"index",void 0),Object(J.a)([Object(et.b)()],uo.prototype,"originalAuditOpinionsFrontEnd",void 0),Object(J.a)([Object(et.b)()],uo.prototype,"opinion",void 0),uo=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,FblDataGrid:gt,CustomPopConfirm:ce,AccordionArea:_e,AuditOpinionQAModal:lo}})],uo);var po=uo,mo=(a("de2a"),Object(st.a)(po,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["N"===t.opinion||"X"===t.opinion?a("div",{staticClass:"row g-0 mt-3 mb-3"},[a("a-collapse",{attrs:{"default-active-key":t.auditOpinionSync.auditOpinionId,"expand-icon-position":"left"}},[a("a-collapse-panel",{key:t.auditOpinionSync.auditOpinionId,attrs:{header:"查核人員："+t.getAuditorsListString(t.auditOpinionSync.auditors,"、")}},[t.isShowMainModifyAuditorBtn?a("div",{attrs:{slot:"extra"},on:{click:function(t){t.stopPropagation()}},slot:"extra"},[a("CustomPopConfirm",{attrs:{title:t.checkIfInAuditor(t.auditOpinionSync.auditors,t.currentUserDomainId)?"確認刪除人員？":"確認新增人員？"},on:{confirm:function(e){t.modifyAuditor(t.checkIfInAuditor(t.auditOpinionSync.auditors,t.currentUserDomainId),t.auditOpinionSync)}}},[a("div",{staticClass:"collapse__btn",class:t.checkIfInAuditor(t.auditOpinionSync.auditors,t.currentUserDomainId)?"btn__icon--subproject_close":"btn__icon--subproject_add"})])],1):t._e(),a("a-form-model",{ref:"formRef",attrs:{model:t.auditOpinion,"hide-required-mark":!0,rules:t.formRules}},[a("div",{staticClass:"main-opinion"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label "},[a("span",{staticClass:"content__label__required"},[t._v("*")]),t._v(" 主項： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"content"}},[a("a-textarea",{attrs:{disabled:!t.auditOpinionSync.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(e){return t.mainFormItemChange(t.auditOpinionSync)}},model:{value:t.auditOpinionSync.content,callback:function(e){t.$set(t.auditOpinionSync,"content",e)},expression:"auditOpinionSync.content"}})],1)],1),a("div",{staticClass:"col-auto main-opinion__action"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.auditOpinionSync.redQaStatusFlag?a("span",[t._v("待回覆")]):a("span",[t._v("回覆提問")])]),a("button",{staticClass:"textarea__control__btn btn__icon--question",class:t.auditOpinionSync.redQaStatusFlag?"btn__icon--question_red":"btn__icon--question",on:{click:function(e){return t.QAHandler(t.auditOpinionSync)}}})],2)],1),t.auditOpinionSync.canModifyFlag&&"01"!==t.auditDraftContentStatus&&!t.auditOpinionSync.auditOpinionId.includes("add")?a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.auditOpinionSync.redCheckStatusFlag?a("span",[t._v("待確認")]):a("span",[t._v("確認修改")])]),a("button",{staticClass:"textarea__control__btn",class:t.auditOpinionSync.redCheckStatusFlag?"btn__icon--confirm":"btn__icon--enter1",on:{click:function(e){return t.modifyAuditOpinion(t.auditOpinionSync)}}})],2)],1):t._e()])])])])])],1)],1)],1):a("a-collapse",{attrs:{"default-active-key":t.auditOpinionSync.auditOpinionId,"expand-icon-position":"left"}},[a("a-collapse-panel",{key:t.auditOpinionSync.auditOpinionId,attrs:{header:"查核人員："+t.getAuditorsListString(t.auditOpinionSync.auditors,"、")}},[t.isShowMainModifyAuditorBtn?a("div",{attrs:{slot:"extra"},on:{click:function(t){t.stopPropagation()}},slot:"extra"},[a("CustomPopConfirm",{attrs:{title:t.checkIfInAuditor(t.auditOpinionSync.auditors,t.currentUserDomainId)?"確認刪除人員？":"確認新增人員？"},on:{confirm:function(e){t.modifyAuditor(t.checkIfInAuditor(t.auditOpinionSync.auditors,t.currentUserDomainId),t.auditOpinionSync)}}},[a("div",{staticClass:"collapse__btn",class:t.checkIfInAuditor(t.auditOpinionSync.auditors,t.currentUserDomainId)?"btn__icon--subproject_close":"btn__icon--subproject_add"})])],1):t._e(),a("a-form-model",{ref:"formRef",attrs:{model:t.auditOpinion,"hide-required-mark":!0,rules:t.formRules}},[a("div",{staticClass:"main-opinion"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label "},[a("span",{staticClass:"content__label__required"},[t._v("*")]),t._v(" "+t._s(t.index+1+".主項：")+" ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"content"}},[a("a-textarea",{attrs:{disabled:!t.auditOpinionSync.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(e){return t.mainFormItemChange(t.auditOpinionSync)}},model:{value:t.auditOpinionSync.content,callback:function(e){t.$set(t.auditOpinionSync,"content",e)},expression:"auditOpinionSync.content"}})],1)],1),a("div",{staticClass:"col-auto main-opinion__action"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.auditOpinionSync.redQaStatusFlag?a("span",[t._v("待回覆")]):a("span",[t._v("回覆提問")])]),a("button",{staticClass:"textarea__control__btn btn__icon--question",class:t.auditOpinionSync.redQaStatusFlag?"btn__icon--question_red":"btn__icon--question",on:{click:function(e){return t.QAHandler(t.auditOpinionSync)}}})],2)],1),t.auditOpinionSync.canModifyFlag&&"01"!==t.auditDraftContentStatus&&!t.auditOpinionSync.auditOpinionId.includes("add")?a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.auditOpinionSync.redCheckStatusFlag?a("span",[t._v("待確認")]):a("span",[t._v("確認修改")])]),a("button",{staticClass:"textarea__control__btn",class:t.auditOpinionSync.redCheckStatusFlag?"btn__icon--confirm":"btn__icon--enter1",on:{click:function(e){return t.modifyAuditOpinion(t.auditOpinionSync)}}})],2)],1):t._e()])])]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 負責部門： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"auditOpinionUnits"}},[a("a-tree-select",{staticClass:"treeselect",attrs:{disabled:!t.auditOpinionSync.canModifyFlag,"tree-data":t.auditOpinionUnitOptions,"tree-checkable":"","tree-default-expand-all":!0,"tree-node-filter-prop":"title","dropdown-class-name":"treeselect","dropdown-style":{maxHeight:"300px"}},on:{change:function(e){return t.mainFormItemChange(t.auditOpinionSync,t.hasValidatedOnce&&t.validateForm)}},model:{value:t.auditOpinionSync.auditOpinionUnits,callback:function(e){t.$set(t.auditOpinionSync,"auditOpinionUnits",e)},expression:"auditOpinionSync.auditOpinionUnits"}})],1)],1),a("div",{staticClass:"col-auto main-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 建議事項： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"suggestion"}},[a("a-textarea",{attrs:{disabled:!t.auditOpinionSync.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(e){return t.mainFormItemChange(t.auditOpinionSync,t.hasValidatedOnce&&t.validateForm)}},model:{value:t.auditOpinionSync.suggestion,callback:function(e){t.$set(t.auditOpinionSync,"suggestion",e)},expression:"auditOpinionSync.suggestion"}})],1)],1),a("div",{staticClass:"col-auto main-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 意見摘要： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"opinionSummary"}},[a("a-textarea",{attrs:{disabled:!t.auditOpinionSync.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(e){return t.mainFormItemChange(t.auditOpinionSync,t.hasValidatedOnce&&t.validateForm)}},model:{value:t.auditOpinionSync.opinionSummary,callback:function(e){t.$set(t.auditOpinionSync,"opinionSummary",e)},expression:"auditOpinionSync.opinionSummary"}})],1)],1),a("div",{staticClass:"col-auto main-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 風險等級： ")]),a("div",{staticClass:"col ps-2 align-self-center"},[a("a-form-model-item",{attrs:{prop:"riskLevel"}},[a("a-radio-group",{staticClass:"align-self-center",attrs:{disabled:!t.auditOpinionSync.canModifyFlag},on:{change:function(e){return t.mainFormItemChange(t.auditOpinionSync,t.hasValidatedOnce&&t.validateForm)}},model:{value:t.auditOpinionSync.riskLevel,callback:function(e){t.$set(t.auditOpinionSync,"riskLevel",e)},expression:"auditOpinionSync.riskLevel"}},t._l(t.riskLevelOptions,(function(e){return a("a-radio",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1),a("div",{staticClass:"col-auto main-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 改善期限： ")]),a("div",{staticClass:"col ps-2 align-self-center"},[a("a-form-model-item",{ref:"mainImporveOptionRef",staticClass:"imporve-option",attrs:{prop:"imporveOption"}},[a("a-radio-group",{staticClass:"align-self-center",attrs:{disabled:!t.auditOpinionSync.canModifyFlag},on:{change:function(e){t.mainFormItemChange(t.auditOpinionSync,t.opinionImproveOptionChange(e,t.auditOpinionSync))}},model:{value:t.auditOpinionSync.imporveOption,callback:function(e){t.$set(t.auditOpinionSync,"imporveOption",e)},expression:"auditOpinionSync.imporveOption"}},[a("div",{staticClass:"radio-item--inline me-3"},[a("a-radio",{attrs:{value:"null"}},[t._v(" 不選擇 ")])],1),a("a-radio",{attrs:{value:"deadLine"}}),a("div",{staticClass:"radio-item--inline me-3"},[a("a-form-model-item",{staticClass:"mb-0",attrs:{prop:"improveDeadline"}},[a("date-picker",{staticClass:"align-self-center w-100",attrs:{disabled:!t.auditOpinionSync.canModifyFlag||"deadLine"!==t.auditOpinionSync.imporveOption,formatter:t.dateFormatter,type:"date","allow-clear":!0},on:{change:function(){t.mainFormItemChange(t.auditOpinionSync,t.$refs.mainImporveOptionRef.onFieldChange())}},model:{value:t.auditOpinionSync.improveDeadline,callback:function(e){t.$set(t.auditOpinionSync,"improveDeadline",e)},expression:"auditOpinionSync.improveDeadline"}})],1)],1),a("a-radio",{attrs:{value:"imporved"}},[t._v(" 已改善 ")]),a("div",{staticClass:"radio-item--inline"},[a("a-form-model-item",{staticClass:"mb-0",attrs:{prop:"improveDate"}},[a("date-picker",{staticClass:"w-100",attrs:{disabled:!t.auditOpinionSync.canModifyFlag||"imporved"!==t.auditOpinionSync.imporveOption,formatter:t.dateFormatter,type:"date","allow-clear":!0},on:{change:function(){t.mainFormItemChange(t.auditOpinionSync,t.$refs.mainImporveOptionRef.onFieldChange())}},model:{value:t.auditOpinionSync.improveDate,callback:function(e){t.$set(t.auditOpinionSync,"improveDate",e)},expression:"auditOpinionSync.improveDate"}})],1)],1)],1)],1)],1),a("div",{staticClass:"col-auto main-opinion__action"})]),"imporved"===t.auditOpinionSync.imporveOption?a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 改善情形： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"improveSituation",rules:{required:"imporved"===t.auditOpinionSync.imporveOption,message:"此為必填欄位"}}},[a("a-textarea",{attrs:{disabled:!t.auditOpinionSync.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(e){return t.mainFormItemChange(t.auditOpinionSync,t.hasValidatedOnce&&t.validateForm)}},model:{value:t.auditOpinionSync.improveSituation,callback:function(e){t.$set(t.auditOpinionSync,"improveSituation",e)},expression:"auditOpinionSync.improveSituation"}})],1)],1),a("div",{staticClass:"col-auto main-opinion__action"})]):t._e()]),t.auditOpinionSync.subAuditOpinions&&t.auditOpinionSync.subAuditOpinions.length>0?t._l(t.auditOpinionSync.subAuditOpinions,(function(e,i){return a("div",{key:e.auditOpinionId,staticClass:"sub-opinion mb-3"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end fw-bold my-3 pt-1"},[t._v(" 查核人員： ")]),a("div",{staticClass:"col ps-1 fw-bold my-3"},[t._v(" "+t._s(t.getAuditorsListString(e.auditors,"、"))+" "),"ROLE_Auditor"===t.currentRoleId&&"99"!==t.auditDraftContentStatus&&"90"!==t.auditDraftContentStatus?a("CustomPopConfirm",{attrs:{title:t.checkIfInAuditor(e.auditors,t.currentUserDomainId)?"確認刪除人員？":"確認新增人員？"},on:{confirm:function(a){t.modifyAuditor(t.checkIfInAuditor(e.auditors,t.currentUserDomainId),e)}}},[a("button",{staticClass:"btn--title",class:t.checkIfInAuditor(e.auditors,t.currentUserDomainId)?"btn__icon--subproject_close":"btn__icon--subproject_add"})]):t._e()],1),a("div",{staticClass:"col-auto sub-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[a("span",{staticClass:"content__label__required"},[t._v("*")]),t._v(" "+t._s("("+(i+1)+")子項：")+" ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"subAuditOpinions."+i+".content",rules:{required:!0,trigger:"change",message:"此為必填欄位"}}},[a("a-textarea",{attrs:{disabled:!e.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(){t.mainFormItemChange(e,t.hasValidatedOnce&&t.validateForm)}},model:{value:e.content,callback:function(a){t.$set(e,"content",a)},expression:"subAuditOpinion.content"}})],1)],1),a("div",{staticClass:"col-auto sub-opinion__action"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[e.redQaStatusFlag?a("span",[t._v("待回覆")]):a("span",[t._v("回覆提問")])]),a("button",{staticClass:"textarea__control__btn btn__icon--question",class:e.redQaStatusFlag?"btn__icon--question_red":"btn__icon--question",on:{click:function(a){return t.QAHandler(e)}}})],2)],1),e.canModifyFlag&&"01"!==t.auditDraftContentStatus&&!e.auditOpinionId.includes("add")?a("div",{staticClass:"col-6"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[e.redCheckStatusFlag?a("span",[t._v("待確認")]):a("span",[t._v("確認修改")])]),a("button",{staticClass:"textarea__control__btn",class:e.redCheckStatusFlag?"btn__icon--confirm":"btn__icon--enter1",on:{click:function(a){return t.modifyAuditOpinion(e)}}})],2)],1):t._e()])])]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 負責部門： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"subAuditOpinions."+i+".auditOpinionUnits",rules:{validator:t.subAuditOpinionValidator}}},[a("a-tree-select",{staticClass:"treeselect",attrs:{"tree-data":t.auditOpinionUnitOptions,disabled:!e.canModifyFlag,"tree-checkable":"","tree-default-expand-all":!0,"tree-node-filter-prop":"title","dropdown-class-name":"treeselect","dropdown-style":{maxHeight:"300px"}},on:{change:function(){t.mainFormItemChange(e,t.hasValidatedOnce&&t.validateForm)}},model:{value:e.auditOpinionUnits,callback:function(a){t.$set(e,"auditOpinionUnits",a)},expression:"subAuditOpinion.auditOpinionUnits"}})],1)],1),a("div",{staticClass:"col-auto sub-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 建議事項： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"subAuditOpinions."+i+".suggestion",rules:{validator:t.subAuditOpinionValidator}}},[a("a-textarea",{attrs:{disabled:!e.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(){t.mainFormItemChange(e,t.hasValidatedOnce&&t.validateForm)}},model:{value:e.suggestion,callback:function(a){t.$set(e,"suggestion",a)},expression:"subAuditOpinion.suggestion"}})],1)],1),a("div",{staticClass:"col-auto sub-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 風險等級： ")]),a("div",{staticClass:"col ps-2 align-self-center"},[a("a-form-model-item",{attrs:{prop:"subAuditOpinions."+i+".riskLevel",rules:{validator:t.subAuditOpinionValidator}}},[a("a-radio-group",{staticClass:"align-self-center",attrs:{disabled:!e.canModifyFlag},on:{change:function(){t.mainFormItemChange(e,t.hasValidatedOnce&&t.validateForm)}},model:{value:e.riskLevel,callback:function(a){t.$set(e,"riskLevel",a)},expression:"subAuditOpinion.riskLevel"}},t._l(t.riskLevelOptions,(function(e){return a("a-radio",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1),a("div",{staticClass:"col-auto sub-opinion__action"})]),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 改善期限： ")]),a("div",{staticClass:"col ps-2 align-self-center"},[a("a-form-model-item",{ref:"subImporveOptionRef",refInFor:!0,staticClass:"imporve-option",attrs:{prop:"subAuditOpinions."+i+".imporveOption",rules:{validator:t.subImporveOptionValidator}}},[a("a-radio-group",{staticClass:"align-self-center",attrs:{disabled:!e.canModifyFlag},on:{change:function(a){t.mainFormItemChange(e,t.opinionImproveOptionChange(a,e))}},model:{value:e.imporveOption,callback:function(a){t.$set(e,"imporveOption",a)},expression:"subAuditOpinion.imporveOption"}},[a("div",{staticClass:"radio-item--inline"},[a("a-radio",{attrs:{value:"null"}},[t._v(" 不選擇 ")])],1),a("a-radio",{attrs:{value:"deadLine"}}),a("div",{staticClass:"radio-item--inline me-3"},[a("a-form-model-item",{staticClass:"mb-0",attrs:{prop:"subAuditOpinions."+i+".improveDeadline",rules:{validator:t.subImproveDeadLineValidator}}},[a("date-picker",{staticClass:"w-100",attrs:{disabled:!e.canModifyFlag||"deadLine"!==e.imporveOption,formatter:t.dateFormatter,type:"date","allow-clear":!0},on:{change:function(a){t.mainFormItemChange(e,t.$refs.subImporveOptionRef[i].onFieldChange())}},model:{value:e.improveDeadline,callback:function(a){t.$set(e,"improveDeadline",a)},expression:"subAuditOpinion.improveDeadline"}})],1)],1),a("a-radio",{attrs:{value:"imporved"}},[t._v(" 已改善 ")]),a("div",{staticClass:"radio-item--inline"},[a("a-form-model-item",{staticClass:"mb-0",attrs:{prop:"subAuditOpinions."+i+".improveDate",rules:{validator:t.subImproveDateValidator}}},[a("date-picker",{staticClass:"w-100",attrs:{disabled:!e.canModifyFlag||"imporved"!==e.imporveOption,formatter:t.dateFormatter,type:"date","allow-clear":!0},on:{change:function(a){t.mainFormItemChange(e,t.$refs.subImporveOptionRef[i].onFieldChange())}},model:{value:e.improveDate,callback:function(a){t.$set(e,"improveDate",a)},expression:"subAuditOpinion.improveDate"}})],1)],1)],1)],1)],1),a("div",{staticClass:"col-auto sub-opinion__action"})]),"imporved"===e.imporveOption?a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 改善情形： ")]),a("div",{staticClass:"col ps-2"},[a("a-form-model-item",{attrs:{prop:"subAuditOpinions."+i+".improveSituation",rules:{required:"imporved"===e.imporveOption,message:"此為必填欄位"}}},[a("a-textarea",{attrs:{disabled:!e.canModifyFlag,"auto-size":{minRows:3,maxRows:5}},on:{change:function(a){return t.mainFormItemChange(e,t.hasValidatedOnce&&t.validateForm)}},model:{value:e.improveSituation,callback:function(a){t.$set(e,"improveSituation",a)},expression:"subAuditOpinion.improveSituation"}})],1)],1),a("div",{staticClass:"col-auto sub-opinion__action"})]):t._e()])})):t._e(),"ROLE_Auditor"===t.currentRoleId&&"99"!==t.auditDraftContentStatus&&"90"!==t.auditDraftContentStatus?a("div",{staticClass:"text-center mb-2"},[a("button",{staticClass:"btn--addblock",on:{click:function(e){return t.addSubAuditOpinion(t.auditOpinionSync.subAuditOpinions)}}},[a("a-icon",{staticClass:"icon",attrs:{type:"plus"}}),a("span",[t._v("新增子項")])],1)]):t._e()],2)],1)],1)],1)}),[],!1,null,"eb7f38da",null).exports);const ho=Object(tt.c)("modalControl");let fo=class extends et.d{constructor(){super(...arguments),this.allAuditor=[],this.notRepeatAuditor=[],this.grid={rowKey:"rowKey",data:[],pagination:null,columns:[{title:"姓名",type:Re.PLAIN,property:"auditor.value",width:"40%"},{title:"調整後",type:Re.TEMPLATE,template:"modifySelect",property:"modify",width:"60%"}]},this.isConfirm=!0,this.isRepeat=!1,this.isAddRepeat=!1,this.disableConfirmDoubleCheck=!1}addAuditorValidator(t,e,a){this.disableConfirmDoubleCheck=!1,this.filterAuditor(),this.isRepeat=!1,this.isAddRepeat=!1;const i=this.grid.data.filter(t=>"add"===t.operate).map(t=>t.modifyAuditor).filter(t=>void 0!==t),s=new Set(i).size!==i.length,o=i.some(t=>void 0!==t);i.forEach(t=>{(this.notRepeatAuditor.some(e=>e===t)||s)&&(this.disableConfirmDoubleCheck=!0)}),this.notRepeatAuditor.some(e=>e==t.field)&&o&&(this.isRepeat=!0,a("此人員已被選擇")),s&&o&&(this.isAddRepeat=!0,a("此人員已被選擇")),a()}addNewItem(){this.grid.data.push({rowKey:"add"+mt.a.v4(),auditor:{key:void 0,value:void 0},modifyAuditor:void 0,operate:"add"})}filterAuditor(){const t=this.grid.data.filter(t=>"modify"===t.operate);this.notRepeatAuditor=[],t.forEach(t=>{this.notRepeatAuditor.includes(t.modifyAuditor||t.auditor.value)||this.notRepeatAuditor.push(t.modifyAuditor||t.auditor.value)})}cancel(){this.close()}close(){this.$emit("closeModal")}getRawData(){this.grid.data=this.draftAuditor.map(t=>({rowKey:"add"+mt.a.v4(),auditor:t,modifyAuditor:void 0,operate:"modify"}))}getSectionAuditor(){const t=this.$global.getParam().query.checkMan;this.allAuditor=t.map(t=>({key:t.domainId,value:t.name}))}confirmModal(){let t="新增";this.grid.data.filter(t=>"add"===t.operate&&null==t.modifyAuditor).forEach(t=>{this.grid.data.splice(this.grid.data.indexOf(t),1)}),this.grid.data.filter(t=>void 0!==t.modifyAuditor).forEach(e=>{const a=this.allAuditor.find(t=>t.value===e.modifyAuditor).key;if(a)switch(this.request.auditors.push({auditor:e.auditor.key?e.auditor.key:" ",modifyAuditor:a||"",operate:e.operate}),this.grid.data.some(t=>"add"===t.operate)){case!0:t="新增",e.operate="modify";break;case!1:t="編輯"}setTimeout(()=>{e.modifyAuditor=void 0},100)}),this.getAPI_updateAuditor(t)}created(){this.getSectionAuditor(),this.request={auditDraftContentId:this.auditDraftContentId,auditors:[]}}get returnModifyAuditor(){return this.grid.data.map(t=>t.modifyAuditor)}modifyAuditorChange(t,e){this.filterAuditor(),this.isConfirm=!t.some(t=>void 0!==t)}isVisible(t){t&&this.getRawData()}getAPI_updateAuditor(t){this.setLoading(!0),this.$workPaperApi.updateDraftContentAuditorUsingPOST(this.request).then(e=>{e.data.success?(this.$emit("reloadDraft"),this.close()):this.setModalState({resultModal:{visible:!0,type:"error",title:t+"失敗",content:e.statusText}})}).catch(e=>{this.setModalState({resultModal:{visible:!0,type:"error",title:t+"失敗",content:e.response.data.status}})}).finally(()=>{this.setLoading(!1),this.request.auditors=[]})}};Object(J.a)([Object(tt.a)("setLoading")],fo.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],fo.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],fo.prototype,"auditDraftContentId",void 0),Object(J.a)([Object(et.b)()],fo.prototype,"draftAuditor",void 0),Object(J.a)([ho.Action("setModalState")],fo.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("returnModifyAuditor",{immediate:!0})],fo.prototype,"modifyAuditorChange",null),Object(J.a)([Object(et.e)("visible")],fo.prototype,"isVisible",null),fo=Object(J.a)([Object(et.a)({components:{InfoModal:_t,FblDataGrid:gt}})],fo);var go=fo,bo=(a("8866"),Object(st.a)(go,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"查核人員編輯",visible:t.visible,closable:!1},on:{closeModal:t.close}},[a("template",{slot:"content"},[a("div",{staticClass:"content"},[a("button",{staticClass:"btn--action mb-1 ms-auto",on:{click:t.addNewItem}},[t._v(" 新增 ")]),a("fbl-data-grid",{staticClass:"table--pale",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,bordered:!0,pagination:!1},scopedSlots:t._u([{key:"modifySelect",fn:function(e){return[a("a-form-model",{ref:"form",attrs:{model:e}},[a("a-form-model-item",{key:e.data.auditor.key,attrs:{prop:e.data.modifyAuditor,rules:{validator:"add"==e.data.operate?t.addAuditorValidator:null}}},[a("a-select",{key:e.rowKey,staticClass:"select--min-width",attrs:{"allow-clear":!0,"show-search":!0,placeholder:"請選擇人員"},model:{value:e.data.modifyAuditor,callback:function(a){t.$set(e.data,"modifyAuditor",a)},expression:"grid.data.modifyAuditor"}},t._l(t.allAuditor,(function(e){return a("a-select-option",{key:e.key,attrs:{value:""+e.value}},[t._v(" "+t._s(e.value)+" ")])})),1)],1)],1)]}}])})],1),a("div",{staticClass:"d-flex mt-4 justify-content-end"},[a("button",{staticClass:"btn--primary me-2",attrs:{disabled:t.isConfirm||t.isRepeat||t.disableConfirmDoubleCheck},on:{click:t.confirmModal}},[t._v(" 確定 ")]),a("button",{staticClass:"btn--dark ms-2",on:{click:t.cancel}},[t._v(" 取消 ")])])])],2)}),[],!1,null,"fb9e57e8",null).exports);const vo=Object(tt.c)("modalControl");let _o=class extends et.d{constructor(){super(...arguments),this.contentData=[],this.attatchments={}}getCurrentView({caseType:t}){var e;return(null===(e=Object.keys(t))||void 0===e?void 0:e.length)>0?"DataType__"+this.$enum.getDataTypeComp(Object.keys(t)[0]):"DataType__comp1"}close(){this.$emit("closeModal")}getApi_GetAttachment(t){this.setLoading(!0),this.$dataCollectApi.getAttachmentUsingGET(t).then(e=>{this.$set(this.attatchments,t,e.data.result)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}onDownload({attachmentId:t,fileName:e}){this.setLoading(!0),this.$auditPlanApi.downloadAttachmentInAuditPlanUsingGET(t,{responseType:"blob"}).then(t=>{const a=document.createElement("a"),i=(window.URL||window.webkitURL).createObjectURL(t.data),s=e;a.setAttribute("href",i),a.setAttribute("download",""+s),a.click(),a.remove()}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getAPI_getData(){this.setLoading(!0),this.$workPaperApi.getDraftContentRelUsingGET(this.auditDraftContentId).then(t=>{this.contentData=t.data.result,this.contentData.forEach(t=>{this.getApi_GetAttachment(t.crawlerDataId)})}).catch(t=>{var e,a,i,s;0===(null==t||null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.total)||this.setModalState({resultModal:{visible:!0,type:"error",title:null==t||null===(i=t.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.message}})}).finally(()=>{this.setLoading(!1)})}onWatchVisible(t){t&&(this.getAPI_getData(),this.attatchments={})}};Object(J.a)([Object(tt.a)("setLoading")],_o.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],_o.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],_o.prototype,"auditDraftContentId",void 0),Object(J.a)([vo.Action("setModalState")],_o.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("visible")],_o.prototype,"onWatchVisible",null),_o=Object(J.a)([Object(et.a)({components:{InfoModal:_t,DataType__comp1:Lt,DataType__comp2:Et,DataType__comp3:Kt,DataType__comp4:Xt}})],_o);var yo=_o,Co=(a("adc0"),Object(st.a)(yo,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{visible:t.visible,closable:!0,centered:!0,footer:null,"body-size":"large","padding-size":"normal"},on:{closeModal:t.close}},[i("template",{slot:"content"},[t.contentData&&t.contentData.length>0?t._l(t.contentData,(function(e,a){return i("div",{key:a,staticClass:"main__contentItem"},[i("div",{staticClass:"main__content"},[e.caseType?i(t.getCurrentView(e),{tag:"component",attrs:{"prop-data":e}}):t._e()],1),t.attatchments[e.crawlerDataId]&&t.attatchments[e.crawlerDataId].length>0?i("div",{staticClass:"file__content"},[i("div",{staticClass:"file__header"},[i("div",{staticClass:"file__header-img"}),i("span",{staticClass:"file__header-title"},[t._v("資料檔案")])]),i("div",{staticClass:"file__list"},t._l(t.attatchments[e.crawlerDataId],(function(e,a){return i("div",{key:a,staticClass:"file__list__item"},[i("a",{staticClass:"file__list__text",on:{click:function(a){return t.onDownload(e)}}},[t._v(" "+t._s(e.fileName)+" ")])])})),0)]):t._e()])})):i("div",{staticClass:"d-flex m-3 flex-column justify-content-center align-items-center comp__empty"},[i("img",{attrs:{src:a("3c7c"),alt:""}}),i("div",{staticClass:"comp__empty--text"},[t._v(" 無關聯資料 ")])])],2)],2)}),[],!1,null,"70741490",null).exports);const Oo=Object(tt.c)("modalControl");let Ao=class extends et.d{constructor(){super(...arguments),this.allowedFileType=null,this.fileList=[],this.grid={rowKey:"updateDatetime",data:[],columns:[{type:Re.TEMPLATE,property:"fileName",title:"檔案上傳",template:"fileName"},{type:Re.PLAIN,property:"updateUser",title:"上傳人員",formatter:t=>t.updateUser.value},{type:Re.PLAIN,property:"updateDatetime",title:"上傳時間",formatter:t=>this.$twDateTimeFormatter.stringify(t.updateDatetime)},{type:Re.TEMPLATE,property:"delete",template:"delete",title:"刪除",width:100}]}}async onVisibleChange(){this.visible&&(this.getDraftContentFile(this.auditDraftContentId),this.allowedFileType=await this.getApi_authorizationFileType())}closeModal(){this.$emit("closeModal")}getDraftContentFile(t){this.setLoading(!0),this.$workPaperApi.getDraftContentFilesUsingGET(t).then(t=>{this.grid.data=t.data.result.auditDraftContentFiles}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"取得附件失敗"}})}).finally(()=>{this.setLoading(!1)})}async getApi_authorizationFileType(){this.setLoading(!0);const t=await this.$parameterApi.searchAllowedFileExtensionsInParameterUsingGET();return this.setLoading(!1),t.data.result}uploadFile(t,e,a,i){this.setLoading(!0),this.$workPaperApi.uploadDraftContentUsingPOST(t,a,e,i).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"上傳附件成功",autoClose:3}}),this.getDraftContentFile(this.auditDraftContentId),this.$emit("reloadDraft")}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"上傳附件失敗"}})}).finally(()=>{this.setLoading(!1)})}downloadFile(t,e){this.setLoading(!0),this.$workPaperApi.downloadDraftContentFileUsingPOST({auditDraftContentFileIds:[t]},{responseType:"blob"}).then(t=>{this.$blobUtils.download(t.data,e)}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"上傳附件失敗"}})}).finally(()=>{this.setLoading(!1)})}deleteFile(t){this.setLoading(!0),this.$workPaperApi.deleteDraftContentFileUsingPOST({auditDraftContentFileId:t}).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除附件成功"}}),this.getDraftContentFile(this.auditDraftContentId),this.$emit("reloadDraft")}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除附件失敗"}})}).finally(()=>{this.setLoading(!1)})}async beforeUpload(t){const e=this.allowedFileType.reduce((t,e)=>`${t}|${e}`);return new RegExp(`(${e})$`).test(t.name)?200/1024/1024<t.size?void this.uploadFile(this.auditDraftContentId,"01",t.name,t):(this.setModalState({resultModal:{visible:!0,type:"warning",title:"上傳提示",content:"檔案大小超過200MB，請重新選擇檔案"}}),!1):(this.setModalState({resultModal:{visible:!0,type:"warning",title:"上傳提示",content:"檔案格式錯誤"}}),!1)}};Object(J.a)([Object(tt.a)("setLoading")],Ao.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Ao.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],Ao.prototype,"auditDraftContentId",void 0),Object(J.a)([Oo.Action("setModalState")],Ao.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("visible")],Ao.prototype,"onVisibleChange",null),Ao=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,InfoModal:_t,CustomPopConfirm:ce}})],Ao);var Io=Ao,Do=(a("cf25"),Object(st.a)(Io,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("InfoModal",{attrs:{title:"上傳附件",visible:t.visible,centered:!0,closable:!0,"body-size":"large","padding-size":"small"},on:{closeModal:t.closeModal}},[i("template",{slot:"content"},[i("div",{staticClass:"content__wrap mt-2"},[i("a-upload-dragger",{staticClass:"upload__dragger",attrs:{"show-upload-list":!1,"file-list":t.fileList,"before-upload":t.beforeUpload,"custom-request":function(){},multiple:!0}},[i("p",{staticClass:"ant-upload-drag-icon"},[i("a-icon",{attrs:{type:"container"}})],1),i("p",{staticClass:"ant-upload-text"},[t._v(" 點選或將文件拖曳到這裡上傳 ")]),i("p",{staticClass:"ant-upload-hint"},[t._v(" 支援"+t._s(t.allowedFileType&&t.allowedFileType.join("、"))+"格式，檔案大小200MB以內 ")])]),i("fbl-data-grid",{staticClass:"upload__table mt-3",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.grid.data,pagination:!1,scroll:{x:!0}},scopedSlots:t._u([{key:"fileName",fn:function(e){return[i("a",{on:{click:function(a){return t.downloadFile(e.data.auditDraftContentFileId,e.data.fileName)}}},[t._v(" "+t._s(e.data.fileName)+" ")])]}},{key:"delete",fn:function(e){return[e.data.canDeleteFlag?i("div",{staticClass:"flex-center"},[i("CustomPopConfirm",{on:{confirm:function(a){return t.deleteFile(e.data.auditDraftContentFileId)}}},[i("img",{staticClass:"table__btn-delete",attrs:{alt:"",src:a("178a")}})])],1):t._e()]}}])})],1)])],2)}),[],!1,null,"24bb9c5d",null).exports);const So=Object(tt.c)("modalControl");let wo=class extends et.d{constructor(){super(...arguments),this.formatter=this.$twDateFormatter,this.yearFormatter=this.$twYearFormatter,this.isLoading=!1,this.currentRole=this.$global.getCurrentRole(),this.currentRoleId=this.$global.getCurrentRoleId(),this.currentUser=this.$user.getMe(),this.QAModal={visible:!1,auditOpinion:null,auditDraftContent:null,type:null},this.compareDataModal={visible:!1,auditDraftContentId:null,currentData:null},this.compareFeedModal={visible:!1,auditDraftContentId:0},this.editAuditorModal={visible:!1},this.connectDataModal={visible:!1},this.uploadModal={visible:!1},this.originalDraftContent=null,this.inChargeAuditor=null,this.auditDraftContent=null,this.opinionOptions=null,this.riskLevelOptions=null,this.auditOpinionOptions=null,this.auditOpinionUnitOptions=null,this.templateOpinionContent=null,this.auditOpinions=[],this.templateAuditOpinions={auditOpinionId:null,canModifyFlag:!0,canQaFlag:null,redCheckStatusFlag:null,redQaStatusFlag:null,auditors:null,itemType:"MAIN",subRelMainId:null,seq:1,content:null,auditOpinionUnits:[],suggestion:null,opinionSummary:null,riskLevel:null,improveDeadline:null,improve:null,improveDate:null,imporveOption:"null",improveSituation:null,subAuditOpinions:[],modify:!0},this.auditOpinionsFrontEnd=null,this.originalAuditOpinionsFrontEnd=null}get isDisabledAuditDraftContentOption(){var t,e;return null===(t=this.auditDraftContent)||void 0===t||!t.canModifyOpinionFlag||!!("Y"===(null===(e=this.auditDraftContent)||void 0===e?void 0:e.opinion)&&this.auditOpinionsFrontEnd&&this.auditOpinionsFrontEnd.length>0)}get isEditAuditor(){var t;return null===(t=this.auditDraftContent)||void 0===t?void 0:t.canModifyAuditorFlag}get isAddMainAuditOpinion(){var t,e,a;return"ROLE_Auditor"===this.currentRoleId&&"99"!==(null===(t=this.auditDraftContent)||void 0===t?void 0:t.status)&&"90"!==(null===(e=this.auditDraftContent)||void 0===e?void 0:e.status)&&"Y"===(null===(a=this.auditDraftContent)||void 0===a?void 0:a.opinion)}get isShowSaveBtn(){if(this.auditOpinionsFrontEnd&&this.auditOpinionsFrontEnd.length>0)for(let t=0;t<this.auditOpinionsFrontEnd.length;t++){if(this.auditOpinionsFrontEnd[t].canModifyFlag)return!0;if(this.auditOpinionsFrontEnd[t].subAuditOpinions&&this.auditOpinionsFrontEnd[t].subAuditOpinions.length>0){const e=this.auditOpinionsFrontEnd[t].subAuditOpinions;for(let t=0;t<e.length;t++)if(e[t].canModifyFlag)return!0}}return!1}get draftAuditorString(){var t,e;return(null===(t=this.auditDraftContent)||void 0===t||null===(e=t.auditors)||void 0===e?void 0:e.length)>0?this.auditDraftContent.auditors.map(t=>t.value).join("、"):""}onauditOpinionsFrontEndChanged(t){}onAuditOpinionsChanged(t){}onDraftContentOpinionChanged(t,e){var a;const i={...this.templateAuditOpinions,auditOpinionId:"add"+mt.a.v4(),auditors:[{key:this.currentUser.employee.domainId,value:this.currentUser.employee.name}],content:null===(a=this.templateOpinionContent.find(e=>e.value===t))||void 0===a?void 0:a.label};"Y"!==e||"N"!==t&&"X"!==t||(this.auditOpinionsFrontEnd=[i]),"Y"===e||"N"!==t&&"X"!==t||(this.auditOpinionsFrontEnd&&0!==this.auditOpinionsFrontEnd.length||(this.auditOpinionsFrontEnd=[]),this.auditOpinionsFrontEnd.push(i))}onCompareData(){this.compareDataModal.visible=!0,this.compareDataModal.auditDraftContentId=this.auditDraftContent.auditDraftContentId,this.compareDataModal.currentData={auditDraftContentId:this.auditDraftContent.auditDraftContentId,auditDraftContentLogId:null,content:this.auditDraftContent.content,updateDatetime:"當前編輯項目",updateRole:{code:this.currentRoleId,name:this.currentRole.name},updateUser:{code:this.currentUser.employee.domainId,name:this.currentUser.employee.name}}}onCompareFeed(){this.compareFeedModal.visible=!0}onEditAuditor(){this.editAuditorModal.visible=!0}onConnectData(){this.connectDataModal.visible=!0}async created(){await this.getOpinionTemplate(),await this.getAuditOpinionOption(),await this.getDraftContent(this.$global.getQuery().auditDraftContentId),this.inChargeAuditor=this.$global.getQuery().inCharge,this.getRiskLevelOption(),this.getAuditOpinionUnitOption(this.auditDraftContent.auditDraftSectionId),this.auditOpinions=await this.getAuditOpinion(this.auditDraftContent.auditDraftContentId),this.initAuditOpinions(this.auditOpinions)}updated(){}async getDraftContent(t){this.setLoading(!0),await this.$workPaperApi.searchAuditDraftContentDetailUsingPOST(t).then(t=>{this.auditDraftContent=t.data.result,this.originalDraftContent=t.data.result.content}).catch(console.error).finally(()=>{this.setLoading(!1)})}getRiskLevelOption(){this.setLoading(!0),this.$workPaperApi.searchRiskLevelUsingGET().then(t=>{this.riskLevelOptions=t.data.result,this.riskLevelOptions=[{label:"不選擇",value:"null"},...this.riskLevelOptions]}).catch(console.error).finally(()=>{this.setLoading(!1)})}async getAuditOpinionOption(){this.setLoading(!0),await this.$workPaperApi.searchAuditOpinionInWorkPaperUsingGET().then(t=>{this.auditOpinionOptions=t.data.result}).catch(console.error).finally(()=>{this.setLoading(!1)})}getAuditOpinionUnitOption(t){this.setLoading(!0),this.$workPaperApi.searchResponsibleDepartmentUsingGET(t).then(t=>{this.auditOpinionUnitOptions=this.convertUnitToTreeSelect(t.data)}).catch(console.error).finally(()=>{this.setLoading(!1)})}async getOpinionTemplate(){this.setLoading(!0),await this.$workPaperApi.searchWordingInWorkPaperUsingGET().then(t=>{this.templateOpinionContent=t.data.result}).catch(console.error).finally(()=>{this.setLoading(!1)})}modifyAuditDraftContent(){this.setLoading(!0);const t={auditDraftContentId:this.auditDraftContent.auditDraftContentId,content:this.auditDraftContent.content,isModify:this.originalDraftContent!==this.auditDraftContent.content};this.$workPaperApi.updateDraftContentUsingPOST(t).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"修改查核內容成功",autoClose:3}}),this.getDraftContent(this.auditDraftContent.auditDraftContentId)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"修改查核內容失敗"}})}).finally(()=>{this.setLoading(!1)})}updateDraftQAStatus(){}async getAuditOpinion(t){this.setLoading(!0);let e=null;return await this.$workPaperApi.searchAuditOpinionUsingGET(t).then(t=>{e=t.data.result}).catch(t=>{console.error}).finally(()=>{this.setLoading(!1)}),e}updateOpinionQAStatus(){}saveAuditOpinion(t){this.setLoading(!0),this.$workPaperApi.saveAuditOpinionTmpUsingPOST(t).then(async t=>{t.data?(this.setModalState({resultModal:{visible:!0,type:"success",title:"暫存成功",autoClose:3}}),this.auditOpinions=await this.getAuditOpinion(this.auditDraftContent.auditDraftContentId),this.initAuditOpinions(this.auditOpinions)):this.setModalState({resultModal:{visible:!0,type:"error",title:"暫存失敗"}})}).catch(t=>{console.error,this.setModalState({resultModal:{visible:!0,type:"error",title:"暫存失敗"}})}).finally(()=>{this.setLoading(!1)})}onDownload(t){const e=this.auditDraftContent.auditDraftContentFileVOS,a={auditDraftContentFileIds:t?[t]:e.map(t=>t.auditDraftContentFileId)};this.setLoading(!0),this.$workPaperApi.downloadDraftContentFileUsingPOST(a,{responseType:"blob"}).then(a=>{const i=e.map(t=>t.auditDraftContentFileId).indexOf(t),s=t?e[i].fileName:ya()(ya()().valueOf()).format("MMDD")+"全部附件";this.$blobUtils.download(a.data,s)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}toPreviousPage(){this.$router.go(-1)}auditOpinionsToAuditOpinionsFrontEnd(t){return t&&0!==t.length?this.$global.deepCopyData(t).map(t=>(t.subAuditOpinions&&t.subAuditOpinions.length>0&&(t.subAuditOpinions=this.auditOpinionsToAuditOpinionsFrontEnd(t.subAuditOpinions)),null===t.riskLevel&&(t.riskLevel="null"),t.imporveOption="null",!0===t.improve?(t.imporveOption="imporved",t.improveDate=Ca.isValidDate(""+t.improveDate)):!1===t.improve&&t.improveDeadline&&(t.imporveOption="deadLine",t.improveDeadline=Ca.isValidDate(""+t.improveDeadline)),t.auditDraftContentId=this.auditDraftContent.auditDraftContentId,t)):[]}auditOpinionsFrontEndToSaveAuditOpinions(t){let e=null;const a=["auditors","imporveOption","canModifyFlag","canQaFlag","redCheckStatusFlag","redQaStatusFlag"];return e=this.$global.deepCopyData(t).map(t=>(t.subAuditOpinions&&t.subAuditOpinions.length>0&&(t.subAuditOpinions=this.auditOpinionsFrontEndToSaveAuditOpinions(t.subAuditOpinions)),"null"===t.riskLevel&&(t.riskLevel=null),t.auditOpinionId.includes("add")&&(t.auditOpinionId=""),t.improveDate&&t.improveDate.toISOString(),t.improveDeadline&&t.improveDeadline.toISOString(),"SUB"===t.itemType&&t.subRelMainId.includes("add")&&(t.subRelMainId=""),a.forEach(e=>delete t[e]),t.auditDraftContentId=this.auditDraftContent.auditDraftContentId,t)),e}initAuditOpinions(t){this.auditOpinionsFrontEnd=this.auditOpinionsToAuditOpinionsFrontEnd(t),this.originalAuditOpinionsFrontEnd=this.$global.deepCopyData(this.auditOpinionsFrontEnd)}convertUnitToTreeSelect(t){return[{title:"全部",value:"all",key:"all",children:t.checkedUnits.concat(t.otherUnits).map(t=>({title:t.value+t.label,value:t.value,key:t.value}))},{title:"無效單位",value:"invalid",key:"invalid",children:t.invalidUnits.map(t=>({title:t.value+t.label,value:t.value,key:t.value}))}]}openDraftQAModal(){this.QAModal={type:"draft",visible:!0,auditOpinion:null,auditDraftContent:this.auditDraftContent}}async vaildateAllAuditOpinion(){this.setLoading(!0);const t=[],e=this.$refs.auditOpinion;let a=!0;return e&&e.length>0?(this.$refs.auditOpinion.forEach(e=>{t.push(e.validateForm())}),await Promise.all(t).then(t=>{if(a=void 0===t.find(t=>!1===t),a)this.setLoading(!1);else{const t=this.$el.querySelector(".has-error");t&&t.scrollIntoView({block:"center",inline:"nearest"}),this.setLoading(!1)}}).catch(()=>{a=!1,this.setLoading(!1)})):(this.setLoading(!1),a=!0),a}async saveHandler(){this.setLoading(!0);let t=null;await this.forceNextTick(async()=>{await this.vaildateAllAuditOpinion()&&(this.setAuditOpinionSequence(this.auditOpinionsFrontEnd),t={auditDraftContentId:this.auditDraftContent.auditDraftContentId,opinion:this.auditDraftContent.opinion,auditOpinions:this.auditOpinionsFrontEndToSaveAuditOpinions(this.auditOpinionsFrontEnd)},this.saveAuditOpinion(t))}),this.setLoading(!1)}addAuditOpinion(t){const e={auditOpinionId:"add"+mt.a.v4(),canModifyFlag:!0,canQaFlag:null,redCheckStatusFlag:null,redQaStatusFlag:null,auditors:[{key:this.currentUser.employee.domainId,value:this.currentUser.employee.name}],itemType:"MAIN",subRelMainId:null,seq:(null==t?void 0:t.length)+1,content:null,auditOpinionUnits:[],suggestion:null,opinionSummary:null,riskLevel:null,improveDeadline:null,improve:null,improveDate:null,imporveOption:"null",improveSituation:null,subAuditOpinions:[],modify:!0};t.push(e)}removeMainAuditOpinion(t){const e=this.auditOpinionsFrontEnd.findIndex(e=>e.auditOpinionId===t);this.auditOpinionsFrontEnd.splice(e,1)}setAuditOpinionSequence(t){t.forEach((t,e)=>{var a;t.seq=e+1,(null===(a=t.subAuditOpinions)||void 0===a?void 0:a.length)>0&&this.setAuditOpinionSequence(t.subAuditOpinions)})}getSingleAuditOpinion(t){return t?"MAIN"===t.itemType?this.auditOpinionsFrontEnd.find(e=>e.auditOpinionId===t.auditOpinionId):"SUB"===t.itemType?this.auditOpinionsFrontEnd.find(e=>e.auditOpinionId===t.subRelMainId).subAuditOpinions.find(e=>e.auditOpinionId===t.auditOpinionId):null:null}async updateAuditOpinion(t,e){const a=await this.getAuditOpinion(this.auditDraftContent.auditDraftContentId);if(!a||0===a.length)return;let i=null,s=null,o=null;if(e){i=a.find(t=>t.auditOpinionId===e),s=this.auditOpinionsFrontEnd.findIndex(t=>t.auditOpinionId==e);const n=i.subAuditOpinions.find(e=>e.auditOpinionId===t),r=this.auditOpinionsFrontEnd[s].subAuditOpinions.findIndex(e=>e.auditOpinionId==t);o=this.$global.deepCopyData(this.auditOpinionsFrontEnd[s]),o.subAuditOpinions[r]={...o.subAuditOpinions[r],canQaFlag:n.canQaFlag,canModifyFlag:n.canModifyFlag,redCheckStatusFlag:n.redCheckStatusFlag,redQaStatusFlag:n.redQaStatusFlag}}else i=a.find(e=>e.auditOpinionId===t),s=this.auditOpinionsFrontEnd.findIndex(e=>e.auditOpinionId==t),o=this.$global.deepCopyData(this.auditOpinionsFrontEnd[s]),o={...o,canQaFlag:i.canQaFlag,canModifyFlag:i.canModifyFlag,redCheckStatusFlag:i.redCheckStatusFlag,redQaStatusFlag:i.redQaStatusFlag};et.d.set(this.auditOpinionsFrontEnd,s,o)}openOpinionQAModal(t){this.QAModal={type:"opinion",visible:!0,auditDraftContent:null,auditOpinion:this.getSingleAuditOpinion(t.auditOpinion)}}updateOpinion({auditOpinionId:t,subRelMainId:e}){this.updateAuditOpinion(t,e)}doubleRequestAnimationFrame(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}forceNextTick(t){if(!t||"function"!=typeof t)return new Promise(t=>{this.doubleRequestAnimationFrame(t)});this.doubleRequestAnimationFrame(t)}};Object(J.a)([Object(tt.a)("setLoading")],wo.prototype,"setLoading",void 0),Object(J.a)([So.Action("setModalState")],wo.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("auditOpinionsFrontEnd",{deep:!0})],wo.prototype,"onauditOpinionsFrontEndChanged",null),Object(J.a)([Object(et.e)("auditOpinions",{deep:!0})],wo.prototype,"onAuditOpinionsChanged",null),Object(J.a)([Object(et.e)("auditDraftContent.opinion")],wo.prototype,"onDraftContentOpinionChanged",null),wo=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,CustomPopConfirm:ce,AccordionArea:_e,AuditOpinion:mo,QAModal:lo,EditAuditorModal:bo,ConnectDataModal:Co,CompareDataModal:eo,CompareFeedModal:so,TemporaryStoreButton:ne,UploadModal:Do}})],wo);var ko=wo,Mo=(a("8e9f"),Object(st.a)(ko,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.auditDraftContent?a("div",{staticClass:"main-contain crawlerindex-container container"},[a("div",{staticClass:"row g-0 mb-3"},[a("div",{staticClass:"col-1"}),a("div",{staticClass:"col ps-2 text-end"},[a("IconTextButton",{staticClass:"align-self-stretch",attrs:{text:"上一頁",type:"return"},on:{click:t.toPreviousPage}})],1),a("div",{staticClass:"col-auto content__action"})]),a("div",{staticClass:"row g-0 mb-3"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 查核人員： ")]),a("div",{staticClass:"col ps-2"},[t._v(" "+t._s(t.draftAuditorString)+" ")]),a("div",{staticClass:"col-auto content__action"},[t.isEditAuditor?a("div",{staticClass:"row g-0"},[t.auditDraftContent.canModifyAuditorFlag?a("div",{staticClass:"col-5"},[a("button",{staticClass:"textarea__control__btn btn__icon--edit-acion",on:{click:t.onEditAuditor}})]):t._e()]):t._e()])]),a("div",{staticClass:"row g-0",class:{"mb-3":!t.auditDraftContent.canUploadFlag}},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 查核內容： ")]),a("div",{staticClass:"col ps-2"},[a("a-textarea",{attrs:{disabled:!t.auditDraftContent.canModifyContentFlag,"auto-size":{minRows:3,maxRows:5}},model:{value:t.auditDraftContent.content,callback:function(e){t.$set(t.auditDraftContent,"content",e)},expression:"auditDraftContent.content"}})],1),a("div",{staticClass:"col-auto content__action"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-5"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("span",[t._v("比對資料")])]),a("button",{staticClass:"textarea__control__btn btn__icon--comparison mb-3",on:{click:t.onCompareData}})],2)],1),a("div",{staticClass:"col-5"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("span",[t._v("連結資料")])]),a("button",{staticClass:"textarea__control__btn btn__icon--small_link mb-3",on:{click:t.onConnectData}})],2)],1),t.auditDraftContent.canQaContentFlag?a("div",{staticClass:"col-5"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.auditDraftContent.redQaStatusFlag?a("span",[t._v("待回覆")]):a("span",[t._v("回覆提問")])]),a("button",{staticClass:"textarea__control__btn",class:t.auditDraftContent.redQaStatusFlag?"btn__icon--question_red":"btn__icon--question",on:{click:t.openDraftQAModal}})],2)],1):t._e(),t.auditDraftContent.canModifyContentFlag?a("div",{staticClass:"col-5"},[a("a-tooltip",{attrs:{placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[t.auditDraftContent.redCheckStatusFlag?a("span",[t._v("待確認")]):a("span",[t._v("確認修改")])]),a("button",{staticClass:"textarea__control__btn",class:t.auditDraftContent.redCheckStatusFlag?"btn__icon--confirm":"btn__icon--enter1",on:{click:t.modifyAuditDraftContent}})],2)],1):t._e()])])]),t.auditDraftContent.canUploadFlag?a("div",{staticClass:"row"},[a("div",{staticClass:"col text-center my-4"},[a("IconTextButton",{staticClass:"align-self-stretch",attrs:{text:"查核人員上傳",type:"upload"},on:{click:function(e){t.uploadModal.visible=!0}}})],1)]):t._e(),a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-1 text-end content__label"},[t._v(" 全部附件： ")]),a("div",{staticClass:"col ps-2"},[t.auditDraftContent.auditDraftContentFileVOS&&t.auditDraftContent.auditDraftContentFileVOS.length>0?a("div",{staticClass:"block block--scroll"},[t._l(t.auditDraftContent.auditDraftContentFileVOS,(function(e,i){return[a("a",{key:e.auditDraftContentFileId,on:{click:function(a){return a.preventDefault(),t.onDownload(e.auditDraftContentFileId)}}},[t._v(" "+t._s(e.fileName)+" ")]),i+1<t.auditDraftContent.auditDraftContentFileVOS.length?a("span",{key:i},[t._v("、")]):t._e()]}))],2):a("div",[t._v(" 無 ")])]),t.auditDraftContent.auditDraftContentFileVOS&&t.auditDraftContent.auditDraftContentFileVOS.length>0?a("div",{staticClass:"col-auto content__action"},[a("div",{staticClass:"row g-0"},[a("div",{staticClass:"col-5"},[a("button",{staticClass:"textarea__control__btn btn__icon--download_light",on:{click:function(e){return t.onDownload()}}})])])]):t._e()]),a("AccordionArea",{staticClass:"mt-3",attrs:{"is-line":!0}},[a("div",{staticClass:"row g-0 mt-3 mb-3"},[a("div",{staticClass:"col-1 text-end content__label label--large align-self-center"},[t._v(" 查核意見： ")]),a("div",{staticClass:"col-11 align-items-center d-flex"},[a("a-radio-group",{staticClass:"align-self-center",attrs:{disabled:t.isDisabledAuditDraftContentOption},model:{value:t.auditDraftContent.opinion,callback:function(e){t.$set(t.auditDraftContent,"opinion",e)},expression:"auditDraftContent.opinion"}},t._l(t.auditOpinionOptions,(function(e){return a("a-radio",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1),a("div",{staticClass:"ms-auto"},[t.isShowSaveBtn?a("IconTextButton",{staticClass:"me-3",attrs:{text:"暫存",type:"save"},on:{click:t.saveHandler}}):t._e(),a("IconTextButton",{attrs:{text:"比對資料",type:"comparison_d"},on:{click:t.onCompareFeed}})],1)],1)]),t.auditOpinionsFrontEnd&&t.auditOpinionsFrontEnd.length>0?t._l(t.auditOpinionsFrontEnd,(function(e,i){return a("AuditOpinion",{key:e.auditOpinionId,ref:"auditOpinion",refInFor:!0,staticClass:"mb-3",attrs:{index:i,"audit-opinion":t.auditOpinionsFrontEnd[i],"original-audit-option":t.originalAuditOpinionsFrontEnd&&t.originalAuditOpinionsFrontEnd[i],"risk-level-options":t.riskLevelOptions,"current-role":t.currentRole,"current-user":t.currentUser,"audit-draft-content-status":t.auditDraftContent.status,"audit-opinion-unit-options":t.auditOpinionUnitOptions,opinion:t.auditDraftContent.opinion},on:{"update:auditOpinion":function(e){return t.$set(t.auditOpinionsFrontEnd,i,e)},"update:audit-opinion":function(e){return t.$set(t.auditOpinionsFrontEnd,i,e)},openOpinionQAModal:t.openOpinionQAModal,removeMainAuditOpinion:t.removeMainAuditOpinion,updateAuditOpinion:t.updateOpinion}})})):t._e(),t.isAddMainAuditOpinion?a("div",{staticClass:"text-center mb-4 mt-4"},[a("button",{staticClass:"btn--addblock",on:{click:function(e){return t.addAuditOpinion(t.auditOpinionsFrontEnd)}}},[a("a-icon",{staticClass:"icon",attrs:{type:"plus"}}),a("span",[t._v("新增主項")])],1)]):t._e()],2),t.isShowSaveBtn?a("TemporaryStoreButton",{on:{click:t.saveHandler}}):t._e(),a("QAModal",{attrs:{visible:t.QAModal.visible,type:t.QAModal.type,"audit-opinion":t.QAModal.auditOpinion,"audit-draft-content":t.QAModal.auditDraftContent},on:{"update:auditOpinion":function(e){return t.$set(t.QAModal,"auditOpinion",e)},"update:audit-opinion":function(e){return t.$set(t.QAModal,"auditOpinion",e)},"update:auditDraftContent":function(e){return t.$set(t.QAModal,"auditDraftContent",e)},"update:audit-draft-content":function(e){return t.$set(t.QAModal,"auditDraftContent",e)},closeModal:function(e){t.QAModal.visible=!1},updateAuditOpinion:t.updateOpinion,reloadDraft:function(){return t.getDraftContent(t.auditDraftContent.auditDraftContentId)}}}),a("EditAuditorModal",{attrs:{visible:t.editAuditorModal.visible,"audit-draft-content-id":t.auditDraftContent.auditDraftContentId,"draft-auditor":t.auditDraftContent.auditors},on:{closeModal:function(e){t.editAuditorModal.visible=!1},reloadDraft:function(){return t.getDraftContent(t.auditDraftContent.auditDraftContentId)}}}),a("ConnectDataModal",{attrs:{visible:t.connectDataModal.visible,"audit-draft-content-id":t.auditDraftContent.auditDraftContentId},on:{closeModal:function(e){t.connectDataModal.visible=!1}}}),a("CompareDataModal",{attrs:{visible:t.compareDataModal.visible,"audit-draft-content-id":t.compareDataModal.auditDraftContentId,"current-data":t.compareDataModal.currentData},on:{closeModal:function(e){t.compareDataModal.visible=!1}}}),a("CompareFeedModal",{attrs:{visible:t.compareFeedModal.visible,"audit-draft-content-id":t.auditDraftContent.auditDraftContentId},on:{closeModal:function(e){t.compareFeedModal.visible=!1}}}),a("UploadModal",{attrs:{visible:t.uploadModal.visible,"audit-draft-content-id":t.auditDraftContent.auditDraftContentId},on:{closeModal:function(e){t.uploadModal.visible=!1},reloadDraft:function(){return t.getDraftContent(t.auditDraftContent.auditDraftContentId)}}})],1):t._e()}),[],!1,null,"455c562a",null).exports),xo=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-6"},[e("img",{staticClass:"result__img",attrs:{src:a("51bc"),alt:""}})])}];let jo=class extends et.d{backHome(){this.$router.push("/index")}};jo=Object(J.a)([Object(et.a)({})],jo);var To=jo,Lo=(a("7a7e"),Object(st.a)(To,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"result__row row"},[t._m(0),a("div",{staticClass:"result__content col-6"},[a("p",{staticClass:"result__title"},[t._v(" 已結束查核！ ")]),a("p",{staticClass:"result__text"}),a("button",{staticClass:"btn--backhome",on:{click:t.backHome}},[t._v(" 回首頁 ")])])])])}),xo,!1,null,"07925e6b",null).exports);let Po=class extends et.d{};Po=Object(J.a)([Object(et.a)({})],Po);var Ro=Po,Eo=Object(st.a)(Ro,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"backPageGroup",attrs:{id:"fubon-backStagePage"}},[e("router-view")],1)}),[],!1,null,"17b9c3fa",null).exports;const $o=Object(tt.c)("modalControl");let Fo=class extends et.d{constructor(){super(...arguments),this.h=this.$createElement,this.statusOptions=[{value:"*",label:"全部"},{value:"pass",label:"同意"},{value:"reject",label:"退回"}],this.dateFormatter=this.$twDateFormatter,this.form={applyDate:null,approveStatus:"*",domainId:null,name:null},this.formRules={applyDate:[{required:!0,message:"請選擇申請日期",trigger:"change"},{trigger:"change",validator:this.appltDateValidator}],domainId:[{pattern:/^[a-zA-Z0-9]*$/,message:"只能填入英文、數字",trigger:"change"}]},this.grid={rowKey:"id",data:null,pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","15","25"],showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{title:"AD帳號",dataIndex:"domainId",key:"domainId",width:90},{title:"姓名",dataIndex:"name",key:"name",width:100},{title:"申請人員",dataIndex:"applyUser",key:"applyUser",width:100},{title:"申請日期",dataIndex:"applyDatetime",key:"applyDatetime",width:120},{title:"覆核人員",dataIndex:"approveUser",key:"approveUser",width:100},{title:"覆核日期",dataIndex:"approveDatetime",key:"approveDatetime",width:120},{title:"覆核狀態",dataIndex:"approveStatus",key:"approveStatus",width:100},{title:"退回原因",dataIndex:"remark",key:"remark",width:130,customRender:t=>null===t?"- -":t}]},this.innerGrid={rowKey:"id",data:[],pagination:{current:1,pageSize:100,total:0},columns:[{title:"角色名稱",dataIndex:"roleUnit",key:"roleUnit",customRender:t=>this.h("div",null==t?void 0:t.join("、"))}]}}onVisibleChanged(t){if(t)return this.clearForm()}appltDateValidator(t,e,a){if(!e)return a("請選擇申請日期");if(null!=e&&e[0]&&null!=e&&e[1]){const t=e[0].getTime();return(e[1].getTime()-t)/864e5>365?a("申請日期區間，最多以1年為限，請重新選擇區間"):a()}return a("請選擇申請日期")}downloadList(){var t,e;this.setLoading(!0);const a={name:this.form.name,startDatetime:null!==(t=this.form.applyDate)&&void 0!==t&&t[0]?ya()(this.form.applyDate[0]).format("YYYY-MM-DD"):null,endDatetime:null!==(e=this.form.applyDate)&&void 0!==e&&e[1]?ya()(this.form.applyDate[1]).format("YYYY-MM-DD"):null,domainId:this.form.domainId,approveStatus:this.form.approveStatus};this.$accountApi.downloadListLogInAccountUsingPOST(a,{responseType:"blob"}).then(t=>{this.$blobUtils.download(t.data,`使用者維護歷史異動紀錄_${ya()().format("YYYYMMDD_hhmmss")}.xlsx`)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"下載使用者維護歷史異動紀錄失敗"}})}).finally(()=>{this.setLoading(!1)})}onSearch(){this.$refs.ruleForm.validate(t=>{if(!t)return!1;this.grid.pagination.current=1,this.searchUserHistory()})}onClose(){this.visibleSync=!1,this.grid.pagination.current=1,this.grid.pagination.pageSize=10}clearForm(){var t;this.form={applyDate:null,approveStatus:"*",domainId:null,name:null},this.setDefaultApplyDate(),this.grid.data=null,this.innerGrid.data=[],null===(t=this.$refs.ruleForm)||void 0===t||t.resetFields()}searchUserHistory(){var t,e;this.setLoading(!0),this.form.applyDate;const a={name:this.form.name,startDatetime:null!==(t=this.form.applyDate)&&void 0!==t&&t[0]?ya()(this.form.applyDate[0]).format("YYYY-MM-DD"):null,endDatetime:null!==(e=this.form.applyDate)&&void 0!==e&&e[1]?ya()(this.form.applyDate[1]).format("YYYY-MM-DD"):null,domainId:this.form.domainId,approveStatus:this.form.approveStatus,pageIndex:this.grid.pagination.current-1,pageSize:this.grid.pagination.pageSize};this.$accountApi.searchListLogInAccountUsingPOST(a).then(t=>{this.grid.pagination.total=parseInt(t.data.totalElements),this.grid.data=t.data.content.map(t=>({...t,id:mt.a.v4()})),this.grid.data.forEach(t=>{this.innerGrid.data[t.id]=[{roleUnit:t.roleUnit,id:t.id}]})}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查詢歷史異動紀錄失敗"}})}).finally(()=>{this.setLoading(!1)})}onPageChange(t){this.grid.pagination.current=t.current,this.grid.pagination.pageSize=t.pageSize,this.searchUserHistory()}setDefaultApplyDate(){const t=new Date,e=new Date;e.setDate(t.getDate()+1),this.form.applyDate=[t,e]}};Object(J.a)([Object(tt.a)("setLoading")],Fo.prototype,"setLoading",void 0),Object(J.a)([$o.Action("setModalState")],Fo.prototype,"setModalState",void 0),Object(J.a)([Object(et.c)("visible")],Fo.prototype,"visibleSync",void 0),Object(J.a)([Object(et.e)("visible")],Fo.prototype,"onVisibleChanged",null),Fo=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut}})],Fo);var Uo=Fo,Go=(a("9e40"),Object(st.a)(Uo,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{staticClass:"common__modal fubon-backStage_modal",attrs:{"mask-closable":!1,width:"90%",footer:null,"after-close":t.onClose},model:{value:t.visibleSync,callback:function(e){t.visibleSync=e},expression:"visibleSync"}},[a("div",{staticClass:"event__block"},[a("div",{staticClass:"page__title m-0"},[t._v(" 歷史異動紀錄 ")])]),a("div",{staticClass:"userMaintain__wrap"},[a("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.formRules,layout:"vertical"}},[a("div",{staticClass:"userMaintain__block bg__light"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 申請日期 ")]),a("div",{staticClass:"mark-required"},[t._v(" * ")])]),a("a-form-model-item",{attrs:{prop:"applyDate"}},[a("date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",range:!0,formatter:t.dateFormatter,placeholder:"e.g. 111/01/01~111/02/01"},model:{value:t.form.applyDate,callback:function(e){t.$set(t.form,"applyDate",e)},expression:"form.applyDate"}})],1)],1),a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 覆核狀態 ")])]),a("a-form-model-item",{attrs:{prop:"approveStatus"}},[a("a-radio-group",{staticClass:"row",model:{value:t.form.approveStatus,callback:function(e){t.$set(t.form,"approveStatus",e)},expression:"form.approveStatus"}},t._l(t.statusOptions,(function(e){return a("div",{key:e.value,staticClass:"col-12 col-md"},[a("a-radio",{staticClass:"query__wrap mb-2",attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])],1)})),0)],1)],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" AD帳號 ")])]),a("a-form-model-item",{attrs:{prop:"domainId"}},[a("a-input",{attrs:{placeholder:"e.g. A1234"},model:{value:t.form.domainId,callback:function(e){t.$set(t.form,"domainId",e)},expression:"form.domainId"}})],1)],1),a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 姓名 ")])]),a("a-form-model-item",{attrs:{prop:"name"}},[a("a-input",{attrs:{vue:"true",alt:"webfont",placeholder:"e.g. 林曉春"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)]),a("div",{staticClass:"btn__wrap text-center"},[a("button",{staticClass:"btn__radius--primary--outline me-1",on:{click:t.onClose}},[t._v(" 取消 ")]),a("button",{staticClass:"btn__radius--primary ms-1",on:{click:t.onSearch}},[t._v(" 查詢 ")])])])])],1),t.grid.data?a("div",{staticClass:"content__wrap"},[a("div",{staticClass:"content__title d-flex justify-content-between align-items-center"},[t._v(" 查詢結果 "),t.grid.data&&t.grid.data.length>0?a("IconTextButton",{staticClass:"me-2",attrs:{text:"下載",type:"download"},on:{click:t.downloadList}}):t._e()],1)]):t._e(),t.grid.data?a("div",{staticClass:"table__wrap"},[a("a-table",{attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,"data-source":t.grid.data,pagination:t.grid.pagination},on:{change:function(e){return t.onPageChange(e)}},scopedSlots:t._u([{key:"expandedRowRender",fn:function(e){return a("a-table",{attrs:{"row-key":t.innerGrid.rowKey,columns:t.innerGrid.columns,"data-source":t.innerGrid.data[e.id],pagination:!1}})}}],null,!1,2587651692)})],1):t._e(),a("div",{staticClass:"btn__wrap d-flex justify-content-center"},[a("button",{staticClass:"btn__radius--primary",on:{click:t.onClose}},[t._v(" 返回 ")])])])}),[],!1,null,"350c64aa",null).exports);let Yo=class extends et.d{constructor(){super(...arguments),this.rejectModalVisible=!1,this.form={gridData:null},this.grid={rowKey:"domainId",data:[],pagination:{current:1,pageSize:100,total:0},columns:[{type:Re.PLAIN,property:"domainId",title:"AD帳號"},{type:Re.PLAIN,property:"name",title:"使用者姓名"},{type:Re.PLAIN,property:"roles",title:"角色名稱",formatter:t=>{var e;return t.roleUnit?null===(e=t.roleUnit)||void 0===e?void 0:e.join("、"):""},width:"40%"},{type:Re.TEMPLATE,property:"remark",title:"退回原因",width:450,template:"remark"}]}}onSelectedUserChanged(t){t&&this.setGridData(t)}onVisibleChanged(t){t&&(this.rejectModalVisible=!0)}setGridData(t){this.form.gridData=this.selectedUser.map(t=>({...t,remark:""}))}onReject(){this.$refs.form.validate(t=>{if(!t)return!1;this.sendReject()})}sendReject(){this.setLoading(!0);const t=this.form.gridData.map(t=>({accountId:t.accountId,logId:t.logId,remark:t.remark}));this.$accountApi.rejectReviewListInAccountUsingPOST(t).then(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountResult",params:{type:"reject"},query:{result:"success"}})}).catch(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountResult",params:{type:"reject"},query:{result:"fail",msg:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}onClose(){this.visibleSync=!1}};Object(J.a)([Object(tt.a)("setLoading")],Yo.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("visible")],Yo.prototype,"visibleSync",void 0),Object(J.a)([Object(et.b)()],Yo.prototype,"selectedUser",void 0),Object(J.a)([Object(et.e)("selectedUser")],Yo.prototype,"onSelectedUserChanged",null),Object(J.a)([Object(et.e)("visible")],Yo.prototype,"onVisibleChanged",null),Yo=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt}})],Yo);var No=Yo,Vo=(a("5b64"),Object(st.a)(No,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{staticClass:"common__modal fubon-backStage_modal",attrs:{"mask-closable":!1,width:"90%",footer:null,"after-close":t.onClose,"z-index":1e4},model:{value:t.visibleSync,callback:function(e){t.visibleSync=e},expression:"visibleSync"}},[a("div",{staticClass:"event__block"},[a("div",{staticClass:"page__title m-0"},[t._v(" 填寫退回原因 ")])]),a("div",{staticClass:"table__wrap"},[a("a-form-model",{ref:"form",attrs:{model:t.form}},[a("fbl-data-grid",{staticClass:"query__table",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,data:t.form.gridData,pagination:!1},scopedSlots:t._u([{key:"remark",fn:function(e){return[a("a-form-model-item",{attrs:{prop:"gridData."+e.index+".remark",rules:{required:!0,message:"請填寫退回原因"}}},[a("a-textarea",{model:{value:e.data.remark,callback:function(a){t.$set(e.data,"remark",a)},expression:"slotProp.data.remark"}})],1)]}}])})],1)],1),a("div",{staticClass:"btn__wrap d-flex justify-content-center"},[a("button",{staticClass:"btn__radius--primary--outline me-1",on:{click:t.onClose}},[t._v(" 取消 ")]),a("button",{staticClass:"btn__radius--primary ms-1",on:{click:t.onReject}},[t._v(" 確定 ")])])])],1)}),[],!1,null,"61ac13bb",null).exports);const qo=Object(tt.c)("modalControl");let Bo=class extends et.d{constructor(){super(...arguments),this.h=this.$createElement,this.modalVisible=!1,this.accountBackModalVisible=!1,this.grid={rowKey:"domainId",data:[],pagination:{current:1,pageSize:100,total:0},columns:[{type:Re.PLAIN,property:"domainId",title:"AD帳號"},{type:Re.PLAIN,property:"name",title:"姓名",width:"80px"},{type:Re.PLAIN,property:"accountUnit",title:"使用者單位"},{type:Re.PLAIN,property:"roleUnit",title:"角色名稱",formatter:t=>{var e;return t.roleUnit?null===(e=t.roleUnit)||void 0===e?void 0:e.join("、"):""},width:"40%"},{type:Re.PLAIN,property:"applyUser",title:"申請人",width:"80px"},{type:Re.PLAIN,property:"applyDatetime",title:"申請日期"}]},this.selectedRowAll=[],this.selectedRowKeys=[]}get rowSelection(){const{selectedRowKeys:t}=this;return{selectedRowKeys:t,onChange:(t,e)=>{this.selectedRowKeys=t,this.selectedRowAll=e},getCheckboxProps:t=>({props:{disabled:null===t.name,name:t.name}})}}onVisibleChanged(t){t&&this.getReviewList()}created(){this.visibleSync&&this.getReviewList()}getReviewList(){this.setLoading(!0),this.$accountApi.searchReviewListInAccountUsingPOST().then(t=>{this.grid.data=t.data.result}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查詢歷史異動紀錄失敗"}})}).finally(()=>{this.setLoading(!1)})}clearCheck(){this.selectedRowAll=[],this.selectedRowKeys=[]}onBack(){this.accountBackModalVisible=!0}onConfirm(){this.setLoading(!0);const t=this.selectedRowAll.map(t=>({accountId:t.accountId,logId:t.logId}));this.$accountApi.passReviewListInAccountUsingPOST(t).then(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountResult",params:{type:"pass"},query:{result:"success"}})}).catch(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountResult",params:{type:"pass"},query:{result:"fail",msg:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}onClose(){this.clearCheck(),this.visibleSync=!1}};Object(J.a)([Object(tt.a)("setLoading")],Bo.prototype,"setLoading",void 0),Object(J.a)([qo.Action("setModalState")],Bo.prototype,"setModalState",void 0),Object(J.a)([Object(et.c)("visible")],Bo.prototype,"visibleSync",void 0),Object(J.a)([Object(et.e)("visibleSync")],Bo.prototype,"onVisibleChanged",null),Bo=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,AccountBackModal:Vo}})],Bo);var zo=Bo,Ho=(a("2b6d"),Object(st.a)(zo,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{staticClass:"common__modal fubon-backStage_modal",attrs:{"mask-closable":!1,width:"90%",footer:null,"after-close":t.onClose},model:{value:t.visibleSync,callback:function(e){t.visibleSync=e},expression:"visibleSync"}},[a("div",{staticClass:"event__block"},[a("div",{staticClass:"page__title m-0"},[t._v(" 待覆核名單 ")])]),a("div",{staticClass:"table__wrap"},[a("fbl-data-grid",{staticClass:"query__table",attrs:{"row-key":t.grid.rowKey,columns:t.grid.columns,"row-selection":t.rowSelection,data:t.grid.data,pagination:!1,scroll:{x:!0}}})],1),a("div",{staticClass:"btn__wrap d-flex justify-content-center"},[a("button",{staticClass:"btn__radius--primary--outline me-1",on:{click:t.onClose}},[t._v(" 取消 ")]),a("button",{staticClass:"btn__radius--primary--outline me-1 ms-1",attrs:{disabled:0===t.selectedRowAll.length},on:{click:t.onBack}},[t._v(" 退回 ")]),a("button",{staticClass:"btn__radius--primary ms-1",attrs:{disabled:0===t.selectedRowAll.length},on:{click:t.onConfirm}},[t._v(" 同意 ")])])]),a("AccountBackModal",{attrs:{visible:t.accountBackModalVisible,"selected-user":t.selectedRowAll},on:{"update:visible":function(e){t.accountBackModalVisible=e},closeAccountBackModal:function(e){t.accountBackModalVisible=!1}}})],1)}),[],!1,null,"3fcab46e",null).exports);let Qo=class extends et.d{constructor(){super(...arguments),this.h=this.$createElement,this.roleOptions=null,this.form={name:null,domainId:null,accountUnit:null,roleUnit:null,enabled:null},this.formRules={name:[{required:!0,message:"姓名不可為空"}],domainId:[{required:!0,message:"AD帳號不可為空"}],accountUnit:[{required:!0,message:"使用者單位不可為空"}],roleUnit:[{validator:this.roleUnitValidator}],enabled:[{required:!0,message:"帳號狀態不可為空"}]}}roleUnitValidator(t,e,a){var i;const s=null==e?void 0:e.some(t=>t.includes("ROLE_Auditor:")),o=null==e?void 0:e.some(t=>t.includes("ROLE_Auditor_Practice:"));if(s&&o)return a("查核人員的實習與非實習身份不能同時存在");const n=null===(i=[{role:"ROLE_Audit_Team_Head",roleName:"組長"},{role:"ROLE_Auditor_Practice",roleName:"(實習)查核人員"},{role:"ROLE_Auditor",roleName:"查核人員"}].filter(t=>this.checkTeamRepeat(e,t.role)))||void 0===i?void 0:i.map(t=>`「${t.roleName}」`).join("、");0!==n.length&&a(`請確認${n}角色是否選擇「無組別」同時也選擇其他的組別`),a()}checkTeamRepeat(t,e){return!!(t.includes(e+":*")&&t.filter(t=>t.includes(e+":")).length>1)}get agentList(){var t,e;return null===(t=this.editData)||void 0===t||null===(e=t.agentRoleUnit)||void 0===e?void 0:e.join("\n")}initData(){this.getRoleList(),this.editData&&(this.form.name=this.editData.name,this.form.domainId=this.editData.domainId,this.form.accountUnit=this.editData.accountUnit,this.form.enabled=this.editData.enabled,this.form.roleUnit=[],this.editData.roleUnit.forEach(t=>{t.selected&&this.form.roleUnit.push(t.value)}))}onSubmit(){this.$refs.ruleForm.validate(t=>{if(!t)return!1;this.applyForm()})}getRoleList(){this.setLoading(!0),this.$accountApi.searchRoleAndUnitListInAccountUsingPOST().then(t=>{this.roleOptions=t.data}).catch(console.error).finally(()=>{this.setLoading(!1)})}applyForm(){this.setLoading(!0);const t={accountId:this.editData.accountId,domainId:this.editData.domainId,empNo:this.editData.empNo,roleUnit:this.form.roleUnit,enabled:this.form.enabled};this.$accountApi.modifyInAccountUsingPOST(t).then(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountResult",params:{type:"edit"},query:{result:"success"}})}).catch(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountResult",params:{type:"edit"},query:{result:"fail",msg:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}onClose(){this.visibleSync=!1}watchVisible(t){t&&this.initData()}};Object(J.a)([Object(tt.a)("setLoading")],Qo.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],Qo.prototype,"editData",void 0),Object(J.a)([Object(et.b)()],Qo.prototype,"deptOptions",void 0),Object(J.a)([Object(et.c)("visible")],Qo.prototype,"visibleSync",void 0),Object(J.a)([Object(et.e)("visible")],Qo.prototype,"watchVisible",null),Qo=Object(J.a)([Object(et.a)({})],Qo);var Wo=Qo,Ko=(a("41e7"),a("e75c"),Object(st.a)(Wo,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{staticClass:"common__modal fubon-backStage_modal",attrs:{"mask-closable":!1,width:"90%",footer:null,"after-close":t.onClose},model:{value:t.visibleSync,callback:function(e){t.visibleSync=e},expression:"visibleSync"}},[a("div",{staticClass:"event__block"},[a("div",{staticClass:"page__title m-0"},[t._v(" "+t._s(t.editData?"編輯使用者":"新增")+" ")])]),a("div",{staticClass:"userMaintain__wrap"},[a("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.formRules,layout:"vertical"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("a-form-model-item",{attrs:{prop:"name",label:"姓名"}},[a("a-input",{attrs:{vue:"true",alt:"webfont",disabled:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),a("div",{staticClass:"col-sm-6"},[a("a-form-model-item",{attrs:{prop:"domainId",label:"AD帳號"}},[a("a-input",{attrs:{disabled:""},model:{value:t.form.domainId,callback:function(e){t.$set(t.form,"domainId",e)},expression:"form.domainId"}})],1)],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("a-form-model-item",{attrs:{prop:"accountUnit",label:"使用者單位"}},[a("a-select",{staticStyle:{color:"#636363"},attrs:{options:t.deptOptions,disabled:""},model:{value:t.form.accountUnit,callback:function(e){t.$set(t.form,"accountUnit",e)},expression:"form.accountUnit"}})],1)],1),a("div",{staticClass:"col-sm-6"},[a("a-form-model-item",{attrs:{prop:"roleUnit",label:"角色名稱"}},[a("a-select",{staticClass:"w-100",attrs:{mode:"multiple","filter-option":t.$global.filterOption,"dropdown-match-select-width":!1},model:{value:t.form.roleUnit,callback:function(e){t.$set(t.form,"roleUnit",e)},expression:"form.roleUnit"}},t._l(t.roleOptions,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("a-form-model-item",{attrs:{prop:"agent",label:"目前協助代理的角色職務"}},[a("a-textarea",{attrs:{"auto-size":{maxRows:10},disabled:!0},model:{value:t.agentList,callback:function(e){t.agentList=e},expression:"agentList"}})],1)],1),a("div",{staticClass:"col-sm-6"},[a("a-form-model-item",{attrs:{prop:"enabled",label:"帳號狀態"}},[a("a-radio-group",{staticClass:"row",model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}},[a("div",{staticClass:"col-12 col-md d-flex mt-2"},[a("a-radio",{staticClass:"mb-2",attrs:{value:!0}},[t._v(" 生效 ")]),a("a-radio",{staticClass:"mb-2",attrs:{value:!1}},[t._v(" 停用 ")])],1)])],1)],1)]),a("div",{staticClass:"btn__wrap text-center mb-1"},[a("button",{staticClass:"btn__radius--primary--outline mx-1 mb-3",on:{click:t.onClose}},[t._v(" 取消 ")]),a("button",{staticClass:"btn__radius--primary mx-1 mb-3",on:{click:t.onSubmit}},[t._v(" 送出覆核 ")])])])],1)])],1)}),[],!1,null,"1de5b6ec",null).exports);class Jo{static transformRocDate(t){const e=t.split(/\D/g);return`${Number.parseInt(e[0])-1911}/${e[1]}/${0===e[2].length?"**":e[2]}`}static transformDate(t){const e=t.split(/\D/g);return`${Number.parseInt(e[0])+1911}/${e[1]}/${0===e[2].length?"**":e[2]}`}static transformMinguoDateTime(t){const e=t.split(/\D/g);return`${Number.parseInt(e[0])+1911}/${e[1]}/${0===e[2].length?"**":e[2]} ${Number.parseInt(e[3]?e[3]:"00")}:${e[4]?e[4]:"00"}:${e[5]?e[5]:"00"}`}static filterRangeDate(t){const e=[...t],a=[];return e[0]||e[1]?(a[0]=ya()(e[0]).format("YYYY-MM-DDTHH:mm:ss.sssZ"),a[1]=ya()(e[1].setHours(23,59,59)).format("YYYY-MM-DDTHH:mm:ss.999Z"),a):null}static formatStringDateDault(t){return ya()(t).format("YYYY-MM-DDTHH:mm:ss.SSS")+"Z"}static formatStringHourAndMinute(t){return ya()(t).format("HH:mm")}static isValidDate(t){return ya()(t).isValid()?new Date(t):t}}const Zo=Object(tt.c)("modalControl");let Xo=class extends et.d{constructor(){super(...arguments),this.reviewModalVisible=!1,this.historyModalVisible=!1,this.form={name:null,domainId:null,department:null},this.formRules={department:[{required:!0,message:"請選擇使用者單位",trigger:"change"}],domainId:[{pattern:/^[a-zA-Z0-9]*$/,message:"只能填入英文、數字",trigger:"change"}]},this.deptOptions=null,this.accountEditModal={visible:!1},this.historyModal={visible:!1},this.reviewModal={visible:!1},this.editData=null,this.gridData={rowKey:"empNo",data:null,pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","15","25"],showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{type:Re.PLAIN,property:"name",title:"員工姓名",fixed:"left"},{type:Re.PLAIN,property:"domainId",title:"AD帳號"},{type:Re.PLAIN,property:"accountUnit",title:"使用者單位",width:"150px"},{type:Re.TEMPLATE,template:"roleUnit",title:"角色名稱",width:"300px"},{type:Re.PLAIN,property:"applyUser",title:"申請人員"},{type:Re.PLAIN,property:"applyDatetime",title:"申請日期"},{type:Re.PLAIN,property:"approveUser",title:"覆核人員"},{type:Re.PLAIN,property:"approveDatetime",title:"覆核日期"},{type:Re.PLAIN,property:"approveStatus",title:"覆核結果"},{type:Re.PLAIN,property:"remark",title:"退回原因",width:"150px"},{type:Re.PLAIN,property:"enabled",title:"帳號狀態"},{type:Re.TEMPLATE,title:"",template:"edit",fixed:"right"}]}}checkShowEdit(t){return!Jo.isValidDate(t)||Jo.isValidDate(t)<new Date}watchRouterParamsType(t){"todo"===t&&(this.reviewModal.visible=!0)}get departmentId(){const t=this.deptOptions.find(t=>t.value===this.form.department);return t?{value:null==t?void 0:t.value,whichDB:null==t?void 0:t.whichDB}:null}created(){this.getDeptList(),this.form.department=this.$user.getMe().employee.departmentId}getDeptList(){this.setLoading(!0),this.$accountApi.searchDeptListInAccountUsingPOST().then(t=>{this.deptOptions=t.data}).catch(console.error).finally(()=>{this.setLoading(!1)})}getAccountList(){this.setLoading(!0);const t={departmentId:this.departmentId,name:this.form.name,domainId:this.form.domainId,pageIndex:this.gridData.pagination.current-1,pageSize:this.gridData.pagination.pageSize};this.$accountApi.searchListInAccountUsingPOST(t).then(t=>{this.gridData.data=t.data.content,this.gridData.pagination.total=parseInt(t.data.totalElements)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查詢使用者維護失敗"}})}).finally(()=>{this.setLoading(!1)})}async getAccountDetail(t){this.setLoading(!0),await this.$accountApi.searchInAccountUsingPOST(t).then(t=>{this.editData=t.data}).catch(console.error).finally(()=>{this.setLoading(!1)})}downloadList(){this.setLoading(!0);const t={departmentId:this.departmentId,name:this.form.name,domainId:this.form.domainId};this.$accountApi.downloadListInAccountUsingPOST(t,{responseType:"blob"}).then(t=>{this.$blobUtils.download(t.data,`使用者維護查詢結果_${ya()().format("YYYYMMDD_hhmmss")}.xlsx`)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"下載使用者維護查詢結果失敗"}})}).finally(()=>{this.setLoading(!1)})}async onPageChange(t){this.gridData.pagination.current=t.pagination.current,this.gridData.pagination.pageSize=t.pagination.pageSize,this.getAccountList()}onReset(){this.form={name:null,domainId:null,department:null},this.gridData.pagination.current=1,this.gridData.pagination.pageSize=10}onSearch(){this.$refs.ruleForm.validate(t=>{if(!t)return!1;this.gridData.pagination.current=1,this.getAccountList()})}async openEditModal(t){await this.getAccountDetail({accountId:t.accountId,domainId:t.domainId,empNo:t.empNo,whichDB:t.whichDB}),this.accountEditModal.visible=!0}};Object(J.a)([Object(tt.a)("setLoading")],Xo.prototype,"setLoading",void 0),Object(J.a)([Zo.Action("setModalState")],Xo.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("$route.params.type",{immediate:!0})],Xo.prototype,"watchRouterParamsType",null),Xo=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,ReviewModal:Ho,HistoryModal:Go,IconTextButton:Ut,AccountEditModal:Ko}})],Xo);var tn=Xo,en=(a("4fc7"),Object(st.a)(tn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"d-flex justify-content-between align-items-center"},[a("div",{staticClass:"page__title"},[t._v(" 使用者維護 ")]),a("div",{staticClass:"d-flex align-items-center"},[a("IconTextButton",{staticClass:"me-3",attrs:{text:"歷史異動紀錄",type:"record"},on:{click:function(e){t.historyModal.visible=!0}}}),a("IconTextButton",{staticClass:"me-3",attrs:{text:"待覆核名單",type:"list"},on:{click:function(e){t.reviewModal.visible=!0}}})],1)]),a("div",{staticClass:"userMaintain__wrap"},[a("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.formRules,layout:"vertical"}},[a("div",{staticClass:"userMaintain__block bg__light"},[a("div",{staticClass:"userMaintain__block__title"},[t._v(" 使用者查詢 ")]),a("div",{staticClass:"row"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 姓名 ")])]),a("a-form-model-item",{attrs:{prop:"name"}},[a("a-input",{attrs:{vue:"true",alt:"webfont",placeholder:"e.g. 林曉春"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" AD帳號 ")])]),a("a-form-model-item",{attrs:{prop:"domainId"}},[a("a-input",{attrs:{placeholder:"e.g. A1234"},model:{value:t.form.domainId,callback:function(e){t.$set(t.form,"domainId",e)},expression:"form.domainId"}})],1)],1),a("div",{staticClass:"col-sm"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 使用者單位 ")]),a("div",{staticClass:"mark-required"},[t._v(" * ")])]),a("a-form-model-item",{attrs:{prop:"department"}},[a("a-select",{attrs:{"allow-clear":!0,"filter-option":t.$global.filterOption,"show-search":!0},model:{value:t.form.department,callback:function(e){t.$set(t.form,"department",e)},expression:"form.department"}},t._l(t.deptOptions,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1)])])]),a("div",{staticClass:"btn__wrap text-center"},[a("button",{staticClass:"btn__radius--primary--outline me-1",on:{click:t.onReset}},[t._v(" 重設 ")]),a("button",{staticClass:"btn__radius--primary",on:{click:t.onSearch}},[t._v(" 查詢 ")])]),t.gridData.data?a("div",{staticClass:"result__block"},[a("div",{staticClass:"result__block__header d-flex justify-content-between"},[a("div",{staticClass:"result__block__title ms-2"},[t._v(" 使用者維護查詢結果 ")]),a("div",[t.gridData.data&&t.gridData.data.length>0?a("IconTextButton",{staticClass:"me-2",attrs:{text:"下載",type:"download"},on:{click:t.downloadList}}):t._e()],1)]),a("div",{staticClass:"table"},[a("FblDataGrid",{attrs:{"row-key":t.gridData.rowKey,columns:t.gridData.columns,data:t.gridData.data,pagination:t.gridData.pagination,"empty-data":t.gridData.data.length<=0,scroll:{x:!0}},on:{tableChange:function(e){return t.onPageChange(e)}},scopedSlots:t._u([{key:"roleUnit",fn:function(e){return[a("div",[t._v(t._s(e.data.roleUnit&&e.data.roleUnit.join("、")))])]}},{key:"edit",fn:function(e){return[a("div",{staticClass:"d-flex justify-content-center edit__block",class:{disabled__block:!e.data.editable}},[a("button",{staticClass:"d-flex justify-content-center align-items-center iconblock",attrs:{disabled:!e.data.editable},on:{click:function(a){return t.openEditModal(e.data)}}},[a("a-icon",{attrs:{type:"edit"}})],1)])]}}],null,!1,1334547460)})],1)]):t._e()],1),a("ReviewModal",{attrs:{visible:t.reviewModal.visible},on:{"update:visible":function(e){return t.$set(t.reviewModal,"visible",e)}}}),a("HistoryModal",{attrs:{visible:t.historyModal.visible},on:{"update:visible":function(e){return t.$set(t.historyModal,"visible",e)}}}),a("AccountEditModal",{attrs:{visible:t.accountEditModal.visible,"edit-data":t.editData,"dept-options":t.deptOptions},on:{"update:visible":function(e){return t.$set(t.accountEditModal,"visible",e)}}})],1)}),[],!1,null,"e2ada34c",null).exports);let an=class extends et.d{constructor(){super(...arguments),this.breadcrumb=[]}onRouteChanged(t){const e=t.params.type;this.breadcrumb=t.params.type&&t.meta.breadcrumb[e]?t.meta.breadcrumb[e]:t.meta.breadcrumb}};Object(J.a)([Object(et.e)("$route",{immediate:!0,deep:!0})],an.prototype,"onRouteChanged",null),an=Object(J.a)([Object(et.a)({})],an);var sn=an,on=(a("33d1"),Object(st.a)(sn,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.breadcrumb&&t.breadcrumb.length>0?i("div",{staticClass:"breadcrumb container"},[i("img",{staticClass:"breadcrumb__img",attrs:{src:a("a3cf"),alt:""}}),i("div",{staticClass:"breadcrumb__title"},[t._v(" "+t._s(t.breadcrumb[0])+" ")]),t.breadcrumb.length>1?t._l(t.breadcrumb.slice(1),(function(e){return i("div",{key:e,staticClass:"breadcrumb__item"},[i("a-icon",{staticClass:"breadcrumb__item__img",attrs:{type:"right"}}),t._v(" "+t._s(e)+" ")],1)})):t._e()],2):t._e()}),[],!1,null,"3a264eca",null).exports);let nn=class extends et.d{};Object(J.a)([Object(et.b)()],nn.prototype,"breadcrumb",void 0),Object(J.a)([Object(et.b)()],nn.prototype,"resultTitle",void 0),Object(J.a)([Object(et.b)()],nn.prototype,"pageTitle",void 0),Object(J.a)([Object(et.b)()],nn.prototype,"resultType",void 0),nn=Object(J.a)([Object(et.a)({components:{Breadcrumb:on}})],nn);var rn=nn,ln=(a("6f87"),Object(st.a)(rn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"result__wrap"},[a("div",{staticClass:"result__header"},[a("h1",{staticClass:"result__title"},[t._v(" "+t._s(t.pageTitle)+" ")])]),a("div",{staticClass:"result__body"},[a("div",{class:"success"===t.resultType?"success__title":"error__title"},[t._v(" "+t._s(t.resultTitle)+" ")]),t._t("body")],2),a("div",{staticClass:"result__footer text-center"},[t._t("buttons")],2)])])}),[],!1,null,"381406cc",null).exports);let cn=class extends et.d{constructor(){super(...arguments),this.result=null,this.msg=null,this.type="覆核",this.subType="同意"}setParam(){const t=this.$global.getQuery();t&&(this.result=t.result,this.msg=t.msg)}changeStr(){switch(this.$route.params.type){case"pass":this.type="覆核",this.subType="覆核同意";break;case"reject":this.type="退回",this.subType="覆核退回";break;case"edit":this.type="編輯",this.subType="編輯"}}get successStr(){return"edit"===this.$route.params.type?`您已成功${this.type}使用者，並已發送通知給相關人員執行覆核作業，謝謝。`:`您欲${this.subType}的項目已處理成功，謝謝。`}goback(){this.$router.push({name:"AccountIndex"})}created(){this.setParam(),this.changeStr()}};cn=Object(J.a)([Object(et.a)({components:{Result:ln}})],cn);var dn=cn,un=(a("04cc"),Object(st.a)(dn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Result",{attrs:{"page-title":"執行結果","result-title":"success"===t.result?t.type+"成功":t.type+"失敗","result-type":t.result},scopedSlots:t._u([{key:"body",fn:function(){return["success"===t.result?a("div",[t._v(" 親愛的同仁您好， "),a("br"),t._v(" "+t._s(t.successStr)+" ")]):a("div",[t._v(" 親愛的同仁您好， "),a("br"),t._v(" 您欲"+t._s(t.type)+"項目，因"+t._s(t.msg)+"因素無法進行。 "),a("br"),t._v(" 如尚需執行，請您再次嘗試。或與相關服務人員聯繫，謝謝您！ ")])]},proxy:!0},{key:"buttons",fn:function(){return[a("div",{staticClass:"btn__wrap"},[a("button",{staticClass:"btn__radius--primary me-1",attrs:{href:"#"},on:{click:t.goback}},[t._v(" 返回主頁 ")])])]},proxy:!0}])})],1)}),[],!1,null,"2d029a4c",null).exports);const pn=Object(tt.c)("modalControl");let mn=class extends et.d{constructor(){super(...arguments),this.initForm={sysCodeMainId:"",defaultTextInSysCodeMain:"",doubleCheck:!1,editableInSysCodeMain:!0,remarkInSysCodeMain:"",sysCodeDetailId:"",defaultTextInSysCodeDetail:"",sequenceInSysCodeDetail:void 0,enabledInDetail:!0,editableInSysCodeDetail:!0,remarkInSysCodeDetail:"",sysCodeGroupId:"",defaultTextInSysCodeGroup:"",sequenceInSysCodeGroup:void 0,enabledInGroup:!0,editableInSysCodeGroup:!0,remarkInSysCodeGroup:""},this.detailFileList=[],this.groupFileList=[],this.tmpAttachment={detail:{uid:"",attachmentId:"",fileName:""},group:{uid:"",attachmentId:"",fileName:""}},this.canType=[],this.form=null,this.mainDisabled=!1,this.detailDisabled=!0,this.groupDisabled=!0,this.detailAttachmentReadOnly=!1,this.groupAttachmentReadOnly=!1,this.formRules={sysCodeMainId:[{required:!0,validator:this.codeIdRule,trigger:"change"}],defaultTextInSysCodeMain:[{required:!0,message:"請輸入系統代碼的預設值",trigger:"change"}],doubleCheck:[{required:!0,message:"請選擇是否啟用",trigger:"change"}],editableInSysCodeMain:[{required:!0,message:"請選擇是否能修改預設值",trigger:"change"}],sysCodeDetailId:[{required:!1,validator:this.codeIdRule,trigger:"change"}],defaultTextInSysCodeDetail:[{required:""!=this.initForm.sysCodeDetailId,message:"請輸入系統代碼的預設值",trigger:"change"}],sequenceInSysCodeDetail:[{required:""!=this.initForm.sysCodeDetailId,message:"請輸入顯示順序",trigger:"change"}],enabledInDetail:[{required:""!=this.initForm.sysCodeDetailId,message:"請選擇是否啟用",trigger:"change"}],editableInSysCodeDetail:[{required:""!=this.initForm.sysCodeDetailId,message:"請選擇是能修改預設值",trigger:"change"}],sysCodeGroupId:[{required:!1,validator:this.codeIdRule,trigger:"change"}],defaultTextInSysCodeGroup:[{required:""!=this.initForm.sysCodeGroupId,message:"請輸入系統代碼的預設值",trigger:"change"}],sequenceInSysCodeGroup:[{required:""!=this.initForm.sysCodeGroupId,message:"請輸入顯示順序",trigger:"change"}],enabledInGroup:[{required:""!=this.initForm.sysCodeGroupId,message:"請選擇是否啟用",trigger:"change"}],editableInSysCodeGroup:[{required:""!=this.initForm.sysCodeGroupId,message:"請選擇是否能修改預設值",trigger:"change"}]}}watchVisible(){if(this.detailAttachmentReadOnly=!1,this.groupAttachmentReadOnly=!1,this.initTmpAttachment(),"edit"==this.type){if(this.form=this.$global.deepCopyData(this.initData),null!=this.form.remarkInSysCodeDetail&&this.form.remarkInSysCodeDetail.indexOf("attachmentId=")>-1){const t=this.convertAttachmentId(this.form.remarkInSysCodeDetail);this.tmpAttachment.detail.uid=t,this.tmpAttachment.detail.attachmentId=t,this.tmpAttachment.detail.fileName=this.form.defaultTextInSysCodeDetail,this.detailAttachmentReadOnly=!0}if(null!=this.form.remarkInSysCodeGroup&&this.form.remarkInSysCodeGroup.indexOf("attachmentId=")>-1){const t=this.convertAttachmentId(this.form.remarkInSysCodeGroup);this.tmpAttachment.group.uid=t,this.tmpAttachment.group.attachmentId=t,this.tmpAttachment.group.fileName=this.form.defaultTextInSysCodeGroup,this.groupAttachmentReadOnly=!0}}else"readonly"==this.type?this.initReadonly():this.form=this.$global.deepCopyData(this.initForm)}codeIdRule(t,e,a){t.required||""!=e&&null!=e?/^(?:[a-zA-Z]|_|\*|-|\d)*$/.test(e)&&""!=e&&null!=e?a():a("請輸入英數字或下底線或*或-"):a()}created(){this.form=this.$global.deepCopyData(this.initForm),this.getApi_authorizationFileType()}getApi_authorizationFileType(){this.$parameterApi.searchAllowedFileExtensionsInParameterUsingGET().then(t=>{this.canType=t.data.result})}initReadonly(){const t=this.$global.deepCopyData(this.initData),e=JSON.parse(t.jsonString);let a=null,i=null,s=null;e.sysCodeGroupId?(s=e,i=e.sysCodeDetail,a=i.sysCodeMain):e.sysCodeDetailId?(i=e,a=i.sysCodeMain):a=e,this.form={sysCodeMainId:a.sysCodeMainId,defaultTextInSysCodeMain:a.defaultText,doubleCheck:a.doubleCheck,editableInSysCodeMain:a.editable,remarkInSysCodeMain:a.remark,sysCodeDetailId:i?i.sysCodeDetailId:"",defaultTextInSysCodeDetail:i?i.defaultText:"",sequenceInSysCodeDetail:i?i.sequence:void 0,enabledInDetail:!i||i.enabled,editableInSysCodeDetail:!!i&&i.editable,remarkInSysCodeDetail:i?i.remark:"",sysCodeGroupId:s?s.sysCodeGroupId:"",defaultTextInSysCodeGroup:s?s.defaultText:"",sequenceInSysCodeGroup:s?s.sequence:void 0,enabledInGroup:!s||s.enabled,editableInSysCodeGroup:!!s&&s.editable,remarkInSysCodeGroup:s?s.remark:""},this.tmpAttachment.detail.uid=this.convertAttachmentId(this.form.remarkInSysCodeDetail),this.tmpAttachment.group.uid=this.convertAttachmentId(this.form.remarkInSysCodeGroup)}isUpdate(){return"edit"==this.type}isReadonly(){return this.type&&"readonly"==this.type}isDetailDownload(){return!(this.isReadonly()&&!this.disabledDetailHasUpload)&&(this.groupDisabled||this.disabledDetailHasUpload)}isGroupDownload(){return!(this.isReadonly()&&!this.disabledGroupHasUpload)&&(this.groupDisabled||this.disabledGroupHasUpload)}submit(){this.$refs.formRef.validate(t=>{t&&(this.setLoading(!0),this.type,this.isUpdate()?this.uploadAttachment().then(()=>{this.sendSubmit()}):this.sendSubmit())})}sendSubmit(){const t="edit"==this.type?"編輯":"新增";this.$parameterApi.createInParameterUsingPOST(this.form).then(e=>{e.data.success?(this.$emit("closeModal",this.form),this.setModalState({resultModal:{visible:!0,type:"success",title:t+"成功"}})):this.setModalState({resultModal:{visible:!0,type:"error",title:t+"失敗",content:e.data.message}})}).catch(e=>{this.setModalState({resultModal:{visible:!0,type:"error",title:t+"失敗",content:e.response.data.message}})}).finally(()=>{this.initTmpAttachment(),this.setLoading(!1)})}initTmpAttachment(){this.detailFileList=[],this.groupFileList=[],this.tmpAttachment={detail:{uid:"",attachmentId:"",fileName:""},group:{uid:"",attachmentId:"",fileName:""}}}initDetailAttachment(){this.form.defaultTextInSysCodeDetail="",this.form.remarkInSysCodeDetail="",this.tmpAttachment.detail.uid="",this.tmpAttachment.detail.attachmentId="",this.tmpAttachment.detail.fileName="",this.detailAttachmentReadOnly=!1,this.detailFileList=[]}initGroupAttachment(){this.form.defaultTextInSysCodeGroup="",this.form.remarkInSysCodeGroup="",this.tmpAttachment.group.uid="",this.tmpAttachment.group.attachmentId="",this.tmpAttachment.group.fileName="",this.groupAttachmentReadOnly=!1}get disabledDetailHasUpload(){return""==this.tmpAttachment.detail.uid}get disabledGroupHasUpload(){return""==this.tmpAttachment.group.uid}closeModal(){this.$emit("closeModal")}watchForm(){if("readonly"==this.type)return this.mainDisabled=!0,this.detailDisabled=!0,void(this.groupDisabled=!0);this.mainDisabled=!1,this.detailDisabled=!(this.form.sysCodeMainId&&this.form.defaultTextInSysCodeMain),this.groupDisabled=!(this.form.sysCodeDetailId&&this.form.defaultTextInSysCodeDetail),this.formRules.defaultTextInSysCodeDetail[0].required=!!this.form.sysCodeDetailId,this.formRules.sequenceInSysCodeDetail[0].required=!!this.form.sysCodeDetailId,this.formRules.enabledInDetail[0].required=!!this.form.sysCodeDetailId,this.formRules.editableInSysCodeDetail[0].required=!!this.form.sysCodeDetailId,this.formRules.defaultTextInSysCodeGroup[0].required=!!this.form.sysCodeGroupId,this.formRules.sequenceInSysCodeGroup[0].required=!!this.form.sysCodeGroupId,this.formRules.enabledInGroup[0].required=!!this.form.sysCodeGroupId,this.formRules.editableInSysCodeGroup[0].required=!!this.form.sysCodeGroupId}uploadDetailAttachment(t){if("done"==t.file.status){const e=t.fileList[0];this.detailAttachmentReadOnly=!0;const a=e.name;if(!this.validatorFileExt(e))return this.form.defaultTextInSysCodeDetail="",void this.uploadFileValidationMsg();if(this.form.defaultTextInSysCodeDetail=a.substring(0,a.lastIndexOf(".")),this.isUpdate())return;const i=t.file.response.result.attachmentId;this.form.remarkInSysCodeDetail="attachmentId="+i,this.tmpAttachment.detail.uid=t.file.uid,this.tmpAttachment.detail.attachmentId=i,this.tmpAttachment.detail.fileName=a}else if("removed"==t.file.status){const t=this.convertAttachmentId(this.form.remarkInSysCodeDetail),e=this.form.defaultTextInSysCodeDetail;this.removeAttachment(t,e),this.initDetailAttachment()}}uploadGroupAttachment(t){if("done"==t.file.status){const e=t.fileList[0];this.groupAttachmentReadOnly=!0;const a=e.name;if(!this.validatorFileExt(e))return this.form.defaultTextInSysCodeGroup="",void this.uploadFileValidationMsg();if(this.form.defaultTextInSysCodeGroup=a.substring(0,a.lastIndexOf(".")),this.isUpdate())return;const i=t.file.response.result.attachmentId;this.form.remarkInSysCodeGroup="attachmentId="+i,this.tmpAttachment.group.uid=t.file.uid,this.tmpAttachment.group.attachmentId=i,this.tmpAttachment.group.fileName=a}else if("removed"==t.file.status){const t=this.convertAttachmentId(this.form.remarkInSysCodeGroup),e=this.form.defaultTextInSysCodeGroup;this.removeAttachment(t,e),this.initGroupAttachment()}}removeAttachment(t,e){""===t||""===e||this.isUpdate()||this.$parameterApi.removeAttachmentInParameterUsingDELETE(t,e)}validatorFileExt(t){const e=this.canType.reduce((t,e)=>`${t}|${e}`);return!!new RegExp(`(${e})$`).test(t.name)}uploadFileValidationMsg(){this.setModalState({resultModal:{autoClose:null,content:"檔案格式不符，請重新選擇檔案",type:"warning",title:"上傳提示",visible:!0}})}beforeUploadDetailAttachment(t,e){if(""!==this.tmpAttachment.detail.uid&&t.uid!==this.tmpAttachment.detail.uid){const t=this.tmpAttachment.detail.attachmentId,e=this.tmpAttachment.detail.fileName;this.removeAttachment(t,e)}this.detailFileList=[t]}beforeUploadGroupAttachment(t,e){if(""!==this.tmpAttachment.group.uid&&t.uid!==this.tmpAttachment.group.uid){const t=this.tmpAttachment.group.attachmentId,e=this.tmpAttachment.group.fileName;this.removeAttachment(t,e)}this.groupFileList=[t]}uploadAttachment(){const t=new Promise(t=>{0!=this.detailFileList.length?this.$parameterApi.uploadAttachmentInParameterUsingPOST(this.detailFileList[0]).then(e=>{const a=e.data.result.attachmentId,i=e.data.result.fileName;this.form.defaultTextInSysCodeDetail=i,this.form.remarkInSysCodeDetail="attachmentId="+a,this.tmpAttachment.detail.uid=a,this.tmpAttachment.detail.attachmentId=a,this.tmpAttachment.detail.fileName=i,this.detailAttachmentReadOnly=!0,t(e)}):t(null)}),e=new Promise(t=>{0!=this.groupFileList.length?this.$parameterApi.uploadAttachmentInParameterUsingPOST(this.groupFileList[0]).then(e=>{const a=e.data.result.attachmentId,i=e.data.result.fileName;this.form.defaultTextInSysCodeGroup=i,this.form.remarkInSysCodeGroup="attachmentId="+a,this.tmpAttachment.group.uid=a,this.tmpAttachment.group.attachmentId=a,this.tmpAttachment.group.fileName=i,this.groupAttachmentReadOnly=!0,t(e)}):t(null)});return Promise.all([t,e])}downloadDetailAttachment(){const t=this.convertAttachmentId(this.form.remarkInSysCodeDetail),e=this.form.defaultTextInSysCodeDetail;this.$parameterApi.downloadAttachmentByDetailInParameterUsingGET(t,e,{responseType:"blob"}).then(t=>{this.downloadFile(t)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"下載檔案失敗"}})})}downloadGroupAttachment(){const t=this.convertAttachmentId(this.form.remarkInSysCodeGroup),e=this.form.defaultTextInSysCodeGroup;this.$parameterApi.downloadAttachmentByGroupInParameterUsingGET(t,e,{responseType:"blob"}).then(t=>{this.downloadFile(t)}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"下載檔案失敗"}})})}removeDetailAttachment(){const t=this.convertAttachmentId(this.form.remarkInSysCodeDetail),e=this.form.defaultTextInSysCodeDetail;this.removeAttachment(t,e),this.initDetailAttachment()}removeGroupAttachment(){const t=this.convertAttachmentId(this.form.remarkInSysCodeGroup),e=this.form.defaultTextInSysCodeGroup;this.removeAttachment(t,e),this.initGroupAttachment()}convertAttachmentId(t){return null!=t&&t.indexOf("=")>-1?t.substring(t.indexOf("=")+1):""}downloadFile(t){const e=t.data,a=URL.createObjectURL(e),i=document.createElement("a"),s=this.getContentDisposition(t.headers);i.setAttribute("href",a),i.setAttribute("download",""+s),i.click(),i.remove()}getContentDisposition(t){const e=t["content-disposition"],a=e.substring(e.indexOf("filename=")+9).replaceAll('"',"");return decodeURI(a)}uploadFile({onSuccess:t,onError:e,file:a,onProgress:i}){const s={onUploadProgress:t=>{i({percent:t.loaded/t.total*100},a)}};if(this.isUpdate())t(a);else{if(!this.validatorFileExt(a))return this.uploadFileValidationMsg(),void e("fail");this.$parameterApi.uploadAttachmentInParameterUsingPOST(a,s).then(e=>{t(e.data)}).catch(t=>{e(t)})}}};Object(J.a)([Object(tt.a)("setLoading")],mn.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],mn.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],mn.prototype,"initData",void 0),Object(J.a)([Object(et.b)()],mn.prototype,"type",void 0),Object(J.a)([Object(et.e)("visible")],mn.prototype,"watchVisible",null),Object(J.a)([pn.Action("setModalState")],mn.prototype,"setModalState",void 0),Object(J.a)([pn.Getter("getResultModal")],mn.prototype,"getResultModal",void 0),Object(J.a)([Object(et.e)("form",{deep:!0})],mn.prototype,"watchForm",null),mn=Object(J.a)([Object(et.a)({components:{InfoModal:_t,UploadModal:oa,IconTextButton:Ut}})],mn);var hn=mn,fn=(a("7a36"),Object(st.a)(hn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"edit"==t.type?"編輯":"新增／預覽",visible:t.visible,centered:!0,width:"80%","padding-size":"small"},on:{closeModal:t.closeModal}},[a("template",{slot:"content"},[a("fragment",[a("div",{staticClass:"form mt-2"},[a("a-form-model",{ref:"formRef",attrs:{model:t.form,rules:t.formRules}},[a("div",{staticClass:"form__group mb-3"},[a("div",{staticClass:"title mb-2"},[t._v(" 用途 ")]),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"sysCodeMainId","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("系統代碼")]),a("a-input",{staticClass:"w-100",attrs:{disabled:t.mainDisabled,"max-length":20},model:{value:t.form.sysCodeMainId,callback:function(e){t.$set(t.form,"sysCodeMainId",e)},expression:"form.sysCodeMainId"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"defaultTextInSysCodeMain","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("系統代碼的預設值")]),a("a-input",{staticClass:"w-100",attrs:{disabled:t.mainDisabled,"max-length":80},model:{value:t.form.defaultTextInSysCodeMain,callback:function(e){t.$set(t.form,"defaultTextInSysCodeMain",e)},expression:"form.defaultTextInSysCodeMain"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"doubleCheck","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("是否要特別授權")]),a("a-radio-group",{staticClass:"w-100",attrs:{disabled:t.mainDisabled},model:{value:t.form.doubleCheck,callback:function(e){t.$set(t.form,"doubleCheck",e)},expression:"form.doubleCheck"}},[a("a-radio",{attrs:{value:!0}},[t._v(" 是 ")]),a("a-radio",{attrs:{value:!1}},[t._v(" 否 ")])],1)],1)],1),a("a-col",{attrs:{span:12}})],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{staticStyle:{display:"block"},attrs:{prop:"remarkInSysCodeMain","label-col":{span:4},"wrapper-col":{span:20}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("備註")]),a("a-textarea",{staticClass:"w-100 remark",attrs:{disabled:t.mainDisabled,"max-length":150},model:{value:t.form.remarkInSysCodeMain,callback:function(e){t.$set(t.form,"remarkInSysCodeMain",e)},expression:"form.remarkInSysCodeMain"}})],1)],1)],1)],1),a("div",{staticClass:"form__group mb-3"},[a("div",{staticClass:"title mb-2"},[t._v(" 大分類 ")]),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"sysCodeDetailId","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("系統代碼")]),a("a-input",{staticClass:"w-100",attrs:{disabled:t.detailDisabled,"max-length":20},model:{value:t.form.sysCodeDetailId,callback:function(e){t.$set(t.form,"sysCodeDetailId",e)},expression:"form.sysCodeDetailId"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"sequenceInSysCodeDetail","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("顯示順序")]),a("a-input-number",{staticClass:"w-100",attrs:{disabled:t.detailDisabled,min:0},model:{value:t.form.sequenceInSysCodeDetail,callback:function(e){t.$set(t.form,"sequenceInSysCodeDetail",e)},expression:"form.sequenceInSysCodeDetail"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{prop:"defaultTextInSysCodeDetail","label-col":{span:4},"wrapper-col":{span:20}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("系統代碼的預設值")]),a("a-input",{attrs:{disabled:t.detailDisabled||t.detailAttachmentReadOnly,"max-length":200},model:{value:t.form.defaultTextInSysCodeDetail,callback:function(e){t.$set(t.form,"defaultTextInSysCodeDetail",e)},expression:"form.defaultTextInSysCodeDetail"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:8,offset:4}},[t.isReadonly()?t._e():a("a-upload",{attrs:{"file-list":t.detailFileList,"show-upload-list":!1,disabled:t.detailDisabled,"before-upload":t.beforeUploadDetailAttachment,"custom-request":t.uploadFile},on:{change:t.uploadDetailAttachment}},[a("button",{staticClass:"btn--primary me-2",attrs:{disabled:t.detailDisabled}},[a("a-icon",{attrs:{type:"upload"}}),t._v("上傳 ")],1)]),a("button",{staticClass:"btn--primary me-2",attrs:{disabled:t.isDetailDownload()},on:{click:t.downloadDetailAttachment}},[a("a-icon",{attrs:{type:"download"}}),t._v("下載 ")],1),t.isReadonly()?t._e():a("button",{staticClass:"btn--primary me-2",attrs:{disabled:t.detailDisabled||t.disabledDetailHasUpload},on:{click:t.removeDetailAttachment}},[a("a-icon",{attrs:{type:"delete"}}),t._v("刪除 ")],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"enabledInDetail","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("是否啟用")]),a("a-radio-group",{staticClass:"w-100",attrs:{disabled:t.detailDisabled},model:{value:t.form.enabledInDetail,callback:function(e){t.$set(t.form,"enabledInDetail",e)},expression:"form.enabledInDetail"}},[a("a-radio",{attrs:{value:!0}},[t._v(" 是 ")]),a("a-radio",{attrs:{value:!1}},[t._v(" 否 ")])],1)],1)],1),a("a-col",{attrs:{span:12}})],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{staticStyle:{display:"block"},attrs:{prop:"remarkInSysCodeDetail","label-col":{span:4},"wrapper-col":{span:20}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("備註")]),a("a-textarea",{staticClass:"w-100 remark",attrs:{disabled:t.detailDisabled||t.detailAttachmentReadOnly,"max-length":150},model:{value:t.form.remarkInSysCodeDetail,callback:function(e){t.$set(t.form,"remarkInSysCodeDetail",e)},expression:"form.remarkInSysCodeDetail"}})],1)],1)],1)],1),a("div",{staticClass:"form__group"},[a("div",{staticClass:"title mb-2"},[t._v(" 小分類 ")]),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"sysCodeGroupId","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("系統代碼")]),a("a-input",{staticClass:"w-100",attrs:{disabled:t.groupDisabled,"max-length":20},model:{value:t.form.sysCodeGroupId,callback:function(e){t.$set(t.form,"sysCodeGroupId",e)},expression:"form.sysCodeGroupId"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"sequenceInSysCodeGroup","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("顯示順序")]),a("a-input-number",{staticClass:"w-100",attrs:{disabled:t.groupDisabled,min:0},model:{value:t.form.sequenceInSysCodeGroup,callback:function(e){t.$set(t.form,"sequenceInSysCodeGroup",e)},expression:"form.sequenceInSysCodeGroup"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{prop:"defaultTextInSysCodeGroup","label-col":{span:4},"wrapper-col":{span:20}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("系統代碼的預設值")]),a("a-input",{attrs:{disabled:t.groupDisabled||t.groupAttachmentReadOnly,"max-length":200},model:{value:t.form.defaultTextInSysCodeGroup,callback:function(e){t.$set(t.form,"defaultTextInSysCodeGroup",e)},expression:"form.defaultTextInSysCodeGroup"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:8,offset:4}},[a("a-upload",{attrs:{"file-list":t.groupFileList,"show-upload-list":!1,disabled:t.groupDisabled,"before-upload":t.beforeUploadGroupAttachment,"custom-request":t.uploadFile},on:{change:t.uploadGroupAttachment}},[t.isReadonly()?t._e():a("button",{staticClass:"btn--primary me-2",attrs:{disabled:t.groupDisabled}},[a("a-icon",{attrs:{type:"upload"}}),t._v("上傳 ")],1)]),a("button",{staticClass:"btn--primary me-2",attrs:{disabled:t.isGroupDownload()},on:{click:t.downloadGroupAttachment}},[a("a-icon",{attrs:{type:"download"}}),t._v("下載 ")],1),t.isReadonly()?t._e():a("button",{staticClass:"btn--primary me-2",attrs:{disabled:t.groupDisabled||t.disabledGroupHasUpload},on:{click:t.removeGroupAttachment}},[a("a-icon",{attrs:{type:"delete"}}),t._v("刪除 ")],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"enabledInGroup","label-col":{span:8},"wrapper-col":{span:16}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("是否啟用")]),a("a-radio-group",{staticClass:"w-100",attrs:{disabled:t.groupDisabled},model:{value:t.form.enabledInGroup,callback:function(e){t.$set(t.form,"enabledInGroup",e)},expression:"form.enabledInGroup"}},[a("a-radio",{attrs:{value:!0}},[t._v(" 是 ")]),a("a-radio",{attrs:{value:!1}},[t._v(" 否 ")])],1)],1)],1),a("a-col",{attrs:{span:12}})],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{staticStyle:{display:"block"},attrs:{prop:"remarkInSysCodeGroup","label-col":{span:4},"wrapper-col":{span:20}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("備註")]),a("a-textarea",{staticClass:"w-100 remark",attrs:{disabled:t.groupDisabled||t.groupAttachmentReadOnly,"max-length":150},model:{value:t.form.remarkInSysCodeGroup,callback:function(e){t.$set(t.form,"remarkInSysCodeGroup",e)},expression:"form.remarkInSysCodeGroup"}})],1)],1)],1)],1)])],1),a("div",{staticClass:"d-flex mt-4 justify-content-end"},[t.isReadonly()?t._e():a("button",{staticClass:"btn--primary me-2",on:{click:t.submit}},[t._v(" "+t._s(t.initData?"確認":"新增")+" ")]),a("button",{staticClass:"btn--dark ms-2",on:{click:t.closeModal}},[t._v(" 取消 ")])])])],1)],2)}),[],!1,null,"0184c916",null).exports);let gn=class extends et.d{close(){this.$emit("closeModal")}handleExport(t){this.$emit("click",t)}};Object(J.a)([Object(et.b)()],gn.prototype,"visible",void 0),gn=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],gn);var bn=gn,vn=(a("cbea"),Object(st.a)(bn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:"匯出系統代碼",visible:t.visible,width:544,"padding-size":"normal",closable:!0,centered:!0},on:{closeModal:t.close}},[a("template",{slot:"content"},[a("div",{staticClass:"modal__subtitle"}),a("div",{staticClass:"d-flex justify-content-between"},[a("a-button",{staticClass:"btn__icon--export flex-center",on:{click:function(e){return t.handleExport(!0)}}},[a("div",{staticClass:"btn__icon--export-icon btn__icon-text--export2",attrs:{alt:""}}),a("div",[a("p",{staticClass:"btn__icon--export-text"},[t._v(" 匯出清單 ")])])]),a("a-button",{staticClass:"btn__icon--export flex-center",on:{click:function(e){return t.handleExport(!1)}}},[a("div",{staticClass:"btn__icon--export-icon btn__icon-text--export1",attrs:{alt:""}}),a("div",[a("p",{staticClass:"btn__icon--export-text"},[t._v(" 匯出歷史清單 ")])])])],1)])],2)}),[],!1,null,"7b9d7f99",null).exports);let _n=class extends et.d{handleClick(t){this.$emit("click",t)}};Object(J.a)([Object(et.b)()],_n.prototype,"isTodoShow",void 0),Object(J.a)([Object(et.b)()],_n.prototype,"selectRowIds",void 0),_n=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut}})],_n);var yn=_n,Cn=Object(st.a)(yn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isTodoShow?a("div",[a("a-tooltip",{attrs:{trigger:0==t.selectRowIds.length?"hover":"",placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("a-icon",{staticClass:"tip__icon",attrs:{type:"exclamation-circle"}}),a("span",{staticClass:"tip__text"},[t._v("請先勾選")])],1),a("IconTextButton",{staticClass:"me-3",attrs:{text:"通過",type:"enter"},on:{click:function(e){t.selectRowIds.length>0&&t.handleClick("pass")}}})],2),a("a-tooltip",{attrs:{trigger:0==t.selectRowIds.length?"hover":"",placement:"top","overlay-class-name":"whiteTooltip"}},[a("template",{slot:"title"},[a("a-icon",{staticClass:"tip__icon",attrs:{type:"exclamation-circle"}}),a("span",{staticClass:"tip__text"},[t._v("請先勾選")])],1),a("icon-text-button",{staticClass:"me-3",attrs:{text:"退回",type:"close"},on:{click:function(e){t.selectRowIds.length>0&&t.handleClick("reject")}}})],2),a("IconTextButton",{attrs:{text:"上一頁",type:"return"},on:{click:function(e){return t.handleClick("goback")}}})],1):a("div",[a("IconTextButton",{staticClass:"me-3",attrs:{text:"新增",type:"add"},on:{click:function(e){return t.handleClick("add")}}}),a("IconTextButton",{attrs:{text:"匯出",type:"export"},on:{click:function(e){return t.handleClick("export")}}})],1)}),[],!1,null,null,null).exports,On=a("19de"),An=a.n(On);const In=Object(tt.c)("modalControl");let Dn=class extends et.d{constructor(){super(...arguments),this.modifyVisible=!1,this.modifyType="",this.modifyData=[],this.importVisible=!1,this.confirmVisible=!1,this.confirmTitle="",this.confirmType="",this.isTodoShow="todo"===this.$route.params.type,this.exportVisible=!1,this.currentRoleId=this.$global.getCurrentRoleId(),this.searchForm={sysCodeMainId:void 0,sysCodeDetailId:void 0,sysCodeGroupId:void 0},this.rejectForm={remark:""},this.searchCatch={sysCodeMainId:void 0,sysCodeDetailId:void 0,sysCodeGroupId:void 0},this.searchRules={sysCodeMainId:[{required:!0,message:"請選擇用途",trigger:"change"}]},this.rejectRules={remark:[{required:!0,message:"請輸入退回原因",trigger:"blur"}]},this.sysCodeMainIdOptions=null,this.sysCodeDetailIdOptions=null,this.sysCodeGroupIdOptions=null,this.listGrid={rowKey:"sysCodeMainId",data:[],pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","15","25","50"],showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{key:"sysCodeMainId",type:Re.PLAIN,property:"sysCodeMainId",title:"用途（代碼）"},{key:"defaultTextInSysCodeMain",type:Re.PLAIN,property:"defaultTextInSysCodeMain",title:"用途（名稱）"},{key:"doubleCheck",type:Re.PLAIN,property:"doubleCheck",title:"doubleCheck",hidden:!0},{key:"editableInSysCodeMain",type:Re.PLAIN,property:"editableInSysCodeMain",title:"editableInSysCodeMain",hidden:!0},{key:"remarkInSysCodeMain",type:Re.PLAIN,property:"remarkInSysCodeMain",title:"remarkInSysCodeMain",hidden:!0},{key:"sysCodeDetailId",type:Re.PLAIN,property:"sysCodeDetailId",title:"大分類（代碼）"},{key:"defaultTextInSysCodeDetail",type:Re.TEMPLATE,template:"ellipsis",property:"defaultTextInSysCodeDetail",title:"大分類（名稱）"},{key:"enabledInDetail",type:Re.PLAIN,property:"enabledInDetail",title:"enabledInDetail",hidden:!0},{key:"editableInSysCodeDetail",type:Re.PLAIN,property:"editableInSysCodeDetail",title:"editableInSysCodeDetail",hidden:!0},{key:"sequenceInSysCodeDetail",type:Re.PLAIN,property:"sequenceInSysCodeDetail",title:"sequenceInSysCodeDetail",hidden:!0},{key:"remarkInSysCodeDetail",type:Re.PLAIN,property:"remarkInSysCodeDetail",title:"remarkInSysCodeDetail",hidden:!0},{key:"sysCodeGroupId",type:Re.PLAIN,property:"sysCodeGroupId",title:"小分類（代碼）"},{key:"defaultTextInSysCodeGroup",type:Re.TEMPLATE,template:"ellipsis",property:"defaultTextInSysCodeGroup",title:"小分類（名稱）"},{key:"enabledInGroup",type:Re.PLAIN,property:"enabledInGroup",title:"enabledInGroup",hidden:!0},{key:"sequenceInSysCodeGroup",type:Re.PLAIN,property:"sequenceInSysCodeGroup",title:"sequenceInSysCodeGroup",hidden:!0},{key:"remarkInSysCodeGroup",type:Re.PLAIN,property:"remarkInSysCodeGroup",title:"remarkInSysCodeGroup",hidden:!0},{key:"edit",type:Re.TEMPLATE,property:"edit",title:"編輯",template:"edit",width:"100px",fixed:"right"}]},this.todoGrid={rowKey:"sysCodeLogId",data:[],pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","15","25","50"],showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{key:"sysCodeLogId",type:Re.PLAIN,property:"sysCodeLogId",title:"sysCodeLogId",hidden:!0},{key:"sysCodeMainId",type:Re.PLAIN,property:"sysCodeMainId",title:"用途（代碼）"},{key:"defaultMainText",type:Re.PLAIN,property:"defaultMainText",title:"用途（名稱）"},{key:"sysCodeDetailId",type:Re.PLAIN,property:"sysCodeDetailId",title:"大分類（代碼）"},{key:"defaultDetailText",type:Re.TEMPLATE,template:"ellipsis",property:"defaultDetailText",title:"大分類（名稱）"},{key:"sysCodeGroupId",type:Re.PLAIN,property:"sysCodeGroupId",title:"小分類（代碼）"},{key:"defaultGroupText",type:Re.TEMPLATE,template:"ellipsis",property:"defaultGroupText",title:"小分類（名稱）"},{key:"status",type:Re.PLAIN,property:"status",title:"狀態",hidden:!0},{key:"applyUser",type:Re.PLAIN,property:"applyUser",title:"申請人"},{key:"applyDatetime",type:Re.PLAIN,property:"applyDatetime",title:"申請日期",formatter:t=>Jo.transformRocDate(t.applyDatetime)},{key:"query",type:Re.TEMPLATE,property:"query",title:"預覽",template:"queryNotice",width:"100px",fixed:"right"}]},this.rowSelection={onChange:this.rowSelectionChange,selectedRowKeys:[]}}async created(){await this.init()}init(){return Promise.all([this.getSysCodeMainIdOptions(),this.getTodo()])}ellipsisString(t){const e="xxl"!==this.getWindowSize?21:59;return t&&t.length>e?t.slice(0,e)+"...":t}getSysCodeMainIdOptions(){return this.$parameterApi.searchMainInParameterUsingGET().then(t=>{this.sysCodeMainIdOptions=t.data.result}).catch(t=>{})}getSysCodeDetailIdOptions(){return this.searchForm.sysCodeDetailId=void 0,this.searchForm.sysCodeGroupId=void 0,this.$parameterApi.searchDetailInParameterUsingGET(this.searchForm.sysCodeMainId).then(t=>{this.sysCodeDetailIdOptions=t.data.result}).catch(t=>{})}getSysCodeGroupIdOptions(){if(this.searchForm.sysCodeGroupId=void 0,null!=this.searchForm.sysCodeDetailId)return this.$parameterApi.searchGroupInParameterUsingGET(this.searchForm.sysCodeDetailId,this.searchForm.sysCodeMainId).then(t=>{this.sysCodeGroupIdOptions=t.data.result}).catch(t=>{})}onSearch(){this.$refs.formRef.validate(t=>{t&&(this.listGrid.pagination.current=1,this.searchCatch=this.searchForm,this.queryData(this.searchCatch))})}queryData(t){this.setLoading(!0);const e={...t,pageIndex:this.listGrid.pagination.current-1,pageSize:this.listGrid.pagination.pageSize};this.$parameterApi.searchInParameterUsingPOST(e).then(t=>{const e=t.data.result.using;this.listGrid.data=e.content,this.listGrid.pagination.total=parseInt(e.totalElements)}).catch(console.error).finally(()=>{this.setLoading(!1)})}async onPageChange(t,e){this[e].pagination.current=t.pagination.current,this[e].pagination.pageSize=t.pagination.pageSize,"listGrid"==await e?this.queryData(this.searchCatch):this.getTodo()}onImport(){}onConfirm(t){let e=!1;"reject"==t&&this.$refs.rejectRef.validate(t=>{e=t,this.confirmVisible=!1}),("pass"==t||"reject"==t&&e)&&(this.setLoading(!0),this.$parameterApi.reviewLogInParameterUsingPOST({remark:this.rejectForm.remark,status:t,sysCodeLogId:this.rowSelection.selectedRowKeys}).then(t=>{this.rowSelection.selectedRowKeys=[],this.init()}).catch(e=>{const a="pass"==t?"通過":"退回";this.setModalState({resultModal:{visible:!0,type:"error",title:a+"失敗",content:e.response.data.message}})}).finally(()=>{this.confirmVisible=!1,this.setLoading(!1)}))}onModifyModalClose(t){t&&(this.searchForm.sysCodeMainId=t.sysCodeMainId,this.queryData(this.searchForm)),this.init().then(()=>{this.getSysCodeDetailIdOptions(),this.getSysCodeGroupIdOptions()}),this.modifyVisible=!1}rowSelectionChange(t,e){this.rowSelection.selectedRowKeys=t}getTodo(){this.$parameterApi.searchLogInParameterUsingPOST({status:"ready",pageIndex:this.todoGrid.pagination.current-1,pageSize:this.todoGrid.pagination.pageSize}).then(t=>{const e=t.data.result;this.todoGrid.data=e.content,this.todoGrid.pagination.total=parseInt(e.totalElements)}).catch(t=>{})}goback(){this.isTodoShow=!1,this.searchForm.sysCodeMainId&&this.queryData(this.searchForm)}handleClick(t){switch(t){case"add":this.modifyVisible=!0,this.modifyType="add",this.modifyData=void 0;break;case"import":this.importVisible=!0;break;case"export":this.onExport();break;case"goback":this.goback();break;case"pass":this.confirmVisible=!0,this.confirmTitle="確定要通過?",this.confirmType="pass",this.rejectForm.remark="";break;case"reject":this.confirmVisible=!0,this.confirmTitle="確定要退回?",this.confirmType="reject",this.rejectForm.remark=""}}onExport(){this.exportVisible=!0}exportExcel(t){this.setLoading(!0);const e=ya()(new Date).format("YYYY/MM/DD_HHmmss").split("/");t?this.$parameterApi.exportResultUsingPOST(this.searchForm,{responseType:"blob"}).then(t=>{const a=`系統代碼清單_${e[0]}${e[1]}${e[2]}.xlsx`;An()(t.data,a)}).catch(t=>{}).finally(()=>{this.setLoading(!1)}):this.$parameterApi.exportLogUsingPOST(this.searchForm,{responseType:"blob"}).then(t=>{const a=`系統代碼Log_${e[0]}${e[1]}${e[2]}.xlsx`;An()(t.data,a)}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}};Object(J.a)([In.Action("setModalState")],Dn.prototype,"setModalState",void 0),Object(J.a)([tt.b],Dn.prototype,"getWindowSize",void 0),Object(J.a)([Object(tt.a)("setLoading")],Dn.prototype,"setLoading",void 0),Dn=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t,FblDataGrid:gt,ModifyModal:fn,ActionBar:Cn,ExportModal:vn}})],Dn);var Sn=Dn,wn=(a("cccb"),Object(st.a)(Sn,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isTodoShow,expression:"!isTodoShow"}],key:"queryForm",staticClass:"search-form"},[i("a-form-model",{ref:"formRef",staticClass:"d-flex align-items-start flex-wrap",attrs:{model:t.searchForm,rules:t.searchRules,"hide-required-mark":!0}},[i("div",{staticClass:"d-flex col"},[i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 用途 ")]),i("a-form-model-item",{attrs:{prop:"sysCodeMainId"}},[i("a-select",{staticClass:"search-form__input--select",attrs:{"show-search":"",placeholder:"請選擇","allow-clear":!0,"dropdown-match-select-width":!0},on:{change:t.getSysCodeDetailIdOptions},model:{value:t.searchForm.sysCodeMainId,callback:function(e){t.$set(t.searchForm,"sysCodeMainId",e)},expression:"searchForm.sysCodeMainId"}},t._l(t.sysCodeMainIdOptions,(function(e){return i("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.value+" "+e.label)+" ")])})),1)],1)],1),i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 大分類 ")]),i("a-form-model-item",[i("a-select",{staticClass:"search-form__input--select",attrs:{"show-search":"",placeholder:"請選擇","allow-clear":!0,"dropdown-match-select-width":!0},on:{change:t.getSysCodeGroupIdOptions},model:{value:t.searchForm.sysCodeDetailId,callback:function(e){t.$set(t.searchForm,"sysCodeDetailId",e)},expression:"searchForm.sysCodeDetailId"}},t._l(t.sysCodeDetailIdOptions,(function(e){return i("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.value+" "+e.label)+" ")])})),1)],1)],1),i("div",{staticClass:"search-form__item col"},[i("div",{staticClass:"search-form__label"},[t._v(" 小分類 ")]),i("a-form-model-item",[i("a-select",{staticClass:"search-form__input--select",attrs:{"show-search":"",placeholder:"請選擇","allow-clear":!0,"dropdown-match-select-width":!0},model:{value:t.searchForm.sysCodeGroupId,callback:function(e){t.$set(t.searchForm,"sysCodeGroupId",e)},expression:"searchForm.sysCodeGroupId"}},t._l(t.sysCodeGroupIdOptions,(function(e){return i("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.value)+" ")])})),1)],1)],1)]),i("a-button",{staticClass:"btn--search",staticStyle:{"margin-top":"22px"},on:{click:t.onSearch}},[t._v(" 查詢 ")])],1)],1),i("div",{staticClass:"d-flex justify-content-between search-header"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isTodoShow,expression:"!isTodoShow"}],key:"titleBar",staticClass:"title"},[t._v(" 系統代碼 "),i("a-badge",{directives:[{name:"show",rawName:"v-show",value:t.todoGrid.data.length>0,expression:"todoGrid.data.length > 0"}],key:"todoBadge",attrs:{count:t.todoGrid.pagination.total,offset:["-5px","0px"]}},[i("a-tag",{staticClass:"ms-3",attrs:{color:"red"}},[i("a",{on:{click:function(e){t.todoGrid.pagination.current=1,t.getTodo(),t.isTodoShow=!0}}},[t._v(" 待辦 ")])])],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isTodoShow,expression:"isTodoShow"}],key:"todoTitle",staticClass:"title"},[t._v(" 待辦清單 ")]),i("ActionBar",{attrs:{"select-row-ids":t.rowSelection.selectedRowKeys,"is-todo-show":t.isTodoShow},on:{click:t.handleClick}})],1),i("fbl-data-grid",{directives:[{name:"show",rawName:"v-show",value:!t.isTodoShow,expression:"!isTodoShow"}],key:"searchResultGrid",attrs:{"row-key":function(t,e){return e},columns:t.listGrid.columns,data:t.listGrid.data,pagination:t.listGrid.pagination,"expanded-row-keys":[],scroll:{x:"max-content"}},on:{tableChange:function(e){return t.onPageChange(e,"listGrid")}},scopedSlots:t._u([{key:"ellipsis",fn:function(e){var a=e.data,s=e.property;return[i("a-popover",{attrs:{"overlay-class-name":"popover--summary",placement:"top",trigger:a[s]&&("xxl"==t.getWindowSize?a[s].length<60:a[s].length<22)?"":"hover"}},[i("template",{slot:"content"},[i("span",[t._v(" "+t._s(a[s])+" ")])]),t._v(" "+t._s(t.ellipsisString(a[s]))+" ")],2)]}},{key:"edit",fn:function(e){return[i("div",{staticClass:"action-icon btn__icon--edit-acion",on:{click:function(a){t.modifyVisible=!0,t.modifyType="edit",t.modifyData=e.data}}})]}}])}),i("fbl-data-grid",{directives:[{name:"show",rawName:"v-show",value:t.isTodoShow,expression:"isTodoShow"}],key:"todoGrid",attrs:{"row-key":t.todoGrid.rowKey,columns:t.todoGrid.columns,data:t.todoGrid.data,pagination:t.todoGrid.pagination,"expanded-row-keys":[],scroll:{x:"max-content"},"row-selection":t.rowSelection},on:{tableChange:function(e){return t.onPageChange(e,"todoGrid")}},scopedSlots:t._u([{key:"ellipsis",fn:function(e){var a=e.data,s=e.property;return[i("a-popover",{attrs:{"overlay-class-name":"popover--summary",placement:"top",trigger:a[s]&&("xxl"==t.getWindowSize?a[s].length<60:a[s].length<22)?"":"hover"}},[i("template",{slot:"content"},[i("span",[t._v(" "+t._s(a[s])+" ")])]),t._v(" "+t._s(t.ellipsisString(a[s]))+" ")],2)]}},{key:"queryNotice",fn:function(e){return[i("div",{staticClass:"action-icon btn--action",attrs:{type:"primary"},on:{click:function(a){t.modifyVisible=!0,t.modifyType="readonly",t.modifyData=e.data}}},[i("a-icon",{attrs:{type:"eye"}})],1)]}}])}),i("ModifyModal",{attrs:{visible:t.modifyVisible,type:t.modifyType,"init-data":t.modifyData},on:{closeModal:t.onModifyModalClose}}),i("InfoModal",{attrs:{title:"匯入",visible:t.importVisible,width:470,"padding-size":"normal",footer:!0},on:{closeModal:function(e){t.importVisible=!1},confirmModal:t.onImport}}),i("ExportModal",{attrs:{visible:t.exportVisible},on:{closeModal:function(e){t.exportVisible=!1},click:t.exportExcel}}),i("InfoModal",{attrs:{title:t.confirmTitle,visible:t.confirmVisible,width:470,footer:!0},on:{closeModal:function(e){t.confirmVisible=!1},confirmModal:function(e){return t.onConfirm(t.confirmType)}}},[i("template",{slot:"content"},[i("fragment",[i("div",{directives:[{name:"show",rawName:"v-show",value:"reject"==t.confirmType,expression:"confirmType == 'reject'"}],key:"todoRejectForm"},[i("a-form-model",{ref:"rejectRef",staticClass:"mt-4 form--light",attrs:{model:t.rejectForm,rules:t.rejectRules,"hide-required-mark":!0}},[i("a-form-model-item",{attrs:{prop:"remark","label-col":{span:24},"wrapper-col":{span:24}}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("退回意見：")]),i("div",{staticClass:"confirm-message"},[i("img",{staticClass:"confirm-message__img",attrs:{src:a("e536"),alt:""}}),i("a-textarea",{attrs:{"auto-size":{minRows:4}},model:{value:t.rejectForm.remark,callback:function(e){t.$set(t.rejectForm,"remark",e)},expression:"rejectForm.remark"}})],1)])],1)],1)])],1)],2)],1)}),[],!1,null,"3e1361e6",null).exports);let kn=class extends et.d{constructor(){super(...arguments),this.currentRoleId=null,this.isDisabledUnit=!0,this.currentRoleUnit=null,this.showTimeRangePanel=!1,this.isContactDatePickerOpen=!1,this.selectOptions={units:[],toAgentList:[],agentList:[]},this.rules={agent:[{required:!0,message:"請選擇代理人",trigger:"change"}],period:[{required:!0,message:"請填入代理時間",trigger:"change"}]},this.form={principal:void 0,principalUnit:void 0,agentUnit:void 0,agent:void 0,period:null}}disableDate(t,e){return new Date(e[0]),(!e[0]||!e[1])&&t&&t<=ya()().subtract(1,"day")}toggleTimeRangePanel(){this.showTimeRangePanel=!this.showTimeRangePanel}openContactDatesPicker(){this.isContactDatePickerOpen=!1,this.isContactDatePickerOpen=!this.isContactDatePickerOpen}closeContactDatesPicker(){this.isContactDatePickerOpen=!1}async getApi_searchAgentDeptList(){await this.$accountAgentApi.searchAgentDeptListInAccountAgentUsingPOST().then(t=>{const e=t.data.result;this.selectOptions.units=e.map(t=>({value:t.value,label:t.label}))}).catch()}getApi_searchAgentList(t){const e={departmentId:t,whichDB:this.$user.getMe().employee.whichDB};return this.$accountAgentApi.searchAgentListInAccountAgentUsingPOST(e).then(t=>t.data.result.filter(t=>null!==t.value).map(t=>({label:t.label,value:t.value}))).catch()}getApi_createRecordInAccountAgent(){this.setLoading(!0);const t={principal:this.form.principal,principalUnit:this.form.principalUnit,agent:this.form.agent,agentUnit:this.form.agentUnit,startDatetime:ya()(this.form.period[0]).format("YYYY-MM-DD HH:mm"),endDatetime:ya()(this.form.period[1]).format("YYYY-MM-DD HH:mm")};this.$accountAgentApi.createRecordInAccountAgentUsingPOST(t).then(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountAgentResult",params:{type:"add"},query:{result:"success"}})}).catch(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountAgentResult",params:{type:"add"},query:{result:"fail",msg:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}onSubmit(){this.$refs.formRef.validate(t=>{t&&this.getApi_createRecordInAccountAgent()})}onClose(){this.visibleSync=!1}reset(){this.form={principal:void 0,principalUnit:void 0,agent:void 0,agentUnit:void 0,period:null},this.closeContactDatesPicker()}async created(){await this.getApi_searchAgentDeptList(),this.currentRoleId=this.$global.getCurrentRoleId(),["ROLE_Auditor","ROLE_Audit_Team_Head"].includes(this.currentRoleId)?(this.currentRoleUnit=this.$global.getCurrentRole().roleUnits[0].auditorTeamCode,this.isDisabledUnit=!0):this.isDisabledUnit=!1,this.isDisabledUnit?(this.form.principalUnit=this.currentRoleUnit,this.form.agentUnit=this.currentRoleUnit):(this.$set(this.rules,"principal",[{required:!0,message:"請選擇被代理人",trigger:"change"}]),this.$set(this.rules,"principalUnit",[{required:!0,message:"請選擇被代理人單位",trigger:"change"}]),this.$set(this.rules,"agentUnit",[{required:!0,message:"請選擇代理人單位",trigger:"change"}]))}async watchToUnit(t){if(this.form.principal=void 0,t){this.selectOptions.toAgentList=await this.getApi_searchAgentList(t);const e=this.selectOptions.toAgentList.find(t=>t.value===this.$user.getMe().employee.domainId);e&&(this.form.principal=e.value)}}async watchUnit(t){this.form.agent=void 0,t&&(this.selectOptions.agentList=await this.getApi_searchAgentList(t))}watchVisible(t){t||(this.reset(),this.closeContactDatesPicker())}};Object(J.a)([Object(tt.a)("setLoading")],kn.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("visible")],kn.prototype,"visibleSync",void 0),Object(J.a)([Object(et.e)("form.principalUnit")],kn.prototype,"watchToUnit",null),Object(J.a)([Object(et.e)("form.agentUnit")],kn.prototype,"watchUnit",null),Object(J.a)([Object(et.e)("visibleSync",{immediate:!0})],kn.prototype,"watchVisible",null),kn=Object(J.a)([Object(et.a)({components:{}})],kn);var Mn=kn,xn=(a("4270"),Object(st.a)(Mn,(function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return i("a-modal",{staticClass:"common__modal fubon-backStage_modal",attrs:{"mask-closable":!1,"after-close":e.onClose,footer:null,width:"66%"},model:{value:e.visibleSync,callback:function(t){e.visibleSync=t},expression:"visibleSync"}},[i("template",{slot:"closeIcon"},[i("a-icon",{attrs:{type:"close"}})],1),i("div",{staticClass:"modal-container"},[i("div",{staticClass:"modal-container__title"},[e._v(" 建立代理事項 ")]),i("a-form-model",{ref:"formRef",attrs:{model:e.form,rules:e.rules}},[i("div",{staticClass:"row form__option"},[i("div",{staticClass:"col-6"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"input__title"},[e._v(" 被代理人單位 ")]),e.isDisabledUnit?e._e():i("div",{staticClass:"mark-required"},[e._v(" * ")])]),i("a-form-model-item",{attrs:{prop:"principalUnit"}},[i("a-select",{staticClass:"input__block",attrs:{placeholder:"請選擇被代理人單位",options:e.selectOptions.units,disabled:e.isDisabledUnit},model:{value:e.form.principalUnit,callback:function(t){e.$set(e.form,"principalUnit",t)},expression:"form.principalUnit"}})],1)],1),i("div",{staticClass:"col-6"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"input__title"},[e._v(" 被代理人姓名 ")]),e.isDisabledUnit?e._e():i("div",{staticClass:"mark-required"},[e._v(" * ")])]),i("a-form-model-item",{attrs:{prop:"principal"}},[i("a-select",{staticClass:"input__block",attrs:{placeholder:"e.g. 林曉春",options:e.selectOptions.toAgentList,disabled:e.isDisabledUnit},model:{value:e.form.principal,callback:function(t){e.$set(e.form,"principal",t)},expression:"form.principal"}})],1)],1)]),i("div",{staticClass:"row form__option"},[i("div",{staticClass:"col-6"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"input__title"},[e._v(" 代理人單位 ")]),e.isDisabledUnit?e._e():i("div",{staticClass:"mark-required"},[e._v(" * ")])]),i("a-form-model-item",{attrs:{prop:"agentUnit"}},[i("a-select",{staticClass:"input__block",attrs:{placeholder:"請選擇代理人單位",options:e.selectOptions.units,disabled:e.isDisabledUnit},model:{value:e.form.agentUnit,callback:function(t){e.$set(e.form,"agentUnit",t)},expression:"form.agentUnit"}})],1)],1),i("div",{staticClass:"col-6"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"input__title"},[e._v(" 代理人姓名 ")]),i("div",{staticClass:"mark-required"},[e._v(" * ")])]),i("a-form-model-item",{attrs:{prop:"agent"}},[i("a-select",{staticClass:"input__block",attrs:{placeholder:"e.g. 林曉春","allow-clear":!0,options:e.selectOptions.agentList.filter((function(e){return e.value!==t.$user.getMe().employee.domainId}))},model:{value:e.form.agent,callback:function(t){e.$set(e.form,"agent",t)},expression:"form.agent"}})],1)],1)]),i("div",{staticClass:"row form__option"},[i("div",{staticClass:"col-12"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"input__title"},[e._v(" 代理時間起迄 ")]),i("div",{staticClass:"mark-required"},[e._v(" * ")])]),i("a-form-model-item",{attrs:{prop:"period"}},[i("date-picker",{staticClass:"input__block",attrs:{"disabled-date":e.disableDate,"show-time":"",range:"","show-time-panel":e.showTimeRangePanel,"minute-step":30,type:"datetime",format:"YYYY/MM/DD HH:mm","show-second":!1,clearable:!0,open:e.isContactDatePickerOpen,editable:!1},on:{"update:open":function(t){e.isContactDatePickerOpen=t},open:e.openContactDatesPicker},scopedSlots:e._u([{key:"footer",fn:function(){return[i("a-space",[i("a-button",{attrs:{type:"primary",size:"small"},on:{click:e.toggleTimeRangePanel}},[e._v(" "+e._s(e.showTimeRangePanel?"選擇日期":"選擇時間")+" ")]),e.form.period?i("a-button",{attrs:{size:"small",type:"primary"},on:{click:e.closeContactDatesPicker}},[e._v(" 確定 ")]):e._e()],1)]},proxy:!0}]),model:{value:e.form.period,callback:function(t){e.$set(e.form,"period",t)},expression:"form.period"}})],1)],1)])]),i("div",{staticClass:"btn__wrap text-center"},[i("button",{staticClass:"btn__radius--primary--outline mb-2",on:{click:e.onClose}},[e._v(" 取消 ")]),i("button",{staticClass:"btn__radius--primary mb-2",on:{click:e.onSubmit}},[e._v(" 確定 ")])])],1)],2)}),[],!1,null,"0db95db8",null).exports);let jn=class extends et.d{constructor(){super(...arguments),this.currentRoleId=null,this.currentRoleUnit=null,this.showTimeRangePanel=!1,this.isContactDatePickerOpen=!1,this.staticData={principalUnit:{departmentId:"",departmentName:""},principal:{domainId:"",name:""},agentUnit:{departmentId:"",departmentName:""},agent:{domainId:"",name:""}},this.form={period:void 0},this.rules={period:[{required:!0,trigger:"change",validator:this.validatorEndDate}]}}reset(){this.form={period:void 0}}disableDate(t,e){if(Jo.isValidDate(e[0]),e[0]&&e[1])return!1;const a=ya()().subtract(1,"day"),i=ya()(this.staticData.startDatetime).add(1911,"year").subtract(1,"day"),s=a.isBefore(i)?i:a;return t&&t<=s}toggleTimeRangePanel(){this.showTimeRangePanel=!this.showTimeRangePanel}openContactDatesPicker(){this.showTimeRangePanel=!1,this.isContactDatePickerOpen=!this.isContactDatePickerOpen}closeContactDatesPicker(){this.isContactDatePickerOpen=!1,this.showTimeRangePanel=!1}validatorEndDate(t,e,a){e instanceof Date||a("請選擇代理結束時間"),ya()(e).isBefore(ya()(this.staticData.startDatetime).add(1911,"year"))&&a("不得小於 代理開始時間"),ya()(e).isBefore(ya()())&&a("不得小於 當前時間"),a()}fetchAgentData(){this.setLoading(!0),this.$accountAgentApi.searchRecordInAccountAgentUsingPOST(this.editModalAccountAgentId).then(t=>{const e=t.data.result;this.staticData=e,this.form.period=Jo.isValidDate(ya()(this.staticData.endDatetime).add(1911,"year").format())}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}getApi_modifyRecordInAccountAgent(){this.setLoading(!0);const t={accountAgentId:this.editModalAccountAgentId,endDatetime:ya()(this.form.period).format("YYYY-MM-DD HH:mm")};this.$accountAgentApi.modifyRecordInAccountAgentUsingPOST(t).then(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountAgentResult",params:{type:"edit"},query:{result:"success"}})}).catch(t=>{this.$global.changeRouterAndaddParam({toRouter:"AccountAgentResult",params:{type:"edit"},query:{result:"fail",msg:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}onSubmit(){this.$refs.formRef.validate(t=>{t&&this.getApi_modifyRecordInAccountAgent()})}onClose(){this.$refs.formRef.clearValidate(),this.visibleSync=!1}watchVisible(t){t?this.fetchAgentData():this.reset()}};Object(J.a)([Object(tt.a)("setLoading")],jn.prototype,"setLoading",void 0),Object(J.a)([Object(et.c)("visible")],jn.prototype,"visibleSync",void 0),Object(J.a)([Object(et.b)()],jn.prototype,"editModalAccountAgentId",void 0),Object(J.a)([Object(et.e)("visibleSync",{immediate:!0})],jn.prototype,"watchVisible",null),jn=Object(J.a)([Object(et.a)({components:{}})],jn);var Tn=jn,Ln=(a("5bf4"),Object(st.a)(Tn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{staticClass:"common__modal fubon-backStage_modal",attrs:{"mask-closable":!1,"after-close":t.onClose,footer:null,width:"66%"},model:{value:t.visibleSync,callback:function(e){t.visibleSync=e},expression:"visibleSync"}},[a("template",{slot:"closeIcon"},[a("a-icon",{attrs:{type:"close"}})],1),a("div",{staticClass:"modal-container"},[a("div",{staticClass:"modal-container__title"},[t._v(" 編輯代理事項 ")]),a("a-form-model",{ref:"formRef",attrs:{model:t.form,rules:t.rules}},[a("div",{staticClass:"row form__option"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 被代理人單位： ")]),a("div",[t._v(" "+t._s(t.staticData.principalUnit.departmentName)+" ")])])]),a("div",{staticClass:"row form__option"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 被代理人姓名： ")]),a("div",[t._v(" "+t._s(t.staticData.principal.name)+" ")])])]),a("div",{staticClass:"row form__option"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 代理人單位： ")]),a("div",[t._v(" "+t._s(t.staticData.agentUnit.departmentName)+" ")])])]),a("div",{staticClass:"row form__option"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 代理人姓名： ")]),a("div",[t._v(" "+t._s(t.staticData.agent.name)+" ")])])]),a("div",{staticClass:"row form__option"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 代理開始時間： ")]),a("div",[t._v(" "+t._s(t.staticData.startDatetime)+" ")])])]),a("div",{staticClass:"row form__option"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 代理結束時間 ")]),a("div",{staticClass:"mark-required"},[t._v(" * ")])]),a("a-form-model-item",{attrs:{prop:"period"}},[a("date-picker",{staticClass:"input__block",attrs:{"disabled-date":t.disableDate,editable:!1,"show-time":"","show-time-panel":t.showTimeRangePanel,"minute-step":30,type:"datetime",format:"YYYY/MM/DD HH:mm","show-second":!1,clearable:!0,open:t.isContactDatePickerOpen},on:{"update:open":function(e){t.isContactDatePickerOpen=e},open:t.openContactDatesPicker},scopedSlots:t._u([{key:"footer",fn:function(){return[a("a-space",[a("a-button",{attrs:{type:"primary",size:"small"},on:{click:t.toggleTimeRangePanel}},[t._v(" "+t._s(t.showTimeRangePanel?"選擇日期":"選擇時間")+" ")]),a("a-button",{attrs:{size:"small",type:"primary"},on:{click:t.closeContactDatesPicker}},[t._v(" 確定 ")])],1)]},proxy:!0}]),model:{value:t.form.period,callback:function(e){t.$set(t.form,"period",e)},expression:"form.period"}})],1)],1)])]),a("div",{staticClass:"btn__wrap text-center"},[a("button",{staticClass:"btn__radius--primary--outline mb-2",on:{click:t.onClose}},[t._v(" 取消 ")]),a("button",{staticClass:"btn__radius--primary mb-2",on:{click:t.onSubmit}},[t._v(" 確定 ")])])],1)],2)}),[],!1,null,"0a5ec145",null).exports);const Pn=Object(tt.c)("modalControl");let Rn=class extends et.d{constructor(){super(...arguments),this.formatter=this.$twDateTimeFormatter,this.curRole="0",this.currentRoleId=null,this.currentRoleUnit=null,this.query=!1,this.buildModalVisible=!1,this.editModalVisible=!1,this.editModalAccountAgentId="",this.downloadEnabled=!0,this.agentId=0,this.selectOptions={units:[],toAgentList:[],agentList:[]},this.form={agent:void 0,agentUnit:void 0,enabled:"*",principal:void 0,principalUnit:void 0,period:null},this.downloadSearchData=null,this.formRules={period:[{required:!0,message:"請選擇代理時間",trigger:"change",validator:(t,e)=>e.every(t=>t)}]},this.gridData={rowKey:"accountAgentId",data:[],pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","25","50"],showSizeChanger:!0,showTotal:(t,e)=>`顯示${e[0]}-${e[1]}筆 共${t}筆`},columns:[{type:Re.PLAIN,property:"principal",title:"被代理人姓名",fixed:"left",formatter:t=>t.principal.name},{type:Re.TEMPLATE,template:"toUnitDisplay",title:"被代理人單位",width:150},{type:Re.PLAIN,property:"agent",title:"代理人姓名",formatter:t=>t.agent.name},{type:Re.TEMPLATE,template:"unitDisplay",title:"代理人單位",width:150},{type:Re.PLAIN,property:"startDatetime",title:"代理起始時間",width:130},{type:Re.PLAIN,property:"endDatetime",title:"代理結束時間",width:130},{type:Re.TEMPLATE,template:"enabled",title:"是否啟用"},{type:Re.PLAIN,property:"createUser",title:"建立人員",formatter:t=>t.createUser.name},{type:Re.PLAIN,property:"createDatetime",title:"建立時間",width:130},{type:Re.PLAIN,property:"updateUser",title:"異動人員",formatter:t=>t.updateUser.name},{type:Re.PLAIN,property:"updateDatetime",title:"異動時間",width:130},{type:Re.TEMPLATE,template:"edit",fixed:"right"}]},this.showTimeRangePanel=!1,this.isContactDatePickerOpen=!1}disableDate(t,e){if(e[0]){const a=Jo.isValidDate(e[0]);return(!e[0]||!e[1])&&t&&(t<ya()(a).subtract(365,"d")||t>ya()(a).add(365,"d"))}return!1}toggleTimeRangePanel(){this.showTimeRangePanel=!this.showTimeRangePanel}openContactDatesPicker(){this.closeContactDatesPicker(),this.isContactDatePickerOpen=!this.isContactDatePickerOpen}closeContactDatesPicker(){this.isContactDatePickerOpen=!1}canEdit({endDatetime:t,principal:e,enabled:a}){const i=Jo.isValidDate(Jo.transformMinguoDateTime(t))>=ya()().toDate(),s=e.domainId===this.$user.getMe().employee.domainId,o="Y"===a.keyId;return i&&s&&o}getApi_searchAgentDeptList(){this.$accountAgentApi.searchAgentDeptListInAccountAgentUsingPOST().then(t=>{const e=t.data.result;this.selectOptions.units=e.map(t=>({value:t.value,label:t.label}))}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查詢失敗",content:t.response.data.message}})})}getApi_searchAgentList(t){const e={departmentId:t,whichDB:this.$user.getMe().employee.whichDB};return this.$accountAgentApi.searchAgentListInAccountAgentUsingPOST(e).then(t=>t.data.result.filter(t=>null!==t.value).map(t=>({label:t.label,value:t.value}))).catch()}getApi_searchRecordListInAccountAgent(){this.setLoading(!0),this.query=!0;const t={agent:this.form.agent,agentUnit:this.form.agentUnit,enabled:this.form.enabled,endDatetime:ya()(this.form.period[1]).format("YYYY-MM-DD HH:mm"),pageIndex:this.gridData.pagination.current-1,pageSize:this.gridData.pagination.pageSize,principal:this.form.principal,principalUnit:this.form.principalUnit,startDatetime:ya()(this.form.period[0]).format("YYYY-MM-DD HH:mm")};this.$accountAgentApi.searchRecordListInAccountAgentUsingPOST(t).then(t=>{const e=t.data.result;this.gridData.data=e.content,this.downloadSearchData={agent:this.form.agent,agentUnit:this.form.agentUnit,enabled:this.form.enabled,endDatetime:ya()(this.form.period[1]).format("YYYY-MM-DD HH:mm"),principal:this.form.principal,principalUnit:this.form.principalUnit,startDatetime:ya()(this.form.period[0]).format("YYYY-MM-DD HH:mm")}}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"查詢失敗",content:t.response.data.message}})}).finally(()=>{this.setLoading(!1)})}getApi_closeRecordInAccountAgent(t){this.setLoading(!0),this.$accountAgentApi.closeRecordInAccountAgentUsingPOST(t).then(t=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"結束代理成功",autoClose:3}}),this.getApi_searchRecordListInAccountAgent()}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"結束代理失敗"}})}).finally(()=>{this.setLoading(!1)})}getApi_download(){this.setLoading(!0),this.$accountAgentApi.downloadRecordListInAccountAgentUsingPOST(this.downloadSearchData,{responseType:"blob"}).then(t=>{this.$blobUtils.downloadFile(t,"代理人紀錄_"+ya()().format("YYYYMMDD_HHmmss"))}).catch(t=>{}).finally(()=>{this.setLoading(!1)})}openBuildModal(){this.buildModalVisible=!0}openEditModal(t){this.editModalAccountAgentId=t,this.editModalVisible=!0}search(){this.$refs.formRef.validate(t=>{t&&this.getApi_searchRecordListInAccountAgent()})}handleTableChange(t){this.gridData.pagination.current=t.pagination.current,this.gridData.pagination.pageSize=t.pagination.pageSize,this.getApi_searchRecordListInAccountAgent()}reset(){this.query=!1,this.form={agent:void 0,agentUnit:void 0,enabled:"*",principal:void 0,principalUnit:void 0,period:null};const t=new Date(ya()(new Date).minute(0).format()),e=new Date(ya()(new Date).add(1,"d").minute(0).format());this.form.period=[t,e],this.downloadSearchData=null}handleSearch(){this.search()}download(){this.getApi_download()}created(){this.getApi_searchAgentDeptList()}mounted(){this.currentRoleId=this.$global.getCurrentRoleId(),this.reset(),this.getApi_searchRecordListInAccountAgent()}async watchToUnit(t){this.form.principal=void 0,t&&(this.selectOptions.toAgentList=await this.getApi_searchAgentList(t))}async watchUnit(t){this.form.agent=void 0,t&&(this.selectOptions.agentList=await this.getApi_searchAgentList(t))}};Object(J.a)([Object(tt.a)("setLoading")],Rn.prototype,"setLoading",void 0),Object(J.a)([Pn.Action("setModalState")],Rn.prototype,"setModalState",void 0),Object(J.a)([Object(et.e)("form.principalUnit")],Rn.prototype,"watchToUnit",null),Object(J.a)([Object(et.e)("form.agentUnit")],Rn.prototype,"watchUnit",null),Rn=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,BuildAgentModal:xn,EditAgentModal:Ln,IconTextButton:Ut,CustomPopConfirm:ce}})],Rn);var En=Rn,$n=(a("8d1d"),Object(st.a)(En,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"accountAgent",staticClass:"container"},[a("div",{staticClass:"d-flex justify-content-between"},[a("div",{staticClass:"page__title"},[t._v(" 代理人設定 ")]),a("div",{staticClass:"pt-4"},[a("IconTextButton",{attrs:{text:"建立代理事項",type:"add"},on:{click:t.openBuildModal}})],1)]),a("div",{staticClass:"form__container",class:{"mb-0":t.query}},[a("div",{staticClass:"form__container__title"},[t._v(" 代理紀錄查詢 ")]),a("a-form-model",{ref:"formRef",attrs:{model:t.form,rules:t.formRules}},[a("div",{staticClass:"row form__option"},[a("div",{staticClass:"col-6 col-xl-4"},[a("div",{staticClass:"input__title"},[t._v(" 被代理人單位 ")]),a("a-form-model-item",{attrs:{prop:"principalUnit"}},[a("a-select",{staticClass:"input__block",attrs:{placeholder:"e.g. VL000 職安管理部","allow-clear":!0,options:t.selectOptions.units},model:{value:t.form.principalUnit,callback:function(e){t.$set(t.form,"principalUnit",e)},expression:"form.principalUnit"}})],1)],1),a("div",{staticClass:"col-6 col-xl-4 mb-2"},[a("div",{staticClass:"input__title"},[t._v(" 被代理人姓名 ")]),a("a-form-model-item",{attrs:{prop:"principal"}},[a("a-select",{staticClass:"input__block",attrs:{placeholder:"e.g. 林曉春","allow-clear":!0,options:t.selectOptions.toAgentList},model:{value:t.form.principal,callback:function(e){t.$set(t.form,"principal",e)},expression:"form.principal"}})],1)],1),a("div",{staticClass:"col-12 col-xl-4"},[a("div",{staticClass:"input__title"},[t._v(" 是否啟用 ")]),a("a-form-model-item",{attrs:{prop:"enabled"}},[a("a-radio-group",{staticClass:"row",model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}},[a("div",{staticClass:"col-4"},[a("a-radio",{staticClass:"radio__block",attrs:{value:"*"}},[t._v(" 全部 ")])],1),a("div",{staticClass:"col-4"},[a("a-radio",{staticClass:"radio__block",attrs:{value:"Y"}},[t._v(" 是 ")])],1),a("div",{staticClass:"col-4"},[a("a-radio",{staticClass:"radio__block",attrs:{value:"N"}},[t._v(" 否 ")])],1)])],1)],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 col-xl-4"},[a("div",{staticClass:"input__title"},[t._v(" 代理人單位 ")]),a("a-form-model-item",{attrs:{prop:"agentUnit"}},[a("a-select",{staticClass:"input__block",attrs:{placeholder:"e.g. VL000 職安管理部",options:t.selectOptions.units},model:{value:t.form.agentUnit,callback:function(e){t.$set(t.form,"agentUnit",e)},expression:"form.agentUnit"}})],1)],1),a("div",{staticClass:"col-6 col-xl-4 mb-2"},[a("div",{staticClass:"input__title"},[t._v(" 代理人姓名 ")]),a("a-form-model-item",{attrs:{prop:"agent"}},[a("a-select",{staticClass:"input__block",attrs:{placeholder:"e.g. 林曉春","allow-clear":!0,options:t.selectOptions.agentList},model:{value:t.form.agent,callback:function(e){t.$set(t.form,"agent",e)},expression:"form.agent"}})],1)],1),a("div",{staticClass:"col-6 col-xl-4"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input__title"},[t._v(" 代理時間起迄 ")]),a("div",{staticClass:"mark-required"},[t._v(" * ")])]),a("a-form-model-item",{attrs:{prop:"period"}},[a("date-picker",{staticClass:"input__block",attrs:{"disabled-date":t.disableDate,"show-time":"",range:"","show-time-panel":t.showTimeRangePanel,"minute-step":30,type:"datetime",format:"YYYY/MM/DD HH:mm",formatter:t.formatter,"show-second":!1,clearable:!0,editable:!1,open:t.isContactDatePickerOpen},on:{"update:open":function(e){t.isContactDatePickerOpen=e},open:t.openContactDatesPicker},scopedSlots:t._u([{key:"footer",fn:function(){return[a("a-space",[a("a-button",{attrs:{type:"primary",size:"small"},on:{click:t.toggleTimeRangePanel}},[t._v(" "+t._s(t.showTimeRangePanel?"選擇日期":"選擇時間")+" ")]),a("a-button",{attrs:{size:"small",type:"primary"},on:{click:t.closeContactDatesPicker}},[t._v(" 確定 ")])],1)]},proxy:!0}]),model:{value:t.form.period,callback:function(e){t.$set(t.form,"period",e)},expression:"form.period"}})],1)],1)])]),a("div",{staticClass:"button__wrap text-center"},[a("button",{staticClass:"btn__radius--primary--outline mb-2",on:{click:t.reset}},[t._v(" 重設 ")]),a("button",{staticClass:"btn__radius--primary mb-2",on:{click:t.handleSearch}},[t._v(" 查詢 ")])])],1),!0===t.query?a("div",{staticClass:"result__block"},[a("div",{staticClass:"result__block__header d-flex justify-content-between"},[a("div",{staticClass:"result__block__title"},[t._v(" 代理紀錄查詢結果 ")]),a("div",[t.gridData.data.length>0?a("button",{staticClass:"btn__radius--primary--outline--small",attrs:{disabled:!t.downloadEnabled},on:{click:t.download}},[t._v(" 下載 ")]):t._e()])]),a("div",{staticClass:"table"},[a("FblDataGrid",{attrs:{"row-key":t.gridData.rowKey,columns:t.gridData.columns,data:t.gridData.data,pagination:t.gridData.pagination,"empty-data":t.gridData.data.length<=0,scroll:{x:!0}},on:{tableChange:t.handleTableChange},scopedSlots:t._u([{key:"toUnitDisplay",fn:function(e){return[a("div",[t._v(t._s(e.data.principalUnit.departmentName))])]}},{key:"unitDisplay",fn:function(e){return[a("div",[t._v(t._s(e.data.agentUnit.departmentName))])]}},{key:"enabled",fn:function(e){return[a("CustomPopConfirm",{attrs:{disabled:!t.canEdit(e.data),title:"確定提早結束代理人設定？"},on:{confirm:function(a){return t.getApi_closeRecordInAccountAgent(e.data.accountAgentId)}}},[a("div",{class:{datalink:t.canEdit(e.data)}},[t._v(" "+t._s("Y"===e.data.enabled.keyId?"是":"否")+" ")])])]}},{key:"edit",fn:function(e){return[a("div",{staticClass:"d-flex justify-content-center edit__block",class:{disabled__block:!t.canEdit(e.data)}},[a("button",{staticClass:"d-flex justify-content-center align-items-center iconblock",attrs:{disabled:!t.canEdit(e.data)},on:{click:function(a){return t.openEditModal(e.data.accountAgentId)}}},[a("a-icon",{attrs:{type:"edit"}})],1)])]}}],null,!1,99014451)})],1)]):t._e(),a("BuildAgentModal",{attrs:{visible:t.buildModalVisible},on:{"update:visible":function(e){t.buildModalVisible=e}}}),a("EditAgentModal",{attrs:{visible:t.editModalVisible,"edit-modal-account-agent-id":t.editModalAccountAgentId},on:{"update:visible":function(e){t.editModalVisible=e}}})],1)}),[],!1,null,"0cc34308",null).exports);let Fn=class extends et.d{constructor(){super(...arguments),this.result=null,this.msg=null}setParam(){const t=this.$global.getQuery();t&&(this.result=t.result,this.msg=t.msg)}get type(){return"edit"===this.$route.params.type?"編輯":"建立"}get successStr(){return"edit"===this.$route.params.type?"您欲編輯的代理事項已完成，謝謝。":"您欲建立的代理事項已成功，並已發送通知給指定代理人，謝謝。"}goback(){this.$router.push({name:"AccountAgentIndex"})}created(){this.setParam()}};Fn=Object(J.a)([Object(et.a)({components:{Result:ln}})],Fn);var Un=Fn,Gn=(a("5679"),Object(st.a)(Un,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("Result",{attrs:{"page-title":"執行結果","result-title":"success"===t.result?t.type+"成功":t.type+"失敗","result-type":t.result},scopedSlots:t._u([{key:"body",fn:function(){return["success"===t.result?[a("div",[t._v(" 親愛的同仁您好， "),a("br"),t._v(" "+t._s(t.successStr)+" ")])]:[a("div",[t._v(" 親愛的同仁您好， "),a("br"),t._v(" 您欲"+t._s(t.type)+"的代理事項，因"+t._s(t.msg)+"因素無法進行。 "),a("br"),t._v(" 如尚需執行，請您再次嘗試。或與相關服務人員聯繫，謝謝您！ ")])]]},proxy:!0},{key:"buttons",fn:function(){return[a("div",{staticClass:"btn__wrap"},[a("button",{staticClass:"btn__radius--primary me-1",attrs:{href:"#"},on:{click:t.goback}},[t._v(" 返回主頁 ")])])]},proxy:!0}])})],1)}),[],!1,null,"3b71f23b",null).exports),Yn={beforeRouteEnter(t,e,a){a(t=>{t.$router.replace(e.path)})}},Nn=Object(st.a)(Yn,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,"0c04f234",null).exports,Vn=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content__img col-8"},[e("img",{attrs:{src:a("d983")}})])}];let qn=class extends et.d{goIndex(){this.$router.push({name:"Index"})}};qn=Object(J.a)([Object(et.a)({})],qn);var Bn=qn,zn=(a("aac1"),Object(st.a)(Bn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content row"},[a("div",{staticClass:"col-4"},[a("div",{staticClass:"notfound__title mt-4"},[t._v(" 404 ")]),a("div",{staticClass:"notfound__text"},[t._v(" 抱歉，您訪問的頁面不存在 ")]),a("a-button",{staticClass:"btn--backhome mt-2",on:{click:t.goIndex}},[t._v(" 回首頁 ")])],1),t._m(0)])}),Vn,!1,null,"f21a8ab0",null).exports),Hn=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12 col-md"},[e("img",{staticClass:"result__img",attrs:{src:a("d4dd"),alt:""}})])}];let Qn=class extends et.d{goLogin(){this.$router.push({name:"Login"})}};Qn=Object(J.a)([Object(et.a)({})],Qn);var Wn=Qn,Kn=(a("cc35"),Object(st.a)(Wn,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"result__row row"},[t._m(0),a("div",{staticClass:"result__content col-12 col-md"},[a("p",{staticClass:"result__title"},[t._v(" Sorry 無權限訪問 ")]),a("p",{staticClass:"result__text"},[t._v(" 您的帳號無權限登入使用 ")]),a("button",{staticClass:"btn--backhome",on:{click:t.goLogin}},[t._v(" 回登入頁 ")])])])])}),Hn,!1,null,"0d86ffd1",null).exports);const Jn=$.a.prototype.push;$.a.prototype.push=function(t){return Jn.call(this,t).catch(t=>t)},E.default.use($.a),E.default.prototype.beforeEnter$=new pt.a(null);const Zn=[{path:"/login",name:"Login",component:ot},{path:"/no-authorization",name:"NoAuthorization",component:Kn},{path:"/refresh",name:"Refresh",component:Nn},{path:"/",name:"Main",redirect:"/index",component:ut,children:[{path:"/index",name:"Index",component:lt},{path:"crawler-data/:type(todo|all)?",name:"DataCollectIndex",component:Sa,meta:{breadcrumb:["資料蒐集確認"]}},{path:"crawler-data/detail",name:"CrawlerDataDetail",component:Ci,meta:{breadcrumb:["資料蒐集確認"]}},{path:"crawler-data/upload",name:"CrawlerDataUpload",component:ca},{path:"audit-plan/:type(todo|all)?",name:"AuditPlanIndex",component:Ze,meta:{breadcrumb:["年度稽核計畫","年度稽核計畫一覽表"]}},{path:"audit-plan/result",name:"AuditPlanResult",component:aa,meta:{breadcrumb:["年度稽核計畫","結案"]}},{path:"preparation/:type(todo|all)?",name:"PreparationIndex",component:Fi,meta:{breadcrumb:["查核行前規劃","季工作規劃表"]}},{path:"preparation/work-planning",name:"WorkPlanning",component:_s,meta:{breadcrumb:["查核行前規劃","工作規劃表"]}},{path:"auditing/:type(todo|all)?",name:"WorkPaperIndex",component:Ss,meta:{breadcrumb:["工作底稿"]}},{path:"auditing/detail",name:"AuditingDetail",component:Js,meta:{breadcrumb:["工作底稿"]}},{path:"auditing/content",name:"AuditingContent",component:Mo,meta:{breadcrumb:["工作底稿","查核內容"]}},{path:"auditing/result",name:"AuditingResult",component:Lo,meta:{breadcrumb:["工作底稿","查核結束"]}},{path:"admin",name:"admin",component:Eo,children:[{path:"account/:type(todo|all)?",name:"AccountIndex",component:en,meta:{breadcrumb:["系統設定","使用者維護"]}},{path:"account/:type(pass|reject|edit)",name:"AccountResult",component:un,meta:{breadcrumb:["系統設定","使用者維護","執行結果"]}},{path:"parameter",name:"ParameterIndex",component:wn,meta:{breadcrumb:["系統設定","參數設定"]}},{path:"account-agent",name:"AccountAgentIndex",component:$n,meta:{breadcrumb:["系統設定","代理人設定"]}},{path:"account-agent/:type(add|edit)",name:"AccountAgentResult",component:Gn,meta:{breadcrumb:["系統設定","代理人設定","執行結果"]}}]},{path:"AuditOpinionIndex",name:"AuditOpinionIndex",component:zn},{path:"AuditMeetingIndex",name:"AuditMeetingIndex",component:zn},{path:"AuditReportIndex",name:"AuditReportIndex",component:zn},{path:"IssueTrackingIndex",name:"IssueTrackingIndex",component:zn}],beforeEnter(t,e,a){E.default.prototype.$user.hasValidToken()?a():(R.a.warn("尚未登入"),a({name:"Login"}))}},{path:"/:pathMatch(.*)*",name:"NotFound",component:zn}],Xn=new $.a({mode:"history",base:"/",routes:Zn});Xn.beforeEach((t,e,a)=>{if("/login"===t.path)return a();E.default.prototype.beforeEnter$.next({to:t,from:e}),a()});var tr=Xn,er=a("bc3a"),ar=a.n(er),ir=a("a884"),sr=new class{install(t,e){t.prototype.$authApi=Object(ir.AuthApiFactory)(e,"/iams-api",ar.a),t.prototype.$accountApi=Object(ir.AccountApiFactory)(e,"/iams-api",ar.a),t.prototype.$roleApi=Object(ir.RoleApiFactory)(e,"/iams-api",ar.a),t.prototype.$menuApi=Object(ir.MenuApiFactory)(e,"/iams-api",ar.a),t.prototype.$announcementApi=Object(ir.AnnouncementApiFactory)(e,"/iams-api",ar.a),t.prototype.$dataCollectApi=Object(ir.DataCollectApiFactory)(e,"/iams-api",ar.a),t.prototype.$auditPlanApi=Object(ir.AuditPlanApiFactory)(e,"/iams-api",ar.a),t.prototype.$parameterApi=Object(ir.ParameterApiFactory)(e,"/iams-api",ar.a),t.prototype.$preparationApi=Object(ir.PreparationApiFactory)(e,"/iams-api",ar.a),t.prototype.$workPaperApi=Object(ir.WorkPaperApiFactory)(e,"/iams-api",ar.a),t.prototype.$accountAgentApi=Object(ir.AccountAgentApiFactory)(e,"/iams-api",ar.a)}},or=a("14b7"),nr=a.n(or),rr=a("2f62"),lr=a("6fc5");let cr=class extends lr.d{constructor(){super(...arguments),this.isLoadingArr=[],this.windowSize="lg",this.is403ChangingRole=!1}get getLoading(){return this.isLoadingArr.length>0}get getWindowSize(){return this.windowSize}get getIs403ChangingRole(){return this.is403ChangingRole}SET_LOADING(t){t?this.isLoadingArr.push("1"):this.isLoadingArr.shift()}SET_WINDOWSIZE(t){this.windowSize=t>=1920?"xxl":t>=1280?"xl":t>=992?"lg":t>=768?"md":t>=576?"sm":"xs"}SET_IS403CHANGINGROLE(t){this.is403ChangingRole=t}setLoading(t){this.context.commit("SET_LOADING",t)}setWindowSize(t){this.context.commit("SET_WINDOWSIZE",t)}setIs403ChangingRole(t){this.context.commit("SET_IS403CHANGINGROLE",t)}};Object(J.a)([lr.c],cr.prototype,"SET_LOADING",null),Object(J.a)([lr.c],cr.prototype,"SET_WINDOWSIZE",null),Object(J.a)([lr.c],cr.prototype,"SET_IS403CHANGINGROLE",null),Object(J.a)([lr.a],cr.prototype,"setLoading",null),Object(J.a)([lr.a],cr.prototype,"setWindowSize",null),Object(J.a)([lr.a],cr.prototype,"setIs403ChangingRole",null),cr=Object(J.a)([Object(lr.b)({namespaced:!1})],cr);var dr=cr,ur=new class{changeRouterAndaddParam({toRouter:t,query:e,params:a},i){const s=this.opt.router;sessionStorage.param&&null!==JSON.parse(sessionStorage.param)||(sessionStorage.param=JSON.stringify({}));const o=JSON.parse(sessionStorage.param),n={};let r;if(r="self"===t?s.history.current.name:t,n[r]={query:e,fromPage:s.history.current.name},sessionStorage.param=JSON.stringify(Object.assign(o,n)),i){const e=this.opt.router.resolve({name:t}),a=(new Date).getMilliseconds().toString();window.open(e.href,a).focus()}else{if("self"===t)return;this.opt.router.push({name:r,params:a})}}addParam({toRouter:t,query:e}){const a=this.opt.router;sessionStorage.param&&null!==JSON.parse(sessionStorage.param)||(sessionStorage.param=JSON.stringify({}));const i=JSON.parse(sessionStorage.param),s={};s[t]={query:e,fromPage:a.history.current.name},sessionStorage.param=JSON.stringify(Object.assign(i,s))}clearParam(){sessionStorage.param=null}getParam(){const t=this.opt.router.history.current.name;if(sessionStorage.param){if(""!==sessionStorage.param){if(JSON.parse(sessionStorage.param)&&null!==JSON.parse(sessionStorage.param)){const e=JSON.parse(sessionStorage.param);return Object.keys(e).includes(t)?e[t]:null}return null}return null}return null}getQuery(){return null===this.getParam()?null:this.getParam().query}getAllParamKey(){return Object.keys(JSON.parse(sessionStorage.param))}getCurrentRole(){if(sessionStorage.getItem("currentRoleData"))return JSON.parse(sessionStorage.getItem("currentRoleData"))}getCurrentRoleId(){return sessionStorage.getItem("currentRoleData")&&"undefined"!==sessionStorage.getItem("currentRoleData")?JSON.parse(sessionStorage.getItem("currentRoleData")).id:null}getCurrentRoleTeamCode(){var t;if(sessionStorage.getItem("currentRoleData"))return null===(t=JSON.parse(sessionStorage.getItem("currentRoleData")).roleUnits[0])||void 0===t?void 0:t.auditorTeamCode}filterOption(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0}autoClearParamFlat(t){if(sessionStorage.param&&null!==JSON.parse(sessionStorage.param)&&"{}"!==sessionStorage.param){const e=this.getAllParamKey(),a=t.matched.filter(t=>null!=t.name).map(t=>t.name);let i;const s=function(e){e.filter(t=>null!==t.name).map(t=>t.name).includes(t.name)?i=e.filter(e=>null!==e.name&&new RegExp(t.path.split("/")[1]).test(e.path)).map(t=>t.name):e.filter(t=>null!=t.children).map(t=>s(t.children))};s(this.opt.router.options.routes);const o=i&&i.length>0?[...new Set([...a,...i])]:[...new Set([...a])];e.map(t=>{if(!o.includes(t)){const e=JSON.parse(sessionStorage.param);delete e[t],sessionStorage.param=JSON.stringify(e)}})}}deepCopyData(t){if("object"!=typeof t||null===t||"[object Date]"===Object.prototype.toString.call(t))return t;const e=Array.isArray(t)?[]:{};for(const a in t){const i=t[a];e[a]=this.deepCopyData(i)}return e}install(t,e){t.prototype.$global=this,this.opt=e}};let pr=class extends lr.d{constructor(){super(...arguments),this.detailData={crawlerData:{caseType:{},confirmStatusVO:{},confrimUser:"",content:"",crawlerDataId:"",dataGroupId:"",fileName:"",groupStatus:"",pageUrl:"",releaseDate:"",subject:"",updateDatetime:""},claimGroup:[],dataRelVOS:[],relProcess_1:[],relProcess_2:[],relProcess_3:[]},this.accountAgentList=[],this.backup={relProcess_1:[],relProcess_2:[],relProcess_3:[]},this.relProcess_3={origin:[],privateOptions:[],flat:[]},this.update={relProcess:!1},this.checkValidation={view1:[],view2:[],view3:[],view4:!1,view5:!1},this.enumData={groupOptions:{},dataTypeEnum:{}},this.modalState={confirmGroupModal:{visible:!1},reviewCommitModal:{visible:!1,type:"confirm"},claimFormModal:{visible:!1,isClaim:!1}},this.confirmData={agree:!0,crawlerDataId:"string",dataRelVOS:[{auditItem:"string",dataGroupId:"string",dataGroupLogId:"string",dataRelId:"string",operate:"add",relContent:{article:"string",content:"string",item:"string",paragraph:"string",subparagraph:"string"},relId:"string",relItem:"string",relProcess:"1"}],remark:"string",roleId:"string"}}get getDetailData(){return this.detailData.crawlerData}get getConfirmData(){return{agree:!0,crawlerDataId:this.detailData.crawlerData.crawlerDataId,dataRelVO:[...this.detailData.relProcess_1.filter(t=>"add"===t.operate),...this.detailData.relProcess_2.filter(t=>"add"===t.operate),...this.detailData.relProcess_3.filter(t=>"add"===t.operate)],remark:"",roleId:""}}get getSubmitData(){return{caseType:Object.keys(this.detailData.crawlerData.caseType)[0],crawlerDataId:this.detailData.crawlerData.crawlerDataId,dataGroupId:this.detailData.crawlerData.dataGroupId,dataRelVO:[...this.detailData.relProcess_1.filter(t=>"add"===t.operate),...this.detailData.relProcess_2.filter(t=>"add"===t.operate),...this.detailData.relProcess_3.filter(t=>"add"===t.operate)]}}get getSaveData(){return{caseType:Object.keys(this.detailData.crawlerData.caseType)[0],crawlerDataId:this.detailData.crawlerData.crawlerDataId,dataGroupId:this.detailData.crawlerData.dataGroupId,dataRelVO:[...this.detailData.relProcess_1.filter(t=>"add"===t.operate),...this.detailData.relProcess_2.filter(t=>"add"===t.operate),...this.detailData.relProcess_3.filter(t=>"add"===t.operate)]}}get getUpdate(){return this.update}get getRelProcess_1(){return this.detailData.relProcess_1}get getRelProcess_2(){return this.detailData.relProcess_2}get getRelProcess_3(){return this.detailData.relProcess_3}get getRelProcess_3Data(){return this.relProcess_3}get getCheckValidation(){return this.checkValidation}SET_DETAILDATA(t){Object.keys(t).map(e=>{Object.keys(this.detailData).map(a=>{void 0!==t[a]&&e===a&&(this.detailData[a]=t[a])})})}setDetailData(t){this.context.commit("SET_DETAILDATA",t)}SET_RELPROCESS(t){Object.keys(t).map(e=>{switch(e){case"relProcess_1":case"relProcess_2":const a=this.detailData[e].map(t=>t.auditItem);t[e].map(t=>{a.includes(t.auditItem)||(this.detailData[e].push(t),this.backup[e].push(ur.deepCopyData(t)))});break;case"relProcess_3_origin":this.relProcess_3.origin=ur.deepCopyData(t[e]);const i=ur.deepCopyData(t[e]).privateProgramType;this.relProcess_3.privateOptions=[...new Set(i.map(t=>t.auditItem))].map(t=>{const e=i.find(e=>e.auditItem===t);return{label:e.auditItemName,value:e.auditItem}}),this.relProcess_3.flat=[...this.relProcess_3.origin.publicProgramType,...this.relProcess_3.origin.privateProgramType]}})}setrelProcess(t){this.context.commit("SET_RELPROCESS",t)}SETRELPROCESS3(t){this.detailData.relProcess_3.map(t=>t.dataRelId),this.detailData.relProcess_3.push(t)}setrelProcess3(t){this.context.commit("SETRELPROCESS3",t)}DEL_RELPROCESS({auditItem:t,relprocessId:e}){const a=this.backup[e].find(e=>e.auditItem===t),i=this.detailData[e].find(e=>e.auditItem===t);Object.keys(i.relContent).map(t=>{i.relContent[t]=a.relContent[t]})}delRelProcess(t){this.context.commit("DEL_RELPROCESS",t)}DEL_RELPROCESS3(t){this.detailData.relProcess_3.filter(e=>e.relItem===t).map(t=>{this.detailData.relProcess_3.splice(this.detailData.relProcess_3.indexOf(t),1)})}delRelProcess3(t){this.context.commit("DEL_RELPROCESS3",t)}UPDATED(t){Object.keys(t).map(e=>{Object.keys(this.update).map(a=>{void 0!==t[a]&&e===a&&(this.update[a]=t[e])})})}updated(t){this.context.commit("UPDATED",t)}DEL_ALLRELPROCESS(){this.detailData.relProcess_1=[],this.detailData.relProcess_2=[],this.detailData.relProcess_3=[]}delAllRelProcess(t){this.context.commit("DEL_ALLRELPROCESS")}SETCHECKVALIDATION(){for(let t=1;t<4;t++){const e=this.detailData["relProcess_"+t].filter(e=>"add"===e.operate&&e.relProcess===t.toString()&&""===e.relContent.content.trim());this.checkValidation["view"+t]=3===t?e.map(t=>t.dataRelId):e.map(t=>t.auditItem)}}setCheckValidation(t){this.context.commit("SETCHECKVALIDATION")}CLEARCHECKVALIDATION(t){this.checkValidation["view"+t.key]=this.checkValidation["view"+t.key].filter(e=>e!==t.auditItem)}clearCheckValidation(t){this.context.commit("CLEARCHECKVALIDATION",t)}SETCHECKVALIDATIONVIEW({viewNum:t,validation:e}){this.checkValidation["view"+t]=e}setCheckValidationView(t){this.context.commit("SETCHECKVALIDATIONVIEW",t)}SETACCOUNTAGENTLIST(t){this.accountAgentList=t}setAccountAgentList(t){this.context.commit("SETACCOUNTAGENTLIST",t)}get getAccountAgentList(){return this.accountAgentList}get getGroupOptions(){return this.enumData.groupOptions}get getDataTypeEnum(){return this.enumData.dataTypeEnum}SET_ENUMDATA(t){Object.keys(t).map(e=>{Object.keys(this.enumData).map(a=>{void 0!==t[a]&&(this.detailData[a]=t[e])})}),this.enumData={...this.enumData,...t}}setEnumData(t){this.context.commit("SET_ENUMDATA",t)}get getConfirmGroupModal(){return this.modalState.confirmGroupModal}get getReviewCommitModal(){return this.modalState.reviewCommitModal}get getClaimFormModal(){return this.modalState.claimFormModal}SET_DETAILMODALSTATE(t){Object.keys(t).map(e=>{Object.keys(this.modalState[e]).map(a=>{void 0!==t[e][a]&&(this.modalState[e][a]=t[e][a])})})}setDetailModalState(t){this.context.commit("SET_DETAILMODALSTATE",t)}};Object(J.a)([lr.c],pr.prototype,"SET_DETAILDATA",null),Object(J.a)([lr.a],pr.prototype,"setDetailData",null),Object(J.a)([lr.c],pr.prototype,"SET_RELPROCESS",null),Object(J.a)([lr.a],pr.prototype,"setrelProcess",null),Object(J.a)([lr.c],pr.prototype,"SETRELPROCESS3",null),Object(J.a)([lr.a],pr.prototype,"setrelProcess3",null),Object(J.a)([lr.c],pr.prototype,"DEL_RELPROCESS",null),Object(J.a)([lr.a],pr.prototype,"delRelProcess",null),Object(J.a)([lr.c],pr.prototype,"DEL_RELPROCESS3",null),Object(J.a)([lr.a],pr.prototype,"delRelProcess3",null),Object(J.a)([lr.c],pr.prototype,"UPDATED",null),Object(J.a)([lr.a],pr.prototype,"updated",null),Object(J.a)([lr.c],pr.prototype,"DEL_ALLRELPROCESS",null),Object(J.a)([lr.a],pr.prototype,"delAllRelProcess",null),Object(J.a)([lr.c],pr.prototype,"SETCHECKVALIDATION",null),Object(J.a)([lr.a],pr.prototype,"setCheckValidation",null),Object(J.a)([lr.c],pr.prototype,"CLEARCHECKVALIDATION",null),Object(J.a)([lr.a],pr.prototype,"clearCheckValidation",null),Object(J.a)([lr.c],pr.prototype,"SETCHECKVALIDATIONVIEW",null),Object(J.a)([lr.a],pr.prototype,"setCheckValidationView",null),Object(J.a)([lr.c],pr.prototype,"SETACCOUNTAGENTLIST",null),Object(J.a)([lr.a],pr.prototype,"setAccountAgentList",null),Object(J.a)([lr.c],pr.prototype,"SET_ENUMDATA",null),Object(J.a)([lr.a],pr.prototype,"setEnumData",null),Object(J.a)([lr.c],pr.prototype,"SET_DETAILMODALSTATE",null),Object(J.a)([lr.a],pr.prototype,"setDetailModalState",null),pr=Object(J.a)([Object(lr.b)({namespaced:!0})],pr);var mr=pr;let hr=class extends lr.d{constructor(){super(...arguments),this.modalState={resultModal:{visible:!1,type:"",title:"",content:"",contentHtml:"",autoClose:null,width:"md"}},this.initState={resultModal:{visible:!1,type:"",title:"",content:"",contentHtml:"",autoClose:null,width:"md"}}}get getResultModal(){return this.modalState.resultModal}SET_MODALSTATE(t){Object.keys(t).map(e=>{Object.keys(this.modalState[e]).map(a=>{void 0!==t[e][a]&&(this.modalState[e][a]=t[e][a])})})}setModalState(t){this.context.commit("SET_MODALSTATE",t)}CLOSEMODAL(t){Object.keys(this.modalState[t]).map(e=>{this.modalState[t][e]=this.initState[t][e]})}closeModal(t){this.context.commit("CLOSEMODAL",t)}};Object(J.a)([lr.c],hr.prototype,"SET_MODALSTATE",null),Object(J.a)([lr.a],hr.prototype,"setModalState",null),Object(J.a)([lr.c],hr.prototype,"CLOSEMODAL",null),Object(J.a)([lr.a],hr.prototype,"closeModal",null),hr=Object(J.a)([Object(lr.b)({namespaced:!0})],hr);var fr=hr;E.default.use(rr.a);var gr=new rr.a.Store({modules:{Index:dr,crawlerDataDetailVuex:mr,modalControl:fr}});const br="login_state";var vr=new class{constructor(){this._loginState$=new pt.a(null)}get loginState$(){return this._loginState$}get loginState(){const t=this._loginState$.getValue();if(t)return t;const e=sessionStorage.getItem(br);return e?JSON.parse(e):null}get token(){return this.loginState?this.loginState.accessToken:null}init(){return this.hasValidToken()&&"timeUp"!==localStorage.getItem("sign-out-time")?(this.signIn(this.token),!0):(this.signOut(),!1)}hasValidToken(){const t=this.token;return!!t&&!this.isTokenExpired(t)}signIn(t){gr.dispatch("setLoading",!0);const e={accessToken:null,me:null};e.accessToken=t,ar.a.get("/iams-api/api/auth/me",{headers:{Authorization:"Bearer "+t}}).then(t=>{if(t.data.roles&&0===t.data.roles.length)return tr.replace({path:"/no-authorization"});e.me=t.data,sessionStorage.setItem(br,JSON.stringify(e)),this._loginState$.next(e)}).finally(()=>{gr.dispatch("setLoading",!1)})}signOut(){sessionStorage.removeItem(br),this._loginState$.next(null)}getMe(){return this.loginState?this.loginState.me:null}isTokenExpired(t){const e=nr.a.decode(t),a=Date.now();return Math.floor(a/1e3)>e.exp}install(t,e){t.prototype.$user=this,this.init(),ar.a.interceptors.request.use(t=>{if(this.hasValidToken()&&!("Authorization"in t.headers.common)){const e=this.token;t.headers.common.Authorization="Bearer "+e}return t},t=>Promise.reject(t)),ar.a.interceptors.response.use(t=>t,t=>{var a,i;return 401===t.response.status&&(this.signOut(),e.router.replace({path:"/no-authorization"})),403===t.response.status&&0!==(null===(a=this.loginState)||void 0===a||null===(i=a.me)||void 0===i?void 0:i.roles.length)&&gr.dispatch("setIs403ChangingRole",!0),Promise.reject(t)})}};class _r extends E.default{constructor(){super(...arguments),this.enumCorrespond={dataTypeEnum:{apiInterface:"$dataCollectApi",functionName:"getDataTypeInDataCollectUsingGET"}},this.monthOption=[{value:"01",label:"1月"},{value:"02",label:"2月"},{value:"03",label:"3月"},{value:"04",label:"4月"},{value:"05",label:"5月"},{value:"06",label:"6月"},{value:"07",label:"7月"},{value:"08",label:"8月"},{value:"09",label:"9月"},{value:"10",label:"10月"},{value:"11",label:"11月"},{value:"12",label:"12月"}],this.quarter=[{value:"1",label:"(Q1)1~3月"},{value:"2",label:"(Q2)4~6月"},{value:"3",label:"(Q3)7~9月"},{value:"4",label:"(Q4)10~12月"}],this.roleEnum=[{label:"ROLE_ROOT",value:"系統管理員"},{label:"ROLE_Auditor",value:"查核人員"},{label:"ROLE_Audit_Team_Head",value:"組長"},{label:"ROLE_Audit_Department_Head",value:"部主管"},{label:"ROLE_Audit_Office_Boss_Vice",value:"副總稽核"},{label:"ROLE_Audit_Office_Boss",value:"總稽核"}],this.dataConfirmStatusEnum=[{label:"資料確認中",value:"A"},{label:"資料確認完成",value:"B"},{label:"全組不確認",value:"C"}],this.yapStatusEnum=[{label:"日常維運",value:"A"},{label:"進行中",value:"B"},{label:"主管審閱",value:"C"},{label:"主管審閱完畢",value:"D"},{label:"結案",value:"E"}],this.auditOpinionStatus=[{label:"查核作業中",value:"01"},{label:"組長覆核",value:"02"},{label:"查核意見審核",value:"03"},{label:"查核意見審核(副總稽核)",value:"04"},{label:"查核意見審畢",value:"05"},{label:"查核溝通",value:"06"},{label:"稽核報告審閱",value:"07"},{label:"稽核報告審閱完畢",value:"08"},{label:"此項刪除",value:"90"},{label:"查核結束",value:"99"}],this.dataClaimStatusEnum=[{label:"已認列(處理中)",value:"A"},{label:"已認列(覆核中)",value:"B"},{label:"已認列(已覆核)",value:"C"},{label:"非本組認列(覆核中)",value:"D"},{label:"非本組認列(已覆核)",value:"E"}],this.operate=[{label:"新增",value:"add"},{label:"刪除",value:"delete"},{label:"修改",value:"modify"}],this.approveStatus=[{label:"退回",value:"N"},{label:"同意",value:"Y"},{label:"待確認",value:"X"}],this.chNums=["零","一","二","三","四","五","六","七","八","九"],this.chIntRadice=["","十","百","千"],this.chIntUnits=["","萬","億","兆"]}getValue(t,e){return this[t].find(t=>t.label===e)?this[t].find(t=>t.label===e).value:""}getLabel(t,e){return this[t].find(t=>t.value===e)?this[t].find(t=>t.value===e).label:""}getDataTypeComp(t){switch(t){case"A":return"comp1";case"B":return"comp2";case"C":case"D":case"E":return"comp3";case"F":case"H":case"I":case"G":return"comp4"}}intNumToCh(t){let e,a="";if("string"==typeof t){if(""===t)return"";isNaN(parseFloat(t)),t=t.replace(/,/g,""),e=parseFloat(t)}else"number"==typeof t&&(e=t);if(0===e)return this.chNums[e];let i=0;const s=e.toString(),o=s.length;if(e>=10)for(let t=0;t<o;t++){const e=s.substr(t,1),n=o-t-1,r=n/4,l=n%4;"0"===e?i++:(i>0&&(a+=this.chNums[0]),i=0,a+=0===t&&"1"===e&&1==l?this.chIntRadice[l]:this.chNums[parseInt(e)]+this.chIntRadice[l]),0===l&&i<4&&(a+=this.chIntUnits[r])}else a+=this.chNums[parseInt(s)];return a}install(t){t.prototype.$enum=this}}var yr=new _r,Cr=a("e252"),Or=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header__logo header__logo--logout"},[e("img",{staticClass:"header__logo__img header__logo__img--signout",attrs:{src:a("02fb"),alt:"fubon logo"}})])}];const Ar=Object(tt.c)("modalControl");let Ir=class extends et.d{constructor(){super(...arguments),this.unsubscribe$=new Z.a,this.roleID=null,this.rolesList=null,this.currentRoleData=null,this.userName=null,this.userDepartment=null,this.userMe=null,this.menuList=null,this.currentMenu=null}get roleName(){var t;return this.rolesList&&this.rolesList.length>0&&(null===(t=this.rolesList.find(t=>t.roleId===this.roleID))||void 0===t?void 0:t.name)}created(){this.$user.loginState$.pipe(Object(X.a)(this.unsubscribe$)).subscribe(t=>{t&&t.me&&(this.userMe=t.me,this.setRole())})}getUserDepartmentName(t){return t?-1===t.name.indexOf("部")&&-1===t.name.indexOf("室")?t.name:-1!==t.name.indexOf("部")?null==t?void 0:t.name.substring(0,t.name.indexOf("部")+1):-1!==t.name.indexOf("室")?null==t?void 0:t.name.substring(0,t.name.indexOf("室")+1):void 0:""}getMenu(t){return t.map(t=>({roleId:t.roleId,hierarchy:Object.entries(t.hierarchy).map(t=>({router:t[1].find(t=>t.id===t.parentMenuId),children:t[1].filter(t=>t.id!==t.parentMenuId)}))}))}getRoleList(t){let e=[];return e=t.reduce((t,e)=>{if(e.roleUnits.length>0){const a=[];for(let t=0;t<e.roleUnits.length;t++)a.push({...e,type:"roleUnitId",roleUnits:[e.roleUnits[t]],roleId:e.roleUnits[t].id,roleUnitId:e.roleUnits[t].id,name:e.roleUnits[t].auditorTeamName});return t.concat(a)}return[...t,{...e,type:"roleId",roleId:e.id,roleUnitId:null}]},[]),e}reloadRole(){this.getUserMe()}changeRole(t){this.setLoading(!0);const e=t.roleUnitId?{roleUnitId:t.roleUnitId}:{roleId:t.roleId};this.$accountApi.switchRoleUnitUsingPOST(e).then(t=>{this.getUserMe(),"Index"===this.$route.name?this.$router.replace("/refresh"):this.$router.push({name:"Index"})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"切換角色失敗"}})}).finally(()=>{this.setLoading(!1)})}setRole(){var t;this.userName=null===(t=this.userMe.employee)||void 0===t?void 0:t.name,this.rolesList=this.getRoleList(this.userMe.roles),this.roleID=this.userMe.defaultRoleUnitId?this.userMe.defaultRoleUnitId:this.userMe.defaultRoleId,this.currentRoleData=this.rolesList.find(t=>t.roleId===this.roleID),this.userDepartment=this.getUserDepartmentName(this.userMe.employee.department),this.menuList=this.getMenu(this.rolesList),this.currentMenu=this.menuList.find(t=>t.roleId===this.roleID),sessionStorage.setItem("currentRoleData",JSON.stringify(this.currentRoleData))}getUserMe(){const t=JSON.parse(sessionStorage.getItem("login_state")).accessToken;this.$user.signIn(t)}signOut(){sessionStorage.removeItem("currentRole"),this.$user.signOut(),this.$router.replace({path:"/login"}),this.$emit("signOut")}handleOpenModal(){this.$emit("open-modal")}destroyed(){this.unsubscribe$.next(),this.unsubscribe$.complete()}};Object(J.a)([Object(tt.a)("setLoading")],Ir.prototype,"setLoading",void 0),Object(J.a)([Ar.Action("setModalState")],Ir.prototype,"setModalState",void 0),Ir=Object(J.a)([Object(et.a)({components:{}})],Ir);var Dr=Ir,Sr=(a("dd8b"),Object(st.a)(Dr,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{staticClass:"header"},[t.$user.hasValidToken()?i("div",{staticClass:"header-container"},[i("div",{staticClass:"header__logo",class:{"header__logo--signout":!t.$user.hasValidToken()}},[i("img",{staticClass:"header__logo__img",attrs:{src:a("02fb"),alt:"fubon logo"}}),i("div",{staticClass:"header__logo__text"},[t._v(" 內部稽核管理系統 ")])]),t.currentMenu?i("div",{staticClass:"header__menu"},[i("ul",{staticClass:"header__menu__list"},t._l(t.currentMenu.hierarchy,(function(e){return i("li",{key:e.router.id},[0==e.children.length?[i("router-link",{attrs:{to:{name:e.router.route}}},["000"===e.router.id?i("img",{staticClass:"header__menu__icon",attrs:{src:a("49d8"),alt:""}}):t._e(),i("span",{staticClass:"align-middle header__meun__dropdown__text"},[t._v(" "+t._s(e.router.title)+" ")])])]:[i("a-dropdown",{attrs:{"overlay-class-name":"header__meun__dropdown"}},[i("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},["001"===e.router.id?i("img",{staticClass:"header__menu__icon",attrs:{src:a("ced2"),alt:""}}):t._e(),"009"===e.router.id?i("img",{staticClass:"header__menu__icon",attrs:{src:a("6e0f"),alt:""}}):t._e(),i("span",{staticClass:"align-middle header__meun__dropdown__text"},[t._v(" "+t._s(e.router.title)+" ")])]),i("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},t._l(e.children,(function(e){return i("a-menu-item",{key:e.id},[i("router-link",{attrs:{to:{name:e.route}}},[t._v(" "+t._s(e.title)+" ")])],1)})),1)],1)]],2)})),0)]):t._e(),i("div",{staticClass:"header__info"},[i("div",{staticClass:"header__info__item",on:{click:t.handleOpenModal}},[i("div",{staticClass:"btn__icon--bell"})]),i("div",{staticClass:"header__info__line"}),i("div",{staticClass:"header__info__item"},[i("router-link",{attrs:{to:"/index"}},[i("div",{staticClass:"btn__icon--house"})])],1),i("div",{staticClass:"header__info__line"}),i("div",{staticClass:"header__info__item header__info__dropdown"},[i("a-dropdown",{attrs:{"overlay-class-name":"header__info__dropdown__meun"}},[i("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[i("img",{attrs:{src:a("14a0"),alt:""}}),t._v(" "+t._s(t.roleName)+" "),i("a-icon",{attrs:{type:"down"}})],1),i("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},t._l(t.rolesList,(function(e){return i("a-menu-item",{key:e.roleId,staticClass:"d-flex",on:{click:function(a){return t.changeRole(e)}}},[i("span",{staticClass:"dot",class:{"dot--hidden":!e.todoExisted}}),i("a",[t._v(t._s(e.name))])])})),1)],1)],1),i("div",{staticClass:"header__info__line"}),i("div",{staticClass:"header__info__item header__info__dropdown"},[i("a-dropdown",[i("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[t._v(" "+t._s(t.userName)+" "),i("a-icon",{attrs:{type:"down"}})],1),i("template",{slot:"overlay"},[i("div",{staticClass:"header__logout"},[t.userDepartment?i("div",{staticClass:"d-flex"},[i("img",{staticClass:"header__logout__img",attrs:{src:a("f153"),alt:""}}),i("div",{staticClass:"header__logout__text"},[t._v(" "+t._s(t.userDepartment)+" ")])]):t._e(),i("button",{staticClass:"btn--logout d-inline-block",on:{click:t.signOut}},[t._v(" 登出 ")])])])],2)],1)])]):i("div",{staticClass:"header-container"},[t._m(0)])])}),Or,!1,null,"2a319786",null).exports);let wr=class extends et.d{};wr=Object(J.a)([Object(et.a)({})],wr);var kr=wr,Mr=(a("37fb"),Object(st.a)(kr,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("footer",{staticClass:"footer"},[t._v(" © Fubon Financial. All Rights Reserved 建議您使用瀏覽器版本為Chrome、Safari、Edge最新版本 ")])}),[],!1,null,null,null).exports);const xr=Object(tt.c)("modalControl");let jr=class extends et.d{constructor(){super(...arguments),this.dateFormatter=this.$twDateFormatter,this.formRules={title:[{required:!0,message:"請填寫主旨",trigger:"change"},{max:80,message:"主旨字數上限為80字"}],content:[{required:!0,message:"請填寫公告內容",trigger:"change"},{max:460,message:"公告內容字數上限為460字"}],date:[{required:!0,message:"請填寫時間",trigger:"change"}]},this.form={title:null,content:null,date:null}}onEditDataChanged(){this.editData&&(this.form.title=this.editData.title,this.form.content=this.editData.content,this.form.date=[new Date(""+this.editData.startTimestamp),new Date(""+this.editData.endTimestamp)])}created(){}onConfirm(){this.$refs.formRef.validate(t=>{t&&(this.editData?this.editAnnouncement():this.addAnnouncement())})}addAnnouncement(){this.setLoading(!0);const t={category:"1",title:this.form.title,content:this.form.content,startDatetime:this.form.date[0],endDatetime:this.form.date[1],unitCodeList:[]};this.$announcementApi.createInAnnouncementUsingPOST(t).then(()=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"新增公告成功",autoClose:3}}),this.reloadAnnouncement(),this.close()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"新增公告失敗"}})}).finally(()=>{this.setLoading(!1)})}editAnnouncement(){this.setLoading(!0);const t={id:this.editData.announcementId,title:this.form.title,content:this.form.content,startDatetime:this.form.date[0],endDatetime:this.form.date[1]};this.$announcementApi.modifyInAnnouncementUsingPOST(t).then(()=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"編輯公告成功",autoClose:3}}),this.reloadAnnouncement(),this.close()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"編輯公告失敗"}})}).finally(()=>{this.setLoading(!1)})}close(){this.$emit("closeModal")}reloadAnnouncement(){this.$emit("reloadAnnouncement")}};Object(J.a)([Object(tt.a)("setLoading")],jr.prototype,"setLoading",void 0),Object(J.a)([xr.Action("setModalState")],jr.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],jr.prototype,"visible",void 0),Object(J.a)([Object(et.b)()],jr.prototype,"editData",void 0),Object(J.a)([Object(et.e)("editData")],jr.prototype,"onEditDataChanged",null),jr=Object(J.a)([Object(et.a)({components:{InfoModal:_t}})],jr);var Tr=jr,Lr=(a("6579"),Object(st.a)(Tr,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InfoModal",{attrs:{title:t.editData?"編輯":"新增",visible:t.visible,"body-size":"large","padding-size":"small",closable:!0,centered:!0,footer:!0},on:{closeModal:t.close,confirmModal:t.onConfirm}},[a("template",{slot:"content"},[a("div",{staticClass:"wrap"},[a("a-form-model",{ref:"formRef",attrs:{model:t.form,rules:t.formRules}},[a("a-form-model-item",{attrs:{prop:"title","label-col":{span:3},"wrapper-col":{span:21}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 主旨 ")]),a("a-textarea",{attrs:{"auto-size":{minRows:3,maxRows:5}},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("a-form-model-item",{attrs:{prop:"content","label-col":{span:3},"wrapper-col":{span:21}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 公告內容 ")]),a("a-textarea",{attrs:{"auto-size":{minRows:3,maxRows:5}},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),a("a-form-model-item",{attrs:{prop:"date","label-col":{span:3},"wrapper-col":{span:21}}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 日期 ")]),a("date-picker",{staticClass:"w-100",attrs:{formatter:t.dateFormatter,type:"date",range:"","allow-clear":!0},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1)],1)],1)])],2)}),[],!1,null,"613a207f",null).exports);const Pr=Object(tt.c)("modalControl");let Rr=class extends et.d{constructor(){super(...arguments),this.unsubscribe$=new Z.a,this.showSearch=!1,this.isAdmin=!1,this.searchInput=null,this.keyword="",this.editModaVisible=!1,this.editData=null,this.grid={pagination:{size:"small",current:1,pageSize:10,total:0,pageSizeOptions:["10","25","50"]},data:null,columns:[{title:"",dataIndex:"icon",key:"icon",colSpan:2,scopedSlots:{customRender:"icon"}},{title:"公告日期",dataIndex:"date",colSpan:2,key:"date",scopedSlots:{customRender:"date"}},{title:"主旨/公告內容",dataIndex:"topic",key:"topic",colSpan:8,scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"topicAndContent"}}]}}onVisibleChanged(t){var e;t&&this.getAnnounce(),"ROLE_ROOT"===(null===(e=this.$global)||void 0===e?void 0:e.getCurrentRoleId())&&(this.isAdmin=!0)}handleSearch(t){t(),this.keyword&&null!==this.keyword&&void 0!==this.keyword&&0!==this.keyword.length&&this.getAnnounce(this.keyword)}handleReset(t){t(),this.keyword=""}created(){var t;"ROLE_ROOT"===(null===(t=this.$global)||void 0===t?void 0:t.getCurrentRoleId())&&(this.isAdmin=!0),this.$user.loginState$.pipe(Object(X.a)(this.unsubscribe$)).subscribe(t=>{t&&t.me&&this.getAnnounce()})}getAnnounce(t,e){this.setLoading(!0);const a={startYYYYMMDD:"",endYYYYMMDD:"",keyword:t||"",pageIndex:e||0,pageSize:10,sortList:[]};this.$announcementApi.getRecentListInAnnouncementUsingPOST(a).then(t=>{const e=t.data.result;this.grid.data=e.content,this.grid.pagination.total=parseInt(e.totalElements)}).catch(t=>{this.grid.pagination.total=0,this.grid.data=[]}).finally(()=>{this.setLoading(!1)})}ROCDateformat(t){const e=new Date(t);if(!e)return"";const a=ya()(e,"YYYY").year().toString(),i=parseInt(a,10)-1911;return ya()(e).format(i+"/MM/DD")}handleCancel(){this.$emit("closeModal")}pageChange(t){const e=t.current-1;this.getAnnounce("",e)}onEdit(t){this.editModaVisible=!0,this.editData=t}onAdd(){this.editData=null,this.editModaVisible=!0}onDelete(t){this.setLoading(!0),this.$announcementApi.removeInAnnouncementUsingGET(t.announcementId).then(()=>{this.setModalState({resultModal:{visible:!0,type:"success",title:"刪除公告成功",autoClose:3}}),this.getAnnounce()}).catch(()=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"刪除公告失敗"}})}).finally(()=>{this.setLoading(!1)})}};Object(J.a)([Object(tt.a)("setLoading")],Rr.prototype,"setLoading",void 0),Object(J.a)([Pr.Action("setModalState")],Rr.prototype,"setModalState",void 0),Object(J.a)([Object(et.b)()],Rr.prototype,"visible",void 0),Object(J.a)([Object(et.e)("visible")],Rr.prototype,"onVisibleChanged",null),Rr=Object(J.a)([Object(et.a)({components:{FblDataGrid:gt,AnnouncementEdit:Lr,CustomPopConfirm:ce}})],Rr);var Er=Rr,$r=(a("82c7"),Object(st.a)(Er,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("a-modal",{attrs:{visible:t.visible,closable:!1,footer:null,"wrap-class-name":"modal__primary annouceModal",width:907,centered:!0,"mask-closable":!1}},[i("div",{staticClass:"modal__close flex-center",on:{click:t.handleCancel}},[i("img",{attrs:{src:a("194e"),alt:""}})]),i("div",{staticClass:"modal__content__title d-flex align-items-center"},[i("div",{staticClass:"icon-notificate"},[i("img",{attrs:{src:a("2bb4"),alt:""}})]),t._v(" 最新公告 ")]),i("div",{staticClass:"text-end mt-3"},[t.isAdmin?i("button",{staticClass:"btn__add ms-0",on:{click:t.onAdd}},[t._v(" 新增 ")]):t._e()]),i("a-table",{staticClass:"table__wrap",attrs:{"data-source":t.grid.data,columns:t.grid.columns,scroll:{x:!1,y:!0},"row-key":"announcementId",pagination:t.grid.pagination},on:{change:t.pageChange},scopedSlots:t._u([{key:"filterDropdown",fn:function(e){var a=e.confirm;return i("div",{staticClass:"search__wrap"},[i("a-input",{staticClass:"input__search",on:{pressEnter:function(e){return t.handleSearch(a)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),i("div",{staticClass:"d-flex"},[i("a-button",{staticClass:"btn--dark--small btn__search flex-center",attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleSearch(a)}}},[t._v(" 查詢 ")]),i("a-button",{staticClass:"btn--light--small btn__search flex-center",attrs:{size:"small"},on:{click:function(e){return t.handleReset(a)}}},[t._v(" 取消 ")])],1)],1)}},{key:"filterIcon",fn:function(t){return i("a-icon",{style:{color:t?"#108ee9":void 0},attrs:{type:"search"}})}},{key:"date",fn:function(e,a){return[i("div",{staticClass:"table__tbody__item"},[i("div",{staticClass:"table__tbody__item-bold"},[t._v(" "+t._s(t.ROCDateformat(a.startTimestamp))+" ")])])]}},{key:"topicAndContent",fn:function(e,a){return[i("div",{staticClass:"table__tbody__item"},[i("p",{staticClass:"table__tbody__item-bold"},[t._v(" 主旨 : "+t._s(a.title)+" ")]),i("p",[t._v(" 內容 : "+t._s(a.content)+" ")]),t.isAdmin?i("div",{staticClass:"d-flex justify-content-end pe-2"},[i("div",{staticClass:"btn__icon--edit-acion me-3",on:{click:function(e){return t.onEdit(a)}}}),i("CustomPopConfirm",{on:{confirm:function(e){return t.onDelete(a)}}},[i("div",{staticClass:"btn__icon--delete-action"})])],1):t._e()])]}}])},[i("template",{slot:"icon"},[i("div",{staticClass:"table__tbody-icon"},[i("img",{attrs:{src:a("91f3"),alt:""}})])])],2)],1),i("AnnouncementEdit",{attrs:{"edit-data":t.editData,visible:t.editModaVisible},on:{closeModal:function(e){t.editModaVisible=!1},reloadAnnouncement:t.getAnnounce}})],1)}),[],!1,null,"eb6b91d4",null).exports);const Fr=Object(tt.c)("modalControl");let Ur=class extends et.d{constructor(){super(...arguments),this.iconObj={success:"icon_recogniz_ok",error:"icon_recogniz_no",warning:"icon_remind"},this.typeEnum=["success","error","warning"],this.widthEnum={lg:1200,md:600,sm:470}}get changeWidth(){return Object.keys(this.widthEnum).includes(this.getResultModal.width)?this.widthEnum[this.getResultModal.width]:this.getResultModal.width}handleCancel(){this.closeModal("resultModal")}autoCloseModal(t){this.$setTimeOut=setTimeout(this.handleCancel,1e3*t)}watchVisible(t){clearTimeout(this.$setTimeOut),this.getResultModal.autoClose&&"number"==typeof this.getResultModal.autoClose&&(this.getResultModal.content||this.setModalState({resultModal:{content:`訊息${this.getResultModal.autoClose}秒自動關閉`}}),this.autoCloseModal(this.getResultModal.autoClose))}};Object(J.a)([Fr.Action("setModalState")],Ur.prototype,"setModalState",void 0),Object(J.a)([Fr.Action("closeModal")],Ur.prototype,"closeModal",void 0),Object(J.a)([Fr.Getter("getResultModal")],Ur.prototype,"getResultModal",void 0),Object(J.a)([Object(et.e)("getResultModal.visible",{immediate:!0,deep:!0})],Ur.prototype,"watchVisible",null),Ur=Object(J.a)([Object(et.a)({})],Ur);var Gr=Ur,Yr=(a("219a"),Object(st.a)(Gr,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{visible:t.getResultModal.visible,closable:!1,footer:null,width:t.changeWidth,centered:!0,"z-index":1080,"destroy-on-close":!0,"wrap-class-name":"modal__primary"}},[i("div",{staticClass:"modal__close flex-center",on:{click:t.handleCancel}},[i("img",{attrs:{src:a("194e")}})]),i("div",{staticClass:"content flex-center flex-column"},[t.typeEnum.includes(t.getResultModal.type)?i("img",{staticClass:"content__img",attrs:{src:a("f57b")("./"+t.iconObj[t.getResultModal.type]+".svg")}}):t._e(),i("div",{staticClass:"content__title"},[t._v(" "+t._s(t.getResultModal.title)+" ")]),t.getResultModal.contentHtml?i("div",{staticClass:"content__text",domProps:{innerHTML:t._s(t.getResultModal.contentHtml)}}):t._e(),t.getResultModal.content?i("div",{staticClass:"content__text"},[i("span",[t._v(t._s(t.getResultModal.content))])]):t._e()])])}),[],!1,null,"432344da",null).exports);let Nr=class extends et.d{constructor(){super(...arguments),this.isVisible=!1,this.vm=this,this.lastTime=(new Date).getTime(),this.currentTime=(new Date).getTime()}created(){}timeOut(t=30,e=null){this.lastTime=(new Date).getTime(),this.currentTime=(new Date).getTime(),this.timeOutSecond=60*t*1e3,this.$user.hasValidToken()&&"timeUp"!==localStorage.getItem("sign-out-time")&&this.initTime()}timeUp(){this.cleanUpTime(),this.signOut()}detectTime(){this.currentTime=(new Date).getTime();const t=localStorage.getItem("sign-out-time");("timeUp"===t||this.currentTime-t>this.timeOutSecond)&&this.timeUp()}updateTime(){"timeUp"===localStorage.getItem("sign-out-time")?this.timeUp():(this.lastTime=(new Date).getTime(),localStorage.setItem("sign-out-time",this.lastTime))}initTime(){this.timer&&window.clearInterval(this.timer),localStorage.setItem("sign-out-time",this.lastTime),window.addEventListener("mousemove",this.updateTime),window.addEventListener("keyup",this.updateTime),window.addEventListener("mousedown",this.updateTime),window.addEventListener("scroll",this.updateTime),this.timer=window.setInterval(this.detectTime,1e3)}cleanUpTime(){window.clearInterval(this.timer),window.removeEventListener("mousedown",this.updateTime),window.removeEventListener("keyup",this.updateTime),window.removeEventListener("mousemove",this.updateTime),window.removeEventListener("scroll",this.updateTime),localStorage.setItem("sign-out-time","timeUp")}async signOut(){this.$user.hasValidToken()&&await this.$user.signOut(),"Login"!==this.$route.name&&this.$router.replace({path:"/login"}),this.isVisible=!0}closeModal(){this.isVisible=!1}};Nr=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t}})],Nr);var Vr=Nr,qr=(a("2fb7"),Object(st.a)(Vr,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{visible:t.isVisible,closable:!1,footer:null,width:995,"wrap-class-name":"modal__signout",centered:"centered"}},[i("div",{staticClass:"d-flex timeout"},[i("div",{staticClass:"row w-100"},[i("div",{staticClass:"col"},[i("div",{staticClass:"title"},[t._v(" 系統已登出 ")]),i("div",{staticClass:"content"},[t._v(" 系統閒置超過30分鐘或帳號已登出， "),i("br"),t._v("請重新登入。 ")]),i("button",{staticClass:"btn--backhome",on:{click:t.closeModal}},[t._v(" 關閉 ")])]),i("div",{staticClass:"col"},[i("img",{staticClass:"img",attrs:{src:a("373e"),alt:""}})])])])])}),[],!1,null,"7a815e02",null).exports);const Br=Object(tt.c)("modalControl");let zr=class extends et.d{constructor(){super(...arguments),this.roleList=null,this.form={selectedRole:null},this.formRules={role:[{required:!0,message:"請選擇角色",trigger:"change"}]}}onVisibleChanged(t){t&&this.setRoleList()}created(){}async getRoleList(){this.setLoading(!0);let t=null;return await this.$roleApi.searchAccountRoleListInRoleUsingGET().then(e=>{t=e.data.result}).catch(console.error).finally(()=>{this.setLoading(!1)}),t}async setRoleList(){const t=await this.getRoleList();this.roleList=t.reduce((t,e)=>{if(e.roleUnits.length>0){const a=[];for(let t=0;t<e.roleUnits.length;t++)a.push({...e,type:"roleUnitId",roleUnits:[e.roleUnits[t]],roleId:e.roleUnits[t].id,roleUnitId:e.roleUnits[t].id,name:e.roleUnits[t].auditorTeamName});return t.concat(a)}return[...t,{...e,type:"roleId",roleId:e.id,roleUnitId:null}]},[])}onSubmit(){this.$refs.formRef.validate(t=>{t&&this.changeRole(this.form.selectedRole)})}onSelectRoleHandle(t){}changeRole(t){this.setLoading(!0);const e="roleUnitId"===this.roleList.filter(e=>e.roleId===t)[0].type?{roleUnitId:t}:{roleId:t};this.$accountApi.switchRoleUnitUsingPOST(e).then(t=>{this.closeModal(),this.$emit("reloadHeader"),"Index"===this.$route.name?this.$router.replace("/refresh"):this.$router.push({name:"Index"})}).catch(t=>{this.setModalState({resultModal:{visible:!0,type:"error",title:"切換角色失敗"}})}).finally(()=>{this.setLoading(!1)})}closeModal(){this.form.selectedRole=null,this.setIs403ChangingRole(!1),this.setModalState({resultModal:{visible:!1}})}};Object(J.a)([Br.Action("setModalState")],zr.prototype,"setModalState",void 0),Object(J.a)([tt.b],zr.prototype,"is403ChangingRole",void 0),Object(J.a)([Object(tt.a)("setIs403ChangingRole")],zr.prototype,"setIs403ChangingRole",void 0),Object(J.a)([Object(tt.a)("setLoading")],zr.prototype,"setLoading",void 0),Object(J.a)([Object(et.b)()],zr.prototype,"visible",void 0),Object(J.a)([Object(et.e)("visible")],zr.prototype,"onVisibleChanged",null),zr=Object(J.a)([Object(et.a)({components:{IconTextButton:Ut,InfoModal:_t}})],zr);var Hr=zr,Qr=(a("6246"),Object(st.a)(Hr,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{visible:t.visible,closable:!1,footer:null,width:995,"wrap-class-name":"modal__signout",centered:"centered","z-index":2e3}},[i("div",{staticClass:"d-flex timeout"},[i("div",{staticClass:"row w-100"},[i("div",{staticClass:"col"},[i("div",{staticClass:"title"},[t._v(" 角色異動通知 ")]),i("div",{staticClass:"content"},[t._v(" 當前登入帳號的角色清單被異動， "),i("br"),t._v("請重新指定目前要登入的角色。 ")]),i("div",{staticClass:"flex"},[i("a-form-model",{ref:"formRef",attrs:{model:t.form,rules:t.formRules}},[i("a-form-model-item",{attrs:{prop:"title","label-col":{span:3},"wrapper-col":{span:21}}},[i("a-select",{attrs:{"allow-clear":!0,"show-search":!0,placeholder:"請選擇登入角色"},model:{value:t.form.selectedRole,callback:function(e){t.$set(t.form,"selectedRole",e)},expression:"form.selectedRole"}},t._l(t.roleList,(function(e){return i("a-select-option",{key:e.id,attrs:{"label-in-value":!0,value:e.roleId}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1)],1),i("button",{staticClass:"btn--backhome",on:{click:t.onSubmit}},[t._v(" 確定 ")])]),i("div",{staticClass:"col"},[i("img",{staticClass:"img",attrs:{src:a("373e"),alt:""}})])])])])}),[],!1,null,"75e3baf4",null).exports);let Wr=class extends et.d{};Wr=Object(J.a)([Object(et.a)({})],Wr);var Kr=Wr,Jr=(a("8268"),Object(st.a)(Kr,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"custom__spinWrap flex-center"},[e("a-spin",{staticClass:"custom__spinWrap__content flex-center",attrs:{tip:"請稍後",size:"large"}})],1)}),[],!1,null,"1dff7e90",null).exports);let Zr=class extends et.d{scrollToTop(){this.$emit("scrollToTop")}};Zr=Object(J.a)([Object(et.a)({})],Zr);var Xr=Zr,tl=(a("d7b4"),Object(st.a)(Xr,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"btn--gotop btn__icon--gotop--circle",on:{click:t.scrollToTop}})}),[],!1,null,"a7917c14",null).exports);const el=Object(tt.c)("modalControl");let al=class extends et.d{constructor(){super(...arguments),this.unsubscribe$=new Z.a,this.locale=Cr.a,this.showGotop=!1,this.annouceModalShow=!1}created(){this.setWindowSize(window.innerWidth),window.addEventListener("resize",()=>{this.setWindowSize(window.innerWidth)}),this.$user.loginState$.pipe(Object(X.a)(this.unsubscribe$)).subscribe(t=>{t&&t.me&&this.$refs.timeOut.timeOut()})}mounted(){window.addEventListener("scroll",this.handleScroll)}modalShow(){this.annouceModalShow=!this.annouceModalShow}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}handleScroll(){window.scrollY>1200?this.showGotop=!0:this.showGotop=!1}reloadHeader(){this.$refs.header.reloadRole()}signOut(){this.$refs.timeOut.cleanUpTime()}destroyed(){this.unsubscribe$.next(),this.unsubscribe$.complete()}async watchGlobalRoute(t){this.$global.autoClearParamFlat(t)}};Object(J.a)([el.Action("setModalState")],al.prototype,"setModalState",void 0),Object(J.a)([el.Getter("getResultModal")],al.prototype,"getResultModal",void 0),Object(J.a)([tt.b],al.prototype,"getIs403ChangingRole",void 0),Object(J.a)([tt.b],al.prototype,"getLoading",void 0),Object(J.a)([Object(tt.a)("setWindowSize")],al.prototype,"setWindowSize",void 0),Object(J.a)([Object(et.e)("$route",{immediate:!0,deep:!0})],al.prototype,"watchGlobalRoute",null),al=Object(J.a)([Object(et.a)({components:{Header:Sr,Footer:Mr,AnnoucementModal:$r,Loading:Jr,Breadcrumb:on,GotopButton:tl,TimeOut:qr,ResultModal:Yr,ChangeRole:Qr}})],al);var il=al,sl=(a("1578"),Object(st.a)(il,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-config-provider",{attrs:{locale:t.locale}},[a("div",{attrs:{id:"app"}},[t.getLoading?a("loading"):t._e(),a("AnnoucementModal",{attrs:{visible:t.annouceModalShow},on:{closeModal:t.modalShow}}),a("TimeOut",{ref:"timeOut"}),a("Header",{ref:"header",on:{"open-modal":t.modalShow,signOut:t.signOut}}),a("div",{staticClass:"main-container"},[a("Breadcrumb",{tag:"div"}),a("div",{staticClass:"mainPage"},[a("router-view")],1)],1),t.showGotop?a("GotopButton",{on:{scrollToTop:t.scrollToTop}}):t._e(),a("ResultModal"),a("ChangeRole",{attrs:{visible:t.getIs403ChangingRole},on:{reloadHeader:t.reloadHeader}}),a("Footer")],1)])}),[],!1,null,"1d81dcc2",null).exports);E.default.use(G.a),E.default.use(sr,{}),E.default.use(ur,{router:tr}),E.default.use(yr),E.default.use(vr,{router:tr,message:R.a}),E.default.use(W,{}),E.default.use($.a),E.default.use(Y.a.Plugin),E.default.use(P.a),E.default.use(V.a),E.default.use(L.a),E.default.use(T.a),E.default.component(U.a.name,U.a),E.default.component(j.a.name,j.a),E.default.component(x.c.name,x.c),E.default.component(x.c.Option.name,x.c.Option),E.default.component(x.c.OptGroup.name,x.c.OptGroup),E.default.component(M.a.name,M.a),E.default.component(k.a.name,k.a),E.default.component(w.a.name,w.a),E.default.component(w.a.Sider.name,w.a.Sider),E.default.component(w.a.Header.name,w.a.Header),E.default.component(w.a.Content.name,w.a.Content),E.default.component(w.a.Footer.name,w.a.Footer),E.default.component(S.a.name,S.a),E.default.component(S.a.SubMenu.name,S.a.SubMenu),E.default.component(S.a.Item.name,S.a.Item),E.default.component(D.a.name,D.a),E.default.component(I.a.name,I.a),E.default.component(A.a.name,A.a),E.default.component(O.a.name,O.a),E.default.component(T.a.name,T.a),E.default.component(C.a.name,C.a),E.default.component(y.a.name,y.a),E.default.component(y.a.Item.name,y.a.Item),E.default.component(L.a.name,L.a),E.default.component(L.a.Item.name,L.a.Item),E.default.component(_.a.name,_.a),E.default.component(_.a.Group.name,_.a.Group),E.default.component(v.a.name,v.a),E.default.component(_.a.TextArea.name,_.a.TextArea),E.default.component(_.a.Search.name,_.a.Search),E.default.component(b.a.name,b.a),E.default.component(g.a.name,g.a),E.default.component(g.a.ColumnGroup.name,g.a.ColumnGroup),E.default.component(g.a.Column.name,g.a.Column),E.default.component(f.a.name,f.a),E.default.component(h.a.name,h.a),E.default.component(m.a.name,m.a),E.default.component(p.b.name,p.b),E.default.component(u.a.name,u.a),E.default.component(d.a.name,d.a),E.default.component(c.a.name,c.a),E.default.component(l.a.name,l.a),E.default.component(P.a.name,P.a),E.default.component(P.a.Panel.name,P.a.Panel),E.default.component(r.a.name,r.a),E.default.component(r.a.Dragger.name,r.a.Dragger),E.default.component(n.a.name,n.a),E.default.component(n.a.Group.name,n.a.Group),E.default.component(o.a.name,o.a),E.default.component(s.a.name,s.a),E.default.component(s.a.Group.name,s.a.Group),E.default.component(s.a.Button.name,s.a.Button),E.default.component(i.a.name,i.a),E.default.component("slide-up-down",N.a),E.default.use(Q),E.default.component("DatePicker",q.a),q.a.locale("zh-tw",{formatLocale:z.a,yearFormat:t=>t-1911+" 年",monthFormat:"MMM",monthBeforeYear:!1}),new E.default({router:tr,store:gr,render:t=>t(sl)}).$mount("#app")},cd78:function(t,e,a){t.exports=a.p+"img/icon_list.c33d7485.svg"},ced2:function(t,e,a){t.exports=a.p+"img/icon-home-process.47755604.svg"},cf1e7:function(t,e,a){t.exports=a.p+"img/icon_subproject_add.67522b02.svg"},cf25:function(t,e,a){"use strict";a("f6b6")},cf46:function(t,e,a){t.exports=a.p+"img/icon_recogniz_no.62f5206b.svg"},d1b2:function(t,e,a){},d219:function(t,e,a){t.exports=a.p+"img/icon_add_name.fdaa4d17.svg"},d234:function(t,e,a){t.exports=a.p+"img/icon_working.6466810c.svg"},d427:function(t,e,a){t.exports=a.p+"img/icon_mail_o.8d2b5cb1.svg"},d4dd:function(t,e,a){t.exports=a.p+"img/icon_no_login.3dce239e.svg"},d50b:function(t,e,a){t.exports=a.p+"img/icon_successfully.f84b43c1.svg"},d5d7:function(t,e,a){t.exports=a.p+"img/icon_save.14da7078.svg"},d614:function(t,e,a){t.exports=a.p+"img/icon_group_o.85da38ea.svg"},d6dc:function(t,e,a){"use strict";a("2e00")},d6e4:function(t,e,a){t.exports=a.p+"img/AuditOpinionIndex.6cef4bb1.svg"},d73a:function(t,e,a){t.exports=a.p+"img/icon_communicate1.abda2327.svg"},d7b4:function(t,e,a){"use strict";a("5f5e")},d7d6:function(t,e,a){t.exports=a.p+"img/icon_delete-action.c67eb8e0.svg"},d8fe:function(t,e,a){t.exports=a.p+"img/icon_save_o.1ca052f6.svg"},d983:function(t,e,a){t.exports=a.p+"img/icon_404.35f4e0eb.svg"},da3e1:function(t,e,a){t.exports=a.p+"img/icon_list_o.22209376.svg"},dab2:function(t,e,a){t.exports=a.p+"img/icon_download_light.dbc28b40.svg"},db05:function(t,e,a){t.exports=a.p+"img/icon-home-right-bg.8b07215b.svg"},db1b:function(t,e,a){},db86:function(t,e,a){},dc9d:function(t,e,a){},dd21:function(t,e,a){"use strict";a("5a3c")},dd8b:function(t,e,a){"use strict";a("fba4")},ddb7:function(t,e,a){"use strict";a("9919")},ddf4:function(t,e,a){t.exports=a.p+"img/icon_set_up.f5a33921.svg"},de2a:function(t,e,a){"use strict";a("5365")},debf:function(t,e,a){},df5f:function(t,e,a){t.exports=a.p+"img/DataCollectIndex.a4d83a42.svg"},e00c:function(t,e,a){"use strict";a("7c34")},e207:function(t,e,a){"use strict";a("94f8")},e28b:function(t,e,a){},e3db3:function(t,e,a){"use strict";a("59d5")},e4e4:function(t,e,a){},e536:function(t,e,a){t.exports=a.p+"img/icon_not_recogniz.2b9a9559.svg"},e5e3:function(t,e,a){t.exports=a.p+"img/AuditReportIndex.52b79688.svg"},e69c:function(t,e,a){t.exports=a.p+"img/icon_enter_o.5e9e1892.svg"},e75c:function(t,e,a){"use strict";a("42d8")},e93f:function(t,e,a){t.exports=a.p+"img/icon_course-action_none.6b09deec.svg"},ea59:function(t,e,a){t.exports=a.p+"img/icon-login-6.2e46666e.svg"},eb03:function(t,e,a){"use strict";a("d1b2")},eb0e:function(t,e,a){},ebe1:function(t,e,a){},ec5e:function(t,e,a){t.exports=a.p+"img/IssueTrackingIndex.3b934109.svg"},ed50:function(t,e,a){"use strict";a("1db4")},edf9:function(t,e,a){t.exports=a.p+"img/icon-home-left-bg.ffc0a07a.svg"},ee07:function(t,e,a){t.exports=a.p+"img/icon_main_top_o.6d489005.svg"},eedc:function(t,e,a){t.exports=a.p+"img/ParameterIndex.c43c9252.svg"},f02c:function(t,e,a){t.exports=a.p+"img/icon-show-open.af94c848.svg"},f0bc:function(t,e,a){"use strict";a("1dbe")},f153:function(t,e,a){t.exports=a.p+"img/icon-acount-number.eb06f3d1.svg"},f1c7:function(t,e,a){t.exports=a.p+"img/icon_comparison.34527507.svg"},f310:function(t,e,a){t.exports=a.p+"img/icon_subproject_close_o.d01f3715.svg"},f362:function(t,e,a){t.exports=a.p+"img/icon_close_o.02513ad9.svg"},f3c3:function(t,e,a){},f437:function(t,e,a){t.exports=a.p+"img/icon-login-5.2ca773cf.svg"},f528:function(t,e,a){t.exports=a.p+"img/icon_review_o.e441038c.svg"},f57b:function(t,e,a){var i={"./header/icon-fubon-logo.svg":"02fb","./header/icon-home-collect.svg":"49d8","./header/icon-home-people.svg":"14a0","./header/icon-home-process.svg":"ced2","./header/icon-home-system.svg":"6e0f","./icon-breadcrumb-title.svg":"a3cf","./icon/icon-no-found.svg":"3c7c","./icon/icon_add.svg":"23ee","./icon/icon_add_name.svg":"d219","./icon/icon_add_name_o.svg":"adb0","./icon/icon_add_o.svg":"a383","./icon/icon_add_project.svg":"2ed7","./icon/icon_announcement_1.svg":"2bb4","./icon/icon_announcement_2.svg":"91f3","./icon/icon_bell.svg":"527d","./icon/icon_bell_o.svg":"8bdd","./icon/icon_canned_add.svg":"9925","./icon/icon_canned_o.svg":"85cc","./icon/icon_change.svg":"09a1","./icon/icon_change_none.svg":"3de8","./icon/icon_change_o.svg":"a754","./icon/icon_check_fin.svg":"cbc6","./icon/icon_check_fin_o.svg":"5bda","./icon/icon_close.svg":"76f7","./icon/icon_close_o.svg":"f362","./icon/icon_close_sobv.svg":"b32a","./icon/icon_closed.svg":"948ee","./icon/icon_closed_o.svg":"6817","./icon/icon_communicate.svg":"32c6","./icon/icon_communicate1.svg":"d73a","./icon/icon_communicate1_n.svg":"3668","./icon/icon_communicate1_o.svg":"5d84","./icon/icon_communicate_o.svg":"86ab","./icon/icon_comparison.svg":"f1c7","./icon/icon_comparison_d.svg":"6e34","./icon/icon_comparison_d_o.svg":"3be4","./icon/icon_comparison_o.svg":"573e","./icon/icon_complete.svg":"ca2d","./icon/icon_complete_o.svg":"8d50","./icon/icon_confirm.svg":"3e1a","./icon/icon_confirm_o.svg":"b2c9","./icon/icon_confirm_sobv.svg":"935a","./icon/icon_course-action.svg":"9233","./icon/icon_course-action_none.svg":"e93f","./icon/icon_course-action_o.svg":"f950","./icon/icon_course.svg":"8f1d","./icon/icon_course_o.svg":"06af","./icon/icon_declare.svg":"851d","./icon/icon_delete-action.svg":"d7d6","./icon/icon_delete-action_none.svg":"0c4d","./icon/icon_delete-action_o.svg":"2a94","./icon/icon_delete.svg":"178a","./icon/icon_delete_name.svg":"310b","./icon/icon_delete_name_o.svg":"364c","./icon/icon_delete_o.svg":"909c","./icon/icon_download.svg":"61d6","./icon/icon_download_light.svg":"dab2","./icon/icon_download_light_o.svg":"a8bb","./icon/icon_download_none.svg":"45d7","./icon/icon_download_o.svg":"8a0e","./icon/icon_edit-acion.svg":"93a4","./icon/icon_edit-acion_none.svg":"197b","./icon/icon_edit-acion_o.svg":"b4a1","./icon/icon_edit.svg":"5dc1","./icon/icon_edit_none.svg":"2cad","./icon/icon_edit_o.svg":"f8e4","./icon/icon_enter.svg":"31c9","./icon/icon_enter1.svg":"1543","./icon/icon_enter1_o.svg":"0018","./icon/icon_enter_o.svg":"e69c","./icon/icon_export.svg":"2820","./icon/icon_export1.svg":"68da","./icon/icon_export1_o.svg":"8f2c","./icon/icon_export2.svg":"0993","./icon/icon_export2_o.svg":"6f02","./icon/icon_export_o.svg":"850b","./icon/icon_feedback.svg":"cd3f","./icon/icon_feedback_o.svg":"c072","./icon/icon_group.svg":"056d","./icon/icon_group_o.svg":"d614","./icon/icon_house.svg":"c232","./icon/icon_house_o.svg":"1b6c","./icon/icon_import.svg":"9870","./icon/icon_import_o.svg":"9811","./icon/icon_list.svg":"cd78","./icon/icon_list_o.svg":"da3e1","./icon/icon_mail.svg":"c2f1","./icon/icon_mail_none.svg":"1f9b","./icon/icon_mail_o.svg":"d427","./icon/icon_main_top_o.svg":"ee07","./icon/icon_manpower.svg":"9b66","./icon/icon_manpower_o.svg":"3415","./icon/icon_news.svg":"5398","./icon/icon_question.svg":"670b","./icon/icon_question_o.svg":"b1b0","./icon/icon_question_red.svg":"58e0","./icon/icon_question_red_o.svg":"8c38","./icon/icon_questionnaire.svg":"1a9b","./icon/icon_questionnaire_o.svg":"2e674","./icon/icon_recogniz_no.svg":"6987","./icon/icon_record.svg":"4255","./icon/icon_record_o.svg":"428a","./icon/icon_remind.svg":"4bc9","./icon/icon_return.svg":"4580","./icon/icon_return_o.svg":"6dcf","./icon/icon_review.svg":"a418","./icon/icon_review_o.svg":"f528","./icon/icon_save.svg":"d5d7","./icon/icon_save_o.svg":"d8fe","./icon/icon_search.svg":"c82c","./icon/icon_search_o.svg":"b080","./icon/icon_set_up.svg":"ddf4","./icon/icon_set_up_o.svg":"0a61","./icon/icon_small_delete.svg":"4257","./icon/icon_small_delete_o.svg":"4fce","./icon/icon_small_link.svg":"5633","./icon/icon_small_link_o.svg":"afd7","./icon/icon_sort.svg":"9661","./icon/icon_sort_o.svg":"47e7","./icon/icon_start.svg":"b1e6","./icon/icon_start_o.svg":"37c2","./icon/icon_store.svg":"c97b","./icon/icon_store_o.svg":"016f","./icon/icon_subproject_add.svg":"cf1e7","./icon/icon_subproject_add_o.svg":"fdf7","./icon/icon_subproject_close.svg":"5395","./icon/icon_subproject_close_o.svg":"f310","./icon/icon_successfully.svg":"d50b","./icon/icon_top.svg":"1b99","./icon/icon_upload.svg":"10df","./icon/icon_upload1.svg":"97a5","./icon/icon_upload1_o.svg":"adfe","./icon/icon_upload_o.svg":"f8c7","./icon/icon_version.svg":"5ded","./icon/icon_version_o.svg":"5d92","./icon/icon_web_linke.svg":"a787","./icon/icon_web_linke_o.svg":"6461","./icon/icon_window.svg":"77f5","./icon/icon_window_close.svg":"194e","./icon_404.svg":"d983","./icon_no_login.svg":"d4dd","./icon_not_recogniz.svg":"e536","./icon_question.svg":"31d9","./icon_question1.svg":"ff46","./icon_recogniz.svg":"5430","./icon_recogniz_no.svg":"cf46","./icon_recogniz_ok.svg":"1f4a","./icon_remind.svg":"3253","./icon_successfully.svg":"51bc","./icon_time_out.svg":"373e","./icon_window.svg":"0f11","./icon_working.svg":"d234","./icon_working_1.svg":"b254","./index/AccountAgentIndex.svg":"00b6","./index/AccountIndex.svg":"1de5","./index/AuditMeetingIndex.svg":"1f2b","./index/AuditOpinionIndex.svg":"d6e4","./index/AuditPlanIndex.svg":"677e","./index/AuditReportIndex.svg":"e5e3","./index/DataCollectIndex.svg":"df5f","./index/IssueTrackingIndex.svg":"ec5e","./index/ParameterIndex.svg":"eedc","./index/PreparationIndex.svg":"16a0","./index/WorkPaperIndex.svg":"a37b","./index/icon-home-left-bg.svg":"edf9","./index/icon-home-right-bg.svg":"db05","./index/icon-home-title.svg":"640c","./login/icon-acount-number.svg":"f153","./login/icon-left-bg.svg":"98393","./login/icon-login-1.svg":"9e57","./login/icon-login-2.svg":"339f","./login/icon-login-3.svg":"4961","./login/icon-login-4.svg":"32cf","./login/icon-login-5.svg":"f437","./login/icon-login-6.svg":"ea59","./login/icon-login-7.svg":"3817","./login/icon-password.svg":"495c","./login/icon-right-bg.svg":"4b0d","./login/icon-show-close.svg":"fe1a","./login/icon-show-open.svg":"f02c"};function s(t){var e=o(t);return a(e)}function o(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=o,t.exports=s,s.id="f57b"},f58d:function(t,e,a){},f6b6:function(t,e,a){},f700:function(t,e,a){"use strict";a("abe5")},f7c7:function(t,e,a){},f8c7:function(t,e,a){t.exports=a.p+"img/icon_upload_o.195172f3.svg"},f8e4:function(t,e,a){t.exports=a.p+"img/icon_edit_o.3c9c6ce4.svg"},f8fa:function(t,e,a){"use strict";a("5ada")},f950:function(t,e,a){t.exports=a.p+"img/icon_course-action_o.9cb9c2b3.svg"},fba4:function(t,e,a){},fd5d:function(t,e,a){},fd75:function(t,e,a){},fdf7:function(t,e,a){t.exports=a.p+"img/icon_subproject_add_o.e019126a.svg"},fe1a:function(t,e,a){t.exports=a.p+"img/icon-show-close.a63defbb.svg"},ff29:function(t,e,a){},ff46:function(t,e,a){t.exports=a.p+"img/icon_question1.8e430531.svg"},ffe5:function(t,e,a){}});